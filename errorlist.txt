  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   CVTRPGFRER
     Library  . . . . . . . . . . . :     CVTRPGFREE
   Text 'description' . . . . . . . :   Convert to RPG free
   Source stream file   . . . . . . :   src/cvtrpgfreR.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   10-02-20  11:20:01
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *NOUNREF   *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                     *FREE            000001
      2   Ctl-Opt Debug                                                                                                      000002
      3           DftActGrp( *No ) ActGrp( *Caller )                                                                         000003
      4           Option( *ShowCpy: *SrcStmt: *NoDebugIO );                                                                  000004
 000005                                                                                                                      000005
 000006   //-------------------------------------------------------------------------------------------                      000006
 000007   // Program Name. . . . . : CVTRPGFREE                                                                              000007
 000008   // Program Description . : Convert RPGILE Source Member to Free-form                                               000008
 000009   // Date Created. . . . . : 30/04/2015                                                                              000009
 000010   // Programmer. . . . . . : Ewarwoowar                                                                              000010
 000011   //                                                                                                                 000011
 000012   // By             Date        Fix                                                                                  000012
 000013   // Niels Liisberg 10.02.2020  Support for source more that 999 lines of code                                       000013
 000014   //-------------------------------------------------------------------------------------------                      000014
 000015   // SYNOPSIS :                                                                                                      000015
 000016   // - Reads through an RPGILE source member and reformats the contents.                                             000016
 000017   //-------------------------------------------------------------------------------------------                      000017
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000019   //-------------------------------------------------------------------------------------------                      000019
 000020   // F I L E S                                                                                                       000020
 000021   //-------------------------------------------------------------------------------------------                      000021
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *                 Convert to RPG free                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *SRCSTMT          *
         *                                       *NODEBUGIO *NOUNREF          *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   *NONE                        *
         *  Activation group . . . . . . . . :   *CALLER                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
 000022   Dcl-F QRPGLESRC              EXTMBR(QpFromMbr)                                                                     000022
 000023                                EXTFILE('QTEMP/QRPGLESRC')                                                            000023
 000024                                RENAME(QRPGLESRC:SRCREC)                                                              000024
 000025                                USROPN;                                                                               000025
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC        CVTRPGFREE/QRPGLESRC                        *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         * Record format(s) . . . . . :  SRCREC           QRPGLESRC                                   *
         *--------------------------------------------------------------------------------------------*
 000026                                                                                                                      000026
 000027   Dcl-F QRPGLESRC2             Usage(*OUTPUT) EXTMBR(QpToMbr)                                                        000027
 000028                                EXTFILE('QTEMP/QRPGLESRC2')                                                           000028
 000029                                RENAME(QRPGLESRC2:OUTREC)                                                             000029
 000030                                USROPN;                                                                               000030
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC2       CVTRPGFREE/QRPGLESRC2                       *
         * Record format(s) . . . . . :  OUTREC           QRPGLESRC2                                  *
         *--------------------------------------------------------------------------------------------*
 000031                                                                                                                      000031
 000032   Dcl-F CVTRPGFREP     PRINTER USROPN                                                                                000032
 000033                                OFLIND(overFlow);                                                                     000033
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  CVTRPGFREP       CVTRPGFREE/CVTRPGFREP                       *
         * Record format(s) . . . . . :  Z1PAGHDG         Z1PAGHDG                                    *
         *                               Z1TOPPAG         Z1TOPPAG                                    *
         *                               ZL01HDG          ZL01HDG                                     *
         *                               Z1DETAIL         Z1DETAIL                                    *
         *                               Z1ENDRPT         Z1ENDRPT                                    *
         *--------------------------------------------------------------------------------------------*
 000034                                                                                                                      000034
 000035   //-------------------------------------------------------------------------------------------                      000035
 000036   // P R O C E D U R E   I N T E R F A C E                                                                           000036
 000037   //-------------------------------------------------------------------------------------------                      000037
 000038                                                                                                                      000038
 000039   Dcl-PR CVTRPGFREE               EXTPGM('CVTRPGFREE');                                                              000039
 000040      QpShutDown               Char(1) CONST;                                                                         000040
 000041      QpFromFile               Char(10) CONST;                                                                        000041
 000042      QpFromLib                Char(10) CONST;                                                                        000042
 000043      QpFromMember             Char(10) CONST;                                                                        000043
 000044      QpToFile                 Char(10) CONST;                                                                        000044
 000045                                                                                                                      000045
 000046      QpToLib                  Char(10) CONST;                                                                        000046
 000047      QpToMbr                  Char(10) CONST;                                                                        000047
 000048      QpIndComment             Char(1) CONST;                                                                         000048
 000049      QpRetBlnkCmt             Char(1) CONST;                                                                         000049
 000050      QpDirectives             Char(1) CONST;                                                                         000050
 000051   End-PR;                                                                                                            000051
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000052                                                                                                                      000052
 000053   Dcl-PI CVTRPGFREE;                                                                                                 000053
 ======>         aaaaaaaaaa
 *RNF3776 10 a      000053  External program on prototype for main procedure is not the
                            same as program being created.
 000054      QpShutDown               Char(1) CONST;                                                                         000054
 000055      QpFromFile               Char(10) CONST;                                                                        000055
 000056      QpFromLib                Char(10) CONST;                                                                        000056
 000057      QpFromMbr                Char(10) CONST;                                                                        000057
 000058      QpToFile                 Char(10) CONST;                                                                        000058
 000059      QpToLib                  Char(10) CONST;                                                                        000059
 000060      QpToMbr                  Char(10) CONST;                                                                        000060
 000061      QpIndComment             Char(1) CONST;                                                                         000061
 000062      QpRetBlnkCmt             Char(1) CONST;                                                                         000062
 000063      QpDirectives             Char(1) CONST;                                                                         000063
 000064   End-PI;                                                                                                            000064
 000065                                                                                                                      000065
 000066   //-------------------------------------------------------------------------------------------                      000066
 000067   // P R O T O T Y P E   I N T E R F A C E S                                                                         000067
 000068   //-------------------------------------------------------------------------------------------                      000068
 000069   Dcl-PR GetDeclarationType;                                                                                         000069
 000070      QpDeclType               Char( 2 );                                                                             000070
 000071      QpSavedName              Char( 80 );                                                                            000071
 000072      QpDeclLine                        Like(SRCSEQ);                                                                 000072
 000073   End-PR;                                                                                                            000073
 000074                                                                                                                      000074
 000075   //-------------------------------------------------------------------------------------------                      000075
 000076   // N A M E D   C O N S T A N T S                                                                                   000076
 000077   //-------------------------------------------------------------------------------------------                      000077
 000078   Dcl-C LO                        'abcdefghijklmnopqrstuvwxyz';                                                      000078
 000079   Dcl-C UP                        'ABCDEFGHIJKLMNOPQRSTUVWXYZ';                                                      000079
 000080   Dcl-C VALIDSPECS                'HFDCP';                                                                           000080
 000081                                                                                                                      000081
 000082   //-------------------------------------------------------------------------------------------                      000082
 000083   // D A T A   S T R U C T U R E S                                                                                   000083
 000084   //-------------------------------------------------------------------------------------------                      000084
 000085                                                                                                                      000085
 000086   Dcl-DS SourceData;                                                                                                 000086
 000087      SRCDTA                   Char(100);                                                                             000087
 000088      prefix                   Char(5) OVERLAY(SRCDTA:1);                                                             000088
 000089      lineType                 Char(1) OVERLAY(SRCDTA:6);                                                             000089
 000090      directive                Char(10) OVERLAY(SRCDTA:7);                                                            000090
 000091      codeLine                 Char(93) OVERLAY(SRCDTA:8);                                                            000091
 000092      fullLine                 Char(94) OVERLAY(SRCDTA:7);                                                            000092
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000093                                                                                                                      000093
 000094      condNot                  Char(1) OVERLAY(SRCDTA:9);                                                             000094
 000095      condInd                  Char(2) OVERLAY(SRCDTA:10);                                                            000095
 000096      factor1                  Char(14) OVERLAY(SRCDTA:12);                                                           000096
 000097      opCode                   Char(10) OVERLAY(SRCDTA:26);                                                           000097
 000098      factor2                  Char(14) OVERLAY(SRCDTA:36);                                                           000098
 000099      result                   Char(14) OVERLAY(SRCDTA:50);                                                           000099
 000100      len                      Char(5) OVERLAY(SRCDTA:64);                                                            000100
 000101      dec                      Char(2) OVERLAY(SRCDTA:69);                                                            000101
 000102      hi                       Char(2) OVERLAY(SRCDTA:71);                                                            000102
 000103      lw                       Char(2) OVERLAY(SRCDTA:73);                                                            000103
 000104      eq                       Char(2) OVERLAY(SRCDTA:75);                                                            000104
 000105      comment                  Char(20) OVERLAY(SRCDTA:81);                                                           000105
 000106                                                                                                                      000106
 000107      extFactor2               Char(45) OVERLAY(SRCDTA:36);                                                           000107
 000108                                                                                                                      000108
 000109      nonPrefix                Char(95) OVERLAY(SRCDTA:6);                                                            000109
 000110                                                                                                                      000110
 000111      procType                 Char(1) OVERLAY(SRCDTA:24);                                                            000111
 000112      procKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000112
 000113                                                                                                                      000113
 000114      declName                 Char(15) OVERLAY(SRCDTA:7);                                                            000114
 000115      declExt                  Char(1) OVERLAY(SRCDTA:22);                                                            000115
 000116      declPrefix               Char(1) OVERLAY(SRCDTA:23);                                                            000116
 000117      declType                 Char(2) OVERLAY(SRCDTA:24);                                                            000117
 000118      declSuffix               Char(1) OVERLAY(SRCDTA:26);                                                            000118
 000119      declFrom                 Char(7) OVERLAY(SRCDTA:26);                                                            000119
 000120      declLen                  Char(7) Overlay(SRCDTA:33);                                                            000120
 000121      declAttr                 Char(1) Overlay(SRCDTA:40);                                                            000121
 000122      declScale                Char(3) Overlay(SRCDTA:41);                                                            000122
 000123      declKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000123
 000124      declOptions              Char(73) Overlay(SRCDTA:7);                                                            000124
 000125                                                                                                                      000125
 000126      FileSpec                 Char(100) Overlay(SRCDTA:1);                                                           000126
 000127      fileName                 Char(10) Overlay(FileSpec:7);                                                          000127
 000128      fileUsage                Char(1) Overlay(FileSpec:17);                                                          000128
 000129      fileDesig                Char(1) Overlay(FileSpec:18);                                                          000129
 000130      fileAdd                  Char(1) Overlay(FileSpec:20);                                                          000130
 000131      fileExternal             Char(1) Overlay(FileSpec:22);                                                          000131
 000132      fileKeyed                Char(1) Overlay(FileSpec:34);                                                          000132
 000133      fileDevice               Char(7) Overlay(FileSpec:36);                                                          000133
 000134      fileKeywords             Char(37) Overlay(FileSpec:44);                                                         000134
 000135   End-DS;                                                                                                            000135
 000136                                                                                                                      000136
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000137   // Display file indicators ------------------------------------------------------------------                      000137
 000138   Dcl-DS IndicatorDS;                                                                                                000138
 000139    // 01-30: Function keys                                                                                           000139
 000140    // 31-59: Conditioning indicators (error)                                                                         000140
 000141    // 60-89: Conditioning indicators (non-error)                                                                     000141
 000142    // 90-99: General indicators                                                                                      000142
 000143   // Report file indicators -------------------------------------------------------------------                      000143
 000144    // 01-79: Conditioning indicators (non-error)                                                                     000144
 000145      cndIndicators             Ind Pos(01) DIM(79);                                                                  000145
 000146    // 80-89: Report control                                                                                          000146
 000147      overFlow                  Ind Pos(80);                                                                          000147
 000148    // 90-99: General indicators                                                                                      000148
 000149      errorInd                  Ind Pos(99) INZ(*OFF);                  // Global error                               000149
 000150   End-DS;                                                                                                            000150
 000151                                                                                                                      000151
 000152   Dcl-DS DCLPR                    QUALIFIED;                                                                         000152
 000153      decl                     Char(7) INZ('Dcl-PR ');                                                                000153
 000154      procName                 Char(16);                                                                              000154
 000155      type                     Char(9);                                                                               000155
 000156      definition               Char(37);                                                                              000156
 000157      comment                  Char(23);                                                                              000157
 000158      fieldName                Char(23) Pos(4);                                                                       000158
 000159   End-DS;                                                                                                            000159
 000160                                                                                                                      000160
 000161   Dcl-DS DCLP                     QUALIFIED;                           // Test comment                               000161
 000162      decl                     Char(9) INZ('Dcl-Proc ');                                                              000162
 000163      definition               Char(61);                                                                              000163
 000164      comment                  Char(23);                                                                              000164
 000165   End-DS;                                                                                                            000165
 000166                                                                                                                      000166
 000167   Dcl-DS DCLS                     QUALIFIED;                                                                         000167
 000168      decl                     Char(6) INZ('Dcl-S ');                                                                 000168
 000169      fieldName                Char(17);                                                                              000169
 000170      type                     Char(9);                                                                               000170
 000171      definition               Char(37);                                                                              000171
 000172      comment                  Char(23);                                                                              000172
 000173   End-DS;                                                                                                            000173
 000174                                                                                                                      000174
 000175   Dcl-DS DCLF                     QUALIFIED;                                                                         000175
 000176      decl                     Char(6) INZ('Dcl-F ');                                                                 000176
 000177      fileName                 Char(15);                                                                              000177
 000178      device                   Char(8);                                                                               000178
 000179      definition               Char(44);                                                                              000179
 000180      comment                  Char(23) Pos(70);                                                                      000180
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000181   End-DS;                                                                                                            000181
 000182                                                                                                                      000182
 000183   Dcl-DS DCLH                     QUALIFIED;                                                                         000183
 000184      decl                     Char(8) INZ('Ctl-Opt ');                                                               000184
 000185      options                  Char(62);                                                                              000185
 000186      comment                  Char(23);                                                                              000186
 000187   End-DS;                                                                                                            000187
 000188                                                                                                                      000188
 000189   //-------------------------------------------------------------------------------------------                      000189
 000190   // S T A N D - A L O N E   V A R I A B L E S                                                                       000190
 000191   //-------------------------------------------------------------------------------------------                      000191
 000192   // Template variables (required - do not alter).                                                                   000192
 000193   Dcl-S cfgCommitControl                                               // Test comment                               000193
 000194                               Char(7) INZ('*SLAVE ');                  // *MASTER/*SLAVE                             000194
 000195   Dcl-S cfgCloseDown          Char(1) INZ('N');                        // Close down program?                        000195
 000196   Dcl-S initialCall           Char(1) INZ(*Blank);                                                                   000196
 000197                                                                                                                      000197
 000198   // End of Template variables (required - do not alter).                                                            000198
 000199   //-------------------------------------------------------------------------------------------                      000199
 000200   Dcl-S QopCodeUP             Char(10) DIM(66) PERRCD(1) CTDATA;                                                     000200
 000201   Dcl-S QopCodeLO             Char(10) DIM(66) ALT(QopCodeUP);                                                       000201
 000202   Dcl-S QdeclUP               Char(10) DIM(12) PERRCD(1) CTDATA;                                                     000202
 000203   Dcl-S QdeclLO               Char(10) DIM(12) ALT(QdeclUP);                                                         000203
 000204   Dcl-S Qcomments             Char(92) DIM(3) CTDATA;                                                                000204
 000205   Dcl-S x                   Packed(5:0);                                                                             000205
 000206   Dcl-S y                   Packed(5:0);                                                                             000206
 000207   Dcl-S i                   Packed(5:0);                                                                             000207
 000208   Dcl-S j                   Packed(5:0);                                                                             000208
 000209   Dcl-S blanks                Char(30) INZ(*Blanks);                                                                 000209
 000210   Dcl-S maxIndent           Packed(5:0) INZ(15);                                                                     000210
 000211   Dcl-S movedDefs                 LIKE(result) DIM(9999);                                                            000211
 000212   Dcl-S moveDef                Ind INZ(*Off);                                                                        000212
 000213                                                                                                                      000213
 000214   Dcl-S fromFileLib           Char(21);                                                                              000214
 000215   Dcl-S toFileLib             Char(21);                                                                              000215
 000216                                                                                                                      000216
 000217   Dcl-S operator              Char(10);                                                                              000217
 000218   Dcl-S operatorEnd         Packed(5:0);                                                                             000218
 000219   Dcl-S newOperator        VarChar(10);                                                                              000219
 000220   Dcl-S nonConvRsn                LIKE(codeLine);                                                                    000220
 000221                                                                                                                      000221
 000222   Dcl-S inCode                 Ind INZ(*Off);                                                                        000222
 000223   Dcl-S inArrayData            Ind INZ(*Off);                                                                        000223
 000224   Dcl-S inComment              Ind INZ(*Off);                                                                        000224
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000225   Dcl-S inDeclaration          Ind INZ(*Off);                                                                        000225
 000226   Dcl-S inPrototype            Ind INZ(*Off);                                                                        000226
 000227   Dcl-S inInterface            Ind INZ(*Off);                                                                        000227
 000228   Dcl-S inDatastructure                                                                                              000228
 000229                                Ind INZ(*Off);                                                                        000229
 000230   Dcl-S inExtProc              Ind INZ(*Off);                                                                        000230
 000231   Dcl-S endDS                  Ind INZ(*Off);                                                                        000231
 000232   Dcl-S inDirective            Ind INZ(*Off);                                                                        000232
 000233   Dcl-S inFreeFormat           Ind INZ(*On);                                                                         000233
 000234   Dcl-S inDeclProc             Ind INZ(*Off);                                                                        000234
 000235   Dcl-S indent                 Ind INZ(*Off);                                                                        000235
 000236   Dcl-S inSpan                 Ind INZ(*Off);                                                                        000236
 000237   Dcl-S inCase                 Ind INZ(*Off);                                                                        000237
 000238   Dcl-S convert                Ind INZ(*Off);                                                                        000238
 000239   Dcl-S unindent               Ind INZ(*Off);                                                                        000239
 000240   Dcl-S defsMoved              Ind INZ(*Off);                                                                        000240
 000241   Dcl-S dropLine               Ind INZ(*Off);                                                                        000241
 000242   Dcl-S codeStart                 LIKE(SRCSEQ) INZ(0);                                                               000242
 000243   Dcl-S endLine                   LIKE(SRCSEQ) INZ(0);                 // Close struct here.                         000243
 000244   Dcl-S endFound               Ind;                                                                                  000244
 000245   Dcl-S endDeclType           Char(2);                                                                               000245
 000246                                                                                                                      000246
 000247   Dcl-S savedLineType         Char(1);                                                                               000247
 000248                                                                                                                      000248
 000249   Dcl-S increment           Packed(1:0) INZ(0);                                                                      000249
 000250   Dcl-S indentCount         Packed(5:0) INZ(0);                                                                      000250
 000251   Dcl-S indentSize          Packed(1:0) INZ(3);                                                                      000251
 000252   Dcl-S indentOffset        Packed(5:0) INZ(0);                                                                      000252
 000253   Dcl-S prevOffset          Packed(5:0) INZ(0);                                                                      000253
 000254   Dcl-S currOffset          Packed(5:0) INZ(0);                                                                      000254
 000255   Dcl-S lineEnd             Packed(5:0) INZ(0);                                                                      000255
 000256   Dcl-S mainlineIndent      Packed(5:0) INZ(1);                                                                      000256
 000257                                                                                                                      000257
 000258   Dcl-S savedSRCDTA               LIKE(SRCDTA);                                                                      000258
 000259   Dcl-S sourceLine            Char(93);                                                                              000259
 000260   Dcl-S overflowLine       VarChar(92);                                                                              000260
 000261   Dcl-S workDirective         Char(10);                                                                              000261
 000262   Dcl-S workLineType          Char(1);                                                                               000262
 000263   Dcl-S workDeclType          Char(2);                                                                               000263
 000264   Dcl-S workDeclAttr          Char(1);                                                                               000264
 000265   Dcl-S workDeclName          Char(50);                                                                              000265
 000266   Dcl-S workDeclLine              LIKE(SRCSEQ);                                                                      000266
 000267   Dcl-S workDeclKeywords   VarChar(92);                                                                              000267
 000268                                                                                                                      000268
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000269   Dcl-S tempDeclType          Char(2);                                                                               000269
 000270   Dcl-S tempDeclLine              LIKE(SRCSEQ);                                                                      000270
 000271   Dcl-S tempSavedName         Char(80);                                                                              000271
 000272                                                                                                                      000272
 000273   Dcl-S workFileUsage         Char(1);                                                                               000273
 000274   Dcl-S workFileDesig         Char(1);                                                                               000274
 000275   Dcl-S workFileAdd           Char(1);                                                                               000275
 000276   Dcl-S workFileKeyed         Char(1);                                                                               000276
 000277   Dcl-S workFileDevice        Char(7);                                                                               000277
 000278   Dcl-S checkLength         Packed(5:0);                                                                             000278
 000279   Dcl-S workLength          Packed(7:0);                                                                             000279
 000280                                                                                                                      000280
 000281   Dcl-S savedComment          Char(20);                                                                              000281
 000282   Dcl-S savedName             Char(80);                                                                              000282
 000283                                                                                                                      000283
 000284   Dcl-S padResult              Ind INZ(*Off);                                                                        000284
 000285   Dcl-S padTarget                 LIKE(result);                                                                      000285
 000286                                                                                                                      000286
 000287   Dcl-S scanString                LIKE(factor1);                                                                     000287
 000288   Dcl-S scanBase                  LIKE(factor2);                                                                     000288
 000289   Dcl-S scanLength            Char(10);                                                                              000289
 000290   Dcl-S scanStart             Char(10);                                                                              000290
 000291   Dcl-S scanNoResult           Ind INZ(*Off);                                                                        000291
 000292                                                                                                                      000292
 000293   Dcl-S substLen              Char(10);                                                                              000293
 000294   Dcl-S substStart            Char(10);                                                                              000294
 000295                                                                                                                      000295
 000296   Dcl-S setOff                 Ind INZ(*Off);                                                                        000296
 000297   Dcl-S setOffInd1            Char(2);                                                                               000297
 000298   Dcl-S setOffInd2            Char(2);                                                                               000298
 000299   Dcl-S setOffInd3            Char(2);                                                                               000299
 000300                                                                                                                      000300
 000301   Dcl-S setOn                  Ind INZ(*Off);                                                                        000301
 000302   Dcl-S setOnInd1             Char(2);                                                                               000302
 000303   Dcl-S setOnInd2             Char(2);                                                                               000303
 000304   Dcl-S setOnInd3             Char(2);                                                                               000304
 000305                                                                                                                      000305
 000306   Dcl-S xlateFrom                 LIKE(factor1);                                                                     000306
 000307   Dcl-S xlateTo                   LIKE(factor1);                                                                     000307
 000308   Dcl-S xlateBase                 LIKE(factor2);                                                                     000308
 000309   Dcl-S xlateStart            Char(10);                                                                              000309
 000310                                                                                                                      000310
 000311   Dcl-S caseSubRoutine        Char(10);                                                                              000311
 000312   Dcl-S caseOperator          Char(4);                                                                               000312
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000313                                                                                                                      000313
 000314   Dcl-S catFactor1                LIKE(factor1);                                                                     000314
 000315   Dcl-S catFactor2                LIKE(factor2);                                                                     000315
 000316   Dcl-S catCount            Packed(5:0) INZ(0);                                                                      000316
 000317   Dcl-S catBlanks                 LIKE(factor2);                                                                     000317
 000318                                                                                                                      000318
 000319   Dcl-S durDuration               LIKE(factor2);                                                                     000319
 000320   Dcl-S durCode                   LIKE(factor2);                                                                     000320
 000321   Dcl-S durNewDate             Ind INZ(*Off);                                                                        000321
 000322                                                                                                                      000322
 000323   Dcl-S inEval                 Ind INZ(*Off);                                                                        000323
 000324   Dcl-S evalOperator              Like(opCode);                                                                      000324
 000325   Dcl-S evalOffset          Packed(5:0);                                                                             000325
 000326                                                                                                                      000326
 000327   Dcl-S inCallP                Ind INZ(*Off);                                                                        000327
 000328   Dcl-S callPOperator             Like(opCode);                                                                      000328
 000329   Dcl-S callPOffset         Packed(5:0);                                                                             000329
 000330                                                                                                                      000330
 000331   Dcl-S inDo                   Ind INZ(*Off);                                                                        000331
 000332   Dcl-S doOperator                Like(opCode);                                                                      000332
 000333   Dcl-S doCompare             Char(2);                                                                               000333
 000334                                                                                                                      000334
 000335   Dcl-S inIf                   Ind INZ(*Off);                                                                        000335
 000336   Dcl-S ifOperator                Like(opCode);                                                                      000336
 000337   Dcl-S ifCompare             Char(2);                                                                               000337
 000338                                                                                                                      000338
 000339   Dcl-S inWhen                 Ind INZ(*Off);                                                                        000339
 000340   Dcl-S whenOperator              Like(opCode);                                                                      000340
 000341   Dcl-S whenCompare           Char(2);                                                                               000341
 000342                                                                                                                      000342
 000343   Dcl-S inSQL                  Ind INZ(*Off);                                                                        000343
 000344                                                                                                                      000344
 000345   Dcl-S forCount            Packed(5:0) INZ(0);                                                                      000345
 000346   Dcl-S forLevel            Packed(5:0) DIM(99);                          // Allow for 99                            000346
 000347   Dcl-S forFactor1                LIKE(factor1);                                                                     000347
 000348   Dcl-S forFactor2                LIKE(factor2);                                                                     000348
 000349                                                                                                                      000349
 000350   Dcl-S doCount             Packed(5:0) INZ(0);                                                                      000350
 000351   Dcl-S doLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000351
 000352                                                                                                                      000352
 000353   Dcl-S slCount             Packed(5:0) INZ(0);                                                                      000353
 000354   Dcl-S slLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000354
 000355                                                                                                                      000355
 000356   Dcl-S divFactor1                LIKE(factor1);                                                                     000356
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000357   Dcl-S divFactor2                LIKE(factor2);                                                                     000357
 000358                                                                                                                      000358
 000359   Dcl-S ERRCheck               Ind INZ(*Off);                                                                        000359
 000360   Dcl-S ERRInd                Char(2);                                                                               000360
 000361                                                                                                                      000361
 000362   Dcl-S foundCheck             Ind INZ(*Off);                                                                        000362
 000363   Dcl-S foundInd              Char(2);                                                                               000363
 000364                                                                                                                      000364
 000365   Dcl-S NRFCheck               Ind INZ(*Off);                                                                        000365
 000366   Dcl-S NRFInd                Char(2);                                                                               000366
 000367   Dcl-S NRFFile                   LIKE(factor2);                                                                     000367
 000368                                                                                                                      000368
 000369   Dcl-S EOFCheck               Ind INZ(*Off);                                                                        000369
 000370   Dcl-S EOFInd                Char(2);                                                                               000370
 000371   Dcl-S EOFFile                   LIKE(factor2);                                                                     000371
 000372                                                                                                                      000372
 000373   Dcl-S HICheck                Ind INZ(*Off);                                                                        000373
 000374   Dcl-S HIInd                 Char(2);                                                                               000374
 000375   Dcl-S HiFactor1                 LIKE(factor1);                                                                     000375
 000376   Dcl-S HiFactor2                 LIKE(factor2);                                                                     000376
 000377                                                                                                                      000377
 000378   Dcl-S LWCheck                Ind INZ(*Off);                                                                        000378
 000379   Dcl-S LWInd                 Char(2);                                                                               000379
 000380   Dcl-S LWFactor1                 LIKE(factor1);                                                                     000380
 000381   Dcl-S LWFactor2                 LIKE(factor2);                                                                     000381
 000382                                                                                                                      000382
 000383   Dcl-S EQCheck                Ind INZ(*Off);                                                                        000383
 000384   Dcl-S EQInd                 Char(2);                                                                               000384
 000385   Dcl-S EQFactor1                 LIKE(factor1);                                                                     000385
 000386   Dcl-S EQFactor2                 LIKE(factor2);                                                                     000386
 000387                                                                                                                      000387
 000388   Dcl-S equalCheck             Ind INZ(*Off);                                                                        000388
 000389   Dcl-S equalInd              Char(2);                                                                               000389
 000390                                                                                                                      000390
 000391   Dcl-S countSource         Packed(7:0) INZ(0);                                                                      000391
 000392   Dcl-S countTarget         Packed(7:0) INZ(0);                                                                      000392
 000393   Dcl-S countEligible       Packed(7:0) INZ(0);                                                                      000393
 000394   Dcl-S countConv           Packed(7:0) INZ(0);                                                                      000394
 000395   Dcl-S countNotConv        Packed(7:0) INZ(0);                                                                      000395
 000396   Dcl-S countMoved          Packed(7:0) INZ(0);                                                                      000396
 000397                                                                                                                      000397
 000398   //Dcl-S testb                   BinDec(2:0);                                                                       000398
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000400   //-------------------------------------------------------------------------------------------                      000400
 000401   // Main Procedure                                                                                                  000401
 000402   //-------------------------------------------------------------------------------------------                      000402
 000403      // Initialize                                                                                                   000403
 000001=ISRCREC                                                                                                             1000001
         *--------------------------------------------------------------------------------------------*                     1
         * RPG record format  . . . . :  SRCREC                                                       *                     1
         * External format  . . . . . :  QRPGLESRC : CVTRPGFREE/QRPGLESRC                             *                     1
         *--------------------------------------------------------------------------------------------*                     1
 000002=I                             S    1    6 2SRCSEQ                                                                   1000002
 000003=I                             S    7   12 0SRCDAT                                                                   1000003
 000004=I                             A   13  112  SRCDTA                                                                   1000004
 000404      Exsr subInitialise;                                                                                             000404
 000405                                                                                                                      000405
 000406      // Perform required function                                                                                    000406
 000407      Exsr subUserFunction;                                                                                           000407
 000408                                                                                                                      000408
 000409      // Terminate the program.                                                                                       000409
 000410      Exsr subExitProgram;                                                                                            000410
 000411   //-------------------------------------------------------------------------------------------                      000411
 000412                                                                                                                      000412
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000414   //-------------------------------------------------------------------------------------------                      000414
 000415   // USER: Perform required function.                                                                                000415
 000416   //-------------------------------------------------------------------------------------------                      000416
 000417   BegSr subUserFunction;                                                                                             000417
 000418                                                                                                                      000418
 000419      // ** Code the necessary processing here.                                                                       000419
 000420      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         000420
 000421                                                                                                                      000421
 000422      // Read through the source member.                                                                              000422
 000423      Read SRCREC;                                                                                                    000423
 000424                                                                                                                      000424
 000425      DoW not %eof(QRPGLESRC);                                                                   B01                  000425
 000426         countSource += 1;                                                                        01                  000426
 000427                                                                                                                      000427
 000428         Exsr subUserReformatLine;                                                                01                  000428
 000429                                                                                                                      000429
 000430         Exsr subUserSetIndicators;                                                               01                  000430
 000431                                                                                                                      000431
 000432         // Old-style SCAN without a result field.                                                                    000432
 000433         If scanNoResult;                                                                        B02                  000433
 000434            Clear nonPrefix;                                                                      02                  000434
 000435                                                                                                                      000435
 000436            codeLine = '// Old-style SCAN without a result!';                                     02                  000436
 000437            Exsr subUserReformatLine;                                                             02                  000437
 000438            codeLine = 'EndIf;';                                                                  02                  000438
 000439            Exsr subUserReformatLine;                                                             02                  000439
 000440                                                                                                                      000440
 000441            scanNoResult = *Off;                                                                  02                  000441
 000442         EndIf;                                                                                  E02                  000442
 000443                                                                                                                      000443
 000444         // If in a CAS statement, record the subroutine to call.                                                     000444
 000445         If inCase and caseSubroutine <> *Blanks;                                                B02                  000445
 000446            codeLine = 'ExSr ' + %trim(caseSubRoutine) + ';';                                     02                  000446
 000447            Exsr subUserReformatLine;                                                             02                  000447
 000448            caseSubRoutine = *Blanks;                                                             02                  000448
 000449         EndIf;                                                                                  E02                  000449
 000450                                                                                                                      000450
 000451         Read SRCREC;                                                                             01                  000451
 000452      EndDo;                                                                                     E01                  000452
 000453                                                                                                                      000453
 000454      // Handle overflow.                                                                                             000454
 000455      If overFlow;                                                                               B01                  000455
 000456                                                                                                                      000456
 000457         // Print page headings.                                                                                      000457
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000458         Z1QPAG += 1;                                                                             01                  000458
 000459         Write Z1PAGHDG;                                                                          01                  000459
 000460                                                                                                                      000460
 000461         ZTFRFL = fromFileLib;                                                                    01                  000461
 000462         ZTTOFL = toFileLib;                                                                      01                  000462
 000463                                                                                                                      000463
 000464         Write Z1TOPPAG;                                                                          01                  000464
 000465                                                                                                                      000465
 000466         overFlow = *Off;                                                                         01                  000466
 000467      EndIf;                                                                                     E01                  000467
 000468                                                                                                                      000468
 000469      Z1FRMB = QpFromMbr;                                                                                             000469
 000470      Z1TOMB = QpToMbr;                                                                                               000470
 000471      Z1CTSC = countSource;                                                                                           000471
 000472      Z1CTTG = countTarget;                                                                                           000472
 000473      Z1CTEL = countEligible;                                                                                         000473
 000474      Z1CTCV = countConv;                                                                                             000474
 000475      Z1CTNV = countNotConv;                                                                                          000475
 000476      Z1CTMV = countMoved;                                                                                            000476
 000477      If countEligible = 0;                                                                      B01                  000477
 000478         Z1CNVR = 0;                                                                              01                  000478
 000479      Else;                                                                                      X01                  000479
 000480         Z1CNVR = countConv * 100 / countEligible;                                                01                  000480
 000481      EndIf;                                                                                     E01                  000481
 000482                                                                                                                      000482
 000483      // Print detail format.                                                                                         000483
 000484      Write Z1DETAIL;                                                                                                 000484
 000485                                                                                                                      000485
 000486      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         000486
 000487                                                                                                                      000487
 000488   EndSr;                                                                                                             000488
 000489   //-------------------------------------------------------------------------------------------                      000489
 000490                                                                                                                      000490
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000492   //-------------------------------------------------------------------------------------------                      000492
 000493   // Perform conversion/reformatting on the current line.                                                            000493
 000494   //-------------------------------------------------------------------------------------------                      000494
 000495   BegSr subUserReformatLine;                                                                                         000495
 000496                                                                                                                      000496
 000497      inDirective = *Off;                                                                                             000497
 000498      inComment = *Off;                                                                                               000498
 000499      increment = 0;                                                                                                  000499
 000500                                                                                                                      000500
 000501      workDirective = %xlate(lo:up:directive);                                                                        000501
 000502      workLineType = %xlate(lo:up:lineType);                                                                          000502
 000503                                                                                                                      000503
 000504      convert = *Off;                                                                                                 000504
 000505      nonConvRsn = *Blanks;                                                                                           000505
 000506                                                                                                                      000506
 000507      sourceLine = codeLine;     // Start with what is already there.                                                 000507
 000508                                                                                                                      000508
 000509      // Array data reached?                                                                                          000509
 000510      If %subst(prefix:1:3) = '** '                                                              B01                  000510
 000511      or %subst(SRCDTA:1:8) = '**CTDATA';                                                        B01                  000511
 000512         inCode = *Off;                                                                           01                  000512
 000513         inDeclaration = *Off;                                                                    01                  000513
 000514         inArrayData = *On;                                                                       01                  000514
 000515      EndIf;                                                                                     E01                  000515
 000516                                                                                                                      000516
 000517      If not inArrayData;                                                                        B01                  000517
 000518         //----------------------------------------------------------------------------------                         000518
 000519         // Determine Line Type                                                                                       000519
 000520         If workLineType = 'C';                  // C-Spec                                       B02                  000520
 000521            inCode = *On;                                                                         02                  000521
 000522            //         ElseIf workLineType = 'P'               // P-Spec                                              000522
 000523            //             or %len(%trim(codeLine)) >= 4                                                              000523
 000524            //            and %xlate(lo:up:%subst(%trim(codeLine):1:4)) = 'DCL-';                                     000524
 000525            //            inCode = *Off;                                                                              000525
 000526            //            defsMoved = *Off;                                                                           000526
 000527         ElseIf workLineType = 'P';              // P-Spec                                       X02                  000527
 000528            inCode = *Off;                                                                        02                  000528
 000529            defsMoved = *Off;                                                                     02                  000529
 000530         ElseIf workLineType = 'D';              // Declaration.                                 X02                  000530
 000531            inCode = *Off;                                                                        02                  000531
 000532         ElseIf workLineType = 'H';              // Header spec.                                 X02                  000532
 000533            inCode = *Off;                                                                        02                  000533
 000534         ElseIf workLineType = 'F';              // File spec.                                   X02                  000534
 000535            inCode = *Off;                                                                        02                  000535
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000536         ElseIf workLineType = 'O';              // O-Spec                                       X02                  000536
 000537            inCode = *Off;                                                                        02                  000537
 000538         ElseIf workLineType = 'I';              // I-Spec                                       X02                  000538
 000539            inCode = *On;                                                                         02                  000539
 000540         ElseIf %check(validSpecs:workLineType) <> 0;    // Invalid spec type.                   X02                  000540
 000541            workLineType = *Blanks;                                                               02                  000541
 000542            lineType = *Blank;                           // Clear it!                             02                  000542
 000543         EndIf;                                                                                  E02                  000543
 000544                                                                                                                      000544
 000545         If %trim(workDirective) = '/FREE';                                                      B02                  000545
 000546            // In a free-format directive, so we must be in code too.                                                 000546
 000547            If not inFreeFormat;                                                                 B03                  000547
 000548               inDirective = *On;                                                                 03                  000548
 000549               inCode = *On;                                                                      03                  000549
 000550               inFreeFormat = *On;                                                                03                  000550
 000551               lineType = ' ';                                                                    03                  000551
 000552               workLineType = ' ';                                                                03                  000552
 000553               If QpDirectives = 'Y';                                                            B04                  000553
 000554                  directive = '/Free';                                                            04                  000554
 000555               Else;                                                                             X04                  000555
 000556                  dropLine = *On;                                                                 04                  000556
 000557               EndIf;                                                                            E04                  000557
 000558            Else;                                                                                X03                  000558
 000559               dropLine = *On;   // Not needed.                                                   03                  000559
 000560            EndIf;                                                                               E03                  000560
 000561         ElseIf %trim(workDirective) = '/END-FREE';                                              X02                  000561
 000562            // At the end of a directive, so we can't be in free format any more.                                     000562
 000563            //inDirective = *On;                                                                                      000563
 000564            //directive = '/End-Free';                                                                                000564
 000565            //inFreeFormat = *Off;                                                                                    000565
 000566            dropLine = *On;                                                                       02                  000566
 000567         ElseIf %trim(workDirective) = '/EJECT';                                                 X02                  000567
 000568            inDirective = *On;                                                                    02                  000568
 000569            lineType = ' ';                                                                       02                  000569
 000570            workLineType = ' ';                                                                   02                  000570
 000571         ElseIf %subst(workDirective:1:5) = '/COPY';                                             X02                  000571
 000572            inDirective = *On;                                                                    02                  000572
 000573            lineType = ' ';                                                                       02                  000573
 000574            workLineType = ' ';                                                                   02                  000574
 000575         ElseIf %subst(workDirective:1:3) = '/IF';                                               X02                  000575
 000576            inDirective = *On;                                                                    02                  000576
 000577            lineType = ' ';                                                                       02                  000577
 000578            workLineType = ' ';                                                                   02                  000578
 000579         ElseIf %subst(workDirective:1:6) = '/ENDIF';                                            X02                  000579
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000580            inDirective = *On;                                                                    02                  000580
 000581            lineType = ' ';                                                                       02                  000581
 000582            workLineType = ' ';                                                                   02                  000582
 000583         ElseIf %subst(workDirective:1:7) = '/DEFINE';                                           X02                  000583
 000584            inDirective = *On;                                                                    02                  000584
 000585            lineType = ' ';                                                                       02                  000585
 000586            workLineType = ' ';                                                                   02                  000586
 000587         ElseIf %subst(workDirective:1:6) = '/SPACE';                                            X02                  000587
 000588            inDirective = *On;                                                                    02                  000588
 000589            lineType = ' ';                                                                       02                  000589
 000590            workLineType = ' ';                                                                   02                  000590
 000591         ElseIf %subst(workDirective:1:6) = '/TITLE';                                            X02                  000591
 000592            inDirective = *On;                                                                    02                  000592
 000593            lineType = ' ';                                                                       02                  000593
 000594            workLineType = ' ';                                                                   02                  000594
 000595         ElseIf (%subst(workDirective:1:1) = '*'                                                 X02                  000595
 000596            or %subst(workDirective:1:2) = '//')                                                 X02                  000596
 000597            and (lineType = *Blank or inCode);                                                   X02                  000597
 000598            //            and inCode;                                                                                 000598
 000599            // This is a comment line.                                                                                000599
 000600            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000600
 000601               inComment = *On;                                                                   03                  000601
 000602            EndIf;                                                                               E03                  000602
 000603            If %subst(workDirective:1:2) = '//';                                                 B03                  000603
 000604               %subst(directive:1:2) = '  ';                                                      03                  000604
 000605            Else;                                                                                X03                  000605
 000606               %subst(directive:1:1) = ' ';                                                       03                  000606
 000607            EndIf;                                                                               E03                  000607
 000608            If workLineType = 'C' or workLineType = 'D';                                         B03                  000608
 000609               lineType = ' ';                                                                    03                  000609
 000610               workLineType = ' ';                                                                03                  000610
 000611            EndIf;                                                                               E03                  000611
 000612            // Retain blank comment markers?                                                                          000612
 000613            If QpRetBlnkCmt = 'N' and %len(%trim(codeLine)) = 0;                                 B03                  000613
 000614               // Leave the line blank, devoid of any marker.                                                         000614
 000615            Else;                                                                                X03                  000615
 000616               codeLine = '//' + codeLine;                                                        03                  000616
 000617            EndIf;                                                                               E03                  000617
 000618         ElseIf %subst(workDirective:1:1) = '*';                                                 X02                  000618
 000619            //            and workLineType = 'O';                                                                     000619
 000620            // Leave the line as it is.                                                                               000620
 000621            inComment = *On;                                                                      02                  000621
 000622         ElseIf %len(%trim(codeLine)) = 0;                                                       X02                  000622
 000623            // Just a 'spacer' line - keep it but drop the line type.                                                 000623
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000624            lineType = ' ';                                                                       02                  000624
 000625            workLineType = ' ';                                                                   02                  000625
 000626         ElseIf %len(%trim(codeLine)) >= 2                                                       X02                  000626
 000627            and %subst(%trim(codeLine):1:2) = '//'                                               X02                  000627
 000628            and (workLineType = *Blank or inCode);                                               X02                  000628
 000629            // This is a comment line.                                                                                000629
 000630            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000630
 000631               inComment = *On;                                                                   03                  000631
 000632            EndIf;                                                                               E03                  000632
 000633            // Retain blank comment markers?                                                                          000633
 000634            If QpRetBlnkCmt = 'N' and %len(%trim(%subst(codeLine:3)))                            B03                  000634
 000635                                              = 0;                                               B03                  000635
 000636               // Leave the line blank, devoid of any marker.                                                         000636
 000637               codeLine = *Blanks;                                                                03                  000637
 000638            EndIf;                                                                               E03                  000638
 000639         ElseIf comment <> *Blanks                                                               X02                  000639
 000640            and %len(%trim(%subst(codeLine:1:73))) = 0;                                          X02                  000640
 000641            // This is a blank line with a comment section.                                                           000641
 000642            %subst(codeLine:71:2) = '//';                                                         02                  000642
 000643            inComment = *On;                                                                      02                  000643
 000644         EndIf;                                                                                  E02                  000644
 000645                                                                                                                      000645
 000646         //----------------------------------------------------------------------------------                         000646
 000647         // Convert fixed-format to free-format?                                                                      000647
 000648         If not inComment                                                                        B02                  000648
 000649         and not inDirective;                                                                    B02                  000649
 000650                                                                                                                      000650
 000651            If workLineType = 'C';                                                               B03                  000651
 000652               countEligible += 1;                                                                03                  000652
 000653               countNotConv += 1;                                                                 03                  000653
 000654               operator = %xlate(lo:up:opCode);                                                   03                  000654
 000655               savedComment = comment;                                                            03                  000655
 000656                                                                                                                      000656
 000657               Exsr subUserConvertC_Spec;                                                         03                  000657
 000658                                                                                                                      000658
 000659               If not inComment and not convert                                                  B04                  000659
 000660               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000660
 000661                  nonConvRsn = 'Conversion not currently supported.';                             04                  000661
 000662               EndIf;                                                                            E04                  000662
 000663                                                                                                                      000663
 000664            ElseIf workLineType = 'P';     // Procedure start/end.                               X03                  000664
 000665               countEligible += 1;                                                                03                  000665
 000666               countNotConv += 1;                                                                 03                  000666
 000667               operator = *Blanks;                                                                03                  000667
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000668               savedComment = comment;                                                            03                  000668
 000669                                                                                                                      000669
 000670               Exsr subUserConvertP_Spec;                                                         03                  000670
 000671                                                                                                                      000671
 000672               If not inComment and not convert                                                  B04                  000672
 000673               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000673
 000674                  nonConvRsn = 'Conversion not currently supported.';                             04                  000674
 000675               EndIf;                                                                            E04                  000675
 000676                                                                                                                      000676
 000677            ElseIf workLineType = 'D';     // Declaration.                                       X03                  000677
 000678               countEligible += 1;                                                                03                  000678
 000679               countNotConv += 1;                                                                 03                  000679
 000680               savedComment = comment;                                                            03                  000680
 000681                                                                                                                      000681
 000682               Exsr subUserConvertD_Spec;                                                         03                  000682
 000683                                                                                                                      000683
 000684               If not inComment and not convert                                                  B04                  000684
 000685               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000685
 000686                  //nonConvRsn = 'Conversion not currently supported.';                                               000686
 000687               EndIf;                                                                            E04                  000687
 000688                                                                                                                      000688
 000689            ElseIf workLineType = 'F';     // File.                                              X03                  000689
 000690               countEligible += 1;                                                                03                  000690
 000691               countNotConv += 1;                                                                 03                  000691
 000692               savedComment = comment;                                                            03                  000692
 000693                                                                                                                      000693
 000694               Exsr subUserConvertF_Spec;                                                         03                  000694
 000695                                                                                                                      000695
 000696               If not inComment and not convert                                                  B04                  000696
 000697               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000697
 000698                  //nonConvRsn = 'Conversion not currently supported.';                                               000698
 000699               EndIf;                                                                            E04                  000699
 000700                                                                                                                      000700
 000701            ElseIf workLineType = 'H';     // Header.                                            X03                  000701
 000702               countEligible += 1;                                                                03                  000702
 000703               countNotConv += 1;                                                                 03                  000703
 000704               savedComment = comment;                                                            03                  000704
 000705                                                                                                                      000705
 000706               Exsr subUserConvertH_Spec;                                                         03                  000706
 000707                                                                                                                      000707
 000708               If not inComment and not convert                                                  B04                  000708
 000709               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000709
 000710                  //nonConvRsn = 'Conversion not currently supported.';                                               000710
 000711               EndIf;                                                                            E04                  000711
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000712                                                                                                                      000712
 000713            ElseIf workLineType = 'O';     // Output spec                                        X03                  000713
 000714               sourceLine = fullLine;                                                             03                  000714
 000715                                                                                                                      000715
 000716            ElseIf workLineType = 'I';     // Input spec                                         X03                  000716
 000717               sourceLine = fullLine;                                                             03                  000717
 000718                                                                                                                      000718
 000719            ElseIf workLineType = ' ' and inCode;                                                X03                  000719
 000720               inFreeFormat = *On;                                                                03                  000720
 000721               // When in an IF we usually want subsequent lines to be pulled back to be                              000721
 000722               // in line with the 'If', but only if those lines start with either 'and'                              000722
 000723               // or 'or'.  Otherwise we retain the existing indentation by turning on                                000723
 000724               // inSpan.                                                                                             000724
 000725               If inIf and %len(%trim(codeLine)) >= 3                                            B04                  000725
 000726               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'AND'                            B04                  000726
 000727               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'OR ';                           B04                  000727
 000728                  inSpan = *On;                                                                   04                  000728
 000729               EndIf;                                                                            E04                  000729
 000730               If inSpan;                                                                        B04                  000730
 000731                  currOffset = %check(' ':codeLine);  // Offset of the continuation line.         04                  000731
 000732               Else;                                                                             X04                  000732
 000733                  prevOffset = %check(' ':codeLine);  // Offset of the parent line.               04                  000733
 000734               EndIf;                                                                            E04                  000734
 000735               sourceLine = %trim(codeLine);         // Free-format already, so trim it.          03                  000735
 000736            Else;                                                                                X03                  000736
 000737               inFreeFormat = *On;                                                                03                  000737
 000738               sourceLine = %trimr(codeLine);        // None of the above, use the raw source     03                  000738
 000739            EndIf;                                                                               E03                  000739
 000740                                                                                                                      000740
 000741            // Converted?                                                                                             000741
 000742            If convert;                                                                          B03                  000742
 000743               countConv += 1;                                                                    03                  000743
 000744               countNotConv -= 1;                                                                 03                  000744
 000745               // Switch to free-format?                                                                              000745
 000746               If not inFreeFormat and not inDeclaration;                                        B04                  000746
 000747                  If QpDirectives = 'Y';                                                         B05                  000747
 000748                     savedSRCDTA = SRCDTA;                                                        05                  000748
 000749                     Clear SRCDTA;                                                                05                  000749
 000750                     directive = '/Free';                                                         05                  000750
 000751                     Exsr subUserWriteLine;                                                       05                  000751
 000752                     SRCDTA = savedSRCDTA;                                                        05                  000752
 000753                  EndIf;                                                                         E05                  000753
 000754                  inFreeFormat = *On;                                                             04                  000754
 000755                  directive = *Blanks;                                                            04                  000755
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000756               EndIf;                                                                            E04                  000756
 000757            EndIf;                                                                               E03                  000757
 000758                                                                                                                      000758
 000759            // Revert to fixed-format?                                                                                000759
 000760            If not convert and (lineType <> *Blanks                                              B03                  000760
 000761            or %subst(workDirective:1:5) = '/COPY');                                             B03                  000761
 000762               //                or  %subst(prefix:1:3) = '** ');        // Array data reached                        000762
 000763               If inFreeFormat and not inDeclaration;                                            B04                  000763
 000764                  If QpDirectives = 'Y';                                                         B05                  000764
 000765                     savedSRCDTA = SRCDTA;                                                        05                  000765
 000766                     Clear SRCDTA;                                                                05                  000766
 000767                     directive = '/End-Free';                                                     05                  000767
 000768                     Exsr subUserWriteLine;                                                       05                  000768
 000769                     SRCDTA = savedSRCDTA;                                                        05                  000769
 000770                  EndIf;                                                                         E05                  000770
 000771                  inFreeFormat = *Off;                                                            04                  000771
 000772                  If not inDirective;                                                            B05                  000772
 000773                     directive = *Blanks;                                                         05                  000773
 000774                  EndIf;                                                                         E05                  000774
 000775               EndIf;                                                                            E04                  000775
 000776               // Record the reason for not converting?                                                               000776
 000777               If nonConvRsn <> *Blanks;                                                         B04                  000777
 000778                  savedSRCDTA = SRCDTA;                                                           04                  000778
 000779                  Clear SRCDTA;                                                                   04                  000779
 000780                  codeLine = '// >>>>> Not converted: ' + nonConvRsn;                             04                  000780
 000781                  Exsr subUserWriteLine;                                                          04                  000781
 000782                  SRCDTA = savedSRCDTA;                                                           04                  000782
 000783               EndIf;                                                                            E04                  000783
 000784               inSpan = *Off;                                                                     03                  000784
 000785            EndIf;                                                                               E03                  000785
 000786         Else;                                                                                   X02                  000786
 000787            // Use source exactly as is.                                                                              000787
 000788            sourceLine = codeLine;                                                                02                  000788
 000789         EndIf;                                                                                  E02                  000789
 000790                                                                                                                      000790
 000791         //----------------------------------------------------------------------------------                         000791
 000792         // If we are in a code section, check if indent is affected at all.                                          000792
 000793         //         If not inDeclaration                                                                              000793
 000794         //         and not inDirective                                                                               000794
 000795         If not inDirective                                                                      B02                  000795
 000796         and not inComment                                                                       B02                  000796
 000797         and not dropLine;                                                                       B02                  000797
 000798            // Isolate the operator to check indentation against.                                                     000798
 000799            //sourceLine = %trimr(codeLine);                                                                          000799
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000800            If inFreeFormat;                                                                     B03                  000800
 000801               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000801
 000802                  operator = *Blanks;                                                             04                  000802
 000803               ElseIf inSQL;                                // Embedded SQL - no operator.       X04                  000803
 000804                  operator = *Blanks;                                                             04                  000804
 000805               Else;                                                                             X04                  000805
 000806                  // Isolate the 'operator' (first word really).                                                      000806
 000807                  operator = %trim(sourceLine);                                                   04                  000807
 000808                  operatorEnd = %scan(' ':%trim(operator)); // Look for end of first 'word'.      04                  000808
 000809                  If operatorEnd = 0;                                                            B05                  000809
 000810                     operatorEnd = %scan(';':operator);  // Only one word - is it an operator     05                  000810
 000811                     If operatorEnd = 0;                                                         B06                  000811
 000812                        operatorEnd = %scan('(':operator);  // Shouldn't match!                   06                  000812
 000813                     EndIf;                                                                      E06                  000813
 000814                  EndIf;                                                                         E05                  000814
 000815                  // If we have an operator, remove any attached extender code.                                       000815
 000816                  If operatorEnd > 0;                                                            B05                  000816
 000817                     operator = %subst(operator:1:operatorEnd - 1);                               05                  000817
 000818                     // Exec SQL?                                                                                     000818
 000819                     If %xlate(lo:up:operator) = 'EXEC';                                         B06                  000819
 000820                        If %scan('SQL':%xlate(lo:up:%trim(sourceLine)):6)                        B07                  000820
 000821                                 > 0;                                                            B07                  000821
 000822                           operator = 'Exec SQL';                                                 07                  000822
 000823                           inSQL = *On;                                                           07                  000823
 000824                        EndIf;                                                                   E07                  000824
 000825                     EndIf;                                                                      E06                  000825
 000826                     operatorEnd = %scan('(':operator);                                           05                  000826
 000827                     If operatorEnd > 1;                                                         B06                  000827
 000828                        operator = %subst(operator:1:operatorEnd - 1);                            06                  000828
 000829                     EndIf;                                                                      E06                  000829
 000830                  EndIf;                                                                         E05                  000830
 000831                                                                                                                      000831
 000832                  If %lookup(%xlate(lo:up:operator):QopCodeUP) > 0                               B05                  000832
 000833                  and not inDeclaration;                                                         B05                  000833
 000834                     inCode = *On;                                                                05                  000834
 000835                  Else;                                                                          X05                  000835
 000836                     If %lookup(%xlate(lo:up:operator):QdeclUP) > 0;                             B06                  000836
 000837                        // Declaration!                                                                               000837
 000838                     Else;                                                                       X06                  000838
 000839                        // Not an operator!                                                                           000839
 000840                        operator = *Blanks;                                                       06                  000840
 000841                        x = %scan('=':sourceLine);                                                06                  000841
 000842                        If x > 0;   // Looks like an assignment.                                 B07                  000842
 000843                           operator = '=';                                                        07                  000843
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000844                           inCode = *On;                                                          07                  000844
 000845                           If workLineType = *Blank;                                             B08                  000845
 000846                              sourceLine = %trim(sourceLine);                                     08                  000846
 000847                           EndIf;                                                                E08                  000847
 000848                        EndIf;                                                                   E07                  000848
 000849                     EndIf;                                                                      E06                  000849
 000850                  EndIf;                                                                         E05                  000850
 000851               EndIf;                                                                            E04                  000851
 000852            Else;                                                                                X03                  000852
 000853               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000853
 000854                  operator = *Blanks;                                                             04                  000854
 000855               Else;                                                                             X04                  000855
 000856                  operator = %xlate(lo:up:opCode);                                                04                  000856
 000857                  If %subst(operator:1:4) <> 'EVAL'                                              B05                  000857
 000858                  and operator <> *Blanks;                                                       B05                  000858
 000859                     // Strip out in-line definitions.                                                                000859
 000860                     len = *Blanks;                                                               05                  000860
 000861                     dec = *Blanks;                                                               05                  000861
 000862                  EndIf;                                                                         E05                  000862
 000863               EndIf;                                                                            E04                  000863
 000864            EndIf;                                                                               E03                  000864
 000865                                                                                                                      000865
 000866            // Convert to upper case for check.                                                                       000866
 000867            operator = %xlate(lo:up:operator);                                                    02                  000867
 000868                                                                                                                      000868
 000869            // Check for indentation level change.                                                                    000869
 000870            Select;                                                                              B03                  000870
 000871               When workDirective = '/EXEC SQL';                                                 X03                  000871
 000872                  increment = 1;                                                                  03                  000872
 000873                  inSQL = *On;                                                                    03                  000873
 000874               When workDirective = '/END-EXEC';                                                 X03                  000874
 000875                  unindent = *On;                                                                 03                  000875
 000876                  increment = -1;                                                                 03                  000876
 000877                  dropLine = *On;                                                                 03                  000877
 000878               When inSQL;                                                                       X03                  000878
 000879                  // Do nothing.                                                                                      000879
 000880               When %subst(operator:1:2) = 'IF';                                                 X03                  000880
 000881                  increment = 1;                                                                  03                  000881
 000882                  inIf = *On;                                                                     03                  000882
 000883               When %subst(operator:1:2) = 'DO';                                                 X03                  000883
 000884                  increment = 1;                                                                  03                  000884
 000885                  inDo = *On;                                                                     03                  000885
 000886                  doCount += 1;                                                                   03                  000886
 000887                  doLevel(doCount) = indentCount;                                                 03                  000887
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000888               When operator = 'FOR';                                                            X03                  000888
 000889                  increment = 1;                                                                  03                  000889
 000890                  forCount += 1;                                                                  03                  000890
 000891                  forLevel(forCount) = indentCount;                                               03                  000891
 000892               When operator = 'SELECT';                                                         X03                  000892
 000893                  increment = 2;                                                                  03                  000893
 000894                  slCount += 1;                                                                   03                  000894
 000895                  slLevel(slCount) = indentCount;                                                 03                  000895
 000896               When operator = 'BEGSR';                                                          X03                  000896
 000897                  increment = 1;                                                                  03                  000897
 000898                  mainlineIndent = 0;                                                             03                  000898
 000899                  indentCount = mainlineIndent;                                                   03                  000899
 000900               When %subst(operator:1:4) = 'DCL-';                                               X03                  000900
 000901                  increment = 0;                                                                  03                  000901
 000902                  mainlineIndent = 1;                                                             03                  000902
 000903                  indentCount = mainlineIndent;                                                   03                  000903
 000904                  defsMoved = *Off;                                                               03                  000904
 000905               When %subst(operator:1:4) = 'END-';                                               X03                  000905
 000906                  increment = 0;                                                                  03                  000906
 000907                  indentCount = mainlineIndent;                                                   03                  000907
 000908               When operator = 'MONITOR';                                                        X03                  000908
 000909                  increment = 1;                                                                  03                  000909
 000910               When operator = 'ENDSL';                                                          X03                  000910
 000911                  unindent = *On;                                                                 03                  000911
 000912                  increment = -2;                                                                 03                  000912
 000913                  slCount -= 1;                                                                   03                  000913
 000914               When operator = 'ENDCS';                                                          X03                  000914
 000915                  Operator = 'ENDIF';                                                             03                  000915
 000916                  unindent = *On;                                                                 03                  000916
 000917                  increment = -1;                                                                 03                  000917
 000918               When operator = 'ENDDO';                                                          X03                  000918
 000919                  unindent = *On;                                                                 03                  000919
 000920                  increment = -1;                                                                 03                  000920
 000921                  doCount -= 1;                                                                   03                  000921
 000922               When operator = 'ENDFOR';                                                         X03                  000922
 000923                  unindent = *On;                                                                 03                  000923
 000924                  increment = -1;                                                                 03                  000924
 000925                  forCount -= 1;                                                                  03                  000925
 000926               When %subst(operator:1:3) = 'END';                                                X03                  000926
 000927                  unindent = *On;                                                                 03                  000927
 000928                  increment = -1;                                                                 03                  000928
 000929               When %subst(operator:1:4) = 'ELSE'; // Unindent ELSE                              X03                  000929
 000930                  unindent = *On;                                                                 03                  000930
 000931                  indent = *On;                                                                   03                  000931
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000932                  increment = -1;                                                                 03                  000932
 000933               When %subst(operator:1:2) = 'OR';   // Unindent OR                                X03                  000933
 000934                  unindent = *On;                                                                 03                  000934
 000935                  indent = *On;                                                                   03                  000935
 000936                  increment = -1;                                                                 03                  000936
 000937               When %subst(operator:1:3) = 'AND';  // Unindent AND                               X03                  000937
 000938                  unindent = *On;                                                                 03                  000938
 000939                  indent = *On;                                                                   03                  000939
 000940                  increment = -1;                                                                 03                  000940
 000941               When operator = 'ON-ERROR';         // Unindent On-Error                          X03                  000941
 000942                  unindent = *On;                                                                 03                  000942
 000943                  indent = *On;                                                                   03                  000943
 000944                  increment = -1;                                                                 03                  000944
 000945               When %subst(operator:1:4) = 'WHEN' or inWhen;                                     X03                  000945
 000946                  unindent = *On;                                                                 03                  000946
 000947                  indent = *On;                                                                   03                  000947
 000948                  increment = -1;                                                                 03                  000948
 000949                  inWhen = *On;                                                                   03                  000949
 000950               When inIF or inDo;                  // Keep conditions in line.                   X03                  000950
 000951                  unindent = *On;                                                                 03                  000951
 000952                  indent = *On;                                                                   03                  000952
 000953                  increment = -1;                                                                 03                  000953
 000954               When operator = 'OTHER';             // Unindent Other                            X03                  000954
 000955                  unindent = *On;                                                                 03                  000955
 000956                  indent = *On;                                                                   03                  000956
 000957                  increment = -1;                                                                 03                  000957
 000958               Other;                                                                            X03                  000958
 000959                  increment = 0;                                                                  03                  000959
 000960            EndSl;                                                                               E03                  000960
 000961         ElseIf inDeclaration;                                                                   X02                  000961
 000962         EndIf;                                                                                  E02                  000962
 000963                                                                                                                      000963
 000964         //----------------------------------------------------------------------------------                         000964
 000965         // Start of code?  If so, pause here and move all field definitions to D-specs.                              000965
 000966         If inCode and not defsMoved;                                                            B02                  000966
 000967            Exsr subUserMoveDefs;                                                                 02                  000967
 000968         EndIf;                                                                                  E02                  000968
 000969                                                                                                                      000969
 000970         //----------------------------------------------------------------------------------                         000970
 000971         // If we need to temporarily unindent, do so to the requested increment.                                     000971
 000972         If unindent;                                                                            B02                  000972
 000973            indentCount += increment;                                                             02                  000973
 000974            increment = 0;                                                                        02                  000974
 000975            unindent = *Off;                                                                      02                  000975
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000976         EndIf;                                                                                  E02                  000976
 000977                                                                                                                      000977
 000978         //----------------------------------------------------------------------------------                         000978
 000979         // If we are in a code section and in free-format, perform reformatting.                                     000979
 000980         //If inCode and inFreeFormat and not inDirective                                                             000980
 000981         If inFreeFormat                                                                         B02                  000981
 000982         and not inDirective                                                                     B02                  000982
 000983         and sourceLine <> *Blanks                                                               B02                  000983
 000984         and not inComment                                                                       B02                  000984
 000985         and not dropLine;       //  and not inSpan                                              B02                  000985
 000986            // Derive reformatted opcode (if any)                                                                     000986
 000987            x = %lookup(operator:QopCodeUP);                                                      02                  000987
 000988            If x > 0;                                                                            B03                  000988
 000989               newOperator = %trim(QopCodeLO(x));                                                 03                  000989
 000990            Else;                                                                                X03                  000990
 000991               x = %lookup(operator:QdeclUP);                                                     03                  000991
 000992               If x > 0;                                                                         B04                  000992
 000993                  newOperator = %trim(QdeclLO(x));                                                04                  000993
 000994               Else;                                                                             X04                  000994
 000995                  // Not a valid operator, check if this is a comment.                                                000995
 000996                  x = %scan('//':%trim(sourceLine));                                              04                  000996
 000997                  If x = 1;                                                                      B05                  000997
 000998                     inComment = *On;                                                             05                  000998
 000999                     newOperator = '';                                                            05                  000999
 001000                     operator = *Blanks;                                                          05                  001000
 001001                  Else;                                                                          X05                  001001
 001002                     newOperator = '';                                                            05                  001002
 001003                  EndIf;                                                                         E05                  001003
 001004               EndIf;                                                                            E04                  001004
 001005            EndIf;                                                                               E03                  001005
 001006                                                                                                                      001006
 001007            // Use new opcode if it exists.                                                                           001007
 001008            If %len(newOperator) > 0;                                                            B03                  001008
 001009               If %len(%trim(sourceLine)) > %len(newOperator);                                   B04                  001009
 001010                  sourceLine = %trim(%subst(%trim(sourceLine)                                     04                  001010
 001011                                   :%len(newOperator) + 1));                                      04                  001011
 001012               Else;                                                                             X04                  001012
 001013                  //                  sourceLine = %trim(%subst(%trim(sourceLine)                                     001013
 001014                  //                                   :%len(newOperator)));                                          001014
 001015                  sourceLine = *Blanks;                                                           04                  001015
 001016               EndIf;                                                                            E04                  001016
 001017               // Insert a spcace after operator if it's not the end of the line                                      001017
 001018               // and there's no operation extender.                                                                  001018
 001019               If %subst(sourceLine:1:1) <> ';'                                                  B04                  001019
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001020               and (%subst(sourceLine:1:1) <> '('                                                B04                  001020
 001021                 or %subst(sourceLine:1:1) = '('                                                 B04                  001021
 001022                and %subst(sourceLine:3:1) <> ')'                                                B04                  001022
 001023                and %subst(sourceLine:4:1) <> ')');                                              B04                  001023
 001024                  sourceLine = ' ' + sourceLine;                                                  04                  001024
 001025               EndIf;                                                                            E04                  001025
 001026               sourceLine = newOperator + sourceLine;                                             03                  001026
 001027            EndIf;                                                                               E03                  001027
 001028                                                                                                                      001028
 001029            If inCode;                                                                           B03                  001029
 001030               // Padding required?                                                                                   001030
 001031               If padResult;                                                                     B04                  001031
 001032                  savedSRCDTA = SRCDTA;                                                           04                  001032
 001033                  Clear codeLine;                                                                 04                  001033
 001034                  %subst(codeLine:indentOffset)                                                   04                  001034
 001035                        = %trim(padTarget) + ' = *Blanks;';                                       04                  001035
 001036                  Exsr subUserWriteLine;                                                          04                  001036
 001037                  SRCDTA = savedSRCDTA;                                                           04                  001037
 001038                  padResult = *Off;                                                               04                  001038
 001039               EndIf;                                                                            E04                  001039
 001040                                                                                                                      001040
 001041               // Determine the indentation to use.                                                                   001041
 001042               If indentCount > maxIndent;                                                       B04                  001042
 001043                  indentOffset = maxIndent * indentSize + 1;                                      04                  001043
 001044               Else;                                                                             X04                  001044
 001045                  indentOffset = indentCount * indentSize + 1;                                    04                  001045
 001046               EndIf;                                                                            E04                  001046
 001047                                                                                                                      001047
 001048               // Adjust for continuation lines.                                                                      001048
 001049               If inCallP and (%subst(operator:1:5) <> 'CALLP');                                 B04                  001049
 001050                  indentOffset += callPOffset;                                                    04                  001050
 001051               ElseIf inEval and (%subst(operator:1:4) <> 'EVAL');                               X04                  001051
 001052                  indentOffset += evalOffset;                                                     04                  001052
 001053               ElseIf inSpan;                                                                    X04                  001053
 001054                  indentOffset = currOffset + (indentOffset - prevOffset);                        04                  001054
 001055               EndIf;                                                                            E04                  001055
 001056                                                                                                                      001056
 001057               // Avoid losing code off of the right hand side (comments mainly).                                     001057
 001058               If %len(%trimr(sourceLine)) + indentOffset > 93;                                  B04                  001058
 001059                  indentOffset = 93 - %len(%trim(sourceLine));                                    04                  001059
 001060               EndIf;                                                                            E04                  001060
 001061                                                                                                                      001061
 001062               // For code lines, check for overflow, and unindent accordingly if it does,                            001062
 001063               If not inComment;                                                                 B04                  001063
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001064                  lineEnd = %scan(';':%trimr(sourceLine));                                        04                  001064
 001065                  If lineEnd = 0;   // Code already spans to next line.                          B05                  001065
 001066                     lineEnd = %scan('//':sourceLine);                                            05                  001066
 001067                     If lineEnd > 0;                                                             B06                  001067
 001068                        lineEnd                                                                   06                  001068
 001069                          = %len(%trimr(%subst(sourceLine:1:lineEnd-1)));                         06                  001069
 001070                     Else;                                                                       X06                  001070
 001071                        lineEnd = %len(%trimr(sourceLine));                                       06                  001071
 001072                     EndIf;                                                                      E06                  001072
 001073                     If not inIf and not inDo and not inWhen;                                    B06                  001073
 001074                        inSpan = *On;                                                             06                  001074
 001075                     EndIf;                                                                      E06                  001075
 001076                  EndIf;                                                                         E05                  001076
 001077               EndIf;                                                                            E04                  001077
 001078                                                                                                                      001078
 001079               // Cater for commented out code that extends into comments.                                            001079
 001080               If indentOffset + lineEnd > 74;                                                   B04                  001080
 001081                  //Exsr subUserWrapLine;                                                                             001081
 001082                  indentOffset -= ((indentOffset + lineEnd) - 74);                                04                  001082
 001083               EndIf;                                                                            E04                  001083
 001084                                                                                                                      001084
 001085               // Ensure that we don't go back too far!                                                               001085
 001086               If indentOffset < 1;                                                              B04                  001086
 001087                  indentOffset = 1;                                                               04                  001087
 001088               EndIf;                                                                            E04                  001088
 001089                                                                                                                      001089
 001090               savedSRCDTA = SRCDTA;                                                              03                  001090
 001091               Clear codeLine;                                                                    03                  001091
 001092               %subst(codeLine:indentOffset) = %trimr(sourceLine);                                03                  001092
 001093               // Append an in-line comment?                                                                          001093
 001094               If (convert or setOn or setOff)                                                   B04                  001094
 001095               and savedComment <> *Blanks;                                                      B04                  001095
 001096                  %subst(codeLine:71) = '// ' + savedComment;                                     04                  001096
 001097                  savedComment = *Blanks;                                                         04                  001097
 001098               EndIf;                                                                            E04                  001098
 001099               sourceLine = codeLine;                                                             03                  001099
 001100               SRCDTA = savedSRCDTA;                                                              03                  001100
 001101               EndIf;   // inCode                                                                E03                  001101
 001102            EndIf;                                                                               E02                  001102
 001103         EndIf;                                                                                  E01                  001103
 001104                                                                                                                      001104
 001105         //----------------------------------------------------------------------------------                         001105
 001106         // Output the formatted line (and any overflows that have occurred.                                          001106
 001107         If not dropLine;                                                                        B01                  001107
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001108            If convert;                                                                          B02                  001108
 001109               Clear nonPrefix;                                                                   02                  001109
 001110            EndIf;                                                                               E02                  001110
 001111            If inCode or inArrayData                                                             B02                  001111
 001112            or lineType = *Blank or %subst(directive:1:1) = '*';                                 B02                  001112
 001113               codeLine = %trimr(sourceLine);                                                     02                  001113
 001114            Else;                                                                                X02                  001114
 001115               fullLine = %trimr(sourceLine);                                                     02                  001115
 001116            EndIf;                                                                               E02                  001116
 001117            Exsr subUserWriteLine;                                                                01                  001117
 001118                                                                                                                      001118
 001119            // Overflow line?                                                                                         001119
 001120            If overFlowLine <> *Blanks;                                                          B02                  001120
 001121               Clear codeLine;                                                                    02                  001121
 001122               %subst(codeLine:indentOffset) = %trimr(overflowLine);                              02                  001122
 001123               overflowLine = *Blanks;                                                            02                  001123
 001124               Exsr subUserWriteLine;                                                             02                  001124
 001125            EndIf;                                                                               E02                  001125
 001126         Else;                                                                                   X01                  001126
 001127            dropLine = *Off;                                                                      01                  001127
 001128         EndIf;                                                                                  E01                  001128
 001129                                                                                                                      001129
 001130         indentCount += increment;                                                                                    001130
 001131                                                                                                                      001131
 001132         // Following a WHEN or ON-ERROR or ELSE, code should be indented again.                                      001132
 001133         If indent;                                                                              B01                  001133
 001134            indentCount += 1;                                                                     01                  001134
 001135            indent = *Off;                                                                        01                  001135
 001136            // Following ENDSR, we should revert to mainline indentation.                                             001136
 001137         ElseIf operator = 'ENDSR';                                                              X01                  001137
 001138            indentCount = mainlineIndent;                                                         01                  001138
 001139            inCode = *Off;                                                                        01                  001139
 001140         EndIf;                                                                                  E01                  001140
 001141                                                                                                                      001141
 001142         // If spanning a line, check if the current line ends the span.                                              001142
 001143         If (inSpan or inIf or inDo or inWhen or inCallP or inEval                               B01                  001143
 001144         or inSQL or inDeclaration)                                                              B01                  001144
 001145         and not inComment;                                                                      B01                  001145
 001146            lineEnd = %scan(';':%trim(sourceLine));                                               01                  001146
 001147            If lineEnd <> 0;                                                                     B02                  001147
 001148               inSpan = *Off;                                                                     02                  001148
 001149               inIf = *Off;                                                                       02                  001149
 001150               inDo = *Off;                                                                       02                  001150
 001151               inWhen = *Off;                                                                     02                  001151
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001152               inCallP = *Off;                                                                    02                  001152
 001153               inEval = *Off;                                                                     02                  001153
 001154               inSQL = *Off;                                                                      02                  001154
 001155               inDeclaration = *Off;                                                              02                  001155
 001156            EndIf;                                                                               E02                  001156
 001157         EndIf;                                                                                  E01                  001157
 001158                                                                                                                      001158
 001159         //----------------------------------------------------------------------------------                         001159
 001160         // Close off Prototype/Interface/Datastructure?                                                              001160
 001161         If (inPrototype or inInterface or inDatastructure)                                      B01                  001161
 001162         and SRCSEQ = endLine;                                                                   B01                  001162
 001163            If not inDatastructure                                                               B02                  001163
 001164            or inDatastructure and endDS;                                                        B02                  001164
 001165               savedSRCDTA = SRCDTA;                                                              02                  001165
 001166               Clear SRCDTA;                                                                      02                  001166
 001167               codeLine = 'End-' + endDeclType + ';';                                             02                  001167
 001168               Exsr subUserWriteLine;                                                             02                  001168
 001169               SRCDTA = savedSRCDTA;                                                              02                  001169
 001170            EndIf;                                                                               E02                  001170
 001171            inPrototype = *Off;                                                                   01                  001171
 001172            inExtProc = *Off;                                                                     01                  001172
 001173            inInterface = *Off;                                                                   01                  001173
 001174            inDatastructure = *Off;                                                               01                  001174
 001175            inSpan = *Off;                                                                        01                  001175
 001176            inDeclaration = *Off;                                                                 01                  001176
 001177            inExtProc = *Off;                                                                     01                  001177
 001178            workDeclName = *Blanks;                                                               01                  001178
 001179         EndIf;                                                                                  E01                  001179
 001180                                                                                                                      001180
 001181      EndSr;                                                                                                          001181
 001182   //-------------------------------------------------------------------------------------------                      001182
 001183                                                                                                                      001183
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     32
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001185   //-------------------------------------------------------------------------------------------                      001185
 001186   // Convert the line to free-format?                                                                                001186
 001187   //-------------------------------------------------------------------------------------------                      001187
 001188   BegSr subUserConvertC_Spec;                                                                                        001188
 001189                                                                                                                      001189
 001190      Select;                                                                                    B01                  001190
 001191            // Keep blank lines.                                                                                      001191
 001192         When codeLine = *Blanks;                                                                X01                  001192
 001193            sourceLine = *Blanks;                                                                 01                  001193
 001194            convert = *On;                                                                        01                  001194
 001195                                                                                                                      001195
 001196           //----------------------------------------------------------------------------------                       001196
 001197            // EXEC SQL                                                                                               001197
 001198         When workDirective = '/EXEC SQL' or inSQL;                                              X01                  001198
 001199            Exsr subUserCvt_EXEC_SQL;                                                             01                  001199
 001200                                                                                                                      001200
 001201           //----------------------------------------------------------------------------------                       001201
 001202            // END-EXEC                                                                                               001202
 001203         When workDirective = '/END-EXEC';                                                       X01                  001203
 001204            convert = *On;                                                                        01                  001204
 001205                                                                                                                      001205
 001206           //----------------------------------------------------------------------------------                       001206
 001207            // Conditioning indicators                                                                                001207
 001208         When condInd <> *Blanks;                                                                X01                  001208
 001209            nonConvRsn = 'Conditioning indicators are not currently '                             01                  001209
 001210                       + 'supported.';                                                            01                  001210
 001211                                                                                                                      001211
 001212           //----------------------------------------------------------------------------------                       001212
 001213            // ACQ.                                                                                                   001213
 001214         When %subst(operator:1:3) = 'ACQ';                                                      X01                  001214
 001215            Exsr subUserCvt_ACQ;                                                                  01                  001215
 001216                                                                                                                      001216
 001217           //----------------------------------------------------------------------------------                       001217
 001218            // ADDDUR.                                                                                                001218
 001219         When %subst(operator:1:6) = 'ADDDUR';                                                   X01                  001219
 001220            Exsr subUserCvt_ADDDUR;                                                               01                  001220
 001221                                                                                                                      001221
 001222           //----------------------------------------------------------------------------------                       001222
 001223            // ADD.                                                                                                   001223
 001224         When %subst(operator:1:3) = 'ADD';                                                      X01                  001224
 001225            Exsr subUserCvt_ADD;                                                                  01                  001225
 001226                                                                                                                      001226
 001227           //----------------------------------------------------------------------------------                       001227
 001228            // ALLOC.                                                                                                 001228
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     33
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001229         When %subst(operator:1:5) = 'ALLOC';                                                    X01                  001229
 001230            Exsr subUserCvt_ALLOC;                                                                01                  001230
 001231                                                                                                                      001231
 001232           //----------------------------------------------------------------------------------                       001232
 001233            // BEGSR                                                                                                  001233
 001234         When operator = 'BEGSR';                                                                X01                  001234
 001235            Exsr subUserCvt_BEGSR;                                                                01                  001235
 001236                                                                                                                      001236
 001237           //----------------------------------------------------------------------------------                       001237
 001238            // CALLP                                                                                                  001238
 001239         When %subst(operator:1:5) = 'CALLP' or inCallP;                                         X01                  001239
 001240            Exsr subUserCvt_CALLP;                                                                01                  001240
 001241                                                                                                                      001241
 001242           //----------------------------------------------------------------------------------                       001242
 001243            // CASxx                                                                                                  001243
 001244         When %subst(operator:1:3) = 'CAS';                                                      X01                  001244
 001245            Exsr subUserCvt_CASxx;                                                                01                  001245
 001246                                                                                                                      001246
 001247           //----------------------------------------------------------------------------------                       001247
 001248            // CAT                                                                                                    001248
 001249         When %subst(operator:1:3) = 'CAT';                                                      X01                  001249
 001250            Exsr subUserCvt_CAT;                                                                  01                  001250
 001251                                                                                                                      001251
 001252           //----------------------------------------------------------------------------------                       001252
 001253            // CHAIN                                                                                                  001253
 001254         When %subst(operator:1:5) = 'CHAIN';                                                    X01                  001254
 001255            Exsr subUserCvt_CHAIN;                                                                01                  001255
 001256                                                                                                                      001256
 001257           //----------------------------------------------------------------------------------                       001257
 001258            // CHECK                                                                                                  001258
 001259         When %subst(operator:1:5) = 'CHECK';                                                    X01                  001259
 001260            Exsr subUserCvt_CHECKx;                                                               01                  001260
 001261                                                                                                                      001261
 001262           //----------------------------------------------------------------------------------                       001262
 001263            // CLEAR                                                                                                  001263
 001264         When %subst(operator:1:5) = 'CLEAR';                                                    X01                  001264
 001265            Exsr subUserCvt_CLEAR;                                                                01                  001265
 001266                                                                                                                      001266
 001267           //----------------------------------------------------------------------------------                       001267
 001268            // CLOSE                                                                                                  001268
 001269         When %subst(operator:1:5) = 'CLOSE';                                                    X01                  001269
 001270            Exsr subUserCvt_CLOSE;                                                                01                  001270
 001271                                                                                                                      001271
 001272           //----------------------------------------------------------------------------------                       001272
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     34
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001273            // COMMIT                                                                                                 001273
 001274         When %subst(operator:1:6) = 'COMMIT';                                                   X01                  001274
 001275            Exsr subUserCvt_COMMIT;                                                               01                  001275
 001276                                                                                                                      001276
 001277           //----------------------------------------------------------------------------------                       001277
 001278            // COMP                                                                                                   001278
 001279         When operator = 'COMP';                                                                 X01                  001279
 001280            Exsr subUserCvt_COMP;                                                                 01                  001280
 001281                                                                                                                      001281
 001282           //----------------------------------------------------------------------------------                       001282
 001283            // DEALLOC.                                                                                               001283
 001284         When %subst(operator:1:7) = 'DEALLOC';                                                  X01                  001284
 001285            Exsr subUserCvt_DEALLOC;                                                              01                  001285
 001286                                                                                                                      001286
 001287           //----------------------------------------------------------------------------------                       001287
 001288            // DEFINE                                                                                                 001288
 001289         When operator = 'DEFINE';                                                               X01                  001289
 001290            dropLine = *On;                                                                       01                  001290
 001291                                                                                                                      001291
 001292           //----------------------------------------------------------------------------------                       001292
 001293            // DELETE                                                                                                 001293
 001294         When %subst(operator:1:6) = 'DELETE';                                                   X01                  001294
 001295            Exsr subUserCvt_DELETE;                                                               01                  001295
 001296                                                                                                                      001296
 001297           //----------------------------------------------------------------------------------                       001297
 001298            // DIV                                                                                                    001298
 001299         When %subst(operator:1:3) = 'DIV';                                                      X01                  001299
 001300            Exsr subUserCvt_DIV;                                                                  01                  001300
 001301                                                                                                                      001301
 001302           //----------------------------------------------------------------------------------                       001302
 001303            // DOxxx                                                                                                  001303
 001304         When %subst(operator:1:2) = 'DO'                                                        X01                  001304
 001305         and (%subst(operator:3:3) = 'WEQ'                                                       X01                  001305
 001306         or %subst(operator:3:2) = 'W '                                                          X01                  001306
 001307         or %subst(operator:3:3) = 'WGT'                                                         X01                  001307
 001308         or %subst(operator:3:3) = 'WLT'                                                         X01                  001308
 001309         or %subst(operator:3:3) = 'WNE'                                                         X01                  001309
 001310         or %subst(operator:3:3) = 'WGE'                                                         X01                  001310
 001311         or %subst(operator:3:3) = 'WLE'                                                         X01                  001311
 001312         or %subst(operator:3:2) = 'U '                                                          X01                  001312
 001313         or %subst(operator:3:3) = 'UEQ'                                                         X01                  001313
 001314         or %subst(operator:3:3) = 'UGT'                                                         X01                  001314
 001315         or %subst(operator:3:3) = 'ULT'                                                         X01                  001315
 001316         or %subst(operator:3:3) = 'UNE'                                                         X01                  001316
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     35
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001317         or %subst(operator:3:3) = 'UGE'                                                         X01                  001317
 001318         or %subst(operator:3:3) = 'ULE'                                                         X01                  001318
 001319         or %subst(operator:3:3) = '   ')                                                        X01                  001319
 001320         or inDo;                                                                                X01                  001320
 001321            Exsr subUserCvt_DO;                                                                   01                  001321
 001322                                                                                                                      001322
 001323           //----------------------------------------------------------------------------------                       001323
 001324            // DSPLY                                                                                                  001324
 001325         When %subst(operator:1:5) = 'DSPLY';                                                    X01                  001325
 001326            Exsr subUserCvt_DSPLY;                                                                01                  001326
 001327                                                                                                                      001327
 001328           //----------------------------------------------------------------------------------                       001328
 001329            // DUMP                                                                                                   001329
 001330         When %subst(operator:1:4) = 'DUMP';                                                     X01                  001330
 001331            Exsr subUserCvt_DUMP;                                                                 01                  001331
 001332                                                                                                                      001332
 001333           //----------------------------------------------------------------------------------                       001333
 001334            // ELSE                                                                                                   001334
 001335         When operator = 'ELSE';                                                                 X01                  001335
 001336            Exsr subUserCvt_ELSE;                                                                 01                  001336
 001337                                                                                                                      001337
 001338           //----------------------------------------------------------------------------------                       001338
 001339            // ELSEIF                                                                                                 001339
 001340         When operator = 'ELSEIF';                                                               X01                  001340
 001341            Exsr subUserCvt_ELSEIF;                                                               01                  001341
 001342                                                                                                                      001342
 001343           //----------------------------------------------------------------------------------                       001343
 001344            // ENDxx                                                                                                  001344
 001345         When %subst(operator:1:3) = 'END';                                                      X01                  001345
 001346            Exsr subUserCvt_ENDxx;                                                                01                  001346
 001347                                                                                                                      001347
 001348           //----------------------------------------------------------------------------------                       001348
 001349            // EVALx                                                                                                  001349
 001350         When %subst(operator:1:4) = 'EVAL' or inEval;                                           X01                  001350
 001351            Exsr subUserCvt_EVALx;                                                                01                  001351
 001352                                                                                                                      001352
 001353           //----------------------------------------------------------------------------------                       001353
 001354            // EXCEPT                                                                                                 001354
 001355         When operator = 'EXCEPT';                                                               X01                  001355
 001356            Exsr subUserCvt_EXCEPT;                                                               01                  001356
 001357                                                                                                                      001357
 001358           //----------------------------------------------------------------------------------                       001358
 001359            // EXFMT                                                                                                  001359
 001360         When %subst(operator:1:5) = 'EXFMT';                                                    X01                  001360
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     36
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001361            Exsr subUserCvt_EXFMT;                                                                01                  001361
 001362                                                                                                                      001362
 001363           //----------------------------------------------------------------------------------                       001363
 001364            // EXSR                                                                                                   001364
 001365         When operator = 'EXSR';                                                                 X01                  001365
 001366            Exsr subUserCvt_EXSR;                                                                 01                  001366
 001367                                                                                                                      001367
 001368           //----------------------------------------------------------------------------------                       001368
 001369            // EXTRCT                                                                                                 001369
 001370         When %subst(operator:1:6) = 'EXTRCT';                                                   X01                  001370
 001371            Exsr subUserCvt_EXTRCT;                                                               01                  001371
 001372                                                                                                                      001372
 001373           //----------------------------------------------------------------------------------                       001373
 001374            // FEOD                                                                                                   001374
 001375         When %subst(operator:1:4) = 'FEOD';                                                     X01                  001375
 001376            Exsr subUserCvt_FEOD;                                                                 01                  001376
 001377                                                                                                                      001377
 001378           //----------------------------------------------------------------------------------                       001378
 001379            // FOR                                                                                                    001379
 001380         When operator = 'FOR';                                                                  X01                  001380
 001381            Exsr subUserCvt_FOR;                                                                  01                  001381
 001382                                                                                                                      001382
 001383           //----------------------------------------------------------------------------------                       001383
 001384            // FORCE                                                                                                  001384
 001385         When operator = 'FORCE';                                                                X01                  001385
 001386            Exsr subUserCvt_FORCE;                                                                01                  001386
 001387                                                                                                                      001387
 001388           //----------------------------------------------------------------------------------                       001388
 001389            // IFxx                                                                                                   001389
 001390         When %subst(operator:1:2) = 'IF' or inIf;                                               X01                  001390
 001391            Exsr subUserCvt_IF;                                                                   01                  001391
 001392                                                                                                                      001392
 001393           //----------------------------------------------------------------------------------                       001393
 001394            // IN                                                                                                     001394
 001395         When %subst(operator:1:2) = 'IN';                                                       X01                  001395
 001396            Exsr subUserCvt_IN;                                                                   01                  001396
 001397                                                                                                                      001397
 001398           //----------------------------------------------------------------------------------                       001398
 001399            // ITER                                                                                                   001399
 001400         When operator = 'ITER';                                                                 X01                  001400
 001401            Exsr subUserCvt_ITER;                                                                 01                  001401
 001402                                                                                                                      001402
 001403           //----------------------------------------------------------------------------------                       001403
 001404            // LEAVExx;                                                                                               001404
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     37
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001405         When %subst(operator:1:5) = 'LEAVE';                                                    X01                  001405
 001406            Exsr subUserCvt_LEAVE;                                                                01                  001406
 001407                                                                                                                      001407
 001408           //----------------------------------------------------------------------------------                       001408
 001409            // LOOKUP                                                                                                 001409
 001410         When operator = 'LOOKUP';                                                               X01                  001410
 001411            Exsr subUserCvt_LOOKUP;                                                               01                  001411
 001412                                                                                                                      001412
 001413           //----------------------------------------------------------------------------------                       001413
 001414            // MOVEA                                                                                                  001414
 001415         When %subst(operator:1:5) = 'MOVEA';                                                    X01                  001415
 001416            Exsr subUserCvt_MOVEA;                                                                01                  001416
 001417            LeaveSr;                                                                              01                  001417
 001418                                                                                                                      001418
 001419           //----------------------------------------------------------------------------------                       001419
 001420            // MOVE/MOVEL                                                                                             001420
 001421         When operator = 'MONITOR';                                                              X01                  001421
 001422            Exsr subUserCvt_MONITOR;                                                              01                  001422
 001423                                                                                                                      001423
 001424           //----------------------------------------------------------------------------------                       001424
 001425            // MOVE/MOVEL                                                                                             001425
 001426         When %subst(operator:1:4) = 'MOVE';                                                     X01                  001426
 001427            Exsr subUserCvt_MOVE;                                                                 01                  001427
 001428                                                                                                                      001428
 001429           //----------------------------------------------------------------------------------                       001429
 001430            // MULT.                                                                                                  001430
 001431         When %subst(operator:1:4) = 'MULT';                                                     X01                  001431
 001432            Exsr subUserCvt_MULT;                                                                 01                  001432
 001433                                                                                                                      001433
 001434           //----------------------------------------------------------------------------------                       001434
 001435            // MVR                                                                                                    001435
 001436         When operator = 'MVR';                                                                  X01                  001436
 001437            Exsr subUserCvt_MVR;                                                                  01                  001437
 001438                                                                                                                      001438
 001439           //----------------------------------------------------------------------------------                       001439
 001440            // OCCUR (but not both set and get).                                                                      001440
 001441         When %subst(operator:1:5) = 'OCCUR';                                                    X01                  001441
 001442            Exsr subUserCvt_OCCUR;                                                                01                  001442
 001443                                                                                                                      001443
 001444           //----------------------------------------------------------------------------------                       001444
 001445            // ON-ERROR                                                                                               001445
 001446         When operator = 'ON-ERROR';                                                             X01                  001446
 001447            Exsr subUserCvt_ON_ERROR;                                                             01                  001447
 001448                                                                                                                      001448
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     38
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001449           //----------------------------------------------------------------------------------                       001449
 001450            // OPEN                                                                                                   001450
 001451         When %subst(operator:1:4) = 'OPEN';                                                     X01                  001451
 001452            Exsr subUserCvt_OPEN;                                                                 01                  001452
 001453                                                                                                                      001453
 001454           //----------------------------------------------------------------------------------                       001454
 001455            // OTHER                                                                                                  001455
 001456         When operator = 'OTHER';                                                                X01                  001456
 001457            Exsr subUserCvt_OTHER;                                                                01                  001457
 001458                                                                                                                      001458
 001459           //----------------------------------------------------------------------------------                       001459
 001460            // OUT                                                                                                    001460
 001461         When %subst(operator:1:3) = 'OUT';                                                      X01                  001461
 001462            Exsr subUserCvt_OUT;                                                                  01                  001462
 001463                                                                                                                      001463
 001464           //----------------------------------------------------------------------------------                       001464
 001465            // POST                                                                                                   001465
 001466         When %subst(operator:1:4) = 'POST';                                                     X01                  001466
 001467            Exsr subUserCvt_POST;                                                                 01                  001467
 001468                                                                                                                      001468
 001469           //----------------------------------------------------------------------------------                       001469
 001470            // READ                                                                                                   001470
 001471         When %subst(operator:1:4) = 'READ';                                                     X01                  001471
 001472            Exsr subUserCvt_READ;                                                                 01                  001472
 001473                                                                                                                      001473
 001474           //----------------------------------------------------------------------------------                       001474
 001475            // REL                                                                                                    001475
 001476         When %subst(operator:1:3) = 'REL';                                                      X01                  001476
 001477            Exsr subUserCvt_REL;                                                                  01                  001477
 001478                                                                                                                      001478
 001479           //----------------------------------------------------------------------------------                       001479
 001480            // RESET                                                                                                  001480
 001481         When %subst(operator:1:5) = 'RESET';                                                    X01                  001481
 001482            Exsr subUserCvt_RESET;                                                                01                  001482
 001483                                                                                                                      001483
 001484           //----------------------------------------------------------------------------------                       001484
 001485            // RETURN                                                                                                 001485
 001486         When %subst(operator:1:6) = 'RETURN';                                                   X01                  001486
 001487            Exsr subUserCvt_RETURN;                                                               01                  001487
 001488                                                                                                                      001488
 001489           //----------------------------------------------------------------------------------                       001489
 001490            // ROLBK                                                                                                  001490
 001491         When %subst(operator:1:5) = 'ROLBK';                                                    X01                  001491
 001492            Exsr subUserCvt_ROLBK;                                                                01                  001492
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     39
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001493                                                                                                                      001493
 001494           //----------------------------------------------------------------------------------                       001494
 001495            // SCAN                                                                                                   001495
 001496         When operator = 'SCAN';                                                                 X01                  001496
 001497            Exsr subUserCvt_SCAN;                                                                 01                  001497
 001498                                                                                                                      001498
 001499           //----------------------------------------------------------------------------------                       001499
 001500            // SELECT                                                                                                 001500
 001501         When operator = 'SELECT';                                                               X01                  001501
 001502            Exsr subUserCvt_SELECT;                                                               01                  001502
 001503                                                                                                                      001503
 001504           //----------------------------------------------------------------------------------                       001504
 001505            // SETLL / SETGT                                                                                          001505
 001506         When %subst(operator:1:5) = 'SETLL'                                                     X01                  001506
 001507         or %subst(operator:1:5) = 'SETGT';                                                      X01                  001507
 001508            Exsr subUserCvt_SETxx;                                                                01                  001508
 001509                                                                                                                      001509
 001510           //----------------------------------------------------------------------------------                       001510
 001511            // SETOFF                                                                                                 001511
 001512         When operator = 'SETOFF';                                                               X01                  001512
 001513            Exsr subUserCvt_SETOFF;                                                               01                  001513
 001514                                                                                                                      001514
 001515           //----------------------------------------------------------------------------------                       001515
 001516            // SETON                                                                                                  001516
 001517         When operator = 'SETON';                                                                X01                  001517
 001518            Exsr subUserCvt_SETON;                                                                01                  001518
 001519                                                                                                                      001519
 001520           //----------------------------------------------------------------------------------                       001520
 001521            // SHTDN                                                                                                  001521
 001522         When operator = 'SHTDN';                                                                X01                  001522
 001523            Exsr subUserCvt_SHTDN;                                                                01                  001523
 001524                                                                                                                      001524
 001525           //----------------------------------------------------------------------------------                       001525
 001526            // SORTA.                                                                                                 001526
 001527         When %subst(operator:1:5) = 'SORTA';                                                    X01                  001527
 001528            Exsr subUserCvt_SORTA;                                                                01                  001528
 001529                                                                                                                      001529
 001530           //----------------------------------------------------------------------------------                       001530
 001531            // SUBDUR.                                                                                                001531
 001532         When %subst(operator:1:6) = 'SUBDUR';                                                   X01                  001532
 001533            Exsr subUserCvt_SUBDUR;                                                               01                  001533
 001534                                                                                                                      001534
 001535           //----------------------------------------------------------------------------------                       001535
 001536            // SUBST.                                                                                                 001536
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     40
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001537         When %subst(operator:1:5) = 'SUBST';                                                    X01                  001537
 001538            Exsr subUserCvt_SUBST;                                                                01                  001538
 001539                                                                                                                      001539
 001540           //----------------------------------------------------------------------------------                       001540
 001541            // SUB                                                                                                    001541
 001542         When %subst(operator:1:3) = 'SUB';                                                      X01                  001542
 001543            Exsr subUserCvt_SUB;                                                                  01                  001543
 001544                                                                                                                      001544
 001545           //----------------------------------------------------------------------------------                       001545
 001546            // TESTB                                                                                                  001546
 001547         When operator = 'TESTB';                                                                X01                  001547
 001548                                                                                                                      001548
 001549           //----------------------------------------------------------------------------------                       001549
 001550            // TESTN                                                                                                  001550
 001551         When operator = 'TESTN';                                                                X01                  001551
 001552                                                                                                                      001552
 001553           //----------------------------------------------------------------------------------                       001553
 001554            // TESTZ                                                                                                  001554
 001555         When operator = 'TESTZ';                                                                X01                  001555
 001556                                                                                                                      001556
 001557           //----------------------------------------------------------------------------------                       001557
 001558            // TEST                                                                                                   001558
 001559         When %subst(operator:1:4) = 'TEST';                                                     X01                  001559
 001560            Exsr subUserCvt_TEST;                                                                 01                  001560
 001561                                                                                                                      001561
 001562           //----------------------------------------------------------------------------------                       001562
 001563            // TIME                                                                                                   001563
 001564         When operator = 'TIME';                                                                 X01                  001564
 001565            Exsr subUserCvt_TIME;                                                                 01                  001565
 001566                                                                                                                      001566
 001567           //----------------------------------------------------------------------------------                       001567
 001568            // UPDATE                                                                                                 001568
 001569         When %subst(operator:1:6) = 'UPDATE';                                                   X01                  001569
 001570            Exsr subUserCvt_UPDATE;                                                               01                  001570
 001571                                                                                                                      001571
 001572           //----------------------------------------------------------------------------------                       001572
 001573            // UNLOCK                                                                                                 001573
 001574         When %subst(operator:1:6) = 'UNLOCK';                                                   X01                  001574
 001575            Exsr subUserCvt_UNLOCK;                                                               01                  001575
 001576                                                                                                                      001576
 001577           //----------------------------------------------------------------------------------                       001577
 001578            // WHENxx                                                                                                 001578
 001579         When %subst(operator:1:4) = 'WHEN' or inWhen;                                           X01                  001579
 001580            Exsr subUserCvt_WHEN;                                                                 01                  001580
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     41
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001581                                                                                                                      001581
 001582           //----------------------------------------------------------------------------------                       001582
 001583            // WRITE                                                                                                  001583
 001584         When %subst(operator:1:5) = 'WRITE';                                                    X01                  001584
 001585            Exsr subUserCvt_WRITE;                                                                01                  001585
 001586                                                                                                                      001586
 001587           //----------------------------------------------------------------------------------                       001587
 001588            // XLATE                                                                                                  001588
 001589         When %subst(operator:1:5) = 'XLATE';                                                    X01                  001589
 001590            Exsr subUserCvt_XLATE;                                                                01                  001590
 001591                                                                                                                      001591
 001592           //----------------------------------------------------------------------------------                       001592
 001593            // Z-ADD (half-adjust not converted).                                                                     001593
 001594         When %subst(operator:1:5) = 'Z-ADD';                                                    X01                  001594
 001595            Exsr subUserCvt_Z_ADD;                                                                01                  001595
 001596                                                                                                                      001596
 001597           //----------------------------------------------------------------------------------                       001597
 001598            // Z-SUB (half-adjust not converted).                                                                     001598
 001599         When %subst(operator:1:5) = 'Z-SUB';                                                    X01                  001599
 001600            Exsr subUserCvt_Z_SUB;                                                                01                  001600
 001601      EndSl;                                                                                     E01                  001601
 001602                                                                                                                      001602
 001603   EndSr;                                                                                                             001603
 001604   //-------------------------------------------------------------------------------------------                      001604
 001605                                                                                                                      001605
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     42
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001607   //-------------------------------------------------------------------------------------------                      001607
 001608   // Convert declaration to free-format.                                                                             001608
 001609   //-------------------------------------------------------------------------------------------                      001609
 001610   BegSr subUserConvertD_Spec;                                                                                        001610
 001611                                                                                                                      001611
 001612      // Keep blank lines.                                                                                            001612
 001613      If codeLine = *Blanks;                                                                     B01                  001613
 001614         sourceLine = *Blanks;                                                                    01                  001614
 001615         convert = *On;                                                                           01                  001615
 001616         LeaveSr;                                                                                 01                  001616
 001617      EndIf;                                                                                     E01                  001617
 001618                                                                                                                      001618
 001619      sourceLine = fullLine;                                                                                          001619
 001620                                                                                                                      001620
 001621      //      declType = %xlate(lo:up:declType);                                                                      001621
 001622      workDeclAttr = %xlate(lo:up:declAttr);                                                                          001622
 001623      workDeclKeywords = declKeywords;       // Use longer work field to cater for expansion.                         001623
 001624                                                                                                                      001624
 001625      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              001625
 001626                                                                                                                      001626
 001627      //If not inDeclaration;                                                                                         001627
 001628      If not inDeclaration or declName = *Blanks;                                                B01                  001628
 001629         If not inDeclaration;                                                                   B02                  001629
 001630            //Exsr subUserGetDeclarationType;                                                                         001630
 001631            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  001631
 001632         EndIf;                                                                                  E02                  001632
 001633                                                                                                                      001633
 001634         //-------------------------------------------------------------------------                                  001634
 001635         // Stand-alone Field Definition.                                                                             001635
 001636         //-------------------------------------------------------------------------                                  001636
 001637         If workDeclType = 'S';      // Stand-alone field.                                       B02                  001637
 001638            inDeclaration = *On;                                                                  02                  001638
 001639                                                                                                                      001639
 001640            Clear DCLS;                                                                           02                  001640
 001641                                                                                                                      001641
 001642            // FROMFILE is not allowed.                                                                               001642
 001643            If %scan('FROMFILE':%xlate(lo:up:workDeclKeywords)) > 0;                             B03                  001643
 001644               inDeclaration = *Off;                                                              03                  001644
 001645               nonConvRsn = 'FROMFILE not allowed in Free-Form';                                  03                  001645
 001646               convert = *Off;                                                                    03                  001646
 001647               LeaveSr;                                                                           03                  001647
 001648            EndIf;                                                                               E03                  001648
 001649                                                                                                                      001649
 001650            If savedName <> *Blanks;                                                             B03                  001650
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     43
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001651               DCLS.decl = 'Dcl-S ';                                                              03                  001651
 001652               %subst(DCLS:7) = savedName;                                                        03                  001652
 001653            EndIf;                                                                               E03                  001653
 001654                                                                                                                      001654
 001655            // Type.                                                                                                  001655
 001656            If workDeclAttr = *Blanks                                                            B03                  001656
 001657            and DCLS.type = *Blanks;                                                             B03                  001657
 001658               If declLen = *Blanks;                                                             B04                  001658
 001659                  // No definition (probably in keywords - e.g. LIKE()).                                              001659
 001660               ElseIf declScale = *Blanks;                                                       X04                  001660
 001661                  workDeclAttr = 'A';                                                             04                  001661
 001662               Else;                                                                             X04                  001662
 001663                  If inDatastructure;                                                            B05                  001663
 001664                     workDeclAttr = 'S';                                                          05                  001664
 001665                  Else;                                                                          X05                  001665
 001666                     workDeclAttr = 'P';                                                          05                  001666
 001667                  EndIf;                                                                         E05                  001667
 001668               EndIf;                                                                            E04                  001668
 001669            EndIf;                                                                               E03                  001669
 001670                                                                                                                      001670
 001671            If workDeclAttr = *Blanks;                                                           B03                  001671
 001672               // No definition (probably in keywords - e.g. LIKE()).                                                 001672
 001673            ElseIf workDeclAttr = 'A';                                                           X03                  001673
 001674               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001674
 001675               If x > 0;                                                                         B04                  001675
 001676                  DCLS.type = '  VarChar';                                                        04                  001676
 001677                  If x = 1;                                                                      B05                  001677
 001678                     workDeclKeywords = %subst(workDeclKeywords:x+7);                             05                  001678
 001679                  Else;                                                                          X05                  001679
 001680                     workDeclKeywords = %subst(workDeclKeywords:1:x-1)                            05                  001680
 001681                                  + %subst(workDeclKeywords:x+7);                                 05                  001681
 001682                  EndIf;                                                                         E05                  001682
 001683               Else;                                                                             X04                  001683
 001684                  DCLS.type = '     Char';                                                        04                  001684
 001685               EndIf;                                                                            E04                  001685
 001686            ElseIf workDeclAttr = 'P';                                                           X03                  001686
 001687               DCLS.type = '   Packed';                                                           03                  001687
 001688            ElseIf workDeclAttr = 'D';                                                           X03                  001688
 001689               DCLS.type = '     Date';                                                           03                  001689
 001690               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001690
 001691               If x > 0;                                                                         B04                  001691
 001692                  x = %scan('(':workDeclKeywords:x);                                              04                  001692
 001693                  y = %scan(')':workDeclKeywords:x);                                              04                  001693
 001694                  DCLS.definition = '('                                                           04                  001694
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     44
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001695                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001695
 001696                            + ')';                                                                04                  001696
 001697                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001697
 001698               EndIf;                                                                            E04                  001698
 001699            ElseIf workDeclAttr = 'T';                                                           X03                  001699
 001700               DCLS.type = '     Time';                                                           03                  001700
 001701               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001701
 001702               If x > 0;                                                                         B04                  001702
 001703                  x = %scan('(':workDeclKeywords:x);                                              04                  001703
 001704                  y = %scan(')':workDeclKeywords:x);                                              04                  001704
 001705                  DCLS.definition = '('                                                           04                  001705
 001706                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001706
 001707                            + ')';                                                                04                  001707
 001708                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001708
 001709               EndIf;                                                                            E04                  001709
 001710            ElseIf workDeclAttr = 'Z';                                                           X03                  001710
 001711               DCLS.type = 'TimeStamp';                                                           03                  001711
 001712            ElseIf workDeclAttr = 'I';                                                           X03                  001712
 001713               DCLS.type = '      Int';                                                           03                  001713
 001714            ElseIf workDeclAttr = 'S';                                                           X03                  001714
 001715               DCLS.type = '    Zoned';                                                           03                  001715
 001716            ElseIf workDeclAttr = 'N';                                                           X03                  001716
 001717               DCLS.type = '      Ind';                                                           03                  001717
 001718            ElseIf workDeclAttr = '*';                                                           X03                  001718
 001719               DCLS.type = '  Pointer';                                                           03                  001719
 001720            ElseIf workDeclAttr = 'B';                                                           X03                  001720
 001721               DCLS.type = '   BinDec';                                                           03                  001721
 001722            ElseIf workDeclAttr = 'G';                                                           X03                  001722
 001723               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001723
 001724               If x > 0;                                                                         B04                  001724
 001725                  DCLS.type = ' VarGraph';                                                        04                  001725
 001726                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001726
 001727               Else;                                                                             X04                  001727
 001728                  DCLS.type = '    Graph';                                                        04                  001728
 001729               EndIf;                                                                            E04                  001729
 001730            Else;                                                                                X03                  001730
 001731               inDeclaration = *Off;                                                              03                  001731
 001732               convert = *Off;                                                                    03                  001732
 001733               LeaveSr;                                                                           03                  001733
 001734            EndIf;                                                                               E03                  001734
 001735                                                                                                                      001735
 001736            // Attributes.                                                                                            001736
 001737            If workDeclAttr <> '*'                                                               B03                  001737
 001738            and workDeclAttr <> 'N'                                                              B03                  001738
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     45
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001739            and workDeclAttr <> 'D'                                                              B03                  001739
 001740            and workDeclAttr <> 'T'                                                              B03                  001740
 001741            and workDeclAttr <> 'Z'                                                              B03                  001741
 001742            and workDeclAttr <> *Blank                                                           B03                  001742
 001743            and DCLS.type <> *Blanks;                                                            B03                  001743
 001744               DCLS.definition = '(' + %trim(declLen);                                            03                  001744
 001745               If declScale <> *Blanks;                                                          B04                  001745
 001746                  DCLS.definition = %trimr(DCLS.definition)                                       04                  001746
 001747                                  + ':' + %trim(declScale);                                       04                  001747
 001748               EndIf;                                                                            E04                  001748
 001749               DCLS.definition = %trimr(DCLS.definition) + ')';                                   03                  001749
 001750            EndIf;                                                                               E03                  001750
 001751                                                                                                                      001751
 001752            // Keywords.                                                                                              001752
 001753                                                                                                                      001753
 001754            // Expand DTAARA?                                                                                         001754
 001755            x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                                  02                  001755
 001756            If x > 0;                                                                            B03                  001756
 001757               i = %scan(')':workDeclKeywords:x+1);                                               03                  001757
 001758               If i > 0;                                                                         B04                  001758
 001759                  If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                         B05                  001759
 001760                     workDeclKeywords = %subst(workDeclKeywords:1:x+6)                            05                  001760
 001761                        + ''''                                                                    05                  001761
 001762                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      05                  001762
 001763                        + ''''                                                                    05                  001763
 001764                        + %subst(workDeclKeywords:i);                                             05                  001764
 001765                  EndIf;                                                                         E05                  001765
 001766               EndIf;                                                                            E04                  001766
 001767            EndIf;                                                                               E03                  001767
 001768                                                                                                                      001768
 001769            // Terminate the line?                                                                                    001769
 001770            If not inSpan;                                                                       B03                  001770
 001771               If workDeclKeyWords = *Blanks;                                                    B04                  001771
 001772                  DCLS.definition = %trimr(DCLS.definition) + ';';                                04                  001772
 001773               Else;                                                                             X04                  001773
 001774                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  001774
 001775               EndIf;                                                                            E04                  001775
 001776               inDeclaration = *Off;                                                              03                  001776
 001777            Else;                                                                                X03                  001777
 001778               inSpan = *Off;                                                                     03                  001778
 001779            EndIf;                                                                               E03                  001779
 001780                                                                                                                      001780
 001781            // Have we encroached on the comments?                                                                    001781
 001782            x = %len(%trimr(DCLS.definition)) + %len(workDeclKeywords);                           02                  001782
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     46
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001783            If x >= 37;                                                                          B03                  001783
 001784               x = x - %len(%trimr(DCLS.definition));                                             03                  001784
 001785               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  001785
 001786               indentOffset = 37;                                                                 03                  001786
 001787            EndIf;                                                                               E03                  001787
 001788                                                                                                                      001788
 001789            If DCLS.definition = *Blanks and DCLS.type = *Blanks;                                B03                  001789
 001790               DCLS.definition = %trim(workDeclKeywords);                                         03                  001790
 001791            Else;                                                                                X03                  001791
 001792               DCLS.definition = %trimr(DCLS.definition) + ' '                                    03                  001792
 001793                               + %trim(workDeclKeywords);                                         03                  001793
 001794            EndIf;                                                                               E03                  001794
 001795                                                                                                                      001795
 001796            // Comment.                                                                                               001796
 001797            If comment <> *Blanks;                                                               B03                  001797
 001798               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001798
 001799                  DCLS.comment = '   ' + comment;                                                 04                  001799
 001800               Else;                                                                             X04                  001800
 001801                  DCLS.comment = '// ' + comment;                                                 04                  001801
 001802               EndIf;                                                                            E04                  001802
 001803            EndIf;                                                                               E03                  001803
 001804                                                                                                                      001804
 001805            // Converted line...                                                                                      001805
 001806            sourceLine = DCLS;                                                                    02                  001806
 001807            If not inSpan;                                                                       B03                  001807
 001808               savedName = *Blanks;                                                               03                  001808
 001809            EndIf;                                                                               E03                  001809
 001810                                                                                                                      001810
 001811            //-------------------------------------------------------------------------                               001811
 001812            // Constant Definition.                                                                                   001812
 001813            //-------------------------------------------------------------------------                               001813
 001814         ElseIf workDeclType = 'C';                                                              X02                  001814
 001815            inDeclaration = *On;                                                                  02                  001815
 001816                                                                                                                      001816
 001817            Clear DCLS;                                                                           02                  001817
 001818            If savedName <> *Blanks;                                                             B03                  001818
 001819               DCLS.decl = 'Dcl-C ';                                                              03                  001819
 001820               %subst(DCLS:7) = %xlate(lo:up:savedName);                                          03                  001820
 001821            EndIf;                                                                               E03                  001821
 001822                                                                                                                      001822
 001823            // Keywords.                                                                                              001823
 001824            If workDeclKeywords <> *Blanks;                                                      B03                  001824
 001825               If DCLS.definition = *Blanks;                                                     B04                  001825
 001826                  DCLS.definition = %trim(workDeclKeywords);                                      04                  001826
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     47
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001827               Else;                                                                             X04                  001827
 001828                  DCLS.definition = %trimr(DCLS.definition) + ' '                                 04                  001828
 001829                                  + %trim(workDeclKeywords);                                      04                  001829
 001830               EndIf;                                                                            E04                  001830
 001831            EndIf;                                                                               E03                  001831
 001832                                                                                                                      001832
 001833            // Comment.                                                                                               001833
 001834            If comment <> *Blanks;                                                               B03                  001834
 001835               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001835
 001836                  DCLS.comment = '   ' + comment;                                                 04                  001836
 001837               Else;                                                                             X04                  001837
 001838                  DCLS.comment = '// ' + comment;                                                 04                  001838
 001839               EndIf;                                                                            E04                  001839
 001840            EndIf;                                                                               E03                  001840
 001841                                                                                                                      001841
 001842            If not inSpan;                                                                       B03                  001842
 001843               DCLS.definition = %trimr(DCLS.definition) + ';';                                   03                  001843
 001844               inDeclaration = *Off;                                                              03                  001844
 001845            Else;                                                                                X03                  001845
 001846               inSpan = *Off;                                                                     03                  001846
 001847            EndIf;                                                                               E03                  001847
 001848                                                                                                                      001848
 001849            // Continuation of constant must start at left margin.                                                    001849
 001850            If DCLS.decl = *Blanks;                                                              B03                  001850
 001851               DCLS = DCLS.definition;                                                            03                  001851
 001852            EndIf;                                                                               E03                  001852
 001853                                                                                                                      001853
 001854            // Converted line...                                                                                      001854
 001855            sourceLine = DCLS;                                                                    02                  001855
 001856            If not inSpan;                                                                       B03                  001856
 001857               savedName = *Blanks;                                                               03                  001857
 001858            EndIf;                                                                               E03                  001858
 001859                                                                                                                      001859
 001860            //-------------------------------------------------------------------------                               001860
 001861            // Prototype/Interface/Datastructure Definition.                                                          001861
 001862            //-------------------------------------------------------------------------                               001862
 001863         ElseIf workDeclType = 'PR'                                                              X02                  001863
 001864             or inPrototype                                                                      X02                  001864
 001865             or workDeclType = 'PI'                                                              X02                  001865
 001866             or inInterface                                                                      X02                  001866
 001867             or workDeclType = 'DS'                                                              X02                  001867
 001868             or inDatastructure;                                                                 X02                  001868
 001869            inDeclaration = *On;                                                                  02                  001869
 001870            Clear DCLPR;                                                                          02                  001870
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     48
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001871                                                                                                                      001871
 001872            // Determine where to end the structure.                                                                  001872
 001873            If not inPrototype                                                                   B03                  001873
 001874            and not inInterface                                                                  B03                  001874
 001875            and not inDatastructure;                                                             B03                  001875
 001876               Exsr subUserGetEndLine;                                                            03                  001876
 001877               If workDeclType = 'PR';                                                           B04                  001877
 001878                  inPrototype = *On;                                                              04                  001878
 001879               ElseIf workDeclType = 'PI';                                                       X04                  001879
 001880                  inInterface = *On;                                                              04                  001880
 001881               ElseIf workDeclType = 'DS';                                                       X04                  001881
 001882                  inDatastructure = *On;                                                          04                  001882
 001883                  endDS = *On;                                                                    04                  001883
 001884               EndIf;                                                                            E04                  001884
 001885               DCLPR.decl = 'Dcl-' + workDeclType;                                                03                  001885
 001886               If savedName = *Blanks;                                                           B04                  001886
 001887                  savedName = '*N';                                                               04                  001887
 001888               EndIf;                                                                            E04                  001888
 001889               %subst(DCLPR:8) = savedName;                                                       03                  001889
 001890               //DCLPR.procName = savedName;                                                                          001890
 001891               endDeclType = workDeclType;                                                        03                  001891
 001892               workDeclName = savedName;                                                          03                  001892
 001893               If %scan('...':sourceLine) > 0;  // Long name!                                    B04                  001893
 001894                  workDeclAttr = *Blanks;                                                         04                  001894
 001895               EndIf;                                                                            E04                  001895
 001896            Else;                                                                                X03                  001896
 001897               If inPrototype                                                                    B04                  001897
 001898               and savedName = *Blanks                                                           B04                  001898
 001899               and declType = *Blanks                                                            B04                  001899
 001900               and not inExtProc                                                                 B04                  001900
 001901               and not inSpan;                                                                   B04                  001901
 001902                  savedName = '*N';                                                               04                  001902
 001903               EndIf;                                                                            E04                  001903
 001904                                                                                                                      001904
 001905               If savedName <> '**';                                                             B04                  001905
 001906                  DCLPR.fieldName = savedName;                                                    04                  001906
 001907               EndIf;                                                                            E04                  001907
 001908            EndIf;                                                                               E03                  001908
 001909                                                                                                                      001909
 001910            // Type.                                                                                                  001910
 001911            If workDeclAttr = *Blanks                                                            B03                  001911
 001912            and DCLPR.type = *Blanks;                                                            B03                  001912
 001913               If declLen = *Blanks;                                                             B04                  001913
 001914                  // No definition (probably in keywords - e.g. LIKE()).                                              001914
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     49
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001915               ElseIf declScale = *Blanks;                                                       X04                  001915
 001916                  workDeclAttr = 'A';                                                             04                  001916
 001917               Else;                                                                             X04                  001917
 001918                  If inDatastructure;                                                            B05                  001918
 001919                     workDeclAttr = 'S';                                                          05                  001919
 001920                  Else;                                                                          X05                  001920
 001921                     workDeclAttr = 'P';                                                          05                  001921
 001922                  EndIf;                                                                         E05                  001922
 001923               EndIf;                                                                            E04                  001923
 001924            EndIf;                                                                               E03                  001924
 001925                                                                                                                      001925
 001926            If workDeclAttr = *Blanks;                                                           B03                  001926
 001927               // No definition (probably in keywords - e.g. LIKE()).                                                 001927
 001928            ElseIf workDeclAttr = 'A';                                                           X03                  001928
 001929               If DCLPR.decl = 'Dcl-DS';                                                         B04                  001929
 001930                  If declLen <> *Blanks;                                                         B05                  001930
 001931                     DCLPR.type = '      Len';                                                    05                  001931
 001932                  EndIf;                                                                         E05                  001932
 001933               Else;                                                                             X04                  001933
 001934                  x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                            04                  001934
 001935                  If x > 0;                                                                      B05                  001935
 001936                     DCLPR.type = '  VarChar';                                                    05                  001936
 001937                     If x = 1;                                                                   B06                  001937
 001938                        workDeclKeywords = %subst(workDeclKeywords:x+7);                          06                  001938
 001939                     Else;                                                                       X06                  001939
 001940                        workDeclKeywords = %subst(workDeclKeywords:1:x-1)                         06                  001940
 001941                                     + %subst(workDeclKeywords:x+7);                              06                  001941
 001942                     EndIf;                                                                      E06                  001942
 001943                  Else;                                                                          X05                  001943
 001944                     DCLPR.type = '     Char';                                                    05                  001944
 001945                  EndIf;                                                                         E05                  001945
 001946               EndIf;                                                                            E04                  001946
 001947            ElseIf workDeclAttr = 'P';                                                           X03                  001947
 001948               DCLPR.type = '   Packed';                                                          03                  001948
 001949            ElseIf workDeclAttr = 'D';                                                           X03                  001949
 001950               DCLPR.type = '     Date';                                                          03                  001950
 001951               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001951
 001952               If x > 0;                                                                         B04                  001952
 001953                  x = %scan('(':workDeclKeywords:x);                                              04                  001953
 001954                  y = %scan(')':workDeclKeywords:x);                                              04                  001954
 001955                  DCLPR.definition = '('                                                          04                  001955
 001956                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001956
 001957                            + ')';                                                                04                  001957
 001958                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001958
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     50
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001959               EndIf;                                                                            E04                  001959
 001960            ElseIf workDeclAttr = 'T';                                                           X03                  001960
 001961               DCLPR.type = '     Time';                                                          03                  001961
 001962               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001962
 001963               If x > 0;                                                                         B04                  001963
 001964                  x = %scan('(':workDeclKeywords:x);                                              04                  001964
 001965                  y = %scan(')':workDeclKeywords:x);                                              04                  001965
 001966                  DCLPR.definition = '('                                                          04                  001966
 001967                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001967
 001968                            + ')';                                                                04                  001968
 001969                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001969
 001970               EndIf;                                                                            E04                  001970
 001971            ElseIf workDeclAttr = 'Z';                                                           X03                  001971
 001972               DCLPR.type = 'TimeStamp';                                                          03                  001972
 001973            ElseIf workDeclAttr = 'I';                                                           X03                  001973
 001974               DCLPR.type = '      Int';                                                          03                  001974
 001975            ElseIf workDeclAttr = 'S';                                                           X03                  001975
 001976               DCLPR.type = '    Zoned';                                                          03                  001976
 001977            ElseIf workDeclAttr = 'N';                                                           X03                  001977
 001978               DCLPR.type = '      Ind';                                                          03                  001978
 001979            ElseIf workDeclAttr = '*';                                                           X03                  001979
 001980               DCLPR.type = '  Pointer';                                                          03                  001980
 001981            ElseIf workDeclAttr = 'B';                                                           X03                  001981
 001982               DCLPR.type = '   BinDec';                                                          03                  001982
 001983            ElseIf workDeclAttr = 'G';                                                           X03                  001983
 001984               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001984
 001985               If x > 0;                                                                         B04                  001985
 001986                  DCLPR.type = ' VarGraph';                                                       04                  001986
 001987                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001987
 001988               Else;                                                                             X04                  001988
 001989                  DCLPR.type = '    Graph';                                                       04                  001989
 001990               EndIf;                                                                            E04                  001990
 001991            Else;                                                                                X03                  001991
 001992               inDeclaration = *Off;                                                              03                  001992
 001993               convert = *Off;                                                                    03                  001993
 001994               LeaveSr;                                                                           03                  001994
 001995            EndIf;                                                                               E03                  001995
 001996                                                                                                                      001996
 001997            // Attributes.                                                                                            001997
 001998            If workDeclAttr <> '*'                                                               B03                  001998
 001999            and workDeclAttr <> 'N'                                                              B03                  001999
 002000            and workDeclAttr <> 'D'                                                              B03                  002000
 002001            and workDeclAttr <> 'T'                                                              B03                  002001
 002002            and workDeclAttr <> 'Z'                                                              B03                  002002
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     51
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002003            and workDeclAttr <> *Blank                                                           B03                  002003
 002004            and DCLPR.type <> *Blanks;                                                           B03                  002004
 002005               DCLPR.definition = '(';                                                            03                  002005
 002006               If inDatastructure and declFrom <> *Blanks;                                       B04                  002006
 002007                  workLength = %dec(%trim(declLen):7:0)                                           04                  002007
 002008                             - %dec(%trim(declFrom):7:0) + 1;                                     04                  002008
 002009                  If workDeclAttr = 'B';                                                         B05                  002009
 002010                     workLength = workLength * 2;                                                 05                  002010
 002011                  ElseIf workDeclAttr = 'P';                                                     X05                  002011
 002012                     workLength = (workLength * 2) - 1;                                           05                  002012
 002013                  EndIf;                                                                         E05                  002013
 002014                  AdjustArrayLength(workLength);                                                  04                  002014
 002015                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002015
 002016                                   + %char(workLength);                                           04                  002016
 002017               Else;                                                                             X04                  002017
 002018                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002018
 002019                                   + %trim(declLen);                                              04                  002019
 002020               EndIf;                                                                            E04                  002020
 002021                                                                                                                      002021
 002022               If declScale <> *Blanks;                                                          B04                  002022
 002023                  DCLPR.definition = %trimr(DCLPR.definition)                                     04                  002023
 002024                                  + ':' + %trim(declScale);                                       04                  002024
 002025               EndIf;                                                                            E04                  002025
 002026               DCLPR.definition = %trimr(DCLPR.definition) + ')';                                 03                  002026
 002027            EndIf;                                                                               E03                  002027
 002028                                                                                                                      002028
 002029            // From specified?                                                                                        002029
 002030            If inDatastructure;                                                                  B03                  002030
 002031               If declFrom <> *Blanks                                                            B04                  002031
 002032               and %scan('...':declOptions) = 0;                                                 B04                  002032
 002033                  If %subst(declFrom:1:1) = '*';                                                 B05                  002033
 002034                     workDeclKeywords = %trim(declFrom) + ' ';                                    05                  002034
 002035                  Else;                                                                          X05                  002035
 002036                  workDeclKeywords = 'Pos(' + %trim(declFrom) + ') '                              05                  002036
 002037                               + workDeclKeywords;                                                05                  002037
 002038                  EndIf;                                                                         E05                  002038
 002039               Else;                                                                             X04                  002039
 002040                  // Overlay specified using the base datastructure name?                                             002040
 002041                  // This is not permitted in free-form, so convert it to 'POS'.                                      002041
 002042                  x = %scan('OVERLAY(':%xlate(lo:up:workDeclKeywords));                           04                  002042
 002043                  If x > 0;                                                                      B05                  002043
 002044                     i = %scan(':':workDeclKeywords:x);                                           05                  002044
 002045                     If i > 0;                                                                   B06                  002045
 002046                        If %trim(%xlate(lo:up                                                    B07                  002046
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     52
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002047                                :%subst(workDeclKeywords:x+8:i-x-8))) =                          B07                  002047
 002048                           %xlate(lo:up:workDeclName);                                           B07                  002048
 002049                           j = %scan(')':workDeclKeywords:i);                                     07                  002049
 002050                           If j > 0;                                                             B08                  002050
 002051                              If x = 1;                                                          B09                  002051
 002052                                 workDeclKeywords                                                 09                  002052
 002053                                  = 'Pos('                                                        09                  002053
 002054                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002054
 002055                                 + %subst(workDeclKeywords:j);                                    09                  002055
 002056                              Else;                                                              X09                  002056
 002057                                 workDeclKeywords                                                 09                  002057
 002058                                   = %trim(%subst(workDeclKeywords:1:x-1))                        09                  002058
 002059                                   + ' Pos('                                                      09                  002059
 002060                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002060
 002061                                 + %subst(workDeclKeywords:j);                                    09                  002061
 002062                              EndIf;                                                             E09                  002062
 002063                           EndIf;                                                                E08                  002063
 002064                        EndIf;                                                                   E07                  002064
 002065                     EndIf;                                                                      E06                  002065
 002066                  EndIf;                                                                         E05                  002066
 002067               EndIf;                                                                            E04                  002067
 002068               // Require End-DS?                                                                                     002068
 002069               x = %scan('LIKEDS(':%xlate(lo:up:workDeclKeywords));                               03                  002069
 002070               If x = 0;                                                                         B04                  002070
 002071                  x = %scan('LIKEREC(':%xlate(lo:up:workDeclKeywords));                           04                  002071
 002072               EndIf;                                                                            E04                  002072
 002073               If x > 0;                                                                         B04                  002073
 002074                  // Nope.                                                                                            002074
 002075                  endDS = *Off;                                                                   04                  002075
 002076               EndIf;                                                                            E04                  002076
 002077                                                                                                                      002077
 002078               // Datastructure type?                                                                                 002078
 002079               If declPrefix = 'S';       // Program Status                                      B04                  002079
 002080                  workDeclKeywords = 'PSDS ' + workDeclKeywords;                                  04                  002080
 002081                  If savedName = DCLPR.procName;                                                 B05                  002081
 002082                     %subst(savedName:16:1) = *Blank;                                             05                  002082
 002083                  EndIf;                                                                         E05                  002083
 002084                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002084
 002085                                                                                                                      002085
 002086               ElseIf declPrefix = 'U';   // Dataarea                                            X04                  002086
 002087                  // If not already defined as a data area, do it now.                                                002087
 002088                  If %scan('DTAARA':%xlate(lo:up:workDeclKeywords)) = 0;                         B05                  002088
 002089                     If declName = *Blanks;                                                      B06                  002089
 002090                        workDeclKeywords = 'DTAARA(*AUTO) '                                       06                  002090
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     53
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002091                                                     + workDeclKeywords;                          06                  002091
 002092                     Else;                                                                       X06                  002092
 002093                        workDeclKeywords = 'DTAARA ' + workDeclKeywords;                          06                  002093
 002094                     EndIf;                                                                      E06                  002094
 002095                  EndIf;                                                                         E05                  002095
 002096                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002096
 002097               EndIf;                                                                            E04                  002097
 002098            EndIf;                                                                               E03                  002098
 002099                                                                                                                      002099
 002100            // Keywords.                                                                                              002100
 002101            If workDeclKeywords <> *Blanks;                                                      B03                  002101
 002102               // ExtProc name has extended to a second line.                                                         002102
 002103               If inExtProc;                                                                     B04                  002103
 002104                  // Continuation of name must start at left margin.                                                  002104
 002105                  DCLPR = workDeclKeywords;                                                       04                  002105
 002106                  workDeclKeywords = *Blanks;                                                     04                  002106
 002107                  inExtProc = *Off;                                                               04                  002107
 002108               EndIf;                                                                            E04                  002108
 002109                                                                                                                      002109
 002110               // Expand EXTNAME?                                                                                     002110
 002111               x = %scan('EXTNAME(':%xlate(lo:up:workDeclKeywords));                              03                  002111
 002112               If x > 0;                                                                         B04                  002112
 002113                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002113
 002114                  If i > 0;                                                                      B05                  002114
 002115                     If %scan('''':%subst(workDeclKeywords:x+8:i-x-8)) = 0;                      B06                  002115
 002116                        workDeclKeywords = %subst(workDeclKeywords:1:x+7)                         06                  002116
 002117                           + ''''                                                                 06                  002117
 002118                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+8:i-x-8)))                      06                  002118
 002119                           + ''''                                                                 06                  002119
 002120                           + %subst(workDeclKeywords:i);                                          06                  002120
 002121                     EndIf;                                                                      E06                  002121
 002122                  EndIf;                                                                         E05                  002122
 002123               EndIf;                                                                            E04                  002123
 002124                                                                                                                      002124
 002125               // Expand DTAARA?                                                                                      002125
 002126               x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                               03                  002126
 002127               If x > 0;                                                                         B04                  002127
 002128                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002128
 002129                  If i > 0;                                                                      B05                  002129
 002130                     If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                      B06                  002130
 002131                        workDeclKeywords = %subst(workDeclKeywords:1:x+6)                         06                  002131
 002132                           + ''''                                                                 06                  002132
 002133                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      06                  002133
 002134                           + ''''                                                                 06                  002134
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     54
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002135                           + %subst(workDeclKeywords:i);                                          06                  002135
 002136                     EndIf;                                                                      E06                  002136
 002137                  EndIf;                                                                         E05                  002137
 002138               EndIf;                                                                            E04                  002138
 002139                                                                                                                      002139
 002140               // EXTPROC?                                                                                            002140
 002141               x = %scan('EXTPROC(':%xlate(lo:up:workDeclKeywords));                              03                  002141
 002142               If x > 0;                                                                         B04                  002142
 002143                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002143
 002144                  If i = 0;                                                                      B05                  002144
 002145                     // Name extends onto next line.                                                                  002145
 002146                     inExtProc = *On;                                                             05                  002146
 002147                  EndIf;                                                                         E05                  002147
 002148               EndIf;                                                                            E04                  002148
 002149            EndIf;                                                                               E03                  002149
 002150                                                                                                                      002150
 002151            // Terminate the line?                                                                                    002151
 002152            If not inSpan;                                                                       B03                  002152
 002153               If workDeclKeywords = *Blanks and DCLPR.type = *Blanks;                           B04                  002153
 002154                  DCLPR.procName = %trimr(DCLPR.procName) + ';';                                  04                  002154
 002155               ElseIf workDeclKeywords = *Blanks;                                                X04                  002155
 002156                  DCLPR.definition = %trimr(DCLPR.definition) + ';';                              04                  002156
 002157               Else;                                                                             X04                  002157
 002158                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  002158
 002159               EndIf;                                                                            E04                  002159
 002160               inDeclaration = *Off;                                                              03                  002160
 002161               savedName = *Blanks;                                                               03                  002161
 002162            Else;                                                                                X03                  002162
 002163               inSpan = *Off;                                                                     03                  002163
 002164            EndIf;                                                                               E03                  002164
 002165                                                                                                                      002165
 002166            // Have we encroached on the comments?                                                                    002166
 002167            x = %len(%trimr(DCLPR.definition)) + %len(workDeclKeywords);                          02                  002167
 002168            If x >= 37;                                                                          B03                  002168
 002169               x = x - %len(%trimr(DCLPR.definition));                                            03                  002169
 002170               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  002170
 002171               indentOffset = 37;                                                                 03                  002171
 002172            EndIf;                                                                               E03                  002172
 002173                                                                                                                      002173
 002174            If DCLPR.definition = *Blanks and DCLPR.type = *Blanks;                              B03                  002174
 002175               DCLPR.definition = %trim(workDeclKeywords);                                        03                  002175
 002176            Else;                                                                                X03                  002176
 002177               DCLPR.definition = %trimr(DCLPR.definition) + ' '                                  03                  002177
 002178                               + %trim(workDeclKeywords);                                         03                  002178
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     55
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002179            EndIf;                                                                               E03                  002179
 002180                                                                                                                      002180
 002181            // Comment.                                                                                               002181
 002182            If comment <> *Blanks;                                                               B03                  002182
 002183               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  002183
 002184                  DCLPR.comment = '   ' + comment;                                                04                  002184
 002185               Else;                                                                             X04                  002185
 002186                  DCLPR.comment = '// ' + comment;                                                04                  002186
 002187               EndIf;                                                                            E04                  002187
 002188            EndIf;                                                                               E03                  002188
 002189                                                                                                                      002189
 002190            // Converted line...                                                                                      002190
 002191            sourceLine = DCLPR;                                                                   02                  002191
 002192            If not inSpan and savedName <> *Blanks;                                              B03                  002192
 002193               savedName = '**';                                                                  03                  002193
 002194            EndIf;                                                                               E03                  002194
 002195                                                                                                                      002195
 002196            //-------------------------------------------------------------------------                               002196
 002197            // Unsupported.                                                                                           002197
 002198            //-------------------------------------------------------------------------                               002198
 002199         Else;                                                                                   X02                  002199
 002200            inDeclaration = *Off;                                                                 02                  002200
 002201            convert = *Off;                                                                       02                  002201
 002202            LeaveSr;                                                                              02                  002202
 002203         EndIf;                                                                                  E02                  002203
 002204                                                                                                                      002204
 002205         //-------------------------------------------------------------------------                                  002205
 002206         // Second+ line of declaration.                                                                              002206
 002207         //-------------------------------------------------------------------------                                  002207
 002208      Else;                                                                                      X01                  002208
 002209         Clear DCLS;                                                                              01                  002209
 002210         DCLS.definition = %trim(workDeclKeywords);                                               01                  002210
 002211         If not inSpan;                                                                          B02                  002211
 002212            DCLS.definition = %trim(DCLS.definition) + ';';                                       02                  002212
 002213         EndIf;                                                                                  E02                  002213
 002214         sourceLine = DCLS;                                                                       01                  002214
 002215         inSpan = *Off;                                                                           01                  002215
 002216      EndIf;                                                                                     E01                  002216
 002217                                                                                                                      002217
 002218      convert = *On;                                                                                                  002218
 002219                                                                                                                      002219
 002220   EndSr;                                                                                                             002220
 002221   //-------------------------------------------------------------------------------------------                      002221
 002222                                                                                                                      002222
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     56
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002224   //-------------------------------------------------------------------------------------------                      002224
 002225   // Convert file spec to free-format.                                                                               002225
 002226   //-------------------------------------------------------------------------------------------                      002226
 002227   BegSr subUserConvertF_Spec;                                                                                        002227
 002228                                                                                                                      002228
 002229      // Keep blank lines.                                                                                            002229
 002230      If codeLine = *Blanks;                                                                     B01                  002230
 002231         sourceLine = *Blanks;                                                                    01                  002231
 002232         convert = *On;                                                                           01                  002232
 002233         LeaveSr;                                                                                 01                  002233
 002234      EndIf;                                                                                     E01                  002234
 002235                                                                                                                      002235
 002236      sourceLine = fullLine;                                                                                          002236
 002237                                                                                                                      002237
 002238      workFileUsage  = %xlate(lo:up:fileUsage);                                                                       002238
 002239      workFileDesig  = %xlate(lo:up:fileDesig);                                                                       002239
 002240      workFileAdd    = %xlate(lo:up:fileAdd);                                                                         002240
 002241      workFileDevice = %xlate(lo:up:fileDevice);                                                                      002241
 002242      workFileKeyed  = %xlate(lo:up:fileKeyed);                                                                       002242
 002243                                                                                                                      002243
 002244      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002244
 002245                                                                                                                      002245
 002246      If not inDeclaration;                                                                      B01                  002246
 002247                                                                                                                      002247
 002248         // Validate whether this can be converted.                                                                   002248
 002249         If workFileUsage = 'I'                                                                  B02                  002249
 002250         and (workFileDesig = 'P'                                                                B02                  002250
 002251         or workFileDesig = 'S'                                                                  B02                  002251
 002252         or workFileUsage = 'T')                                                                 B02                  002252
 002253                                                                                                 B02                  002253
 002254         or workFileUsage = 'O'                                                                  B02                  002254
 002255         and workFileAdd = 'A'                                                                   B02                  002255
 002256                                                                                                 B02                  002256
 002257         or workFileUsage = 'U'                                                                  B02                  002257
 002258         and (workFileDesig = 'P'                                                                B02                  002258
 002259         or workFileDesig = 'S')                                                                 B02                  002259
 002260                                                                                                 B02                  002260
 002261         or workFileUsage = 'C'                                                                  B02                  002261
 002262         and workFileDesig = 'T';                                                                B02                  002262
 002263                                                                                                                      002263
 002264            // Not supported in free-form.                                                                            002264
 002265            inDeclaration = *Off;                                                                 02                  002265
 002266            convert = *Off;                                                                       02                  002266
 002267            nonConvRsn = 'File usage not supported in free-form';                                 02                  002267
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     57
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002268            LeaveSr;                                                                              02                  002268
 002269         EndIf;                                                                                  E02                  002269
 002270                                                                                                                      002270
 002271         savedName = %trim(fileName);                                                             01                  002271
 002272                                                                                                                      002272
 002273         If %xlate(lo:up:fileExternal) = 'E';       // Externally-described file.                B02                  002273
 002274            inDeclaration = *On;                                                                  02                  002274
 002275                                                                                                                      002275
 002276            Clear DCLF;                                                                           02                  002276
 002277            DCLF.decl = 'Dcl-F ';                                                                 02                  002277
 002278            %subst(DCLF:7) = %xlate(lo:up:savedName);                                             02                  002278
 002279                                                                                                                      002279
 002280            // Set device type.                                                                                       002280
 002281            If workFileDevice <> 'DISK';                                                         B03                  002281
 002282               DCLF.device = workFileDevice;                                                      03                  002282
 002283            EndIf;                                                                               E03                  002283
 002284                                                                                                                      002284
 002285            // Set usage.                                                                                             002285
 002286            If workFileUsage = 'I';                                                              B03                  002286
 002287               If workFileAdd = ' ';                                                             B04                  002287
 002288                  If workFileDevice <> 'DISK'                                                    B05                  002288
 002289                  and workFileDevice <> 'SEQ'                                                    B05                  002289
 002290                  and workFileDevice <> 'SPECIAL';                                               B05                  002290
 002291                     DCLF.definition = '*INPUT';                                                  05                  002291
 002292                  EndIf;                                                                         E05                  002292
 002293               Else;                                                                             X04                  002293
 002294                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002294
 002295               EndIf;                                                                            E04                  002295
 002296            ElseIf workFileUsage = 'U';                                                          X03                  002296
 002297               If workFileAdd = ' ';                                                             B04                  002297
 002298                  DCLF.definition = '*UPDATE:*DELETE';                                            04                  002298
 002299               Else;                                                                             X04                  002299
 002300                  DCLF.definition = '*UPDATE:*DELETE:*OUTPUT';                                    04                  002300
 002301               EndIf;                                                                            E04                  002301
 002302            ElseIf workFileUsage = 'O';                                                          X03                  002302
 002303               If workFileDevice <> 'PRINTER';                                                   B04                  002303
 002304                  DCLF.definition = '*OUTPUT';                                                    04                  002304
 002305               EndIf;                                                                            E04                  002305
 002306            ElseIf workFileUsage = 'C';                                                          X03                  002306
 002307               If workFileDevice <> 'WORKSTN';                                                   B04                  002307
 002308                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002308
 002309               EndIf;                                                                            E04                  002309
 002310            EndIf;                                                                               E03                  002310
 002311                                                                                                                      002311
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     58
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002312            // Pad out usage.                                                                                         002312
 002313            If DCLF.definition <> *Blanks;                                                       B03                  002313
 002314               DCLF.definition = 'Usage(' + %trim(DCLF.definition) + ')';                         03                  002314
 002315            EndIf;                                                                               E03                  002315
 002316                                                                                                                      002316
 002317            // Keyed file?                                                                                            002317
 002318            If workFileKeyed = 'K';                                                              B03                  002318
 002319               DCLF.definition = %trim(%trim(DCLF.definition)                                     03                  002319
 002320                                       + ' ' + 'Keyed');                                          03                  002320
 002321            EndIf;                                                                               E03                  002321
 002322                                                                                                                      002322
 002323            If comment <> *Blanks;                                                               B03                  002323
 002324               If %subst(%trim(comment):1:2) = '//';                                             B04                  002324
 002325                  DCLF.comment = '   ' + comment;                                                 04                  002325
 002326               Else;                                                                             X04                  002326
 002327                  DCLF.comment = '// ' + comment;                                                 04                  002327
 002328               EndIf;                                                                            E04                  002328
 002329            EndIf;                                                                               E03                  002329
 002330                                                                                                                      002330
 002331            // Keywords.                                                                                              002331
 002332            If fileKeyWords <> *Blanks;                                                          B03                  002332
 002333               // Do we have room to insert the keywords here?                                                        002333
 002334               checkLength = %len(%trim(%trim(DCLF.definition)                                    03                  002334
 002335                                       + ' ' + %trim(fileKeyWords))) + 1;                         03                  002335
 002336                                                                                                                      002336
 002337               If comment <> *Blanks;                                                            B04                  002337
 002338                  checkLength += 3;                                                               04                  002338
 002339               EndIf;                                                                            E04                  002339
 002340                                                                                                                      002340
 002341               If checkLength > %len(DCLF.definition);                                           B04                  002341
 002342                  // Not enoungh room for the keywords, so output the current line.                                   002342
 002343                  savedSRCDTA = SRCDTA;                                                           04                  002343
 002344                  lineType = *Blank;                                                              04                  002344
 002345                  directive = *Blanks;                                                            04                  002345
 002346                  codeLine = DCLF;                                                                04                  002346
 002347                  Exsr subUserWriteLine;                                                          04                  002347
 002348                  SRCDTA = savedSRCDTA;                                                           04                  002348
 002349                  // ...and move the keywords to their own line.                                                      002349
 002350                  Clear DCLF;                                                                     04                  002350
 002351                  DCLF.definition = fileKeywords;                                                 04                  002351
 002352                  savedComment = *Blanks;                                                         04                  002352
 002353               Else;                                                                             X04                  002353
 002354                  DCLF.definition = %trim(%trim(DCLF.definition)                                  04                  002354
 002355                                          + ' ' + %trim(fileKeyWords));                           04                  002355
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     59
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002356               EndIf;                                                                            E04                  002356
 002357            EndIf;                                                                               E03                  002357
 002358                                                                                                                      002358
 002359            If not inSpan;                                                                       B03                  002359
 002360               DCLF.definition = %trimr(DCLF.definition) + ';';                                   03                  002360
 002361               inDeclaration = *Off;                                                              03                  002361
 002362            Else;                                                                                X03                  002362
 002363               inSpan = *Off;                                                                     03                  002363
 002364            EndIf;                                                                               E03                  002364
 002365                                                                                                                      002365
 002366            // Converted line...                                                                                      002366
 002367            sourceLine = DCLF;                                                                    02                  002367
 002368                                                                                                                      002368
 002369         Else;                                                                                   X02                  002369
 002370            inDeclaration = *Off;                                                                 02                  002370
 002371            convert = *Off;                                                                       02                  002371
 002372            nonConvRsn = 'File not externally-described';                                         02                  002372
 002373            LeaveSr;                                                                              02                  002373
 002374         EndIf;                                                                                  E02                  002374
 002375                                                                                                                      002375
 002376      Else;                   // Second+ line of declaration                                     X01                  002376
 002377         Clear DCLF;                                                                              01                  002377
 002378         DCLF.definition = %trim(fileKeyWords);                                                   01                  002378
 002379         If not inSpan;                                                                          B02                  002379
 002380            DCLF.definition = %trim(DCLF.definition) + ';';                                       02                  002380
 002381         EndIf;                                                                                  E02                  002381
 002382         sourceLine = DCLF;                                                                       01                  002382
 002383         inSpan = *Off;                                                                           01                  002383
 002384      EndIf;                                                                                     E01                  002384
 002385                                                                                                                      002385
 002386      convert = *On;                                                                                                  002386
 002387                                                                                                                      002387
 002388   EndSr;                                                                                                             002388
 002389   //-------------------------------------------------------------------------------------------                      002389
 002390                                                                                                                      002390
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     60
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002392   //-------------------------------------------------------------------------------------------                      002392
 002393   // Convert Header spec to free-format.                                                                             002393
 002394   //-------------------------------------------------------------------------------------------                      002394
 002395   BegSr subUserConvertH_Spec;                                                                                        002395
 002396                                                                                                                      002396
 002397      // Keep blank lines.                                                                                            002397
 002398      If codeLine = *Blanks;                                                                     B01                  002398
 002399         sourceLine = *Blanks;                                                                    01                  002399
 002400         convert = *On;                                                                           01                  002400
 002401         LeaveSr;                                                                                 01                  002401
 002402      EndIf;                                                                                     E01                  002402
 002403                                                                                                                      002403
 002404      sourceLine = codeLine;                                                                                          002404
 002405                                                                                                                      002405
 002406      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002406
 002407                                                                                                                      002407
 002408      If not inDeclaration;                                                                      B01                  002408
 002409         inDeclaration = *On;                                                                     01                  002409
 002410                                                                                                                      002410
 002411         Clear DCLH;                                                                              01                  002411
 002412         DCLH.decl = 'Ctl-Opt ';                                                                  01                  002412
 002413         DCLH.options = %trim(declOptions);                                                       01                  002413
 002414                                                                                                                      002414
 002415         If comment <> *Blanks;                                                                  B02                  002415
 002416            If %subst(%trim(comment):1:2) = '//';                                                B03                  002416
 002417               DCLH.comment = '   ' + comment;                                                    03                  002417
 002418            Else;                                                                                X03                  002418
 002419               DCLH.comment = '// ' + comment;                                                    03                  002419
 002420            EndIf;                                                                               E03                  002420
 002421         EndIf;                                                                                  E02                  002421
 002422                                                                                                                      002422
 002423         If not inSpan;                                                                          B02                  002423
 002424            DCLH.options = %trimr(DCLH.options) + ';';                                            02                  002424
 002425            inDeclaration = *Off;                                                                 02                  002425
 002426         Else;                                                                                   X02                  002426
 002427            inSpan = *Off;                                                                        02                  002427
 002428         EndIf;                                                                                  E02                  002428
 002429                                                                                                                      002429
 002430         // Converted line...                                                                                         002430
 002431         sourceLine = DCLH;                                                                       01                  002431
 002432                                                                                                                      002432
 002433      Else;                   // Second+ line of declaration                                     X01                  002433
 002434         Clear DCLH;                                                                              01                  002434
 002435         DCLH.options = %trim(declOptions);                                                       01                  002435
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     61
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002436         If not inSpan;                                                                          B02                  002436
 002437            DCLH.options = %trim(DCLH.options) + ';';                                             02                  002437
 002438         EndIf;                                                                                  E02                  002438
 002439         sourceLine = DCLH;                                                                       01                  002439
 002440         inSpan = *Off;                                                                           01                  002440
 002441      EndIf;                                                                                     E01                  002441
 002442                                                                                                                      002442
 002443      convert = *On;                                                                                                  002443
 002444                                                                                                                      002444
 002445   EndSr;                                                                                                             002445
 002446   //-------------------------------------------------------------------------------------------                      002446
 002447                                                                                                                      002447
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     62
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002449   //-------------------------------------------------------------------------------------------                      002449
 002450   // Convert procedure declaration to free-format?                                                                   002450
 002451   //-------------------------------------------------------------------------------------------                      002451
 002452   BegSr subUserConvertP_Spec;                                                                                        002452
 002453                                                                                                                      002453
 002454      // Keep blank lines.                                                                                            002454
 002455      If codeLine = *Blanks;                                                                     B01                  002455
 002456         sourceLine = *Blanks;                                                                    01                  002456
 002457         convert = *On;                                                                           01                  002457
 002458         LeaveSr;                                                                                 01                  002458
 002459      EndIf;                                                                                     E01                  002459
 002460                                                                                                                      002460
 002461      sourceLine = fullLine;                                                                                          002461
 002462                                                                                                                      002462
 002463      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002463
 002464                                                                                                                      002464
 002465      If not inDeclaration;   // First line of procedure start/end.                              B01                  002465
 002466         If not inDeclaration;                                                                   B02                  002466
 002467            //Exsr subUserGetDeclarationType;                                                                         002467
 002468            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  002468
 002469         EndIf;                                                                                  E02                  002469
 002470                                                                                                                      002470
 002471         If workDeclType = 'B'       // Begin.                                                   B02                  002471
 002472         or workDeclType = 'E'       // End.                                                     B02                  002472
 002473         or declName <> *Blanks;                                                                 B02                  002473
 002474            inDeclaration = *On;                                                                  02                  002474
 002475                                                                                                                      002475
 002476            Clear DCLP;                                                                           02                  002476
 002477            //            If savedName <> *Blanks;                                                                    002477
 002478            If workDeclType = 'B';                                                               B03                  002478
 002479               DCLP.decl = 'Dcl-Proc ';                                                           03                  002479
 002480            Else;                                                                                X03                  002480
 002481               DCLP.decl = 'End-Proc ';                                                           03                  002481
 002482            EndIf;                                                                               E03                  002482
 002483            DCLP.definition = savedName;                                                          02                  002483
 002484            //            EndIf;                                                                                      002484
 002485                                                                                                                      002485
 002486            If procKeyWords <> *Blanks;                                                          B03                  002486
 002487               DCLP.definition = %trimr(DCLP.definition)                                          03                  002487
 002488                               + ' ' + %trim(procKeyWords);                                       03                  002488
 002489            EndIf;                                                                               E03                  002489
 002490                                                                                                                      002490
 002491            If comment <> *Blanks;                                                               B03                  002491
 002492               If %subst(%trim(comment):1:2) = '//';                                             B04                  002492
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     63
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002493                  DCLP.comment = '   ' + comment;                                                 04                  002493
 002494               Else;                                                                             X04                  002494
 002495                  DCLP.comment = '// ' + comment;                                                 04                  002495
 002496               EndIf;                                                                            E04                  002496
 002497            EndIf;                                                                               E03                  002497
 002498                                                                                                                      002498
 002499            If not inSpan;                                                                       B03                  002499
 002500               DCLP.definition = %trimr(DCLP.definition) + ';';                                   03                  002500
 002501               inDeclaration = *Off;                                                              03                  002501
 002502            Else;                                                                                X03                  002502
 002503               inSpan = *Off;                                                                     03                  002503
 002504            EndIf;                                                                               E03                  002504
 002505                                                                                                                      002505
 002506            // Converted line...                                                                                      002506
 002507            sourceLine = DCLP;                                                                    02                  002507
 002508            savedName = *Blanks;                                                                  02                  002508
 002509                                                                                                                      002509
 002510         Else;                                                                                   X02                  002510
 002511            inDeclaration = *Off;                                                                 02                  002511
 002512            convert = *Off;                                                                       02                  002512
 002513            LeaveSr;                                                                              02                  002513
 002514         EndIf;                                                                                  E02                  002514
 002515                                                                                                                      002515
 002516      Else;                   // Second+ line of procedure start/end.                            X01                  002516
 002517         Clear DCLP;                                                                              01                  002517
 002518         DCLP.definition = %trim(declKeyWords);                                                   01                  002518
 002519         If not inSpan;                                                                          B02                  002519
 002520            DCLP.definition = %trimr(DCLP.definition) + ';';                                      02                  002520
 002521         EndIf;                                                                                  E02                  002521
 002522         sourceLine = DCLP;                                                                       01                  002522
 002523         inSpan = *Off;                                                                           01                  002523
 002524      EndIf;                                                                                     E01                  002524
 002525                                                                                                                      002525
 002526      convert = *On;                                                                                                  002526
 002527                                                                                                                      002527
 002528   EndSr;                                                                                                             002528
 002529   //-------------------------------------------------------------------------------------------                      002529
 002530                                                                                                                      002530
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     64
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002532   //-------------------------------------------------------------------------------------------                      002532
 002533   // Set Resulting Indicators.                                                                                       002533
 002534   //-------------------------------------------------------------------------------------------                      002534
 002535   BegSr subUserSetIndicators;                                                                                        002535
 002536                                                                                                                      002536
 002537      //-----------------------------------------------------------------------                                       002537
 002538      // Scan found.                                                                                                  002538
 002539      If foundCheck;                                                                             B01                  002539
 002540         Clear nonPrefix;                                                                         01                  002540
 002541                                                                                                                      002541
 002542         codeLine = '*IN' + foundInd + ' = %found();';                                            01                  002542
 002543         Exsr subUserReformatLine;                                                                01                  002543
 002544                                                                                                                      002544
 002545         foundCheck = *Off;                                                                       01                  002545
 002546      EndIf;                                                                                     E01                  002546
 002547                                                                                                                      002547
 002548      //-----------------------------------------------------------------------                                       002548
 002549      // Error indicator check.                                                                                       002549
 002550      If ERRCheck;                                                                               B01                  002550
 002551         Clear nonPrefix;                                                                         01                  002551
 002552                                                                                                                      002552
 002553         codeLine = '*IN' + ERRInd + ' = %error();';                                              01                  002553
 002554         Exsr subUserReformatLine;                                                                01                  002554
 002555                                                                                                                      002555
 002556         ERRCheck = *Off;                                                                         01                  002556
 002557      EndIf;                                                                                     E01                  002557
 002558                                                                                                                      002558
 002559      //-----------------------------------------------------------------------                                       002559
 002560      // Record not found check.                                                                                      002560
 002561      If NRFCheck;                                                                               B01                  002561
 002562         Clear nonPrefix;                                                                         01                  002562
 002563                                                                                                                      002563
 002564         codeLine = '*IN' + NRFInd + ' = not %found();';                                          01                  002564
 002565         Exsr subUserReformatLine;                                                                01                  002565
 002566                                                                                                                      002566
 002567         NRFCheck = *Off;                                                                         01                  002567
 002568      EndIf;                                                                                     E01                  002568
 002569                                                                                                                      002569
 002570      //-----------------------------------------------------------------------                                       002570
 002571      // End of File check.                                                                                           002571
 002572      If EOFCheck;                                                                               B01                  002572
 002573         Clear nonPrefix;                                                                         01                  002573
 002574                                                                                                                      002574
 002575         codeLine = '*IN' + EOFInd + ' = %eof();';                                                01                  002575
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     65
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002576         Exsr subUserReformatLine;                                                                01                  002576
 002577                                                                                                                      002577
 002578         EOFCheck = *Off;                                                                         01                  002578
 002579      EndIf;                                                                                     E01                  002579
 002580                                                                                                                      002580
 002581      //-----------------------------------------------------------------------                                       002581
 002582      // Matching Key check.                                                                                          002582
 002583      If equalCheck;                                                                             B01                  002583
 002584         Clear nonPrefix;                                                                         01                  002584
 002585                                                                                                                      002585
 002586         codeLine = '*IN' + equalInd + ' = %equal();';                                            01                  002586
 002587         Exsr subUserReformatLine;                                                                01                  002587
 002588                                                                                                                      002588
 002589         equalCheck = *Off;                                                                       01                  002589
 002590      EndIf;                                                                                     E01                  002590
 002591                                                                                                                      002591
 002592      //-----------------------------------------------------------------------                                       002592
 002593      // Perform SETOFF / SETON Expansion.                                                                            002593
 002594      If setOff;                                                                                 B01                  002594
 002595         Clear nonPrefix;                                                                         01                  002595
 002596         If setOffInd1 <> *Blanks;                                                               B02                  002596
 002597            codeLine = '*IN' + setOffInd1 + ' = *Off;';                                           02                  002597
 002598            Exsr subUserReformatLine;                                                             02                  002598
 002599         EndIf;                                                                                  E02                  002599
 002600         If setOffInd2 <> *Blanks;                                                               B02                  002600
 002601            codeLine = '*IN' + setOffInd2 + ' = *Off;';                                           02                  002601
 002602            Exsr subUserReformatLine;                                                             02                  002602
 002603         EndIf;                                                                                  E02                  002603
 002604         If setOffInd3 <> *Blanks;                                                               B02                  002604
 002605            codeLine = '*IN' + setOffInd3 + ' = *Off;';                                           02                  002605
 002606            Exsr subUserReformatLine;                                                             02                  002606
 002607         EndIf;                                                                                  E02                  002607
 002608         setOff = *Off;                                                                           01                  002608
 002609      EndIf;                                                                                     E01                  002609
 002610      If setOn;                                                                                  B01                  002610
 002611         Clear nonPrefix;                                                                         01                  002611
 002612         If setOnInd1 <> *Blanks;                                                                B02                  002612
 002613            codeLine = '*IN' + setOnInd1 + ' = *On;';                                             02                  002613
 002614            Exsr subUserReformatLine;                                                             02                  002614
 002615         EndIf;                                                                                  E02                  002615
 002616         If setOnInd2 <> *Blanks;                                                                B02                  002616
 002617            codeLine = '*IN' + setOnInd2 + ' = *On;';                                             02                  002617
 002618            Exsr subUserReformatLine;                                                             02                  002618
 002619         EndIf;                                                                                  E02                  002619
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     66
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002620         If setOnInd3 <> *Blanks;                                                                B02                  002620
 002621            codeLine = '*IN' + setOnInd3 + ' = *On;';                                             02                  002621
 002622            Exsr subUserReformatLine;                                                             02                  002622
 002623         EndIf;                                                                                  E02                  002623
 002624         setOn = *Off;                                                                            01                  002624
 002625      EndIf;                                                                                     E01                  002625
 002626                                                                                                                      002626
 002627      //-----------------------------------------------------------------------                                       002627
 002628      // Resulting indicators...                                                                                      002628
 002629                                                                                                                      002629
 002630      // Turn off all specified indicators first.                                                                     002630
 002631      If HICheck;                                                                                B01                  002631
 002632         Clear nonPrefix;                                                                         01                  002632
 002633         codeLine = '*IN' + HIInd + ' = *Off;';                                                   01                  002633
 002634         Exsr subUserReformatLine;                                                                01                  002634
 002635      EndIf;                                                                                     E01                  002635
 002636      If LWCheck;                                                                                B01                  002636
 002637         Clear nonPrefix;                                                                         01                  002637
 002638         codeLine = '*IN' + LWInd + ' = *Off;';                                                   01                  002638
 002639         Exsr subUserReformatLine;                                                                01                  002639
 002640      EndIf;                                                                                     E01                  002640
 002641      If EQCheck;                                                                                B01                  002641
 002642         Clear nonPrefix;                                                                         01                  002642
 002643         codeLine = '*IN' + EQInd + ' = *Off;';                                                   01                  002643
 002644         Exsr subUserReformatLine;                                                                01                  002644
 002645      EndIf;                                                                                     E01                  002645
 002646                                                                                                                      002646
 002647      // And now turn on those specified accordingly.                                                                 002647
 002648                                                                                                                      002648
 002649      // HI check.                                                                                                    002649
 002650      If HICheck;                                                                                B01                  002650
 002651         Clear nonPrefix;                                                                         01                  002651
 002652                                                                                                                      002652
 002653         codeLine = 'If ' + %trim(HIFactor1) + ' > '                                              01                  002653
 002654                  + %trim(HIFactor2) + ';';                                                       01                  002654
 002655         Exsr subUserReformatLine;                                                                01                  002655
 002656         codeLine = '*IN' + HIInd + ' = *On;';                                                    01                  002656
 002657         Exsr subUserReformatLine;                                                                01                  002657
 002658         codeLine = 'EndIf;';                                                                     01                  002658
 002659         Exsr subUserReformatLine;                                                                01                  002659
 002660                                                                                                                      002660
 002661         HICheck = *Off;                                                                          01                  002661
 002662      EndIf;                                                                                     E01                  002662
 002663                                                                                                                      002663
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     67
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002664      // LO check.                                                                                                    002664
 002665      If LWCheck;                                                                                B01                  002665
 002666         Clear nonPrefix;                                                                         01                  002666
 002667                                                                                                                      002667
 002668         codeLine = 'If ' + %trim(LWFactor1) + ' < '                                              01                  002668
 002669                  + %trim(LWFactor2) + ';';                                                       01                  002669
 002670         Exsr subUserReformatLine;                                                                01                  002670
 002671         codeLine = '*IN' + LWInd + ' = *On;';                                                    01                  002671
 002672         Exsr subUserReformatLine;                                                                01                  002672
 002673         codeLine = 'EndIf;';                                                                     01                  002673
 002674         Exsr subUserReformatLine;                                                                01                  002674
 002675                                                                                                                      002675
 002676         LWCheck = *Off;                                                                          01                  002676
 002677      EndIf;                                                                                     E01                  002677
 002678                                                                                                                      002678
 002679      // EQ check.                                                                                                    002679
 002680      If EQCheck;                                                                                B01                  002680
 002681         Clear nonPrefix;                                                                         01                  002681
 002682                                                                                                                      002682
 002683         codeLine = 'If ' + %trim(EQFactor1) + ' = '                                              01                  002683
 002684                  + %trim(EQFactor2) + ';';                                                       01                  002684
 002685         Exsr subUserReformatLine;                                                                01                  002685
 002686         codeLine = '*IN' + EQInd + ' = *On;';                                                    01                  002686
 002687         Exsr subUserReformatLine;                                                                01                  002687
 002688         codeLine = 'EndIf;';                                                                     01                  002688
 002689         Exsr subUserReformatLine;                                                                01                  002689
 002690                                                                                                                      002690
 002691         EQCheck = *Off;                                                                          01                  002691
 002692      EndIf;                                                                                     E01                  002692
 002693                                                                                                                      002693
 002694   EndSr;                                                                                                             002694
 002695   //-------------------------------------------------------------------------------------------                      002695
 002696                                                                                                                      002696
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     68
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002698   //-------------------------------------------------------------------------------------------                      002698
 002699   // Convert ACQ.                                                                                                    002699
 002700   //-------------------------------------------------------------------------------------------                      002700
 002701   BegSr subUserCvt_ACQ;                                                                                              002701
 002702                                                                                                                      002702
 002703      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             002703
 002704                 + ' ' + %trim(factor2) + ';';                                                                        002704
 002705                                                                                                                      002705
 002706      // Set resulting indicators?                                                                                    002706
 002707      If lw <> *Blanks;                                                                          B01                  002707
 002708         ERRCheck = *On;                                                                          01                  002708
 002709         ERRInd = lw;                                                                             01                  002709
 002710      EndIf;                                                                                     E01                  002710
 002711                                                                                                                      002711
 002712      convert = *On;                                                                                                  002712
 002713                                                                                                                      002713
 002714   EndSr;                                                                                                             002714
 002715   //-------------------------------------------------------------------------------------------                      002715
 002716                                                                                                                      002716
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     69
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002718   //-------------------------------------------------------------------------------------------                      002718
 002719   // Convert ADD.                                                                                                    002719
 002720   //-------------------------------------------------------------------------------------------                      002720
 002721   BegSr subUserCvt_ADD;                                                                                              002721
 002722                                                                                                                      002722
 002723      // Half-adjust?                                                                                                 002723
 002724      x = %scan('H':operator:4);                                                                                      002724
 002725      If x > 0;                                                                                  B01                  002725
 002726         sourceLine = 'Eval(H)';                                                                  01                  002726
 002727      Else;                                                                                      X01                  002727
 002728         sourceLine = *Blanks;                                                                    01                  002728
 002729      EndIf;                                                                                     E01                  002729
 002730                                                                                                                      002730
 002731      If factor1 = *Blanks;                                                                      B01                  002731
 002732         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002732
 002733                    + ' = ' + %trim(result)                                                       01                  002733
 002734                    + ' + ' + %trim(factor2) +';';                                                01                  002734
 002735      Else;                                                                                      X01                  002735
 002736         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002736
 002737                    + ' = ' + %trim(factor1)                                                      01                  002737
 002738                    + ' + ' + %trim(factor2) + ';';                                               01                  002738
 002739      EndIf;                                                                                     E01                  002739
 002740                                                                                                                      002740
 002741      sourceLine = %trim(sourceLine);                                                                                 002741
 002742                                                                                                                      002742
 002743      convert = *On;                                                                                                  002743
 002744                                                                                                                      002744
 002745   EndSr;                                                                                                             002745
 002746   //-------------------------------------------------------------------------------------------                      002746
 002747                                                                                                                      002747
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     70
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002749   //-------------------------------------------------------------------------------------------                      002749
 002750   // Convert ADDDUR.                                                                                                 002750
 002751   //-------------------------------------------------------------------------------------------                      002751
 002752   BegSr subUserCvt_ADDDUR;                                                                                           002752
 002753                                                                                                                      002753
 002754      // Split out duration and code.                                                                                 002754
 002755      x = %scan(':':factor2);                                                                                         002755
 002756      If x = 0;                                                                                  B01                  002756
 002757         nonConvRsn =  'No duration code specified.';                                             01                  002757
 002758         LeaveSr;                                                                                 01                  002758
 002759      EndIf;                                                                                     E01                  002759
 002760                                                                                                                      002760
 002761      durDuration = %trim(%subst(factor2:1:x-1));                                                                     002761
 002762      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         002762
 002763                                                                                                                      002763
 002764      Select;                                                                                    B01                  002764
 002765         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  002765
 002766            durCode = '%years';                                                                   01                  002766
 002767         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  002767
 002768            durCode = '%months';                                                                  01                  002768
 002769         When durCode = '*D' or durCode = '*DAYS';                                               X01                  002769
 002770            durCode = '%days';                                                                    01                  002770
 002771         When durCode = '*H' or durCode = '*HOURS';                                              X01                  002771
 002772            durCode = '%hours';                                                                   01                  002772
 002773         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  002773
 002774            durCode = '%minutes';                                                                 01                  002774
 002775         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  002775
 002776            durCode = '%seconds';                                                                 01                  002776
 002777         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  002777
 002778            durCode = '%mseconds';                                                                01                  002778
 002779         Other;                                                                                  X01                  002779
 002780            nonConvRsn = 'Invalid duration code specified.';                                      01                  002780
 002781            LeaveSr;                                                                              01                  002781
 002782      EndSl;                                                                                     E01                  002782
 002783                                                                                                                      002783
 002784      If factor1 = *Blanks;                                                                      B01                  002784
 002785         sourceLine = %trim(result) + ' = ' + %trim(result);                                      01                  002785
 002786      Else;                                                                                      X01                  002786
 002787         sourceLine = %trim(result) + ' = ' + %trim(factor1);                                     01                  002787
 002788      EndIf;                                                                                     E01                  002788
 002789                                                                                                                      002789
 002790      sourceLine = %trimr(sourceLine) + ' + ' + %trim(durCode)                                                        002790
 002791                 + '(' + %trim(durDuration) + ');';                                                                   002791
 002792                                                                                                                      002792
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     71
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002793      // Set resulting indicators?                                                                                    002793
 002794      If lw <> *Blanks;                                                                          B01                  002794
 002795         ERRCheck = *On;                                                                          01                  002795
 002796         ERRInd = lw;                                                                             01                  002796
 002797      EndIf;                                                                                     E01                  002797
 002798                                                                                                                      002798
 002799      convert = *On;                                                                                                  002799
 002800                                                                                                                      002800
 002801   EndSr;                                                                                                             002801
 002802   //-------------------------------------------------------------------------------------------                      002802
 002803                                                                                                                      002803
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     72
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002805   //-------------------------------------------------------------------------------------------                      002805
 002806   // Convert ALLOC.                                                                                                  002806
 002807   //-------------------------------------------------------------------------------------------                      002807
 002808   BegSr subUserCvt_ALLOC;                                                                                            002808
 002809                                                                                                                      002809
 002810      sourceLine = %trim(result) + ' = %alloc(' + %trim(factor2) + ');';                                              002810
 002811                                                                                                                      002811
 002812      // Set resulting indicators?                                                                                    002812
 002813      If lw <> *Blanks;                                                                          B01                  002813
 002814         ERRCheck = *On;                                                                          01                  002814
 002815         ERRInd = lw;                                                                             01                  002815
 002816      EndIf;                                                                                     E01                  002816
 002817                                                                                                                      002817
 002818      convert = *On;                                                                                                  002818
 002819                                                                                                                      002819
 002820   EndSr;                                                                                                             002820
 002821   //-------------------------------------------------------------------------------------------                      002821
 002822                                                                                                                      002822
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     73
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002824   //-------------------------------------------------------------------------------------------                      002824
 002825   // Convert BEGSR.                                                                                                  002825
 002826   //-------------------------------------------------------------------------------------------                      002826
 002827   BegSr subUserCvt_BEGSR;                                                                                            002827
 002828                                                                                                                      002828
 002829      sourceLine = 'BegSr ' + %trim(factor1) + ';';                                                                   002829
 002830                                                                                                                      002830
 002831      convert = *On;                                                                                                  002831
 002832                                                                                                                      002832
 002833   EndSr;                                                                                                             002833
 002834   //-------------------------------------------------------------------------------------------                      002834
 002835                                                                                                                      002835
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     74
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002837   //-------------------------------------------------------------------------------------------                      002837
 002838   // Convert CALLP.                                                                                                  002838
 002839   //-------------------------------------------------------------------------------------------                      002839
 002840   BegSr subUserCvt_CALLP;                                                                                            002840
 002841                                                                                                                      002841
 002842      // Returning for a multi-line CALLP - restore the original opcode.                                              002842
 002843      If inCallP;                                                                                B01                  002843
 002844         operator = callPOperator;                                                                01                  002844
 002845      EndIf;                                                                                     E01                  002845
 002846                                                                                                                      002846
 002847      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002847
 002848                                                                                                                      002848
 002849      If not inCallP;         // First line of CALLP.                                            B01                  002849
 002850         sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                                 01                  002850
 002851         If not inSpan;                                                                          B02                  002851
 002852            sourceLine = %trim(sourceLine) + ';';                                                 02                  002852
 002853         Else;                                                                                   X02                  002853
 002854            callPOffset = %len(%trim(operator)) + 2;                                              02                  002854
 002855            inCallP = *On;                                                                        02                  002855
 002856            inSpan = *Off;                                                                        02                  002856
 002857         EndIf;                                                                                  E02                  002857
 002858      Else;                   // Second+ line of CALLP.                                          X01                  002858
 002859         sourceLine = *Blanks;                                                                    01                  002859
 002860         sourceLine = %trim(extFactor2);                                                          01                  002860
 002861         If not inSpan;                                                                          B02                  002861
 002862            sourceLine = %trimr(sourceLine) + ';';                                                02                  002862
 002863            //            inCallP = *Off;                                                                             002863
 002864         EndIf;                                                                                  E02                  002864
 002865         inSpan = *Off;                                                                           01                  002865
 002866      EndIf;                                                                                     E01                  002866
 002867                                                                                                                      002867
 002868      // Multi-line CALLP?  Save the opcode.                                                                          002868
 002869      If inCallP;                                                                                B01                  002869
 002870         callPOperator = operator;                                                                01                  002870
 002871      Else;                                                                                      X01                  002871
 002872         callPOperator = *Blanks;                                                                 01                  002872
 002873      EndIf;                                                                                     E01                  002873
 002874                                                                                                                      002874
 002875      convert = *On;                                                                                                  002875
 002876                                                                                                                      002876
 002877   EndSr;                                                                                                             002877
 002878   //-------------------------------------------------------------------------------------------                      002878
 002879                                                                                                                      002879
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     75
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002881   //-------------------------------------------------------------------------------------------                      002881
 002882   // Convert CASxx.                                                                                                  002882
 002883   //-------------------------------------------------------------------------------------------                      002883
 002884   BegSr subUserCvt_CASxx;                                                                                            002884
 002885                                                                                                                      002885
 002886      // Extract components.                                                                                          002886
 002887      caseSubRoutine = %trim(result);                                                                                 002887
 002888      caseOperator = %subst(operator:4:2);                                                                            002888
 002889                                                                                                                      002889
 002890      // Determine comparator.                                                                                        002890
 002891      If caseOperator = 'EQ';                                                                    B01                  002891
 002892         caseOperator = '=';                                                                      01                  002892
 002893      ElseIf caseOperator = 'GT';                                                                X01                  002893
 002894         caseOperator = '>';                                                                      01                  002894
 002895      ElseIf caseOperator = 'LT';                                                                X01                  002895
 002896         caseOperator = '<';                                                                      01                  002896
 002897      ElseIf caseOperator = 'GE';                                                                X01                  002897
 002898         caseOperator = '>=';                                                                     01                  002898
 002899      ElseIf caseOperator = 'LE';                                                                X01                  002899
 002900         caseOperator = '<=';                                                                     01                  002900
 002901      ElseIf caseOperator = 'NE';                                                                X01                  002901
 002902         caseOperator = '<>';                                                                     01                  002902
 002903      Else;                                                                                      X01                  002903
 002904         caseOperator = 'Else';                                                                   01                  002904
 002905      EndIf;                                                                                     E01                  002905
 002906                                                                                                                      002906
 002907      // Build 'If' statement.                                                                                        002907
 002908      If not inCase;                                                                             B01                  002908
 002909         sourceLine = 'If ' +  %trim(factor1) + ' '                                               01                  002909
 002910                    + %trim(caseOperator) + ' ' + %trim(factor2)                                  01                  002910
 002911                    + ';';                                                                        01                  002911
 002912         inCase = *On;                                                                            01                  002912
 002913      Else;                                                                                      X01                  002913
 002914         If caseOperator = 'Else';                                                               B02                  002914
 002915            sourceLine = 'Else;';                                                                 02                  002915
 002916         Else;                                                                                   X02                  002916
 002917            sourceLine = 'ElseIf ' +  %trim(factor1) + ' '                                        02                  002917
 002918                       + %trim(caseOperator) + ' ' + %trim(factor2)                               02                  002918
 002919                       + ';';                                                                     02                  002919
 002920         EndIf;                                                                                  E02                  002920
 002921      EndIf;                                                                                     E01                  002921
 002922                                                                                                                      002922
 002923      // Do we need to set Resulting indicators?                                                                      002923
 002924      If hi <> *Blanks;                                                                          B01                  002924
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     76
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002925         HICheck = *On;                                                                           01                  002925
 002926         HIInd = hi;                                                                              01                  002926
 002927         HIFactor1 = %trim(factor1);                                                              01                  002927
 002928         HIFactor2 = %trim(factor2);                                                              01                  002928
 002929      EndIf;                                                                                     E01                  002929
 002930      If lw <> *Blanks;                                                                          B01                  002930
 002931         LWCheck = *On;                                                                           01                  002931
 002932         LWInd = lw;                                                                              01                  002932
 002933         LWFactor1 = %trim(factor1);                                                              01                  002933
 002934         LWFactor2 = %trim(factor2);                                                              01                  002934
 002935      EndIf;                                                                                     E01                  002935
 002936      If eq <> *Blanks;                                                                          B01                  002936
 002937         EQCheck = *On;                                                                           01                  002937
 002938         EQInd = eq;                                                                              01                  002938
 002939         EQFactor1 = %trim(factor1);                                                              01                  002939
 002940         EQFactor2 = %trim(factor2);                                                              01                  002940
 002941      EndIf;                                                                                     E01                  002941
 002942                                                                                                                      002942
 002943      convert = *On;                                                                                                  002943
 002944                                                                                                                      002944
 002945   EndSr;                                                                                                             002945
 002946   //-------------------------------------------------------------------------------------------                      002946
 002947                                                                                                                      002947
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     77
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002949   //-------------------------------------------------------------------------------------------                      002949
 002950   // Convert CAT.                                                                                                    002950
 002951   //-------------------------------------------------------------------------------------------                      002951
 002952   BegSr subUserCvt_CAT;                                                                                              002952
 002953                                                                                                                      002953
 002954      // Pad the result?                                                                                              002954
 002955      x = %scan('P':operator:4);                                                                                      002955
 002956      If x = 0                                              // Not padding.                      B01                  002956
 002957      and factor1 <> *Blanks                                // Factor1 specified.                B01                  002957
 002958      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  002958
 002959         nonConvRsn =  'No padding specified, result unpredictable.';                             01                  002959
 002960         LeaveSr;    // Don't convert - too difficult to get right.                               01                  002960
 002961      EndIf;                                                                                     E01                  002961
 002962                                                                                                                      002962
 002963      // Drop the extender.                                                                                           002963
 002964      operator = 'CAT';                                                                                               002964
 002965                                                                                                                      002965
 002966      // Determine first part of string.                                                                              002966
 002967      If factor1 = *Blanks;                                                                      B01                  002967
 002968         catFactor1 = %trim(result);                                                              01                  002968
 002969      Else;                                                                                      X01                  002969
 002970         catFactor1 = %trim(factor1);                                                             01                  002970
 002971      EndIf;                                                                                     E01                  002971
 002972                                                                                                                      002972
 002973      // Determine number of blanks.                                                                                  002973
 002974      x = %scan(':':factor2);                                                                                         002974
 002975      If x = 0;   // No trimming required;                                                       B01                  002975
 002976         catBlanks = *Blanks;                                                                     01                  002976
 002977         catFactor2 = %trim(factor2);                                                             01                  002977
 002978      Else;                                                                                      X01                  002978
 002979         catBlanks = %subst(factor2:x+1);                                                         01                  002979
 002980         catFactor2 = %subst(factor2:1:x-1);                                                      01                  002980
 002981      EndIf;                                                                                     E01                  002981
 002982                                                                                                                      002982
 002983      // Determine second part of String.                                                                             002983
 002984                                                                                                                      002984
 002985      // Blanks zero?                                                                                                 002985
 002986      If catBlanks <> *blanks;                                                                   B01                  002986
 002987         Monitor;                                                                                B02                  002987
 002988            catCount = %dec(catBlanks:3:0);                                                       02                  002988
 002989         On-Error;                                                                               X02                  002989
 002990            LeaveSr; // Uses a field to vary the number of blanks - don't convert.                02                  002990
 002991         EndMon;                                                                                 E02                  002991
 002992      EndIf;                                                                                     E01                  002992
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     78
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002993                                                                                                                      002993
 002994      // Build the new line.                                                                                          002994
 002995      If catBlanks = *Blanks;                                                                    B01                  002995
 002996         // No trimming.                                                                                              002996
 002997         sourceLine = %trim(result) + ' = ' + %trim(catFactor1)                                   01                  002997
 002998                    + ' + ' + %trim(catFactor2) + ';';                                            01                  002998
 002999      ElseIf catCount = 0;                                                                       X01                  002999
 003000         // No spaces.                                                                                                003000
 003001         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003001
 003002                    + ') + %trim(' + %trim(catFactor2) + ');';                                    01                  003002
 003003      ElseIf catCount > 25;                                                                      X01                  003003
 003004         LeaveSr; // Arbitrary upper limit - don't convert.                                       01                  003004
 003005      Else;                                                                                      X01                  003005
 003006         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003006
 003007                    + ') + ''' + %str(%addr(blanks):catCount)                                     01                  003007
 003008                    + ''' + %trim(' + %trim(catFactor2) + ');';                                   01                  003008
 003009      EndIf;                                                                                     E01                  003009
 003010                                                                                                                      003010
 003011      // Set resulting indicators?                                                                                    003011
 003012      If lw <> *Blanks;                                                                          B01                  003012
 003013         ERRCheck = *On;                                                                          01                  003013
 003014         ERRInd = lw;                                                                             01                  003014
 003015      EndIf;                                                                                     E01                  003015
 003016                                                                                                                      003016
 003017      convert = *On;                                                                                                  003017
 003018                                                                                                                      003018
 003019   EndSr;                                                                                                             003019
 003020   //-------------------------------------------------------------------------------------------                      003020
 003021                                                                                                                      003021
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     79
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003023   //-------------------------------------------------------------------------------------------                      003023
 003024   // Convert CHAIN.                                                                                                  003024
 003025   //-------------------------------------------------------------------------------------------                      003025
 003026   BegSr subUserCvt_CHAIN;                                                                                            003026
 003027                                                                                                                      003027
 003028      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       003028
 003029                 + %trim(factor2);                                                                                    003029
 003030                                                                                                                      003030
 003031      If result <> *Blanks;                                                                      B01                  003031
 003032         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003032
 003033      Else;                                                                                      X01                  003033
 003034         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003034
 003035      EndIf;                                                                                     E01                  003035
 003036                                                                                                                      003036
 003037      // Set resulting indicators?                                                                                    003037
 003038      If hi <> *Blanks;                                                                          B01                  003038
 003039         NRFCheck = *On;                                                                          01                  003039
 003040         NRFInd = hi;                                                                             01                  003040
 003041         NRFFile = %trim(factor2);                                                                01                  003041
 003042      EndIf;                                                                                     E01                  003042
 003043      If lw <> *Blanks;                                                                          B01                  003043
 003044         ERRCheck = *On;                                                                          01                  003044
 003045         ERRInd = lw;                                                                             01                  003045
 003046      EndIf;                                                                                     E01                  003046
 003047                                                                                                                      003047
 003048      convert = *On;                                                                                                  003048
 003049                                                                                                                      003049
 003050   EndSr;                                                                                                             003050
 003051   //-------------------------------------------------------------------------------------------                      003051
 003052                                                                                                                      003052
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     80
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003054   //-------------------------------------------------------------------------------------------                      003054
 003055   // Convert CHECK.                                                                                                  003055
 003056   //-------------------------------------------------------------------------------------------                      003056
 003057   BegSr subUserCvt_CHECKx;                                                                                           003057
 003058                                                                                                                      003058
 003059      // Don't convert of no result specified.                                                                        003059
 003060      If result = *Blanks;                                                                       B01                  003060
 003061         nonConvRsn = 'No result field specified.';                                               01                  003061
 003062         LeaveSr;                                                                                 01                  003062
 003063      EndIf;                                                                                     E01                  003063
 003064                                                                                                                      003064
 003065      If %subst(operator:1:5) = 'CHECKR';                                                        B01                  003065
 003066         operator = '%checkr(';                                                                   01                  003066
 003067      Else;                                                                                      X01                  003067
 003068         operator = '%check(';                                                                    01                  003068
 003069      EndIf;                                                                                     E01                  003069
 003070                                                                                                                      003070
 003071      // Determine starting point.                                                                                    003071
 003072      x = %scan(':':factor2);                                                                                         003072
 003073                                                                                                                      003073
 003074      // Build the new line.                                                                                          003074
 003075      If x = 0;                                                                                  B01                  003075
 003076         // No start specified.                                                                                       003076
 003077         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003077
 003078                    + %trim(factor1) + ':' + %trim(factor2) + ');';                               01                  003078
 003079      Else;                                                                                      X01                  003079
 003080         // Start from a specified point.                                                                             003080
 003081         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003081
 003082                    + %trim(factor1) + ':' + %subst(factor2:1:x-1)                                01                  003082
 003083                    + ':' + %trim(%subst(factor2:x+1))                                            01                  003083
 003084                    + ');';                                                                       01                  003084
 003085      EndIf;                                                                                     E01                  003085
 003086                                                                                                                      003086
 003087      // Set resulting indicators?                                                                                    003087
 003088      If lw <> *Blanks;                                                                          B01                  003088
 003089         ERRCheck = *On;                                                                          01                  003089
 003090         ERRInd = lw;                                                                             01                  003090
 003091      EndIf;                                                                                     E01                  003091
 003092      If eq <> *Blanks;                                                                          B01                  003092
 003093         HICheck = *On;                                                                           01                  003093
 003094         HIInd = eq;                                                                              01                  003094
 003095         HIFactor1 = result;                                                                      01                  003095
 003096         HIFactor2 = '0';                                                                         01                  003096
 003097      EndIf;                                                                                     E01                  003097
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     81
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003098                                                                                                                      003098
 003099      convert = *On;                                                                                                  003099
 003100                                                                                                                      003100
 003101   EndSr;                                                                                                             003101
 003102   //-------------------------------------------------------------------------------------------                      003102
 003103                                                                                                                      003103
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     82
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003105   //-------------------------------------------------------------------------------------------                      003105
 003106   // Convert CLEAR.                                                                                                  003106
 003107   //-------------------------------------------------------------------------------------------                      003107
 003108   BegSr subUserCvt_CLEAR;                                                                                            003108
 003109                                                                                                                      003109
 003110      sourceLine = 'Clear ' + %trim(result) + ';';                                                                    003110
 003111                                                                                                                      003111
 003112      convert = *On;                                                                                                  003112
 003113                                                                                                                      003113
 003114   EndSr;                                                                                                             003114
 003115   //-------------------------------------------------------------------------------------------                      003115
 003116                                                                                                                      003116
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     83
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003118   //-------------------------------------------------------------------------------------------                      003118
 003119   // Convert CLOSE.                                                                                                  003119
 003120   //-------------------------------------------------------------------------------------------                      003120
 003121   BegSr subUserCvt_CLOSE;                                                                                            003121
 003122                                                                                                                      003122
 003123      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003123
 003124                                                                                                                      003124
 003125      If lw <> *Blanks;                                                                          B01                  003125
 003126         ERRCheck = *On;                                                                          01                  003126
 003127         ERRInd = lw;                                                                             01                  003127
 003128      EndIf;                                                                                     E01                  003128
 003129                                                                                                                      003129
 003130      convert = *On;                                                                                                  003130
 003131                                                                                                                      003131
 003132   EndSr;                                                                                                             003132
 003133   //-------------------------------------------------------------------------------------------                      003133
 003134                                                                                                                      003134
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     84
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003136   //-------------------------------------------------------------------------------------------                      003136
 003137   // Convert COMMIT.                                                                                                 003137
 003138   //-------------------------------------------------------------------------------------------                      003138
 003139   BegSr subUserCvt_COMMIT;                                                                                           003139
 003140                                                                                                                      003140
 003141      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            003141
 003142                                                                                                                      003142
 003143      sourceLine = %trim(sourceLine)  + ';';                                                                          003143
 003144                                                                                                                      003144
 003145      // Check indicators?                                                                                            003145
 003146      If lw <> *Blanks;                                                                          B01                  003146
 003147         ERRCheck = *On;                                                                          01                  003147
 003148         ERRInd = lw;                                                                             01                  003148
 003149      EndIf;                                                                                     E01                  003149
 003150                                                                                                                      003150
 003151      convert = *On;                                                                                                  003151
 003152                                                                                                                      003152
 003153   EndSr;                                                                                                             003153
 003154   //-------------------------------------------------------------------------------------------                      003154
 003155                                                                                                                      003155
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     85
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003157   //-------------------------------------------------------------------------------------------                      003157
 003158   // Convert COMP.                                                                                                   003158
 003159   //-------------------------------------------------------------------------------------------                      003159
 003160   BegSr subUserCvt_COMP;                                                                                             003160
 003161                                                                                                                      003161
 003162      // Set resulting indicators to check.                                                                           003162
 003163      If hi <> *Blanks;                                                                          B01                  003163
 003164         HICheck = *On;                                                                           01                  003164
 003165         HIInd = hi;                                                                              01                  003165
 003166         HIFactor1 = factor1;                                                                     01                  003166
 003167         HIFactor2 = factor2;                                                                     01                  003167
 003168      EndIf;                                                                                     E01                  003168
 003169                                                                                                                      003169
 003170      If lw <> *Blanks;                                                                          B01                  003170
 003171         LWCheck = *On;                                                                           01                  003171
 003172         LWInd = lw;                                                                              01                  003172
 003173         LWFactor1 = factor1;                                                                     01                  003173
 003174         LWFactor2 = factor2;                                                                     01                  003174
 003175      EndIf;                                                                                     E01                  003175
 003176                                                                                                                      003176
 003177      If eq <> *Blanks;                                                                          B01                  003177
 003178         EQCheck = *On;                                                                           01                  003178
 003179         EQInd = eq;                                                                              01                  003179
 003180         EQFactor1 = factor1;                                                                     01                  003180
 003181         EQFactor2 = factor2;                                                                     01                  003181
 003182      EndIf;                                                                                     E01                  003182
 003183                                                                                                                      003183
 003184      // Drop the current line.                                                                                       003184
 003185      dropLine = *On;                                                                                                 003185
 003186      convert = *On;                                                                                                  003186
 003187                                                                                                                      003187
 003188   EndSr;                                                                                                             003188
 003189   //-------------------------------------------------------------------------------------------                      003189
 003190                                                                                                                      003190
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     86
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003192   //-------------------------------------------------------------------------------------------                      003192
 003193   // Convert DEALLOC.                                                                                                003193
 003194   //-------------------------------------------------------------------------------------------                      003194
 003195   BegSr subUserCvt_DEALLOC;                                                                                          003195
 003196                                                                                                                      003196
 003197      sourceLine = %trim(operator) + ' ' + %trim(result);                                                             003197
 003198                                                                                                                      003198
 003199      sourceLine = %trim(sourceLine)  + ';';                                                                          003199
 003200                                                                                                                      003200
 003201      // Set resulting indicators?                                                                                    003201
 003202      If lw <> *Blanks;                                                                          B01                  003202
 003203         ERRCheck = *On;                                                                          01                  003203
 003204         ERRInd = lw;                                                                             01                  003204
 003205      EndIf;                                                                                     E01                  003205
 003206                                                                                                                      003206
 003207      convert = *On;                                                                                                  003207
 003208                                                                                                                      003208
 003209   EndSr;                                                                                                             003209
 003210   //-------------------------------------------------------------------------------------------                      003210
 003211                                                                                                                      003211
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     87
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003213   //-------------------------------------------------------------------------------------------                      003213
 003214   // Convert DELETE.                                                                                                 003214
 003215   //-------------------------------------------------------------------------------------------                      003215
 003216   BegSr subUserCvt_DELETE;                                                                                           003216
 003217                                                                                                                      003217
 003218      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003218
 003219                                                                                                                      003219
 003220      sourceLine = %trim(sourceLine)  + ';';                                                                          003220
 003221                                                                                                                      003221
 003222      // Check indicators?                                                                                            003222
 003223      If hi <> *Blanks;                                                                          B01                  003223
 003224         NRFCheck = *On;                                                                          01                  003224
 003225         NRFInd = eq;                                                                             01                  003225
 003226         NRFFile = %trim(factor2);                                                                01                  003226
 003227      EndIf;                                                                                     E01                  003227
 003228      If lw <> *Blanks;                                                                          B01                  003228
 003229         ERRCheck = *On;                                                                          01                  003229
 003230         ERRInd = lw;                                                                             01                  003230
 003231      EndIf;                                                                                     E01                  003231
 003232                                                                                                                      003232
 003233      convert = *On;                                                                                                  003233
 003234                                                                                                                      003234
 003235   EndSr;                                                                                                             003235
 003236   //-------------------------------------------------------------------------------------------                      003236
 003237                                                                                                                      003237
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     88
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003239   //-------------------------------------------------------------------------------------------                      003239
 003240   // Convert DIV.                                                                                                    003240
 003241   //-------------------------------------------------------------------------------------------                      003241
 003242   BegSr subUserCvt_DIV;                                                                                              003242
 003243                                                                                                                      003243
 003244      // Half-adjust?                                                                                                 003244
 003245      If %scan('H':operator:4) > 0;                                                              B01                  003245
 003246         sourceLine = 'Eval(H) ';                                                                 01                  003246
 003247      Else;                                                                                      X01                  003247
 003248         sourceLine = *Blanks;                                                                    01                  003248
 003249      EndIf;                                                                                     E01                  003249
 003250                                                                                                                      003250
 003251      If factor1 = *Blanks;                                                                      B01                  003251
 003252         divFactor1 = result;                                                                     01                  003252
 003253         divFactor2 = factor2;                                                                    01                  003253
 003254      Else;                                                                                      X01                  003254
 003255         divFactor1 = factor1;                                                                    01                  003255
 003256         divFactor2 = factor2;                                                                    01                  003256
 003257      EndIf;                                                                                     E01                  003257
 003258                                                                                                                      003258
 003259      sourceLine = %trim( %trimr(sourceLine) + ' ' + %trim(result)                                                    003259
 003260                 + ' = ' + %trim(divFactor1) + ' / '                                                                  003260
 003261                 + %trim(divFactor2) + ';');                                                                          003261
 003262                                                                                                                      003262
 003263      convert = *On;                                                                                                  003263
 003264                                                                                                                      003264
 003265   EndSr;                                                                                                             003265
 003266   //-------------------------------------------------------------------------------------------                      003266
 003267                                                                                                                      003267
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     89
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003269   //-------------------------------------------------------------------------------------------                      003269
 003270   // Convert DO.                                                                                                     003270
 003271   //-------------------------------------------------------------------------------------------                      003271
 003272   BegSr subUserCvt_DO;                                                                                               003272
 003273                                                                                                                      003273
 003274      If inDo;                                                                                   B01                  003274
 003275         operator = doOperator;                                                                   01                  003275
 003276      EndIf;                                                                                     E01                  003276
 003277                                                                                                                      003277
 003278      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003278
 003279                                                                                                                      003279
 003280      If operator = 'DOW'     // Use Extended Factor2.                                           B01                  003280
 003281      or operator = 'DOU';    // Use Extended Factor2.                                           B01                  003281
 003282         If not inDo;         // First line of DO.                                               B02                  003282
 003283            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003283
 003284            If not inSpan;                                                                       B03                  003284
 003285               sourceLine = %trim(sourceLine) + ';';                                              03                  003285
 003286            Else;                                                                                X03                  003286
 003287               inDo = *On;                                                                        03                  003287
 003288               inSpan = *Off;                                                                     03                  003288
 003289            EndIf;                                                                               E03                  003289
 003290         Else;                   // Second line of DO.                                           X02                  003290
 003291            sourceLine = *Blanks;                                                                 02                  003291
 003292            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003292
 003293            sourceLine = %trim(extFactor2);                                                       02                  003293
 003294            If not inSpan;                                                                       B03                  003294
 003295               sourceLine = %trimr(sourceLine) + ';';                                             03                  003295
 003296               //               inDo = *Off;                                                                          003296
 003297            EndIf;                                                                               E03                  003297
 003298            inSpan = *Off;                                                                        02                  003298
 003299         EndIf;                                                                                  E02                  003299
 003300         doCompare = '!!';    // Just a regular DO.                                               01                  003300
 003301      Else;                                                                                      X01                  003301
 003302         // Fixed format.                                                                                             003302
 003303         opCode = %xlate(lo:up:opCode);                                                           01                  003303
 003304         If not inDo;         // First line of DO.                                               B02                  003304
 003305            doCompare = %subst(opCode:4:2);                                                       02                  003305
 003306            sourceLine = %subst(opcode:1:3);                                                      02                  003306
 003307         Else;                // Second line of DO.                                              X02                  003307
 003308            If %subst(opCode:1:3) = 'AND';                                                       B03                  003308
 003309               doCompare = %subst(opCode:4:2);                                                    03                  003309
 003310               sourceLine = 'And';                                                                03                  003310
 003311            Else;                                                                                X03                  003311
 003312               doCompare = %subst(opCode:3:2);                                                    03                  003312
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     90
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003313               sourceLine = 'Or';                                                                 03                  003313
 003314            EndIf;                                                                               E03                  003314
 003315         EndIf;                                                                                  E02                  003315
 003316                                                                                                                      003316
 003317         If doCompare = 'EQ';                                                                    B02                  003317
 003318            doCompare = '=';                                                                      02                  003318
 003319         ElseIf doCompare = 'GT';                                                                X02                  003319
 003320            doCompare = '>';                                                                      02                  003320
 003321         ElseIf doCompare = 'GE';                                                                X02                  003321
 003322            doCompare = '>=';                                                                     02                  003322
 003323         ElseIf doCompare = 'LT';                                                                X02                  003323
 003324            doCompare = '<';                                                                      02                  003324
 003325         ElseIf doCompare = 'LE';                                                                X02                  003325
 003326            doCompare = '<=';                                                                     02                  003326
 003327         ElseIf doCompare = 'NE';                                                                X02                  003327
 003328            doCompare = '<>';                                                                     02                  003328
 003329         ElseIf doCompare = '!!';                                                                X02                  003329
 003330            // Do nothing.                                                                                            003330
 003331            Else;    // Just DO - convert to FOR.                                                X02                  003331
 003332            If factor1 = *Blanks;                                                                B03                  003332
 003333               forFactor1 = '1';                                                                  03                  003333
 003334            Else;                                                                                X03                  003334
 003335               forFactor1 = factor1;                                                              03                  003335
 003336            EndIf;                                                                               E03                  003336
 003337            forFactor2 = factor2;                                                                 02                  003337
 003338            factor1 = *Blanks;                                                                    02                  003338
 003339            factor2 = *Blanks;                                                                    02                  003339
 003340            doCompare = *Blanks;                                                                  02                  003340
 003341            If result = *Blanks;                                                                 B03                  003341
 003342               result = '???';                                                                    03                  003342
 003343            EndIf;                                                                               E03                  003343
 003344            sourceLine = 'For ' + %trim(result) + ' = '                                           02                  003344
 003345                       + %trim(forFactor1) + ' To '                                               02                  003345
 003346                       + %trim(forFactor2);                                                       02                  003346
 003347         EndIf;                                                                                  E02                  003347
 003348                                                                                                                      003348
 003349         //         If doCompare = *Blanks;                                                                           003349
 003350     //            // Save current indentation level to match up to the associated ENDDO later.                       003350
 003351         //            forCount += 1;                                                                                 003351
 003352         //            forLevel(forCount) = indentCount;                                                              003352
 003353         //         Else;                                                                                             003353
 003354     //            // Save current indentation level to match up to the associated ENDDO later.                       003354
 003355         //            doCount += 1;                                                                                  003355
 003356         //            doLevel(doCount) = indentCount;                                                                003356
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     91
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003357         //         EndIf;                                                                                            003357
 003358                                                                                                                      003358
 003359         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003359
 003360                            + ' ' + %trim(doCompare) + ' '                                        01                  003360
 003361                            + %trim(factor2);                                                     01                  003361
 003362         If not inSpan;                                                                          B02                  003362
 003363            sourceLine = %trimr(sourceLine) + ';';                                                02                  003363
 003364            inDo = *Off;                                                                          02                  003364
 003365         Else;                                                                                   X02                  003365
 003366            inDo = *On;                                                                           02                  003366
 003367            inSpan = *Off;                                                                        02                  003367
 003368         EndIf;                                                                                  E02                  003368
 003369      EndIf;                                                                                     E01                  003369
 003370                                                                                                                      003370
 003371      // If multi-line, retain the original opcode.                                                                   003371
 003372      If inDo;                                                                                   B01                  003372
 003373         doOperator = operator;                                                                   01                  003373
 003374      Else;                                                                                      X01                  003374
 003375         doOperator = *Blanks;                                                                    01                  003375
 003376      EndIf;                                                                                     E01                  003376
 003377                                                                                                                      003377
 003378      convert = *On;                                                                                                  003378
 003379                                                                                                                      003379
 003380   EndSr;                                                                                                             003380
 003381   //-------------------------------------------------------------------------------------------                      003381
 003382                                                                                                                      003382
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     92
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003384   //-------------------------------------------------------------------------------------------                      003384
 003385   // Convert DSPLY.                                                                                                  003385
 003386   //-------------------------------------------------------------------------------------------                      003386
 003387   BegSr subUserCvt_DSPLY;                                                                                            003387
 003388                                                                                                                      003388
 003389      sourceLine = %trim(operator);                                                                                   003389
 003390                                                                                                                      003390
 003391      If factor1 <> *Blanks;                                                                     B01                  003391
 003392         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  003392
 003393         If factor2 <> *Blanks;                                                                  B02                  003393
 003394            sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                               02                  003394
 003395         ElseIf result <> *Blanks;                                                               X02                  003395
 003396            sourceLine = %trimr(sourceLine) + ' ''''';                                            02                  003396
 003397         EndIf;                                                                                  E02                  003397
 003398         If result <> *Blanks;                                                                   B02                  003398
 003399            sourceLine = %trimr(sourceLine) + ' ' + %trim(result);                                02                  003399
 003400         EndIf;                                                                                  E02                  003400
 003401      EndIf;                                                                                     E01                  003401
 003402                                                                                                                      003402
 003403      sourceLine = %trimr(sourceLine) + ';';                                                                          003403
 003404                                                                                                                      003404
 003405      // Set resulting indicators?                                                                                    003405
 003406      If lw <> *Blanks;                                                                          B01                  003406
 003407         ERRCheck = *On;                                                                          01                  003407
 003408         ERRInd = lw;                                                                             01                  003408
 003409      EndIf;                                                                                     E01                  003409
 003410                                                                                                                      003410
 003411      convert = *On;                                                                                                  003411
 003412                                                                                                                      003412
 003413   EndSr;                                                                                                             003413
 003414   //-------------------------------------------------------------------------------------------                      003414
 003415                                                                                                                      003415
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     93
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003417   //-------------------------------------------------------------------------------------------                      003417
 003418   // Convert DUMP.                                                                                                   003418
 003419   //-------------------------------------------------------------------------------------------                      003419
 003420   BegSr subUserCvt_DUMP;                                                                                             003420
 003421                                                                                                                      003421
 003422      If factor1 <> *Blanks;                                                                     B01                  003422
 003423         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ';';                               01                  003423
 003424      Else;                                                                                      X01                  003424
 003425         sourceLine = %trim(operator) + ';';                                                      01                  003425
 003426      EndIf;                                                                                     E01                  003426
 003427                                                                                                                      003427
 003428      convert = *On;                                                                                                  003428
 003429                                                                                                                      003429
 003430   EndSr;                                                                                                             003430
 003431   //-------------------------------------------------------------------------------------------                      003431
 003432                                                                                                                      003432
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     94
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003434   //-------------------------------------------------------------------------------------------                      003434
 003435   // Convert ELSE.                                                                                                   003435
 003436   //-------------------------------------------------------------------------------------------                      003436
 003437   BegSr subUserCvt_ELSE;                                                                                             003437
 003438                                                                                                                      003438
 003439      sourceLine = 'Else;';                                                                                           003439
 003440                                                                                                                      003440
 003441      convert = *On;                                                                                                  003441
 003442                                                                                                                      003442
 003443   EndSr;                                                                                                             003443
 003444   //-------------------------------------------------------------------------------------------                      003444
 003445                                                                                                                      003445
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     95
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003447   //-------------------------------------------------------------------------------------------                      003447
 003448   // Convert ELSEIF.                                                                                                 003448
 003449   //-------------------------------------------------------------------------------------------                      003449
 003450   BegSr subUserCvt_ELSEIF;                                                                                           003450
 003451                                                                                                                      003451
 003452      sourceLine = 'ElseIf ' + %trim(factor2) + ';';                                                                  003452
 003453                                                                                                                      003453
 003454      convert = *On;                                                                                                  003454
 003455                                                                                                                      003455
 003456   EndSr;                                                                                                             003456
 003457   //-------------------------------------------------------------------------------------------                      003457
 003458                                                                                                                      003458
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     96
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003460   //-------------------------------------------------------------------------------------------                      003460
 003461   // Convert ENDxx.                                                                                                  003461
 003462   //-------------------------------------------------------------------------------------------                      003462
 003463   BegSr subUserCvt_ENDxx;                                                                                            003463
 003464                                                                                                                      003464
 003465      // Catch labels on ENDSR.                                                                                       003465
 003466      If %trim(operator) = 'ENDSR';                                                              B01                  003466
 003467         If %len(%trim(factor1)) > 0;                                                            B02                  003467
 003468            nonConvRsn = 'Label on ENDSR is not supported in free-form';                          02                  003468
 003469            LeaveSr;                                                                              02                  003469
 003470         EndIf;                                                                                  E02                  003470
 003471      EndIf;                                                                                     E01                  003471
 003472                                                                                                                      003472
 003473      // Do we need to convert an ENDDO to ENDFOR?                                                                    003473
 003474      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003474
 003475         If forCount > 0;                                                                        B02                  003475
 003476            If forLevel(forCount) = indentCount - 1;                                             B03                  003476
 003477               operator = 'ENDFOR' + ' ' + %trim(factor2);                                        03                  003477
 003478               If factor2 <> *Blanks;                                                            B04                  003478
 003479                  savedSRCDTA = SRCDTA;                                                           04                  003479
 003480                  codeLine = '* CHECK: This is a converted ENDDO -'                               04                  003480
 003481                           + ' Please add ''BY'' to the corresponding'                            04                  003481
 003482                           + ' FOR';                                                              04                  003482
 003483                  Exsr subUserWriteLine;                                                          04                  003483
 003484                  SRCDTA = savedSRCDTA;                                                           04                  003484
 003485               EndIf;                                                                            E04                  003485
 003486            EndIf;                                                                               E03                  003486
 003487         EndIf;                                                                                  E02                  003487
 003488      EndIf;                                                                                     E01                  003488
 003489                                                                                                                      003489
 003490      // Convert END to ENDDO?                                                                                        003490
 003491      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003491
 003492         If doCount > 0;                                                                         B02                  003492
 003493            If doLevel(doCount) = indentCount - 1;                                               B03                  003493
 003494               operator = 'ENDDO';                                                                03                  003494
 003495            EndIf;                                                                               E03                  003495
 003496         EndIf;                                                                                  E02                  003496
 003497      EndIf;                                                                                     E01                  003497
 003498                                                                                                                      003498
 003499      // Convert END to ENDSL?                                                                                        003499
 003500      If %trim(operator) = 'ENDSL' or %trim(operator) = 'END';                                   B01                  003500
 003501         If slCount > 0;                                                                         B02                  003501
 003502            If slLevel(slCount) = indentCount - 2;                                               B03                  003502
 003503               operator = 'ENDSL';                                                                03                  003503
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     97
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003504            EndIf;                                                                               E03                  003504
 003505         EndIf;                                                                                  E02                  003505
 003506      EndIf;                                                                                     E01                  003506
 003507                                                                                                                      003507
 003508      If %trim(operator) = 'END';                                                                B01                  003508
 003509         If inCase;                                                                              B02                  003509
 003510            operator = 'ENDCS';                                                                   02                  003510
 003511         Else;                                                                                   X02                  003511
 003512            operator = 'ENDIF';                                                                   02                  003512
 003513         EndIf;                                                                                  E02                  003513
 003514      EndIf;                                                                                     E01                  003514
 003515                                                                                                                      003515
 003516      sourceLine = %trim(operator) + ';';                                                                             003516
 003517                                                                                                                      003517
 003518      convert = *On;                                                                                                  003518
 003519                                                                                                                      003519
 003520      If operator = 'ENDCS';                                                                     B01                  003520
 003521         inCase = *Off;                                                                           01                  003521
 003522      EndIf;                                                                                     E01                  003522
 003523                                                                                                                      003523
 003524   EndSr;                                                                                                             003524
 003525   //-------------------------------------------------------------------------------------------                      003525
 003526                                                                                                                      003526
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     98
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003528   //-------------------------------------------------------------------------------------------                      003528
 003529   // Convert EVALx.                                                                                                  003529
 003530   //-------------------------------------------------------------------------------------------                      003530
 003531   BegSr subUserCvt_EVALx;                                                                                            003531
 003532                                                                                                                      003532
 003533      // Returning for a multi-line EVAL - restore the original opcode.                                               003533
 003534      If inEval;                                                                                 B01                  003534
 003535         operator = evalOperator;                                                                 01                  003535
 003536      EndIf;                                                                                     E01                  003536
 003537                                                                                                                      003537
 003538      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003538
 003539                                                                                                                      003539
 003540      If not inEval;          // First line of EVAL.                                             B01                  003540
 003541         inEval = *On;                                                                            01                  003541
 003542         If %scan('H':operator:5) > 0  // Half-adjust.                                           B02                  003542
 003543         or %scan('R':operator:1) > 0; // EVALR.                                                 B02                  003543
 003544            sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                              02                  003544
 003545         Else;                                                                                   X02                  003545
 003546            sourceLine = %trim(extFactor2);                                                       02                  003546
 003547         EndIf;                                                                                  E02                  003547
 003548         If not inSpan;                                                                          B02                  003548
 003549            sourceLine = %trim(sourceLine) + ';';                                                 02                  003549
 003550         Else;                                                                                   X02                  003550
 003551            inSpan = *Off;                                                                        02                  003551
 003552         EndIf;                                                                                  E02                  003552
 003553      Else;                   // Second+ line of EVAL.                                           X01                  003553
 003554         sourceLine = *Blanks;                                                                    01                  003554
 003555         %subst(sourceLine:%len(%trim(operator)) + 2)                                             01                  003555
 003556               = %trim(extFactor2);                                                               01                  003556
 003557         If not inSpan;                                                                          B02                  003557
 003558            sourceLine = %trimr(sourceLine) + ';';                                                02                  003558
 003559         EndIf;                                                                                  E02                  003559
 003560         inSpan = *Off;                                                                           01                  003560
 003561      EndIf;                                                                                     E01                  003561
 003562                                                                                                                      003562
 003563      // Multi-line EVAL?  Save the opcode.                                                                           003563
 003564      If inEval;                                                                                 B01                  003564
 003565         evalOperator = operator;                                                                 01                  003565
 003566      Else;                                                                                      X01                  003566
 003567         evalOperator = *Blanks;                                                                  01                  003567
 003568      EndIf;                                                                                     E01                  003568
 003569                                                                                                                      003569
 003570      convert = *On;                                                                                                  003570
 003571                                                                                                                      003571
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page     99
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003572   EndSr;                                                                                                             003572
 003573   //-------------------------------------------------------------------------------------------                      003573
 003574                                                                                                                      003574
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    100
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003576   //-------------------------------------------------------------------------------------------                      003576
 003577   // Convert EXCEPT.                                                                                                 003577
 003578   //-------------------------------------------------------------------------------------------                      003578
 003579   BegSr subUserCvt_EXCEPT;                                                                                           003579
 003580                                                                                                                      003580
 003581      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003581
 003582                                                                                                                      003582
 003583      convert = *On;                                                                                                  003583
 003584                                                                                                                      003584
 003585   EndSr;                                                                                                             003585
 003586   //-------------------------------------------------------------------------------------------                      003586
 003587                                                                                                                      003587
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    101
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003589   //-------------------------------------------------------------------------------------------                      003589
 003590   // Convert Embedded SQL.                                                                                           003590
 003591   //-------------------------------------------------------------------------------------------                      003591
 003592   BegSr subUserCvt_EXEC_SQL;                                                                                         003592
 003593                                                                                                                      003593
 003594      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003594
 003595                                                                                                                      003595
 003596      If workDirective = '/EXEC SQL';                                                            B01                  003596
 003597         sourceLine = 'Exec SQL';                                                                 01                  003597
 003598         inSQL = *On;                                                                             01                  003598
 003599         inSpan = *Off;                                                                           01                  003599
 003600      Else;                                                                                      X01                  003600
 003601         sourceLine = %trimr(%subst(codeLine:2));                                                 01                  003601
 003602         If not inSpan;                                                                          B02                  003602
 003603            sourceLine = %trim(sourceLine) + ';';                                                 02                  003603
 003604         Else;                                                                                   X02                  003604
 003605            inSQL = *On;                                                                          02                  003605
 003606            inSpan = *Off;                                                                        02                  003606
 003607         EndIf;                                                                                  E02                  003607
 003608      EndIf;                                                                                     E01                  003608
 003609                                                                                                                      003609
 003610      convert = *On;                                                                                                  003610
 003611                                                                                                                      003611
 003612   EndSr;                                                                                                             003612
 003613   //-------------------------------------------------------------------------------------------                      003613
 003614                                                                                                                      003614
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    102
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003616   //-------------------------------------------------------------------------------------------                      003616
 003617   // Convert EXFMT.                                                                                                  003617
 003618   //-------------------------------------------------------------------------------------------                      003618
 003619   BegSr subUserCvt_EXFMT;                                                                                            003619
 003620                                                                                                                      003620
 003621      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003621
 003622                                                                                                                      003622
 003623      // Append datastructure?                                                                                        003623
 003624      If result <> *Blanks;                                                                      B01                  003624
 003625         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003625
 003626      Else;                                                                                      X01                  003626
 003627         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003627
 003628      EndIf;                                                                                     E01                  003628
 003629                                                                                                                      003629
 003630      // Check indicators?                                                                                            003630
 003631      If lw <> *Blanks;                                                                          B01                  003631
 003632         ERRCheck = *On;                                                                          01                  003632
 003633         ERRInd = lw;                                                                             01                  003633
 003634      EndIf;                                                                                     E01                  003634
 003635                                                                                                                      003635
 003636      convert = *On;                                                                                                  003636
 003637                                                                                                                      003637
 003638   EndSr;                                                                                                             003638
 003639   //-------------------------------------------------------------------------------------------                      003639
 003640                                                                                                                      003640
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    103
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003642   //-------------------------------------------------------------------------------------------                      003642
 003643   // Convert EXSR.                                                                                                   003643
 003644   //-------------------------------------------------------------------------------------------                      003644
 003645   BegSr subUserCvt_EXSR;                                                                                             003645
 003646                                                                                                                      003646
 003647      sourceLine = 'ExSr ' + %trim(factor2) + ';';                                                                    003647
 003648                                                                                                                      003648
 003649      convert = *On;                                                                                                  003649
 003650                                                                                                                      003650
 003651   EndSr;                                                                                                             003651
 003652   //-------------------------------------------------------------------------------------------                      003652
 003653                                                                                                                      003653
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    104
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003655   //-------------------------------------------------------------------------------------------                      003655
 003656   // Convert EXTRCT                                                                                                  003656
 003657   //-------------------------------------------------------------------------------------------                      003657
 003658   BegSr subUserCvt_EXTRCT;                                                                                           003658
 003659                                                                                                                      003659
 003660      // Split out duration and code.                                                                                 003660
 003661      x = %scan(':':factor2);                                                                                         003661
 003662      If x = 0;                                                                                  B01                  003662
 003663         nonConvRsn =  'No duration code specified.';                                             01                  003663
 003664         LeaveSr;                                                                                 01                  003664
 003665      EndIf;                                                                                     E01                  003665
 003666                                                                                                                      003666
 003667      durDuration = %trim(%subst(factor2:1:x-1));                                                                     003667
 003668      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         003668
 003669                                                                                                                      003669
 003670      Select;                                                                                    B01                  003670
 003671         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  003671
 003672            durCode = '%years';                                                                   01                  003672
 003673         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  003673
 003674            durCode = '%months';                                                                  01                  003674
 003675         When durCode = '*D' or durCode = '*DAYS';                                               X01                  003675
 003676            durCode = '%days';                                                                    01                  003676
 003677         When durCode = '*H' or durCode = '*HOURS';                                              X01                  003677
 003678            durCode = '%hours';                                                                   01                  003678
 003679         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  003679
 003680            durCode = '%minutes';                                                                 01                  003680
 003681         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  003681
 003682            durCode = '%seconds';                                                                 01                  003682
 003683         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  003683
 003684            durCode = '%mseconds';                                                                01                  003684
 003685         Other;                                                                                  X01                  003685
 003686            nonConvRsn = 'Invalid duration code specified.';                                      01                  003686
 003687            LeaveSr;                                                                              01                  003687
 003688      EndSl;                                                                                     E01                  003688
 003689                                                                                                                      003689
 003690      sourceLine = %trim(result) + ' = %subdt(' + %trim(durDuration)                                                  003690
 003691                 + ':' + %trim(durCode) + ');';                                                                       003691
 003692                                                                                                                      003692
 003693      // Check indicators?                                                                                            003693
 003694      If lw <> *Blanks;                                                                          B01                  003694
 003695         ERRCheck = *On;                                                                          01                  003695
 003696         ERRInd = lw;                                                                             01                  003696
 003697      EndIf;                                                                                     E01                  003697
 003698                                                                                                                      003698
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    105
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003699      convert = *On;                                                                                                  003699
 003700                                                                                                                      003700
 003701   EndSr;                                                                                                             003701
 003702   //-------------------------------------------------------------------------------------------                      003702
 003703                                                                                                                      003703
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    106
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003705   //-------------------------------------------------------------------------------------------                      003705
 003706   // Convert FEOD.                                                                                                   003706
 003707   //-------------------------------------------------------------------------------------------                      003707
 003708   BegSr subUserCvt_FEOD;                                                                                             003708
 003709                                                                                                                      003709
 003710      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003710
 003711                                                                                                                      003711
 003712      // Check indicators?                                                                                            003712
 003713      If lw <> *Blanks;                                                                          B01                  003713
 003714         ERRCheck = *On;                                                                          01                  003714
 003715         ERRInd = lw;                                                                             01                  003715
 003716      EndIf;                                                                                     E01                  003716
 003717                                                                                                                      003717
 003718      convert = *On;                                                                                                  003718
 003719                                                                                                                      003719
 003720   EndSr;                                                                                                             003720
 003721   //-------------------------------------------------------------------------------------------                      003721
 003722                                                                                                                      003722
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    107
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003724   //-------------------------------------------------------------------------------------------                      003724
 003725   // Convert FORCE.                                                                                                  003725
 003726   //-------------------------------------------------------------------------------------------                      003726
 003727   BegSr subUserCvt_FORCE;                                                                                            003727
 003728                                                                                                                      003728
 003729      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003729
 003730                                                                                                                      003730
 003731      convert = *On;                                                                                                  003731
 003732                                                                                                                      003732
 003733   EndSr;                                                                                                             003733
 003734   //-------------------------------------------------------------------------------------------                      003734
 003735                                                                                                                      003735
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    108
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003737   //-------------------------------------------------------------------------------------------                      003737
 003738   // Convert FOR.                                                                                                    003738
 003739   //-------------------------------------------------------------------------------------------                      003739
 003740   BegSr subUserCvt_FOR;                                                                                              003740
 003741                                                                                                                      003741
 003742      sourceLine = 'For ' + %trim(extFactor2) + ';';                                                                  003742
 003743                                                                                                                      003743
 003744      convert = *On;                                                                                                  003744
 003745                                                                                                                      003745
 003746   EndSr;                                                                                                             003746
 003747   //-------------------------------------------------------------------------------------------                      003747
 003748                                                                                                                      003748
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    109
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003750   //-------------------------------------------------------------------------------------------                      003750
 003751   // Convert IF.                                                                                                     003751
 003752   //-------------------------------------------------------------------------------------------                      003752
 003753   BegSr subUserCvt_IF;                                                                                               003753
 003754                                                                                                                      003754
 003755      // Returning for a multi-line IF?  Reinstate original opcode.                                                   003755
 003756      If inIf;                                                                                   B01                  003756
 003757         operator = ifOperator;                                                                   01                  003757
 003758      EndIf;                                                                                     E01                  003758
 003759                                                                                                                      003759
 003760      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003760
 003761                                                                                                                      003761
 003762      If operator = 'IF';     // Use Extended Factor2.                                           B01                  003762
 003763         If not inIf;            // First line of IF.                                            B02                  003763
 003764            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003764
 003765            If not inSpan;                                                                       B03                  003765
 003766               sourceLine = %trim(sourceLine) + ';';                                              03                  003766
 003767            Else;                                                                                X03                  003767
 003768               inIf = *On;                                                                        03                  003768
 003769               inSpan = *Off;                                                                     03                  003769
 003770            EndIf;                                                                               E03                  003770
 003771         Else;                   // Second line of IF.                                           X02                  003771
 003772            //            sourceLine = *Blanks;                                                                       003772
 003773            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003773
 003774            sourceLine = %trim(extFactor2);                                                       02                  003774
 003775            If not inSpan;                                                                       B03                  003775
 003776               sourceLine = %trimr(sourceLine) + ';';                                             03                  003776
 003777               //               inIf = *Off;                                                                          003777
 003778            EndIf;                                                                               E03                  003778
 003779            //            inSpan = *On;                                                                               003779
 003780            inSpan = *Off;                                                                        02                  003780
 003781         EndIf;                                                                                  E02                  003781
 003782      Else;                                                                                      X01                  003782
 003783         // Fixed format.                                                                                             003783
 003784         opCode = %xlate(lo:up:opCode);                                                           01                  003784
 003785         If not inIf;         // First line of IF.                                               B02                  003785
 003786            ifCompare = %subst(opCode:3:2);                                                       02                  003786
 003787            sourceLine = 'If';                                                                    02                  003787
 003788         Else;                // Second line of IF.                                              X02                  003788
 003789            If %subst(opCode:1:3) = 'AND';                                                       B03                  003789
 003790               ifCompare = %subst(opCode:4:2);                                                    03                  003790
 003791               sourceLine = 'And';                                                                03                  003791
 003792            Else;                                                                                X03                  003792
 003793               ifCompare = %subst(opCode:3:2);                                                    03                  003793
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    110
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003794               sourceLine = 'Or';                                                                 03                  003794
 003795            EndIf;                                                                               E03                  003795
 003796         EndIf;                                                                                  E02                  003796
 003797         If ifCompare = 'EQ';                                                                    B02                  003797
 003798            ifCompare = '=';                                                                      02                  003798
 003799         ElseIf ifCompare = 'GT';                                                                X02                  003799
 003800            ifCompare = '>';                                                                      02                  003800
 003801         ElseIf ifCompare = 'GE';                                                                X02                  003801
 003802            ifCompare = '>=';                                                                     02                  003802
 003803         ElseIf ifCompare = 'LT';                                                                X02                  003803
 003804            ifCompare = '<';                                                                      02                  003804
 003805         ElseIf ifCompare = 'LE';                                                                X02                  003805
 003806            ifCompare = '<=';                                                                     02                  003806
 003807         ElseIf ifCompare = 'NE';                                                                X02                  003807
 003808            ifCompare = '<>';                                                                     02                  003808
 003809         EndIf;                                                                                  E02                  003809
 003810         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003810
 003811                            + ' ' + %trim(ifCompare) + ' '                                        01                  003811
 003812                            + %trim(factor2);                                                     01                  003812
 003813         If not inSpan;                                                                          B02                  003813
 003814            sourceLine = %trimr(sourceLine) + ';';                                                02                  003814
 003815            inIf = *Off;                                                                          02                  003815
 003816         Else;                                                                                   X02                  003816
 003817            inIf = *On;                                                                           02                  003817
 003818            inSpan = *Off;                                                                        02                  003818
 003819         EndIf;                                                                                  E02                  003819
 003820      EndIf;                                                                                     E01                  003820
 003821                                                                                                                      003821
 003822      // Multi-line IF?  Retain original opcode.                                                                      003822
 003823      If inIf;                                                                                   B01                  003823
 003824         ifOperator = operator;                                                                   01                  003824
 003825      Else;                                                                                      X01                  003825
 003826         ifOperator = *Blanks;                                                                    01                  003826
 003827      EndIf;                                                                                     E01                  003827
 003828                                                                                                                      003828
 003829      convert = *On;                                                                                                  003829
 003830                                                                                                                      003830
 003831   EndSr;                                                                                                             003831
 003832   //-------------------------------------------------------------------------------------------                      003832
 003833                                                                                                                      003833
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    111
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003835   //-------------------------------------------------------------------------------------------                      003835
 003836   // Convert IN.                                                                                                     003836
 003837   //-------------------------------------------------------------------------------------------                      003837
 003838   BegSr subUserCvt_IN;                                                                                               003838
 003839                                                                                                                      003839
 003840      If factor1 <> *Blanks;                                                                     B01                  003840
 003841         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  003841
 003842                    + %trim(factor2) + ';';                                                       01                  003842
 003843      Else;                                                                                      X01                  003843
 003844         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  003844
 003845      EndIf;                                                                                     E01                  003845
 003846                                                                                                                      003846
 003847      // Set resulting indicators?                                                                                    003847
 003848      If lw <> *Blanks;                                                                          B01                  003848
 003849         ERRCheck = *On;                                                                          01                  003849
 003850         ERRInd = lw;                                                                             01                  003850
 003851      EndIf;                                                                                     E01                  003851
 003852                                                                                                                      003852
 003853      convert = *On;                                                                                                  003853
 003854                                                                                                                      003854
 003855   EndSr;                                                                                                             003855
 003856   //-------------------------------------------------------------------------------------------                      003856
 003857                                                                                                                      003857
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    112
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003859   //-------------------------------------------------------------------------------------------                      003859
 003860   // Convert ITER.                                                                                                   003860
 003861   //-------------------------------------------------------------------------------------------                      003861
 003862   BegSr subUserCvt_ITER;                                                                                             003862
 003863                                                                                                                      003863
 003864      sourceLine = %trim(operator) + ';';                                                                             003864
 003865                                                                                                                      003865
 003866      convert = *On;                                                                                                  003866
 003867                                                                                                                      003867
 003868   EndSr;                                                                                                             003868
 003869   //-------------------------------------------------------------------------------------------                      003869
 003870                                                                                                                      003870
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    113
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003872   //-------------------------------------------------------------------------------------------                      003872
 003873   // Convert LEAVExx.                                                                                                003873
 003874   //-------------------------------------------------------------------------------------------                      003874
 003875   BegSr subUserCvt_LEAVE;                                                                                            003875
 003876                                                                                                                      003876
 003877      sourceLine = %trim(operator) + ';';                                                                             003877
 003878                                                                                                                      003878
 003879      convert = *On;                                                                                                  003879
 003880                                                                                                                      003880
 003881   EndSr;                                                                                                             003881
 003882   //-------------------------------------------------------------------------------------------                      003882
 003883                                                                                                                      003883
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    114
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003885   //-------------------------------------------------------------------------------------------                      003885
 003886   // Convert LOOKUP.                                                                                                 003886
 003887   //-------------------------------------------------------------------------------------------                      003887
 003888   BegSr subUserCvt_LOOKUP;                                                                                           003888
 003889                                                                                                                      003889
 003890      //            If %subst(factor2:1:3) = 'TAB';  // Table lookup.                                                 003890
 003891      //            Else;                            // Array lookup.                                                 003891
 003892      //               // Extract element variable.                                                                   003892
 003893      //               x = %scan('(':factor2);                                                                        003893
 003894      //               If x = 0;   // No variable specified, so use a substitute.                                     003894
 003895      //                  lookupVar = 'lookupIndex';                                                                  003895
 003896      //               Else;                                                                                          003896
 003897      //                  lookupVar = %subst(factor2:x+1:%scan(')':factor2:x)-x-1);                                   003897
 003898      //               EndIf;                                                                                         003898
 003899      //               If eq <> *Blanks and lw <> *Blanks;                                                            003899
 003900      //                  sourceLine = '%lookupLE(';                                                                  003900
 003901      //               ElseIf eq <> *Blanks and hi <> *Blanks;                                                        003901
 003902      //                  sourceLine = '%lookupGE(';                                                                  003902
 003903      //               ElseIf lw <> *Blanks;                                                                          003903
 003904      //                  sourceLine = '%lookupLT(';                                                                  003904
 003905      //               ElseIf hi <> *Blanks;                                                                          003905
 003906      //                  sourceLine = '%lookupGT(';                                                                  003906
 003907      //               Else;                                                                                          003907
 003908      //                  sourceLine = '%lookup(';                                                                    003908
 003909      //               EndIf;                                                                                         003909
 003910      //               sourceLine = %trim(sourceLine) + %trim(factor1) + ':'                                          003910
 003911      //                          + %trim(factor2) + ');';                                                            003911
 003912      //            EndIf;                                                                                            003912
 003913      //            convert = *On;                                                                                    003913
 003914                                                                                                                      003914
 003915   EndSr;                                                                                                             003915
 003916   //-------------------------------------------------------------------------------------------                      003916
 003917                                                                                                                      003917
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    115
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003919   //-------------------------------------------------------------------------------------------                      003919
 003920   // Convert MONITOR.                                                                                                003920
 003921   //-------------------------------------------------------------------------------------------                      003921
 003922   BegSr subUserCvt_MONITOR;                                                                                          003922
 003923                                                                                                                      003923
 003924      sourceLine = 'Monitor;';                                                                                        003924
 003925                                                                                                                      003925
 003926      convert = *On;                                                                                                  003926
 003927                                                                                                                      003927
 003928   EndSr;                                                                                                             003928
 003929   //-------------------------------------------------------------------------------------------                      003929
 003930                                                                                                                      003930
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    116
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003932   //-------------------------------------------------------------------------------------------                      003932
 003933   // Convert MOVE.                                                                                                   003933
 003934   //-------------------------------------------------------------------------------------------                      003934
 003935   BegSr subUserCvt_MOVE;                                                                                             003935
 003936                                                                                                                      003936
 003937      // Pad the result?                                                                                              003937
 003938      x = %scan('P':operator:5);                                                                                      003938
 003939                                                                                                                      003939
 003940      If x > 0 and %subst(operator:5:1) <> 'L';                                                  B01                  003940
 003941         // Move right and pad left.                                                                                  003941
 003942         sourceLine = 'EvalR ' + %trim(result) + ' = ' + %trim(factor2)                           01                  003942
 003943                    + ';';                                                                        01                  003943
 003944                                                                                                                      003944
 003945      ElseIf x > 0 and %subst(operator:5:1) = 'L';                                               X01                  003945
 003946         // Move left and pad right.                                                                                  003946
 003947         sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                               01                  003947
 003948                                                                                                                      003948
 003949      ElseIf factor1 = *Blanks;                                                                  X01                  003949
 003950         // Straight move.                                                                                            003950
 003951         If %lookup(%xlate(lo:up:%trim(result)):QopCodeUp) = 0;                                  B02                  003951
 003952            sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                            02                  003952
 003953         Else;                                                                                   X02                  003953
 003954            // Result is a reserved word - don't convert.                                                             003954
 003955            nonConvRsn = 'Result field name is a reserved word.';                                 02                  003955
 003956            LeaveSr;                                                                              02                  003956
 003957         EndIf;                                                                                  E02                  003957
 003958                                                                                                                      003958
 003959      Else;                                                                                      X01                  003959
 003960         // Conversion from one format to another...                                                                  003960
 003961         //         sourceLine = %xlate(lo:up:factor1);                                                               003961
 003962                                                                                                                      003962
 003963         //         If sourceLine = '*CYMD';   // Date.                                                               003963
 003964         //            sourceLine = %trim(result) + ' = %dec(' + %trim(factor2)                                       003964
 003965         //                       + ':*CYMD);';                                                                       003965
 003966         //         Else;                                                                                             003966
 003967         nonConvRsn = 'Data conversion is needed.';                                               01                  003967
 003968         LeaveSr; // Don't convert.                                                               01                  003968
 003969         //         EndIf;                                                                                            003969
 003970      EndIf;                                                                                     E01                  003970
 003971                                                                                                                      003971
 003972      convert = *On;                                                                                                  003972
 003973                                                                                                                      003973
 003974   EndSr;                                                                                                             003974
 003975   //-------------------------------------------------------------------------------------------                      003975
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    117
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003976                                                                                                                      003976
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    118
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003978   //-------------------------------------------------------------------------------------------                      003978
 003979   // Convert MOVEA.                                                                                                  003979
 003980   //-------------------------------------------------------------------------------------------                      003980
 003981   BegSr subUserCvt_MOVEA;                                                                                            003981
 003982                                                                                                                      003982
 003983      // Not supported.                                                                                               003983
 003984                                                                                                                      003984
 003985   EndSr;                                                                                                             003985
 003986   //-------------------------------------------------------------------------------------------                      003986
 003987                                                                                                                      003987
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    119
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003989   //-------------------------------------------------------------------------------------------                      003989
 003990   // Convert MULT.                                                                                                   003990
 003991   //-------------------------------------------------------------------------------------------                      003991
 003992   BegSr subUserCvt_MULT;                                                                                             003992
 003993                                                                                                                      003993
 003994      // Half-adjust?                                                                                                 003994
 003995      x = %scan('H':operator:4);                                                                                      003995
 003996      If x > 0;                                                                                  B01                  003996
 003997         sourceLine = 'Eval(H)';                                                                  01                  003997
 003998      Else;                                                                                      X01                  003998
 003999         sourceLine = *Blanks;                                                                    01                  003999
 004000      EndIf;                                                                                     E01                  004000
 004001                                                                                                                      004001
 004002      If factor1 = *Blanks;                                                                      B01                  004002
 004003         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004003
 004004                    + ' = ' + %trim(result)                                                       01                  004004
 004005                    + ' * ' + %trim(factor2) +';';                                                01                  004005
 004006      Else;                                                                                      X01                  004006
 004007         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004007
 004008                    + ' = ' + %trim(factor1)                                                      01                  004008
 004009                    + ' * ' + %trim(factor2) + ';';                                               01                  004009
 004010      EndIf;                                                                                     E01                  004010
 004011                                                                                                                      004011
 004012      sourceLine = %trim(sourceLine);                                                                                 004012
 004013                                                                                                                      004013
 004014      convert = *On;                                                                                                  004014
 004015                                                                                                                      004015
 004016   EndSr;                                                                                                             004016
 004017   //-------------------------------------------------------------------------------------------                      004017
 004018                                                                                                                      004018
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    120
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004020   //-------------------------------------------------------------------------------------------                      004020
 004021   // Convert MVR.                                                                                                    004021
 004022   //-------------------------------------------------------------------------------------------                      004022
 004023   BegSr subUserCvt_MVR;                                                                                              004023
 004024                                                                                                                      004024
 004025      sourceLine = %trim(result) + ' = %rem(' + %trim(divFactor1)                                                     004025
 004026                 + ':' + %trim(divFactor2) + ');';                                                                    004026
 004027                                                                                                                      004027
 004028      convert = *On;                                                                                                  004028
 004029                                                                                                                      004029
 004030   EndSr;                                                                                                             004030
 004031   //-------------------------------------------------------------------------------------------                      004031
 004032                                                                                                                      004032
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    121
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004034   //-------------------------------------------------------------------------------------------                      004034
 004035   // Convert NEXT.                                                                                                   004035
 004036   //-------------------------------------------------------------------------------------------                      004036
 004037   BegSr subUserCvt_NEXT;                                                                                             004037
 004038                                                                                                                      004038
 004039      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004039
 004040                 + %trim(factor2) + ';';                                                                              004040
 004041                                                                                                                      004041
 004042                                                                                                                      004042
 004043      // Check indicators?                                                                                            004043
 004044      If lw <> *Blanks;                                                                          B01                  004044
 004045         ERRCheck = *On;                                                                          01                  004045
 004046         ERRInd = lw;                                                                             01                  004046
 004047      EndIf;                                                                                     E01                  004047
 004048                                                                                                                      004048
 004049      convert = *On;                                                                                                  004049
 004050                                                                                                                      004050
 004051   EndSr;                                                                                                             004051
 004052   //-------------------------------------------------------------------------------------------                      004052
 004053                                                                                                                      004053
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    122
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004055   //-------------------------------------------------------------------------------------------                      004055
 004056   // Convert OCCUR.                                                                                                  004056
 004057   //-------------------------------------------------------------------------------------------                      004057
 004058   BegSr subUserCvt_OCCUR;                                                                                            004058
 004059                                                                                                                      004059
 004060      If factor1 = *Blanks;      // Get occurrence.                                              B01                  004060
 004061         sourceLine = %trim(result) + ' = ' + '%occur('                                           01                  004061
 004062                    + %trim(factor2) + ');';                                                      01                  004062
 004063      ElseIf result = *Blanks;   // Set occurrent.                                               X01                  004063
 004064         sourceLine = '%occur(' + %trim(factor2) + ') = '                                         01                  004064
 004065                    + %trim(factor1) + ';';                                                       01                  004065
 004066      Else;                                                                                      X01                  004066
 004067         nonConvRsn = 'Cannot determine of OCCUR is used to set or '                              01                  004067
 004068                    + 'get the occurrence.';                                                      01                  004068
 004069         LeaveSr;                                                                                 01                  004069
 004070      EndIf;                                                                                     E01                  004070
 004071                                                                                                                      004071
 004072      // Check resulting indicators?                                                                                  004072
 004073      If lw <> *Blanks;                                                                          B01                  004073
 004074         ERRCheck = *On;                                                                          01                  004074
 004075         ERRInd = lw;                                                                             01                  004075
 004076      EndIf;                                                                                     E01                  004076
 004077                                                                                                                      004077
 004078      convert = *On;                                                                                                  004078
 004079                                                                                                                      004079
 004080   EndSr;                                                                                                             004080
 004081   //-------------------------------------------------------------------------------------------                      004081
 004082                                                                                                                      004082
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    123
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004084   //-------------------------------------------------------------------------------------------                      004084
 004085   // Convert ON-ERROR.                                                                                               004085
 004086   //-------------------------------------------------------------------------------------------                      004086
 004087   BegSr subUserCvt_ON_ERROR;                                                                                         004087
 004088                                                                                                                      004088
 004089      If extFactor2 = *Blanks;                                                                   B01                  004089
 004090         sourceLine = %trim(operator) + ';';                                                      01                  004090
 004091      Else;                                                                                      X01                  004091
 004092         sourceLine = %trim(operator) + ' ' + %trim(extFactor2) + ';';                            01                  004092
 004093      EndIf;                                                                                     E01                  004093
 004094                                                                                                                      004094
 004095      convert = *On;                                                                                                  004095
 004096                                                                                                                      004096
 004097   EndSr;                                                                                                             004097
 004098   //-------------------------------------------------------------------------------------------                      004098
 004099                                                                                                                      004099
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    124
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004101   //-------------------------------------------------------------------------------------------                      004101
 004102   // Convert OPEN.                                                                                                   004102
 004103   //-------------------------------------------------------------------------------------------                      004103
 004104   BegSr subUserCvt_OPEN;                                                                                             004104
 004105                                                                                                                      004105
 004106      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004106
 004107                                                                                                                      004107
 004108      // Check resulting indicators?                                                                                  004108
 004109      If lw <> *Blanks;                                                                          B01                  004109
 004110         ERRCheck = *On;                                                                          01                  004110
 004111         ERRInd = lw;                                                                             01                  004111
 004112      EndIf;                                                                                     E01                  004112
 004113                                                                                                                      004113
 004114      convert = *On;                                                                                                  004114
 004115                                                                                                                      004115
 004116   EndSr;                                                                                                             004116
 004117   //-------------------------------------------------------------------------------------------                      004117
 004118                                                                                                                      004118
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    125
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004120   //-------------------------------------------------------------------------------------------                      004120
 004121   // Convert OTHER.                                                                                                  004121
 004122   //-------------------------------------------------------------------------------------------                      004122
 004123   BegSr subUserCvt_OTHER;                                                                                            004123
 004124                                                                                                                      004124
 004125      sourceLine = 'Other;';                                                                                          004125
 004126                                                                                                                      004126
 004127      convert = *On;                                                                                                  004127
 004128                                                                                                                      004128
 004129   EndSr;                                                                                                             004129
 004130   //-------------------------------------------------------------------------------------------                      004130
 004131                                                                                                                      004131
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    126
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004133   //-------------------------------------------------------------------------------------------                      004133
 004134   // Convert OUT.                                                                                                    004134
 004135   //-------------------------------------------------------------------------------------------                      004135
 004136   BegSr subUserCvt_OUT;                                                                                              004136
 004137                                                                                                                      004137
 004138      If factor1 = *Blanks;                                                                      B01                  004138
 004139         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004139
 004140      Else;                                                                                      X01                  004140
 004141         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004141
 004142                    + %trim(factor2) + ';';                                                       01                  004142
 004143      EndIf;                                                                                     E01                  004143
 004144                                                                                                                      004144
 004145      // Set resulting indicators?                                                                                    004145
 004146      If lw <> *Blanks;                                                                          B01                  004146
 004147         ERRCheck = *On;                                                                          01                  004147
 004148         ERRInd = lw;                                                                             01                  004148
 004149      EndIf;                                                                                     E01                  004149
 004150                                                                                                                      004150
 004151      convert = *On;                                                                                                  004151
 004152                                                                                                                      004152
 004153   EndSr;                                                                                                             004153
 004154   //-------------------------------------------------------------------------------------------                      004154
 004155                                                                                                                      004155
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    127
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004157   //-------------------------------------------------------------------------------------------                      004157
 004158   // Convert POST.                                                                                                   004158
 004159   //-------------------------------------------------------------------------------------------                      004159
 004160   BegSr subUserCvt_POST;                                                                                             004160
 004161                                                                                                                      004161
 004162      If factor2 = *Blanks;                                                                      B01                  004162
 004163         nonConvRsn =  'No filename specified in Factor2.';                                       01                  004163
 004164         LeaveSr;                                                                                 01                  004164
 004165      EndIf;                                                                                     E01                  004165
 004166                                                                                                                      004166
 004167      If result <> *Blanks;                                                                      B01                  004167
 004168         nonConvRsn =  'INFDS specified in result.';                                              01                  004168
 004169         LeaveSr;                                                                                 01                  004169
 004170      EndIf;                                                                                     E01                  004170
 004171                                                                                                                      004171
 004172      If factor1 = *Blanks;                                                                      B01                  004172
 004173         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004173
 004174      Else;                                                                                      X01                  004174
 004175         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004175
 004176                    + %trim(factor2) + ';';                                                       01                  004176
 004177      EndIf;                                                                                     E01                  004177
 004178                                                                                                                      004178
 004179      // Set resulting indicators?                                                                                    004179
 004180      If lw <> *Blanks;                                                                          B01                  004180
 004181         ERRCheck = *On;                                                                          01                  004181
 004182         ERRInd = lw;                                                                             01                  004182
 004183      EndIf;                                                                                     E01                  004183
 004184                                                                                                                      004184
 004185      convert = *On;                                                                                                  004185
 004186                                                                                                                      004186
 004187   EndSr;                                                                                                             004187
 004188   //-------------------------------------------------------------------------------------------                      004188
 004189                                                                                                                      004189
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    128
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004191   //-------------------------------------------------------------------------------------------                      004191
 004192   // Convert READ.                                                                                                   004192
 004193   //-------------------------------------------------------------------------------------------                      004193
 004194   BegSr subUserCvt_READ;                                                                                             004194
 004195                                                                                                                      004195
 004196      If factor1 <> *Blanks;                                                                     B01                  004196
 004197         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004197
 004198                    + %trim(factor2);                                                             01                  004198
 004199      Else;                                                                                      X01                  004199
 004200         sourceLine = %trim(operator) + ' ' + %trim(factor2);                                     01                  004200
 004201      EndIf;                                                                                     E01                  004201
 004202                                                                                                                      004202
 004203      // Append datastructure?                                                                                        004203
 004204      If result <> *Blanks;                                                                      B01                  004204
 004205         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004205
 004206      Else;                                                                                      X01                  004206
 004207         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004207
 004208      EndIf;                                                                                     E01                  004208
 004209                                                                                                                      004209
 004210      // Check indicators?                                                                                            004210
 004211      If eq <> *Blanks;                                                                          B01                  004211
 004212         EOFCheck = *On;                                                                          01                  004212
 004213         EOFInd = eq;                                                                             01                  004213
 004214         EOFFile = %trim(factor2);                                                                01                  004214
 004215      EndIf;                                                                                     E01                  004215
 004216      If lw <> *Blanks;                                                                          B01                  004216
 004217         ERRCheck = *On;                                                                          01                  004217
 004218         ERRInd = lw;                                                                             01                  004218
 004219      EndIf;                                                                                     E01                  004219
 004220                                                                                                                      004220
 004221      convert = *On;                                                                                                  004221
 004222                                                                                                                      004222
 004223   EndSr;                                                                                                             004223
 004224   //-------------------------------------------------------------------------------------------                      004224
 004225                                                                                                                      004225
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    129
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004227   //-------------------------------------------------------------------------------------------                      004227
 004228   // Convert REALLOC.                                                                                                004228
 004229   //-------------------------------------------------------------------------------------------                      004229
 004230   BegSr subUserCvt_REALLOC;                                                                                          004230
 004231                                                                                                                      004231
 004232      sourceLine = %trim(result) + ' = %realloc(' + %trim(factor2)                                                    004232
 004233                 + ');';                                                                                              004233
 004234                                                                                                                      004234
 004235      // Set resulting indicators?                                                                                    004235
 004236      If lw <> *Blanks;                                                                          B01                  004236
 004237         ERRCheck = *On;                                                                          01                  004237
 004238         ERRInd = lw;                                                                             01                  004238
 004239      EndIf;                                                                                     E01                  004239
 004240                                                                                                                      004240
 004241      convert = *On;                                                                                                  004241
 004242                                                                                                                      004242
 004243   EndSr;                                                                                                             004243
 004244   //-------------------------------------------------------------------------------------------                      004244
 004245                                                                                                                      004245
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    130
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004247   //-------------------------------------------------------------------------------------------                      004247
 004248   // Convert REL.                                                                                                    004248
 004249   //-------------------------------------------------------------------------------------------                      004249
 004250   BegSr subUserCvt_REL;                                                                                              004250
 004251                                                                                                                      004251
 004252      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             004252
 004253                 + ' ' + %trim(factor2) + ';';                                                                        004253
 004254                                                                                                                      004254
 004255      // Check resulting indicators?                                                                                  004255
 004256      If lw <> *Blanks;                                                                          B01                  004256
 004257         ERRCheck = *On;                                                                          01                  004257
 004258         ERRInd = lw;                                                                             01                  004258
 004259      EndIf;                                                                                     E01                  004259
 004260                                                                                                                      004260
 004261      convert = *On;                                                                                                  004261
 004262                                                                                                                      004262
 004263   EndSr;                                                                                                             004263
 004264   //-------------------------------------------------------------------------------------------                      004264
 004265                                                                                                                      004265
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    131
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004267   //-------------------------------------------------------------------------------------------                      004267
 004268   // Convert RESET.                                                                                                  004268
 004269   //-------------------------------------------------------------------------------------------                      004269
 004270   BegSr subUserCvt_RESET;                                                                                            004270
 004271                                                                                                                      004271
 004272      sourceLine = %trim(operator);                                                                                   004272
 004273                                                                                                                      004273
 004274      If factor1 <> *Blanks;                                                                     B01                  004274
 004275         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  004275
 004276      EndIf;                                                                                     E01                  004276
 004277                                                                                                                      004277
 004278      If factor2 <> *Blanks;                                                                     B01                  004278
 004279         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                                  01                  004279
 004280      EndIf;                                                                                     E01                  004280
 004281                                                                                                                      004281
 004282      sourceLine = %trimr(sourceLine) + ' ' + %trim(result) + ';';                                                    004282
 004283                                                                                                                      004283
 004284      // Check indicators?                                                                                            004284
 004285      If hi <> *Blanks;                                                                          B01                  004285
 004286         NRFCheck = *On;                                                                          01                  004286
 004287         NRFInd = eq;                                                                             01                  004287
 004288         NRFFile = %trim(factor2);                                                                01                  004288
 004289      EndIf;                                                                                     E01                  004289
 004290      If lw <> *Blanks;                                                                          B01                  004290
 004291         ERRCheck = *On;                                                                          01                  004291
 004292         ERRInd = lw;                                                                             01                  004292
 004293      EndIf;                                                                                     E01                  004293
 004294                                                                                                                      004294
 004295      convert = *On;                                                                                                  004295
 004296                                                                                                                      004296
 004297   EndSr;                                                                                                             004297
 004298   //-------------------------------------------------------------------------------------------                      004298
 004299                                                                                                                      004299
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    132
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004301   //-------------------------------------------------------------------------------------------                      004301
 004302   // Convert RETURN;                                                                                                 004302
 004303   //-------------------------------------------------------------------------------------------                      004303
 004304   BegSr subUserCvt_RETURN;                                                                                           004304
 004305                                                                                                                      004305
 004306      sourceLine = 'Return ' + %trim(%subst(operator:7))                                                              004306
 004307                 + ' ' + %trim(extFactor2) + ';';                                                                     004307
 004308                                                                                                                      004308
 004309      convert = *On;                                                                                                  004309
 004310                                                                                                                      004310
 004311   EndSr;                                                                                                             004311
 004312   //-------------------------------------------------------------------------------------------                      004312
 004313                                                                                                                      004313
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    133
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004315   //-------------------------------------------------------------------------------------------                      004315
 004316   // Convert ROLBK.                                                                                                  004316
 004317   //-------------------------------------------------------------------------------------------                      004317
 004318   BegSr subUserCvt_ROLBK;                                                                                            004318
 004319                                                                                                                      004319
 004320      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            004320
 004321                                                                                                                      004321
 004322      sourceLine = %trim(sourceLine)  + ';';                                                                          004322
 004323                                                                                                                      004323
 004324      // Check indicators?                                                                                            004324
 004325      If lw <> *Blanks;                                                                          B01                  004325
 004326         ERRCheck = *On;                                                                          01                  004326
 004327         ERRInd = lw;                                                                             01                  004327
 004328      EndIf;                                                                                     E01                  004328
 004329                                                                                                                      004329
 004330      convert = *On;                                                                                                  004330
 004331                                                                                                                      004331
 004332   EndSr;                                                                                                             004332
 004333   //-------------------------------------------------------------------------------------------                      004333
 004334                                                                                                                      004334
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    134
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004336   //-------------------------------------------------------------------------------------------                      004336
 004337   // Convert SCAN.                                                                                                   004337
 004338   //-------------------------------------------------------------------------------------------                      004338
 004339   BegSr subUserCvt_SCAN;                                                                                             004339
 004340                                                                                                                      004340
 004341      // Determine length of comparator.                                                                              004341
 004342      x = %scan(':':factor1);                                                                                         004342
 004343      If x = 0;   // No length specified.                                                        B01                  004343
 004344         scanLength = *Blanks;               // Scan length                                       01                  004344
 004345         scanString = %trim(factor1);        // Scan string                                       01                  004345
 004346      Else;                                                                                      X01                  004346
 004347         scanLength = %subst(factor1:x+1);   // Scan length                                       01                  004347
 004348         scanString = %subst(factor1:1:x-1); // Scan string                                       01                  004348
 004349      EndIf;                                                                                     E01                  004349
 004350                                                                                                                      004350
 004351      // Determine starting point.                                                                                    004351
 004352      x = %scan(':':factor2);                                                                                         004352
 004353      If x = 0;   // No start specified.                                                         B01                  004353
 004354         scanStart = '1';                    // Start position                                    01                  004354
 004355         scanBase = %trim(factor2);          // Base string                                       01                  004355
 004356      Else;                                                                                      X01                  004356
 004357         scanStart = %subst(factor2:x+1);    // Start position                                    01                  004357
 004358         scanBase = %subst(factor2:1:x-1);   // Base string                                       01                  004358
 004359      EndIf;                                                                                     E01                  004359
 004360                                                                                                                      004360
 004361      // Build the new line.                                                                                          004361
 004362      If scanLength = *Blanks;                                                                   B01                  004362
 004363         // No length specified.                                                                                      004363
 004364         sourceLine = '%scan(' + %trim(scanString)                                                01                  004364
 004365                    + ':' + %trim(scanBase) + ':' + %trim(scanStart)                              01                  004365
 004366                    + ')';                                                                        01                  004366
 004367      Else;                                                                                      X01                  004367
 004368         // Use a subset of the scan string.                                                                          004368
 004369         sourceLine = '%scan(%subst('                                                             01                  004369
 004370                    + %trim(scanString) + ':1:' + %trim(scanLength)                               01                  004370
 004371                    + '):' + %trim(scanBase) + ':' + %trim(scanStart)                             01                  004371
 004372                    + ')';                                                                        01                  004372
 004373      EndIf;                                                                                     E01                  004373
 004374                                                                                                                      004374
 004375      // Result specified?                                                                                            004375
 004376      If result = *Blanks;                                                                       B01                  004376
 004377         scanNoResult = *On;                                                                      01                  004377
 004378         sourceLine = 'If ' + %trimr(sourceLine) + ' = 0;';                                       01                  004378
 004379      Else;                                                                                      X01                  004379
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    135
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004380         scanNoResult = *Off;                                                                     01                  004380
 004381         sourceLine = %trim(result) + ' = ' + %trimr(sourceLine) + ';';                           01                  004381
 004382      EndIf;                                                                                     E01                  004382
 004383                                                                                                                      004383
 004384      // Set resulting indicators?                                                                                    004384
 004385      If lw <> *Blanks;                                                                          B01                  004385
 004386         ERRCheck = *On;                                                                          01                  004386
 004387         ERRInd = lw;                                                                             01                  004387
 004388      EndIf;                                                                                     E01                  004388
 004389      If eq <> *Blanks;                                                                          B01                  004389
 004390         foundCheck = *On;                                                                        01                  004390
 004391         foundInd = eq;                                                                           01                  004391
 004392      EndIf;                                                                                     E01                  004392
 004393                                                                                                                      004393
 004394      convert = *On;                                                                                                  004394
 004395                                                                                                                      004395
 004396   EndSr;                                                                                                             004396
 004397   //-------------------------------------------------------------------------------------------                      004397
 004398                                                                                                                      004398
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    136
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004400   //-------------------------------------------------------------------------------------------                      004400
 004401   // Convert SELECT                                                                                                  004401
 004402   //-------------------------------------------------------------------------------------------                      004402
 004403   BegSr subUserCvt_SELECT;                                                                                           004403
 004404                                                                                                                      004404
 004405      sourceLine = 'Select;';                                                                                         004405
 004406                                                                                                                      004406
 004407      convert = *On;                                                                                                  004407
 004408                                                                                                                      004408
 004409   EndSr;                                                                                                             004409
 004410   //-------------------------------------------------------------------------------------------                      004410
 004411                                                                                                                      004411
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    137
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004413   //-------------------------------------------------------------------------------------------                      004413
 004414   // Convert SETOFF                                                                                                  004414
 004415   //-------------------------------------------------------------------------------------------                      004415
 004416   BegSr subUserCvt_SETOFF;                                                                                           004416
 004417                                                                                                                      004417
 004418      setOff = *On;                                                                                                   004418
 004419      setOffInd1 = hi;                                                                                                004419
 004420      setOffInd2 = lw;                                                                                                004420
 004421      setOffInd3 = eq;                                                                                                004421
 004422                                                                                                                      004422
 004423      dropLine = *On;                                                                                                 004423
 004424                                                                                                                      004424
 004425      convert = *On;                                                                                                  004425
 004426                                                                                                                      004426
 004427   EndSr;                                                                                                             004427
 004428   //-------------------------------------------------------------------------------------------                      004428
 004429                                                                                                                      004429
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    138
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004431   //-------------------------------------------------------------------------------------------                      004431
 004432   // Convert SETON                                                                                                   004432
 004433   //-------------------------------------------------------------------------------------------                      004433
 004434   BegSr subUserCvt_SETON;                                                                                            004434
 004435                                                                                                                      004435
 004436      setOn = *On;                                                                                                    004436
 004437      setOnInd1 = hi;                                                                                                 004437
 004438      setOnInd2 = lw;                                                                                                 004438
 004439      setOnInd3 = eq;                                                                                                 004439
 004440                                                                                                                      004440
 004441      dropLine = *On;                                                                                                 004441
 004442                                                                                                                      004442
 004443      convert = *On;                                                                                                  004443
 004444                                                                                                                      004444
 004445   EndSr;                                                                                                             004445
 004446   //-------------------------------------------------------------------------------------------                      004446
 004447                                                                                                                      004447
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    139
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004449   //-------------------------------------------------------------------------------------------                      004449
 004450   // Convert SETxx.                                                                                                  004450
 004451   //-------------------------------------------------------------------------------------------                      004451
 004452   BegSr subUserCvt_SETxx;                                                                                            004452
 004453                                                                                                                      004453
 004454      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004454
 004455                 + %trim(factor2);                                                                                    004455
 004456      If result <> *Blanks;                                                                      B01                  004456
 004457         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004457
 004458      Else;                                                                                      X01                  004458
 004459         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004459
 004460      EndIf;                                                                                     E01                  004460
 004461                                                                                                                      004461
 004462      // Check resulting indicators.                                                                                  004462
 004463      If hi <> *Blanks;                                                                          B01                  004463
 004464         NRFCheck = *On;                                                                          01                  004464
 004465         NRFInd = hi;                                                                             01                  004465
 004466         NRFFile = %trim(factor2);                                                                01                  004466
 004467      EndIf;                                                                                     E01                  004467
 004468      If eq <> *Blanks;                                                                          B01                  004468
 004469         equalCheck = *On;                                                                        01                  004469
 004470         equalInd = eq;                                                                           01                  004470
 004471      EndIf;                                                                                     E01                  004471
 004472      If lw <> *Blanks;                                                                          B01                  004472
 004473         ERRCheck = *On;                                                                          01                  004473
 004474         ERRInd = lw;                                                                             01                  004474
 004475      EndIf;                                                                                     E01                  004475
 004476                                                                                                                      004476
 004477      convert = *On;                                                                                                  004477
 004478                                                                                                                      004478
 004479   EndSr;                                                                                                             004479
 004480   //-------------------------------------------------------------------------------------------                      004480
 004481                                                                                                                      004481
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    140
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004483   //-------------------------------------------------------------------------------------------                      004483
 004484   // Convert SHTDN                                                                                                   004484
 004485   //-------------------------------------------------------------------------------------------                      004485
 004486   BegSr subUserCvt_SHTDN;                                                                                            004486
 004487                                                                                                                      004487
 004488      sourceLine = '*IN' + hi + ' = %shtdn();';                                                                       004488
 004489                                                                                                                      004489
 004490      convert = *On;                                                                                                  004490
 004491                                                                                                                      004491
 004492   EndSr;                                                                                                             004492
 004493   //-------------------------------------------------------------------------------------------                      004493
 004494                                                                                                                      004494
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    141
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004496   //-------------------------------------------------------------------------------------------                      004496
 004497   // Convert SORTA.                                                                                                  004497
 004498   //-------------------------------------------------------------------------------------------                      004498
 004499   BegSr subUserCvt_SORTA;                                                                                            004499
 004500                                                                                                                      004500
 004501      sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                                                         004501
 004502                                                                                                                      004502
 004503      sourceLine = %trim(sourceLine)  + ';';                                                                          004503
 004504                                                                                                                      004504
 004505      convert = *On;                                                                                                  004505
 004506                                                                                                                      004506
 004507   EndSr;                                                                                                             004507
 004508   //-------------------------------------------------------------------------------------------                      004508
 004509                                                                                                                      004509
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    142
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004511   //-------------------------------------------------------------------------------------------                      004511
 004512   // Convert SQRT.                                                                                                   004512
 004513   //-------------------------------------------------------------------------------------------                      004513
 004514   BegSr subUserCvt_SQRT;                                                                                             004514
 004515                                                                                                                      004515
 004516      sourceLine = %trim(result) + ' = %sqrt(' + %trim(factor2) + ');';                                               004516
 004517                                                                                                                      004517
 004518      convert = *On;                                                                                                  004518
 004519                                                                                                                      004519
 004520   EndSr;                                                                                                             004520
 004521   //-------------------------------------------------------------------------------------------                      004521
 004522                                                                                                                      004522
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    143
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004524   //-------------------------------------------------------------------------------------------                      004524
 004525   // Convert SUB.                                                                                                    004525
 004526   //-------------------------------------------------------------------------------------------                      004526
 004527   BegSr subUserCvt_SUB;                                                                                              004527
 004528                                                                                                                      004528
 004529      // Half-adjust?                                                                                                 004529
 004530      x = %scan('H':operator:4);                                                                                      004530
 004531      If x > 0;                                                                                  B01                  004531
 004532         operator = 'SUB';                                                                        01                  004532
 004533         sourceLine = 'Eval(H)';                                                                  01                  004533
 004534      Else;                                                                                      X01                  004534
 004535         sourceLine = *Blanks;                                                                    01                  004535
 004536      EndIf;                                                                                     E01                  004536
 004537                                                                                                                      004537
 004538      If factor1 = *Blanks;                                                                      B01                  004538
 004539         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004539
 004540                    + ' = ' + %trim(result)                                                       01                  004540
 004541                    + ' - ' + %trim(factor2) +';';                                                01                  004541
 004542      Else;                                                                                      X01                  004542
 004543         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004543
 004544                    + ' = ' + %trim(factor1)                                                      01                  004544
 004545                    + ' - ' + %trim(factor2) + ';';                                               01                  004545
 004546      EndIf;                                                                                     E01                  004546
 004547                                                                                                                      004547
 004548      sourceLine = %trim(sourceLine);                                                                                 004548
 004549                                                                                                                      004549
 004550      convert = *On;                                                                                                  004550
 004551                                                                                                                      004551
 004552   EndSr;                                                                                                             004552
 004553   //-------------------------------------------------------------------------------------------                      004553
 004554                                                                                                                      004554
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    144
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004556   //-------------------------------------------------------------------------------------------                      004556
 004557   // Convert SUBDUR.                                                                                                 004557
 004558   //-------------------------------------------------------------------------------------------                      004558
 004559   BegSr subUserCvt_SUBDUR;                                                                                           004559
 004560                                                                                                                      004560
 004561      // Split out duration and code.                                                                                 004561
 004562      x = %scan(':':factor2);                                                                                         004562
 004563      If x = 0;                                                                                  B01                  004563
 004564         x = %scan(':':result);                                                                   01                  004564
 004565         If x = 0;                                                                               B02                  004565
 004566            nonConvRsn =  'No duration code specified.';                                          02                  004566
 004567            LeaveSr;                                                                              02                  004567
 004568         Else;                                                                                   X02                  004568
 004569            durNewDate = *Off;                                                                    02                  004569
 004570         EndIf;                                                                                  E02                  004570
 004571      Else;                                                                                      X01                  004571
 004572         durNewDate = *On;                                                                        01                  004572
 004573      EndIf;                                                                                     E01                  004573
 004574                                                                                                                      004574
 004575      If durNewDate;                                                                             B01                  004575
 004576         durDuration = %trim(%subst(factor2:1:x-1));                                              01                  004576
 004577         durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                  01                  004577
 004578                                                                                                                      004578
 004579         Select;                                                                                 B02                  004579
 004580            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004580
 004581               durCode = '%years';                                                                02                  004581
 004582            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004582
 004583               durCode = '%months';                                                               02                  004583
 004584            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004584
 004585               durCode = '%days';                                                                 02                  004585
 004586            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004586
 004587               durCode = '%hours';                                                                02                  004587
 004588            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004588
 004589               durCode = '%minutes';                                                              02                  004589
 004590            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004590
 004591               durCode = '%seconds';                                                              02                  004591
 004592            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004592
 004593               durCode = '%mseconds';                                                             02                  004593
 004594            Other;                                                                               X02                  004594
 004595               nonConvRsn = 'Invalid duration code specified.';                                   02                  004595
 004596               LeaveSr;                                                                           02                  004596
 004597         EndSl;                                                                                  E02                  004597
 004598                                                                                                                      004598
 004599         If factor1 = *Blanks;                                                                   B02                  004599
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    145
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004600            sourceLine = %trim(result) + ' = ' + %trim(result);                                   02                  004600
 004601         Else;                                                                                   X02                  004601
 004602            sourceLine = %trim(result) + ' = ' + %trim(factor1);                                  02                  004602
 004603         EndIf;                                                                                  E02                  004603
 004604                                                                                                                      004604
 004605         sourceLine = %trimr(sourceLine) + ' - ' + %trim(durCode)                                 01                  004605
 004606                    + '(' + %trim(durDuration) + ');';                                            01                  004606
 004607      Else;                                                                                      X01                  004607
 004608         durDuration = %trim(%subst(result:1:x-1));                                               01                  004608
 004609         durCode     = %xlate(lo:up:%trim(%subst(result:x+1)));                                   01                  004609
 004610                                                                                                                      004610
 004611         Select;                                                                                 B02                  004611
 004612            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004612
 004613            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004613
 004614            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004614
 004615            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004615
 004616            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004616
 004617            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004617
 004618            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004618
 004619            Other;                                                                               X02                  004619
 004620               nonConvRsn = 'Invalid duration code specified.';                                   02                  004620
 004621               LeaveSr;                                                                           02                  004621
 004622         EndSl;                                                                                  E02                  004622
 004623                                                                                                                      004623
 004624         sourceLine = %trim(durDuration) + ' = %diff(' + %trim(factor1)                           01                  004624
 004625                    + ':' + %trim(factor2) + ':' + %trim(durCode) + ');';                         01                  004625
 004626      EndIf;                                                                                     E01                  004626
 004627                                                                                                                      004627
 004628      // Set resulting indicators?                                                                                    004628
 004629      If lw <> *Blanks;                                                                          B01                  004629
 004630         ERRCheck = *On;                                                                          01                  004630
 004631         ERRInd = lw;                                                                             01                  004631
 004632      EndIf;                                                                                     E01                  004632
 004633                                                                                                                      004633
 004634      convert = *On;                                                                                                  004634
 004635                                                                                                                      004635
 004636   EndSr;                                                                                                             004636
 004637   //-------------------------------------------------------------------------------------------                      004637
 004638                                                                                                                      004638
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    146
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004640   //-------------------------------------------------------------------------------------------                      004640
 004641   // Convert SUBST.                                                                                                  004641
 004642   //-------------------------------------------------------------------------------------------                      004642
 004643   BegSr subUserCvt_SUBST;                                                                                            004643
 004644                                                                                                                      004644
 004645      // Pad the result?                                                                                              004645
 004646      x = %scan('P':operator:4);                                                                                      004646
 004647      If x = 0                                              // Not padding.                      B01                  004647
 004648      and factor1 <> *Blanks                                // Factor1 specified.                B01                  004648
 004649      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  004649
 004650         nonConvRsn = 'No padding specified, and factor1 and result '                             01                  004650
 004651                    + 'are not the same.';                                                        01                  004651
 004652         LeaveSr;    // Don't convert - too difficult to get right.                               01                  004652
 004653      EndIf;                                                                                     E01                  004653
 004654                                                                                                                      004654
 004655      substLen = %trim(factor1);                                                                                      004655
 004656                                                                                                                      004656
 004657      x = %scan(':':factor2);                                                                                         004657
 004658      If x = 0;                                                                                  B01                  004658
 004659         substStart = '1';                                                                        01                  004659
 004660         x = %len(%trim(factor2)) + 1;                                                            01                  004660
 004661      Else;                                                                                      X01                  004661
 004662         substStart = %subst(factor2:x+1);                                                        01                  004662
 004663      EndIf;                                                                                     E01                  004663
 004664                                                                                                                      004664
 004665      sourceLine = %trim(result) + ' = %subst('                                                                       004665
 004666                 + %subst(factor2:1:x-1) + ':'                                                                        004666
 004667                 + %trim(substStart)                                                                                  004667
 004668                 + ':' + %trim(substLen) + ');';                                                                      004668
 004669                                                                                                                      004669
 004670      // Set resulting indicators?                                                                                    004670
 004671      If lw <> *Blanks;                                                                          B01                  004671
 004672         ERRCheck = *On;                                                                          01                  004672
 004673         ERRInd = lw;                                                                             01                  004673
 004674      EndIf;                                                                                     E01                  004674
 004675                                                                                                                      004675
 004676      convert = *On;                                                                                                  004676
 004677                                                                                                                      004677
 004678   EndSr;                                                                                                             004678
 004679   //-------------------------------------------------------------------------------------------                      004679
 004680                                                                                                                      004680
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    147
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004682   //-------------------------------------------------------------------------------------------                      004682
 004683   // Convert TEST.                                                                                                   004683
 004684   //-------------------------------------------------------------------------------------------                      004684
 004685   BegSr subUserCvt_TEST;                                                                                             004685
 004686                                                                                                                      004686
 004687      If operator = 'TEST';                                                                      B01                  004687
 004688         operator = 'Test(E)';                                                                    01                  004688
 004689      EndIf;                                                                                     E01                  004689
 004690                                                                                                                      004690
 004691      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004691
 004692                 + %trim(result) + ';';                                                                               004692
 004693                                                                                                                      004693
 004694      // Set resulting indicators?                                                                                    004694
 004695      If lw <> *Blanks;                                                                          B01                  004695
 004696         ERRCheck = *On;                                                                          01                  004696
 004697         ERRInd = lw;                                                                             01                  004697
 004698      EndIf;                                                                                     E01                  004698
 004699                                                                                                                      004699
 004700      convert = *On;                                                                                                  004700
 004701                                                                                                                      004701
 004702   EndSr;                                                                                                             004702
 004703   //-------------------------------------------------------------------------------------------                      004703
 004704                                                                                                                      004704
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    148
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004706   //-------------------------------------------------------------------------------------------                      004706
 004707   // Convert TIME.                                                                                                   004707
 004708   //-------------------------------------------------------------------------------------------                      004708
 004709   BegSr subUserCvt_TIME;                                                                                             004709
 004710                                                                                                                      004710
 004711      sourceLine = %trim(result) + ' = %time();';                                                                     004711
 004712                                                                                                                      004712
 004713      convert = *On;                                                                                                  004713
 004714                                                                                                                      004714
 004715   EndSr;                                                                                                             004715
 004716   //-------------------------------------------------------------------------------------------                      004716
 004717                                                                                                                      004717
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    149
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004719   //-------------------------------------------------------------------------------------------                      004719
 004720   // Convert UNLOCK.                                                                                                 004720
 004721   //-------------------------------------------------------------------------------------------                      004721
 004722   BegSr subUserCvt_UNLOCK;                                                                                           004722
 004723                                                                                                                      004723
 004724      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004724
 004725                                                                                                                      004725
 004726      // Check indicators?                                                                                            004726
 004727      If lw <> *Blanks;                                                                          B01                  004727
 004728         ERRCheck = *On;                                                                          01                  004728
 004729         ERRInd = lw;                                                                             01                  004729
 004730      EndIf;                                                                                     E01                  004730
 004731                                                                                                                      004731
 004732      convert = *On;                                                                                                  004732
 004733                                                                                                                      004733
 004734   EndSr;                                                                                                             004734
 004735   //-------------------------------------------------------------------------------------------                      004735
 004736                                                                                                                      004736
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    150
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004738   //-------------------------------------------------------------------------------------------                      004738
 004739   // Convert UPDATE.                                                                                                 004739
 004740   //-------------------------------------------------------------------------------------------                      004740
 004741   BegSr subUserCvt_UPDATE;                                                                                           004741
 004742                                                                                                                      004742
 004743      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004743
 004744                                                                                                                      004744
 004745      // Append datastructure?                                                                                        004745
 004746      If result <> *Blanks;                                                                      B01                  004746
 004747         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004747
 004748      Else;                                                                                      X01                  004748
 004749         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004749
 004750      EndIf;                                                                                     E01                  004750
 004751                                                                                                                      004751
 004752      // Check indicators?                                                                                            004752
 004753      If lw <> *Blanks;                                                                          B01                  004753
 004754         ERRCheck = *On;                                                                          01                  004754
 004755         ERRInd = lw;                                                                             01                  004755
 004756      EndIf;                                                                                     E01                  004756
 004757                                                                                                                      004757
 004758      convert = *On;                                                                                                  004758
 004759                                                                                                                      004759
 004760   EndSr;                                                                                                             004760
 004761   //-------------------------------------------------------------------------------------------                      004761
 004762                                                                                                                      004762
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    151
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004764   //-------------------------------------------------------------------------------------------                      004764
 004765   // Convert WHEN.                                                                                                   004765
 004766   //-------------------------------------------------------------------------------------------                      004766
 004767   BegSr subUserCvt_WHEN;                                                                                             004767
 004768                                                                                                                      004768
 004769      // Returning for a multi-line IF?  Reinstate original opcode.                                                   004769
 004770      If inWhen;                                                                                 B01                  004770
 004771         operator = whenOperator;                                                                 01                  004771
 004772      EndIf;                                                                                     E01                  004772
 004773                                                                                                                      004773
 004774      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              004774
 004775                                                                                                                      004775
 004776      If operator = 'WHEN';     // Use Extended Factor2.                                         B01                  004776
 004777         If not inWhen;            // First line of IF.                                          B02                  004777
 004778            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  004778
 004779            If not inSpan;                                                                       B03                  004779
 004780               sourceLine = %trim(sourceLine) + ';';                                              03                  004780
 004781            Else;                                                                                X03                  004781
 004782               inWhen = *On;                                                                      03                  004782
 004783               inSpan = *Off;                                                                     03                  004783
 004784            EndIf;                                                                               E03                  004784
 004785         Else;                   // Second line of WHEN.                                         X02                  004785
 004786            //            sourceLine = *Blanks;                                                                       004786
 004787            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  004787
 004788            sourceLine = %trim(extFactor2);                                                       02                  004788
 004789            If not inSpan;                                                                       B03                  004789
 004790               sourceLine = %trimr(sourceLine) + ';';                                             03                  004790
 004791               //               inWhen = *Off;                                                                        004791
 004792            EndIf;                                                                               E03                  004792
 004793            inSpan = *Off;                                                                        02                  004793
 004794         EndIf;                                                                                  E02                  004794
 004795      Else;                                                                                      X01                  004795
 004796         // Fixed format.                                                                                             004796
 004797         opCode = %xlate(lo:up:opCode);                                                           01                  004797
 004798         If not inWhen;         // First line of WHEN.                                           B02                  004798
 004799            whenCompare = %subst(opCode:5:2);                                                     02                  004799
 004800            sourceLine = 'When';                                                                  02                  004800
 004801         Else;                // Second line of WHEN.                                            X02                  004801
 004802            If %subst(opCode:1:3) = 'AND';                                                       B03                  004802
 004803               whenCompare = %subst(opCode:4:2);                                                  03                  004803
 004804               sourceLine = 'And';                                                                03                  004804
 004805            Else;                                                                                X03                  004805
 004806               whenCompare = %subst(opCode:3:2);                                                  03                  004806
 004807               sourceLine = 'Or';                                                                 03                  004807
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    152
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004808            EndIf;                                                                               E03                  004808
 004809         EndIf;                                                                                  E02                  004809
 004810         If whenCompare = 'EQ';                                                                  B02                  004810
 004811            whenCompare = '=';                                                                    02                  004811
 004812         ElseIf whenCompare = 'GT';                                                              X02                  004812
 004813            whenCompare = '>';                                                                    02                  004813
 004814         ElseIf whenCompare = 'GE';                                                              X02                  004814
 004815            whenCompare = '>=';                                                                   02                  004815
 004816         ElseIf whenCompare = 'LT';                                                              X02                  004816
 004817            whenCompare = '<';                                                                    02                  004817
 004818         ElseIf whenCompare = 'LE';                                                              X02                  004818
 004819            whenCompare = '<=';                                                                   02                  004819
 004820         ElseIf whenCompare = 'NE';                                                              X02                  004820
 004821            whenCompare = '<>';                                                                   02                  004821
 004822         EndIf;                                                                                  E02                  004822
 004823         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  004823
 004824                            + ' ' + %trim(whenCompare) + ' '                                      01                  004824
 004825                            + %trim(factor2);                                                     01                  004825
 004826         If not inSpan;                                                                          B02                  004826
 004827            sourceLine = %trimr(sourceLine) + ';';                                                02                  004827
 004828            inWhen = *Off;                                                                        02                  004828
 004829         Else;                                                                                   X02                  004829
 004830            inWhen = *On;                                                                         02                  004830
 004831            inSpan = *Off;                                                                        02                  004831
 004832         EndIf;                                                                                  E02                  004832
 004833      EndIf;                                                                                     E01                  004833
 004834                                                                                                                      004834
 004835      // Multi-line IF?  Retain original opcode.                                                                      004835
 004836      If inWhen;                                                                                 B01                  004836
 004837         whenOperator = operator;                                                                 01                  004837
 004838      Else;                                                                                      X01                  004838
 004839         whenOperator = *Blanks;                                                                  01                  004839
 004840      EndIf;                                                                                     E01                  004840
 004841                                                                                                                      004841
 004842      convert = *On;                                                                                                  004842
 004843                                                                                                                      004843
 004844   EndSr;                                                                                                             004844
 004845   //-------------------------------------------------------------------------------------------                      004845
 004846                                                                                                                      004846
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    153
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004848   //-------------------------------------------------------------------------------------------                      004848
 004849   // Convert WRITE.                                                                                                  004849
 004850   //-------------------------------------------------------------------------------------------                      004850
 004851   BegSr subUserCvt_WRITE;                                                                                            004851
 004852                                                                                                                      004852
 004853      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004853
 004854                                                                                                                      004854
 004855      // Append datastructure?                                                                                        004855
 004856      If result <> *Blanks;                                                                      B01                  004856
 004857         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004857
 004858      Else;                                                                                      X01                  004858
 004859         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004859
 004860      EndIf;                                                                                     E01                  004860
 004861                                                                                                                      004861
 004862      // Check indicators?                                                                                            004862
 004863      If eq <> *Blanks;                                                                          B01                  004863
 004864         EOFCheck = *On;                                                                          01                  004864
 004865         EOFInd = eq;                                                                             01                  004865
 004866         EOFFile = %trim(factor2);                                                                01                  004866
 004867      EndIf;                                                                                     E01                  004867
 004868      If lw <> *Blanks;                                                                          B01                  004868
 004869         ERRCheck = *On;                                                                          01                  004869
 004870         ERRInd = lw;                                                                             01                  004870
 004871      EndIf;                                                                                     E01                  004871
 004872                                                                                                                      004872
 004873      convert = *On;                                                                                                  004873
 004874                                                                                                                      004874
 004875   EndSr;                                                                                                             004875
 004876   //-------------------------------------------------------------------------------------------                      004876
 004877                                                                                                                      004877
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    154
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004879   //-------------------------------------------------------------------------------------------                      004879
 004880   // Convert XFOOT.                                                                                                  004880
 004881   //-------------------------------------------------------------------------------------------                      004881
 004882   BegSr subUserCvt_XFOOT;                                                                                            004882
 004883                                                                                                                      004883
 004884      If %scan('H':operator) = 0;                                                                B01                  004884
 004885         sourceLine = %trim(result) + ' = %xfoot(' + %trim(factor2)                               01                  004885
 004886                    + ');';                                                                       01                  004886
 004887      Else;                                                                                      X01                  004887
 004888         // Half-adjust.                                                                                              004888
 004889         sourceLine = 'Eval(H) ' + %trim(result) + ' = %xfoot('                                   01                  004889
 004890                    + %trim(factor2) + ');';                                                      01                  004890
 004891      EndIf;                                                                                     E01                  004891
 004892                                                                                                                      004892
 004893      convert = *On;                                                                                                  004893
 004894                                                                                                                      004894
 004895   EndSr;                                                                                                             004895
 004896   //-------------------------------------------------------------------------------------------                      004896
 004897                                                                                                                      004897
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    155
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004899   //-------------------------------------------------------------------------------------------                      004899
 004900   // Convert XLATE.                                                                                                  004900
 004901   //-------------------------------------------------------------------------------------------                      004901
 004902   BegSr subUserCvt_XLATE;                                                                                            004902
 004903                                                                                                                      004903
 004904      //      // Pad the result?                                                                                      004904
 004905      //      x = %scan('P':operator:6);                                                                              004905
 004906      //      If x > 0;                                                                                               004906
 004907      //         padResult = *On;                                                                                     004907
 004908      //         padTarget = result;                                                                                  004908
 004909      //         // Drop the extender.                                                                                004909
 004910      //         operator = 'XLATE';                                                                                  004910
 004911      //      EndIf;                                                                                                  004911
 004912                                                                                                                      004912
 004913      // Derive from and to.                                                                                          004913
 004914      x = %scan(':':factor1);                                                                                         004914
 004915      If x = 0;                                                                                  B01                  004915
 004916         LeaveSr;    // Invalid specification - there MUST be a from and to - don't convert.      01                  004916
 004917      Else;                                                                                      X01                  004917
 004918         xlateFrom = %subst(factor1:1:x-1);                                                       01                  004918
 004919         xlateTo = %subst(factor1:x+1);                                                           01                  004919
 004920      EndIf;                                                                                     E01                  004920
 004921                                                                                                                      004921
 004922      // Check for start position.                                                                                    004922
 004923      x = %scan(':':factor2);                                                                                         004923
 004924      If x = 0;                                                                                  B01                  004924
 004925         xlateStart = *Blanks;                                                                    01                  004925
 004926         xlateBase = factor2;                                                                     01                  004926
 004927      Else;                                                                                      X01                  004927
 004928         xlateStart = %subst(factor2:x+1);                                                        01                  004928
 004929         xlateBase = %subst(factor2:1:x-1);                                                       01                  004929
 004930      EndIf;                                                                                     E01                  004930
 004931                                                                                                                      004931
 004932      // Build new line.                                                                                              004932
 004933      sourceLine = %trim(result) + ' = %xlate('                                                                       004933
 004934                 + %trim(xlateFrom) + ':' + %trim(xlateTo) + ':'                                                      004934
 004935                 + %trim(xlateBase);                                                                                  004935
 004936      If xlateStart <> *Blanks;                                                                  B01                  004936
 004937         sourceLine = %trimr(sourceLine) + ':' + %trim(xlateStart);                               01                  004937
 004938      EndIf;                                                                                     E01                  004938
 004939      sourceLine = %trimr(sourceLine) + ');';                                                                         004939
 004940                                                                                                                      004940
 004941      // Set resulting indicators?                                                                                    004941
 004942      If lw <> *Blanks;                                                                          B01                  004942
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    156
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004943         ERRCheck = *On;                                                                          01                  004943
 004944         ERRInd = lw;                                                                             01                  004944
 004945      EndIf;                                                                                     E01                  004945
 004946                                                                                                                      004946
 004947      convert = *On;                                                                                                  004947
 004948                                                                                                                      004948
 004949   EndSr;                                                                                                             004949
 004950   //-------------------------------------------------------------------------------------------                      004950
 004951                                                                                                                      004951
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    157
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004953   //-------------------------------------------------------------------------------------------                      004953
 004954   // Convert Z-ADD.                                                                                                  004954
 004955   //-------------------------------------------------------------------------------------------                      004955
 004956   BegSr subUserCvt_Z_ADD;                                                                                            004956
 004957                                                                                                                      004957
 004958      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                                                      004958
 004959                                                                                                                      004959
 004960      // Half-adjust required?                                                                                        004960
 004961      If %len(%trim(operator)) > 5;                                                              B01                  004961
 004962         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004962
 004963      EndIf;                                                                                     E01                  004963
 004964                                                                                                                      004964
 004965      convert = *On;                                                                                                  004965
 004966                                                                                                                      004966
 004967   EndSr;                                                                                                             004967
 004968   //-------------------------------------------------------------------------------------------                      004968
 004969                                                                                                                      004969
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    158
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004971   //-------------------------------------------------------------------------------------------                      004971
 004972   // Convert Z-SUB.                                                                                                  004972
 004973   //-------------------------------------------------------------------------------------------                      004973
 004974   BegSr subUserCvt_Z_SUB;                                                                                            004974
 004975                                                                                                                      004975
 004976                                                                                                                      004976
 004977      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ' * -1;';                                                 004977
 004978                                                                                                                      004978
 004979      // Half-adjust required?                                                                                        004979
 004980      If %len(%trim(operator)) > 5;                                                              B01                  004980
 004981         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004981
 004982      EndIf;                                                                                     E01                  004982
 004983                                                                                                                      004983
 004984      convert = *On;                                                                                                  004984
 004985                                                                                                                      004985
 004986   EndSr;                                                                                                             004986
 004987   //-------------------------------------------------------------------------------------------                      004987
 004988                                                                                                                      004988
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    159
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004990   //-------------------------------------------------------------------------------------------                      004990
 004991   // Check if the next line is a continuation of the current line.                                                   004991
 004992   //-------------------------------------------------------------------------------------------                      004992
 004993   BegSr subUserCheckSpan;                                                                                            004993
 004994                                                                                                                      004994
 004995      inspan = *Off;                                                                                                  004995
 004996      savedSRCDTA = SRCDTA;                                                                                           004996
 004997      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          004997
 004998      x = 0;                                                                                                          004998
 004999                                                                                                                      004999
 005000      // Is the current line a continuation line?                                                                     005000
 005001      If savedLineType = 'D';                                                                    B01                  005001
 005002         If declName <> *Blanks;                                                                 B02                  005002
 005003            If %scan('...':%trim(declOptions)) > 0;                                              B03                  005003
 005004               // Yes - so we must be in a span.                                                                      005004
 005005               inSpan = *On;                                                                      03                  005005
 005006            EndIf;                                                                               E03                  005006
 005007         EndIf;                                                                                  E02                  005007
 005008      EndIf;                                                                                     E01                  005008
 005009                                                                                                                      005009
 005010      If not inSpan;                                                                             B01                  005010
 005011         Read SRCREC;                                                                             01                  005011
 005012         DoW not %eof();                                                                         B02                  005012
 005013            x += 1;     // Keep a track of how many lines we have read.                           02                  005013
 005014                                                                                                                      005014
 005015            lineType = %xlate(lo:up:lineType);                                                    02                  005015
 005016                                                                                                                      005016
 005017            If lineType <> *Blank                                                                B03                  005017
 005018            and lineType <> savedLineType;                                                       B03                  005018
 005019               // Not a spanned line.                                                                                 005019
 005020               Leave;                                                                             03                  005020
 005021                                                                                                                      005021
 005022            ElseIf lineType = 'D'                                                                X03                  005022
 005023            and %subst(directive:1:1) <> '*';                       // D-spec and no comment     X03                  005023
 005024               If declName = *Blanks                                                             B04                  005024
 005025               and declType = *Blanks                                                            B04                  005025
 005026               and declLen = *Blanks                                                             B04                  005026
 005027               and declKeyWords <> *Blanks;                                                      B04                  005027
 005028                  //               and ((declType <> *Blanks and workDeclType = *Blanks)                              005028
 005029                  //                    or (declType <> *Blanks and declType <> workDeclType)                         005029
 005030                  //                    or (declType = *Blanks and declKeyWords <> *Blanks));                         005030
 005031                  inSpan = *On;                                                                   04                  005031
 005032               EndIf;                                                                            E04                  005032
 005033               Leave;                                                                             03                  005033
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    160
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005034                                                                                                                      005034
 005035            ElseIf lineType = 'P'                                                                X03                  005035
 005036            and %subst(directive:1:1) <> '*';                       // P-spec and no comment     X03                  005036
 005037               If declName = *Blanks                                                             B04                  005037
 005038               and (procType <> *Blanks or procKeyWords <> *Blanks);                             B04                  005038
 005039                  inSpan = *On;                                                                   04                  005039
 005040               EndIf;                                                                            E04                  005040
 005041               Leave;                                                                             03                  005041
 005042                                                                                                                      005042
 005043            ElseIf lineType = 'H'                                                                X03                  005043
 005044            and %subst(directive:1:1) = *Blank;                     // H-spec and no comment     X03                  005044
 005045               inSpan = *On;                                                                      03                  005045
 005046               Leave;                                                                             03                  005046
 005047                                                                                                                      005047
 005048            ElseIf lineType = 'C'                                                                X03                  005048
 005049            and %subst(directive:1:1) = *Blank;                      // C-spec and no comment    X03                  005049
 005050               opCode = %xlate(lo:up:opCode);                                                     03                  005050
 005051               If %subst(operator:1:4) = 'EVAL';                                                 B04                  005051
 005052                  If opCode = *Blanks and extFactor2 <> *Blanks;     // EVAL continues.          B05                  005052
 005053                     inSpan = *On;                                                                05                  005053
 005054                  EndIf;                                                                         E05                  005054
 005055                  Leave;                                                                          04                  005055
 005056               ElseIf %subst(operator:1:6) = 'CALLP';                                            X04                  005056
 005057                  If opCode = *Blanks;                               // CALLP continues.         B05                  005057
 005058                     inSpan = *On;                                                                05                  005058
 005059                  EndIf;                                                                         E05                  005059
 005060                  Leave;                                                                          04                  005060
 005061               ElseIf operator = 'IF';                               // IF Continues.            X04                  005061
 005062                  If opCode = *Blanks;                                                           B05                  005062
 005063                     inSpan = *On;                                                                05                  005063
 005064                  EndIf;                                                                         E05                  005064
 005065                  Leave;                                                                          04                  005065
 005066               ElseIf %subst(operator:1:2) = 'IF';                   // IF Continues.            X04                  005066
 005067                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005067
 005068                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005068
 005069                  or opCode = *Blanks;                                                           B05                  005069
 005070                     inSpan = *On;                                                                05                  005070
 005071                  EndIf;                                                                         E05                  005071
 005072                  Leave;                                                                          04                  005072
 005073               ElseIf %subst(operator:1:2) = 'DO';                   // DO Continues.            X04                  005073
 005074                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005074
 005075                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005075
 005076                  or opCode = *Blanks;                                                           B05                  005076
 005077                     inSpan = *On;                                                                05                  005077
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    161
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005078                  EndIf;                                                                         E05                  005078
 005079                  Leave;                                                                          04                  005079
 005080               ElseIf %subst(operator:1:4) = 'WHEN';                 // WHEN Continues.          X04                  005080
 005081                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005081
 005082                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005082
 005083                  or opCode = *Blanks;                                                           B05                  005083
 005084                     inSpan = *On;                                                                05                  005084
 005085                  EndIf;                                                                         E05                  005085
 005086                  Leave;                                                                          04                  005086
 005087               EndIf;                                                                            E04                  005087
 005088                                                                                                                      005088
 005089            ElseIf lineType = 'C'                                                                X03                  005089
 005090            and %subst(directive:1:1) = '+';                        // Embedded SQL              X03                  005090
 005091               inSpan = *On;                                                                      03                  005091
 005092               Leave;                                                                             03                  005092
 005093                                                                                                                      005093
 005094            ElseIf lineType = 'F'                                                                X03                  005094
 005095            and %subst(directive:1:1) <> '*';                       // F-spec and no comment     X03                  005095
 005096               If fileName = *Blanks and fileKeyWords <> *Blanks;                                B04                  005096
 005097                  inSpan = *On;                                                                   04                  005097
 005098               EndIf;                                                                            E04                  005098
 005099               Leave;                                                                             03                  005099
 005100                                                                                                                      005100
 005101            ElseIf %subst(directive:1:1) = '/';          // Directive, so line must end here.    X03                  005101
 005102               Leave;                                                                             03                  005102
 005103               //            ElseIf lineType = ' '                                                                    005103
 005104               //            and opCode <> *Blanks;                                                                   005104
 005105             //               Leave;                                       // Free-format line.                       005105
 005106            EndIf;                                                                               E03                  005106
 005107                                                                                                                      005107
 005108            Read SRCREC;                                                                          02                  005108
 005109         EndDo;                                                                                  E02                  005109
 005110      EndIf;                                                                                     E01                  005110
 005111                                                                                                                      005111
 005112      // End of file breaks the logic!  We need to reposition to the last record before                               005112
 005113      // continuing.                                                                                                  005113
 005114      If %eof(QRPGLESRC);                                                                        B01                  005114
 005115         SetGT *HIVAL SRCREC;                                                                     01                  005115
 005116         ReadP SRCREC;                                                                            01                  005116
 005117      EndIf;                                                                                     E01                  005117
 005118                                                                                                                      005118
 005119      // Return to the previous point.                                                                                005119
 005120      For i = 1 to x;                                                                            B01                  005120
 005121         ReadP SRCREC;                                                                            01                  005121
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    162
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005122      EndFor;                                                                                    E01                  005122
 005123                                                                                                                      005123
 005124      SRCDTA = savedSRCDTA;                                                                                           005124
 005125                                                                                                                      005125
 005126   EndSr;                                                                                                             005126
 005127   //-------------------------------------------------------------------------------------------                      005127
 005128                                                                                                                      005128
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    163
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005130   //-------------------------------------------------------------------------------------------                      005130
 005131   // Get the type of declaration encountered - it may not be on the current line!                                    005131
 005132   //-------------------------------------------------------------------------------------------                      005132
 005133   BegSr subUserGetDeclarationType;                                                                                   005133
 005134                                                                                                                      005134
 005135      // Start with what we've got.                                                                                   005135
 005136      If declSuffix  = ' '                                                                       B01                  005136
 005137      and (declPrefix = ' '                                                                      B01                  005137
 005138      or declPrefix = 'U' or declPrefix = 'S');                                                  B01                  005138
 005139         workDeclType = %xlate(lo:up:declType);                                                   01                  005139
 005140         savedName = %trim(declName);                                                             01                  005140
 005141      Else;                                                                                      X01                  005141
 005142         workDeclType = *Blank;                                                                   01                  005142
 005143         savedName = %trim(%subst(fullLine:1:74));                                                01                  005143
 005144      EndIf;                                                                                     E01                  005144
 005145                                                                                                                      005145
 005146      // If we already have the declaration type, then stop.                                                          005146
 005147      If workDeclType = 'S'                                                                      B01                  005147
 005148      or workDeclType = 'DS'                                                                     B01                  005148
 005149      or workDeclType = 'C'                                                                      B01                  005149
 005150      or workDeclType = 'B'                                                                      B01                  005150
 005151      or workDeclType = 'E'                                                                      B01                  005151
 005152      or workDeclType = 'PR'                                                                     B01                  005152
 005153      or workDeclType = 'PI'                                                                     B01                  005153
 005154      or workDeclType = *Blanks and inPrototype;                                                 B01                  005154
 005155         workDeclLine = SRCSEQ;                                                                   01                  005155
 005156         LeaveSr;                                                                                 01                  005156
 005157      EndIf;                                                                                     E01                  005157
 005158                                                                                                                      005158
 005159      savedSRCDTA = SRCDTA;                                                                                           005159
 005160      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005160
 005161      x = 0;                                                                                                          005161
 005162      workDeclLine = 0;                                                                                               005162
 005163                                                                                                                      005163
 005164      //      // Name of the variable/routine should be on this line.                                                 005164
 005165      //      savedName = %trim(declOptions);                                                                         005165
 005166                                                                                                                      005166
 005167      // Trim any ellipsis from the name as this is not valid in free-form.                                           005167
 005168      x = %scan('...':savedName);                                                                                     005168
 005169      If x > 0;                                                                                  B01                  005169
 005170         savedName = %subst(savedName:1:x-1);                                                     01                  005170
 005171         x = 0;                                                                                   01                  005171
 005172      EndIf;                                                                                     E01                  005172
 005173                                                                                                                      005173
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    164
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005174      // Read ahead to find the next line with a declaration type.                                                    005174
 005175      Read SRCREC;                                                                                                    005175
 005176      DoW not %eof();                                                                            B01                  005176
 005177         x += 1;     // Keep a track of how many lines we have read.                              01                  005177
 005178                                                                                                                      005178
 005179         lineType = %xlate(lo:up:lineType);                                                       01                  005179
 005180                                                                                                                      005180
 005181         If lineType <> savedLineType;                                                           B02                  005181
 005182            // End of this declaration.                                                                               005182
 005183            Leave;                                                                                02                  005183
 005184         EndIf;                                                                                  E02                  005184
 005185                                                                                                                      005185
 005186         If declType <> *Blanks;                                                                 B02                  005186
 005187            workDeclType = %xlate(lo:up:declType);                                                02                  005187
 005188            workDeclLine = SRCSEQ;                                                                02                  005188
 005189            Leave;                                                                                02                  005189
 005190         EndIf;                                                                                  E02                  005190
 005191                                                                                                                      005191
 005192         Read SRCREC;                                                                             01                  005192
 005193      EndDo;                                                                                     E01                  005193
 005194                                                                                                                      005194
 005195      // End of file breaks the logic!  We need to reposition to the last record before                               005195
 005196      // continuing.                                                                                                  005196
 005197      If %eof(QRPGLESRC);                                                                        B01                  005197
 005198         SetGT *HIVAL SRCREC;                                                                     01                  005198
 005199         ReadP SRCREC;                                                                            01                  005199
 005200      EndIf;                                                                                     E01                  005200
 005201                                                                                                                      005201
 005202      // Return to the previous point.                                                                                005202
 005203      For i = 1 to x;                                                                            B01                  005203
 005204         ReadP SRCREC;                                                                            01                  005204
 005205      EndFor;                                                                                    E01                  005205
 005206                                                                                                                      005206
 005207      SRCDTA = savedSRCDTA;                                                                                           005207
 005208                                                                                                                      005208
 005209   EndSr;                                                                                                             005209
 005210   //-------------------------------------------------------------------------------------------                      005210
 005211                                                                                                                      005211
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    165
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005213   //-------------------------------------------------------------------------------------------                      005213
 005214   // Get the line number at which the current structure ends.                                                        005214
 005215   //-------------------------------------------------------------------------------------------                      005215
 005216   BegSr subUserGetEndLine;                                                                                           005216
 005217                                                                                                                      005217
 005218      savedSRCDTA = SRCDTA;                                                                                           005218
 005219      endLine = 0;                                                                                                    005219
 005220      endFound = *Off;                                                                                                005220
 005221                                                                                                                      005221
 005222      // Read ahead to find the start of the next declaration.                                                        005222
 005223      Read SRCREC;                                                                                                    005223
 005224      x = 1;                                                                                                          005224
 005225      DoW not %eof();                                                                            B01                  005225
 005226         If lineType <> *Blanks                                                                  B02                  005226
 005227         and %xlate(lo:up:lineType) <> workLineType;                                             B02                  005227
 005228            // We've found a different line type.                                                                     005228
 005229            Leave;                                                                                02                  005229
 005230         Else;                                                                                   X02                  005230
 005231            If %len(%trim(codeLine)) >= 4;                                                       B03                  005231
 005232               If %xlate(lo:up:%subst(codeLine:1:4)) = 'DCL-';                                   B04                  005232
 005233                  // We've found a different line type.                                                               005233
 005234                  Leave;                                                                          04                  005234
 005235               EndIf;                                                                            E04                  005235
 005236            EndIf;                                                                               E03                  005236
 005237         EndIf;                                                                                  E02                  005237
 005238                                                                                                                      005238
 005239         If codeLine = *Blanks;                                                                  B02                  005239
 005240            // Ignore empty lines.                                                                                    005240
 005241   //      ElseIf %subst(directive:1:1) = '/';                                                                        005241
 005242   //         // Ignore directives.                                                                                   005242
 005243         ElseIf %subst(directive:2:1) = '*'                                                      X02                  005243
 005244             or %len(%trim(codeLine)) >= 2                                                       X02                  005244
 005245            and %subst(%trim(codeLine):1:2) = '//';                                              X02                  005245
 005246            // Ignore comment.                                                                                        005246
 005247         ElseIf inSpan                                                                           X02                  005247
 005248            and declName = *Blanks                                                               X02                  005248
 005249            and SRCSEQ = workDeclLine;                                                           X02                  005249
 005250            // Ignore the curent declaration.                                                                         005250
 005251         ElseIf declType = *Blanks                                                               X02                  005251
 005252            and (declLen <> *Blanks or declKeywords <> *Blanks);                                 X02                  005252
 005253            // Ignore sub-field definition.                                                                           005253
 005254         ElseIf declType = *Blanks                                                               X02                  005254
 005255            and declName <> *Blanks                                                              X02                  005255
 005256            and %scan('...':declOptions) = 0;                                                    X02                  005256
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    166
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005257            // Ignore sub-field definition.                                                                           005257
 005258         ElseIf %scan('...':declOptions) > 0;                                                    X02                  005258
 005259            // We have a continuation line, but is it a sub-field or a new                                            005259
 005260            // delcaration?                                                                                           005260
 005261            GetDeclarationType(tempDeclType                                                       02                  005261
 005262                              :tempSavedName                                                      02                  005262
 005263                              :tempDeclLine);                                                     02                  005263
 005264            If tempDeclType <> *Blanks;                                                          B03                  005264
 005265               // We've hit the next declaration or code.                                                             005265
 005266               Leave;                                                                             03                  005266
 005267            EndIf;                                                                               E03                  005267
 005268         Else;                                                                                   X02                  005268
 005269            // We've hit the next declaration or code.                                                                005269
 005270            Leave;                                                                                02                  005270
 005271         EndIf;                                                                                  E02                  005271
 005272                                                                                                                      005272
 005273         Read SRCREC;                                                                             01                  005273
 005274         x += 1;     // Keep a track of how many lines we have read.                              01                  005274
 005275      EndDo;                                                                                     E01                  005275
 005276                                                                                                                      005276
 005277      // We are now at the start of the next declaration.                                                             005277
 005278      endLine = SRCSEQ;                                                                                               005278
 005279                                                                                                                      005279
 005280      // End of file breaks the logic!  We need to reposition to the last record before                               005280
 005281      // continuing.                                                                                                  005281
 005282      If %eof(QRPGLESRC);                                                                        B01                  005282
 005283         SetGT *HIVAL SRCREC;                                                                     01                  005283
 005284         //ReadP SRCREC;                                                                                              005284
 005285      EndIf;                                                                                     E01                  005285
 005286                                                                                                                      005286
 005287      // Return to the previous point.                                                                                005287
 005288      For i = 1 to x;                                                                            B01                  005288
 005289         ReadP SRCREC;                                                                            01                  005289
 005290                                                                                                                      005290
 005291         // Move the end point for blank lines or comments.                                                           005291
 005292         If not endFound;                                                                        B02                  005292
 005293            If (lineType = *Blanks                                                               B03                  005293
 005294            or %subst(directive:1:1) = '*'                                                       B03                  005294
 005295            or %subst(directive:1:2) = '//'                                                      B03                  005295
 005296            or (%len(%trim(codeLine)) > 0                                                        B03                  005296
 005297            and %subst(%trim(codeLine):1:2) = '//'));                                            B03                  005297
 005298               //            and %subst(directive:1:1) <> '/';                                                        005298
 005299            Else;                                                                                X03                  005299
 005300               endFound = *On;                                                                    03                  005300
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    167
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005301               endLine = SRCSEQ;                                                                  03                  005301
 005302            EndIf;                                                                               E03                  005302
 005303         EndIf;                                                                                  E02                  005303
 005304      EndFor;                                                                                    E01                  005304
 005305                                                                                                                      005305
 005306      SRCDTA = savedSRCDTA;                                                                                           005306
 005307                                                                                                                      005307
 005308   EndSr;                                                                                                             005308
 005309   //-------------------------------------------------------------------------------------------                      005309
 005310                                                                                                                      005310
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    168
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005312   //-------------------------------------------------------------------------------------------                      005312
 005313   // Move field definitions to D-specs.                                                                              005313
 005314   //-------------------------------------------------------------------------------------------                      005314
 005315   BegSr subUserMoveDefs;                                                                                             005315
 005316                                                                                                                      005316
 005317      codeStart = SRCSEQ;   // Save the start of the source.                                                          005317
 005318      savedSRCDTA = SRCDTA;                                                                                           005318
 005319                                                                                                                      005319
 005320      Clear movedDefs;                                                                                                005320
 005321      Reset DCLS;                                                                                                     005321
 005322                                                                                                                      005322
 005323      // Read through the source and create a D-spec for every field definition found.                                005323
 005324      DoW not %eof(QRPGLESRC);                                                                   B01                  005324
 005325         // Stop if we hit either the start or end of a procedure (to preserve local                                  005325
 005326         // definitions of variables).                                                                                005326
 005327         If lineType = 'P'                                                                       B02                  005327
 005328         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005328
 005329                                                      = 'DCL-PROC'                               B02                  005329
 005330         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005330
 005331                                                      = 'END-PROC';                              B02                  005331
 005332            Leave;                                                                                02                  005332
 005333         EndIf;                                                                                  E02                  005333
 005334                                                                                                                      005334
 005335         If %xlate(lo:up:lineType) = 'C'                                                         B02                  005335
 005336         and %subst(directive:1:1) = ' ';                                                        B02                  005336
 005337            opCode = %xlate(lo:up:opCode);                                                        02                  005337
 005338            // C-Spec with a size definition.                                                                         005338
 005339            If opCode <> *Blanks                                                                 B03                  005339
 005340            and %subst(opCode:1:4) <> 'EVAL'                                                     B03                  005340
 005341            and opCode <> 'IF'                                                                   B03                  005341
 005342            and opCode <> 'WHEN'                                                                 B03                  005342
 005343            and opCode <> 'DOW'                                                                  B03                  005343
 005344            and opCode <> 'DOU'                                                                  B03                  005344
 005345            and opCode <> 'DSPLY'                                                                B03                  005345
 005346            and opCode <> 'CALLP'                                                                B03                  005346
 005347            and (len <> *Blanks or opCode = 'DEFINE');                                           B03                  005347
 005348               moveDef = *Off;                                                                    03                  005348
 005349               // Only do if not already moved.                                                                       005349
 005350               If %lookup(%xlate(lo:up:result):movedDefs) = 0;                                   B04                  005350
 005351                  Reset DCLS;                                                                     04                  005351
 005352                  // In-line definition.                                                                              005352
 005353                  If len <> *Blanks                                                              B05                  005353
 005354                  and %scan('+':len) = 0 and %scan('-':len) = 0;                                 B05                  005354
 005355                     moveDef = *On;                                                               05                  005355
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    169
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005356                     DCLS.fieldName = result;                                                     05                  005356
 005357                     If dec = *Blanks;                                                           B06                  005357
 005358                        DCLS.type = '     Char';                                                  06                  005358
 005359                     Else;                                                                       X06                  005359
 005360                        DCLS.type = '   Packed';                                                  06                  005360
 005361                     EndIf;                                                                      E06                  005361
 005362                     DCLS.definition = '(' + %trim(len);                                          05                  005362
 005363                     If dec <> *Blanks;                                                          B06                  005363
 005364                        DCLS.definition = %trimr(DCLS.definition)                                 06                  005364
 005365                                        + ':' + %trim(dec);                                       06                  005365
 005366                     EndIf;                                                                      E06                  005366
 005367                     DCLS.definition = %trimr(DCLS.definition) + ')';                             05                  005367
 005368                  EndIf;                                                                         E05                  005368
 005369                                                                                                                      005369
 005370                  // *LIKE Definition                                                                                 005370
 005371                  If %xlate(lo:up:opCode) = 'DEFINE';                                            B05                  005371
 005372                     moveDef = *On;                                                               05                  005372
 005373                     DCLS.fieldName = result;                                                     05                  005373
 005374                     If %xlate(lo:up:factor1) = '*LIKE';                                         B06                  005374
 005375                        %subst(DCLS.definition:8)                                                 06                  005375
 005376                                    = 'LIKE(' + %trimr(factor2);                                  06                  005376
 005377                        // Length adjustment?                                                                         005377
 005378                        If %scan('+':len) > 0 or %scan('-':len) > 0;                             B07                  005378
 005379                           len = %scanrpl(' ':'':len);                                            07                  005379
 005380                           DCLS.definition = %trimr(DCLS.definition)                              07                  005380
 005381                                           + ':' + %trim(len);                                    07                  005381
 005382                        EndIf;                                                                   E07                  005382
 005383                        DCLS.definition = %trimr(DCLS.definition) + ')';                          06                  005383
 005384                     Else;                                                                       X06                  005384
 005385                        If %xlate(lo:up:%trim(factor2)) = '*LDA';                                B07                  005385
 005386                           DCLS.definition = %trimr(DCLS.definition)                              07                  005386
 005387                                 + ' DTAARA(' + %trimr(factor2) + ')';                            07                  005387
 005388                        Else;                                                                    X07                  005388
 005389                           DCLS.definition = %trimr(DCLS.definition)                              07                  005389
 005390                             + ' DTAARA(''' + %trimr(factor2) + ''')';                            07                  005390
 005391                        EndIf;                                                                   E07                  005391
 005392                     EndIf;                                                                      E06                  005392
 005393                  EndIf;                                                                         E05                  005393
 005394                                                                                                                      005394
 005395                  If moveDef;                                                                    B05                  005395
 005396                     // Put any additional keywords needed here!                                                      005396
 005397                     DCLS.definition = %trimr(DCLS.definition) + ';';                             05                  005397
 005398                     If comment <> *Blanks;                                                      B06                  005398
 005399                        DCLS.comment = '// ' + comment;                                           06                  005399
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    170
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005400                     EndIf;                                                                      E06                  005400
 005401                                                                                                                      005401
 005402                     // Store the moved definition.                                                                   005402
 005403                     x = %lookup(' ':movedDefs);                                                  05                  005403
 005404                     movedDefs(x) = %xlate(lo:up:result);                                         05                  005404
 005405                  EndIf;                                                                         E05                  005405
 005406               EndIf;                                                                            E04                  005406
 005407            EndIf;                                                                               E03                  005407
 005408         EndIf;                                                                                  E02                  005408
 005409                                                                                                                      005409
 005410         // Anything to output?                                                                                       005410
 005411         If DCLS.fieldName <> *Blanks;                                                           B02                  005411
 005412            DCLS.decl = 'Dcl-S ';                                                                 02                  005412
 005413            If not defsMoved;                                                                    B03                  005413
 005414               // Log start of moved field block;                                                                     005414
 005415               SRCDTA = *Blanks;                                                                  03                  005415
 005416               codeLine = Qcomments(1);                                                           03                  005416
 005417               Exsr subUserWriteLine;                                                             03                  005417
 005418               codeLine = Qcomments(2);                                                           03                  005418
 005419               Exsr subUserWriteLine;                                                             03                  005419
 005420               codeLine = Qcomments(1);                                                           03                  005420
 005421               Exsr subUserWriteLine;                                                             03                  005421
 005422               defsMoved = *On;                                                                   03                  005422
 005423            EndIf;                                                                               E03                  005423
 005424                                                                                                                      005424
 005425            lineType = ' ';                                                                       02                  005425
 005426            codeLine = DCLS;                                                                      02                  005426
 005427            countMoved += 1;                                                                      02                  005427
 005428            Clear DCLS.fieldName;                                                                 02                  005428
 005429                                                                                                                      005429
 005430            Exsr subUserWriteLine;                                                                02                  005430
 005431         EndIf;                                                                                  E02                  005431
 005432                                                                                                                      005432
 005433         Read QRPGLESRC;                                                                          01                  005433
 005434      EndDo;                                                                                     E01                  005434
 005435                                                                                                                      005435
 005436      If defsMoved;                                                                              B01                  005436
 005437         // Log end of moved field block;                                                                             005437
 005438         SRCDTA = *Blanks;                                                                        01                  005438
 005439         codeLine = Qcomments(1);                                                                 01                  005439
 005440         Exsr subUserWriteLine;                                                                   01                  005440
 005441         codeLine = Qcomments(3);                                                                 01                  005441
 005442         Exsr subUserWriteLine;                                                                   01                  005442
 005443         codeLine = Qcomments(1);                                                                 01                  005443
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    171
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005444         Exsr subUserWriteLine;                                                                   01                  005444
 005445      EndIf;                                                                                     E01                  005445
 005446                                                                                                                      005446
 005447      // Reposition source file pointer to the start of the source again.                                             005447
 005448      Close QRPGLESRC;                                                                                                005448
 005449      Open QRPGLESRC;                                                                                                 005449
 005450      Read SRCREC;                                                                                                    005450
 005451      DoW SRCSEQ <> codeStart;                                                                   B01                  005451
 005452         Read SRCREC;                                                                             01                  005452
 005453      EndDo;                                                                                     E01                  005453
 005454                                                                                                                      005454
 005455      defsMoved = *On;                                                                                                005455
 005456      SRCDTA = savedSRCDTA;                                                                                           005456
 005457                                                                                                                      005457
 005458   EndSr;                                                                                                             005458
 005459   //-------------------------------------------------------------------------------------------                      005459
 005460                                                                                                                      005460
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    172
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005462   //-------------------------------------------------------------------------------------------                      005462
 005463   // Output the current line.                                                                                        005463
 005464   //-------------------------------------------------------------------------------------------                      005464
 005465   BegSr subUserWriteLine;                                                                                            005465
 005466                                                                                                                      005466
 005467      countTarget += 1;                                                                                               005467
 005468                                                                                                                      005468
 005469      Write OUTREC;                                                                                                   005469
 005470      //Except OUTREC;                                                                                                005470
 005471                                                                                                                      005471
 005472   EndSr;                                                                                                             005472
 005473   //-------------------------------------------------------------------------------------------                      005473
 005474                                                                                                                      005474
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    173
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005476   //-------------------------------------------------------------------------------------------                      005476
 005477   // Exit the program directly.                                                                                      005477
 005478   //-------------------------------------------------------------------------------------------                      005478
 005479   BegSr subExitProgram;                                                                                              005479
 005480                                                                                                                      005480
 005481      Exsr subUserExitProgram;     // Perform any user-specified exit processing.                                     005481
 005482                                                                                                                      005482
 005483      // If commitment control is active, a commit should have been done if everything                                005483
 005484      // was OK, so issue a rollback here to catch and remove any uncommitted changes.                                005484
 005485      If cfgCommitControl = '*MASTER';                                                           B01                  005485
 005486         RolBk;                                                                                   01                  005486
 005487      EndIf;                                                                                     E01                  005487
 005488                                                                                                                      005488
 005489      If cfgCloseDown = 'Y';                                                                     B01                  005489
 005490         *INLR = *On;                  // Close down the program.                                 01                  005490
 005491      EndIf;                                                                                     E01                  005491
 005492                                                                                                                      005492
 005493      Return;                          // Exit the program.                                                           005493
 005494                                                                                                                      005494
 005495   EndSr;                                                                                                             005495
 005496   //-------------------------------------------------------------------------------------------                      005496
 005497                                                                                                                      005497
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    174
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005499   //-------------------------------------------------------------------------------------------                      005499
 005500   // USER: Exit processing.                                                                                          005500
 005501   //-------------------------------------------------------------------------------------------                      005501
 005502   BegSr subUserExitProgram;                                                                                          005502
 005503                                                                                                                      005503
 005504      // ** Place any program-specific exit code here.                                                                005504
 005505      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005505
 005506                                                                                                                      005506
 005507      If QpShutDown <> 'Y';                                                                      B01                  005507
 005508         Close QRPGLESRC;                                                                         01                  005508
 005509         Close QRPGLESRC2;                                                                        01                  005509
 005510      EndIf;                                                                                     E01                  005510
 005511                                                                                                                      005511
 005512      If QpShutDown = 'Y' and initialCall <> 'Y';                                                B01                  005512
 005513         cfgCloseDown = 'Y';                                                                      01                  005513
 005514         Write Z1ENDRPT;                                                                          01                  005514
 005515         Close CVTRPGFREP;                                                                        01                  005515
 005516      EndIf;                                                                                     E01                  005516
 005517                                                                                                                      005517
 005518      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005518
 005519                                                                                                                      005519
 005520   EndSr;                                                                                                             005520
 005521   //-------------------------------------------------------------------------------------------                      005521
 005522                                                                                                                      005522
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    175
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005524   //-------------------------------------------------------------------------------------------                      005524
 005525   // Initialisation                                                                                                  005525
 005526   //-------------------------------------------------------------------------------------------                      005526
 005527   BegSr subInitialise;                                                                                               005527
 005528                                                                                                                      005528
 005529      // Flag initial call.                                                                                           005529
 005530      If initialCall = *Blank;                                                                   B01                  005530
 005531         initialCall = 'Y';                                                                       01                  005531
 005532      Else;                                                                                      X01                  005532
 005533         initialCall = 'N';                                                                       01                  005533
 005534      EndIf;                                                                                     E01                  005534
 005535                                                                                                                      005535
 005536      // Perform user-specified intialisation processing.                                                             005536
 005537      Exsr subUserInitialise;                                                                                         005537
 005538                                                                                                                      005538
 005539   EndSr;                                                                                                             005539
 005540   //-------------------------------------------------------------------------------------------                      005540
 005541                                                                                                                      005541
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    176
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005543   //-------------------------------------------------------------------------------------------                      005543
 005544   // USER: Initialisation                                                                                            005544
 005545   //-------------------------------------------------------------------------------------------                      005545
 005546   BegSr subUserInitialise;                                                                                           005546
 005547                                                                                                                      005547
 005548      // Set configuration/processing options:                                                                        005548
 005549      cfgCommitControl   = '*NONE  '; // Commitment control setting: *MASTER/*SLAVE                                   005549
 005550      cfgCloseDown       = 'N';       // Close down the program on exit?                                              005550
 005551                                                                                                                      005551
 005552                                                                                                                      005552
 005553      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005553
 005554                                                                                                                      005554
 005555      // Shut down?                                                                                                   005555
 005556      If QpShutDown = 'Y';                                                                       B01                  005556
 005557         Exsr subExitProgram;                                                                     01                  005557
 005558      EndIf;                                                                                     E01                  005558
 005559                                                                                                                      005559
 005560      // Open audit report.                                                                                           005560
 005561      If initialCall = 'Y';                                                                      B01                  005561
 005562         Open CVTRPGFREP;                                                                         01                  005562
 005563         Z1QTTL = 'RPG/ILE to Free-Format Conversion Report';                                     01                  005563
 005564         overflow = *On;                                                                          01                  005564
 005565      EndIf;                                                                                     E01                  005565
 005566                                                                                                                      005566
 005567      fromFileLib = %trim(QpFromLib) + '/' + %trim(QpFromFile);                                                       005567
 005568      Open QRPGLESRC;                                                                                                 005568
 005569                                                                                                                      005569
 005570      toFileLib = %trim(QpToLib) + '/' + %trim(QpToFile);                                                             005570
 005571      Open QRPGLESRC2;                                                                                                005571
 005572                                                                                                                      005572
 005573      Reset countSource;                                                                                              005573
 005574      Reset countTarget;                                                                                              005574
 005575      Reset countEligible;                                                                                            005575
 005576      Reset countConv;                                                                                                005576
 005577      Reset CountNotConv;                                                                                             005577
 005578                                                                                                                      005578
 005579      Reset maxIndent;                                                                                                005579
 005580      Reset movedDefs;                                                                                                005580
 005581      Reset moveDef;                                                                                                  005581
 005582      Reset inCode;                                                                                                   005582
 005583      Reset inArrayData;                                                                                              005583
 005584      Reset indentCount;                                                                                              005584
 005585                                                                                                                      005585
 005586      indentCount = mainlineIndent;                                                                                   005586
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    177
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005587                                                                                                                      005587
 005588      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005588
 005589                                                                                                                      005589
 005590   EndSr;                                                                                                             005590
 005591   //-------------------------------------------------------------------------------------------                      005591
 005592   //===========================================================================================                      005592
 005593                                                                                                                      005593
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    178
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005595   //==========================================================================================                       005595
 005596   // Get the type of declaration encountered - it may not be on the current line!                                    005596
 005597   //==========================================================================================                       005597
 000001=OOUTREC                                                                                                             2000001
         *--------------------------------------------------------------------------------------------*                     2
         * RPG record format  . . . . :  OUTREC                                                       *                     2
         * External format  . . . . . :  QRPGLESRC2 : CVTRPGFREE/QRPGLESRC2                           *                     2
         *--------------------------------------------------------------------------------------------*                     2
 000002=O                       SRCSEQ               6S ZONE      6,2                                                       2000002
 000003=O                       SRCDAT              12S ZONE      6,0                                                       2000003
 000004=O                       SRCDTA             112A CHAR      100                                                       2000004
 000001=OZ1PAGHDG                                                                                                           3000001
         *--------------------------------------------------------------------------------------------*                     3
         * RPG record format  . . . . :  Z1PAGHDG                                                     *                     3
         * External format  . . . . . :  Z1PAGHDG : CVTRPGFREE/CVTRPGFREP                             *                     3
         *--------------------------------------------------------------------------------------------*                     3
 000002=O                       Z1QPGM              10A CHAR       10                                                       3000002
 000003=O                       Z1QUSR              20A CHAR       10                                                       3000003
 000004=O                       Z1QTTL              60A CHAR       40                                                       3000004
 000005=O                       Z1QPAG              64S ZONE      4,0                                                       3000005
 000001=OZ1TOPPAG                                                                                                           4000001
         *--------------------------------------------------------------------------------------------*                     4
         * RPG record format  . . . . :  Z1TOPPAG                                                     *                     4
         * External format  . . . . . :  Z1TOPPAG : CVTRPGFREE/CVTRPGFREP                             *                     4
         *--------------------------------------------------------------------------------------------*                     4
 000002=O                       ZTFRFL              21A CHAR       21                                                       4000002
 000003=O                       ZTTOFL              42A CHAR       21                                                       4000003
 000001=OZL01HDG                                                                                                            5000001
         *--------------------------------------------------------------------------------------------*                     5
         * RPG record format  . . . . :  ZL01HDG                                                      *                     5
         * External format  . . . . . :  ZL01HDG : CVTRPGFREE/CVTRPGFREP                              *                     5
         *--------------------------------------------------------------------------------------------*                     5
 000001=OZ1DETAIL                                                                                                           6000001
         *--------------------------------------------------------------------------------------------*                     6
         * RPG record format  . . . . :  Z1DETAIL                                                     *                     6
         * External format  . . . . . :  Z1DETAIL : CVTRPGFREE/CVTRPGFREP                             *                     6
         *--------------------------------------------------------------------------------------------*                     6
 000002=O                       Z1FRMB              10A CHAR       10                                                       6000002
 000003=O                       Z1TOMB              20A CHAR       10                                                       6000003
 000004=O                       Z1CTSC              27S ZONE      7,0                                                       6000004
 000005=O                       Z1CTTG              34S ZONE      7,0                                                       6000005
 000006=O                       Z1CTMV              41S ZONE      7,0                                                       6000006
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    179
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000007=O                       Z1CTEL              48S ZONE      7,0                                                       6000007
 000008=O                       Z1CTCV              55S ZONE      7,0                                                       6000008
 000009=O                       Z1CTNV              62S ZONE      7,0                                                       6000009
 000010=O                       Z1CNVR              67S ZONE      5,2                                                       6000010
 000001=OZ1ENDRPT                                                                                                           7000001
         *--------------------------------------------------------------------------------------------*                     7
         * RPG record format  . . . . :  Z1ENDRPT                                                     *                     7
         * External format  . . . . . :  Z1ENDRPT : CVTRPGFREE/CVTRPGFREP                             *                     7
         *--------------------------------------------------------------------------------------------*                     7
 005598   Dcl-Proc GetDeclarationType;                                                                                       005598
 005599                                                                                                                      005599
 005600   // -- Procedure Interface ------------------------------------------------------------------                       005600
 005601   Dcl-PI GetDeclarationType;                                                                                         005601
 005602      QpDeclType               Char( 2 );                                                                             005602
 005603      QpSavedName              Char( 80 );                                                                            005603
 005604      QpDeclLine                        Like(SRCSEQ);                                                                 005604
 005605   End-PI;                                                                                                            005605
 005606                                                                                                                      005606
 005607   // -- Data Structures ----------------------------------------------------------------------                       005607
 005608                                                                                                                      005608
 005609   // -- Variables ----------------------------------------------------------------------------                       005609
 005610   Dcl-S savedLineType        Char(  1 );                                                                             005610
 005611   Dcl-S x                  Packed( 3:0 );                                                                            005611
 005612   Dcl-S savedSRCDTA          Char( 100 );                                                                            005612
 005613                                                                                                                      005613
 005614   //-------------------------------------------------------------------------------------------                      005614
 005615                                                                                                                      005615
 005616      // Start with what we've got.                                                                                   005616
 005617      If ((declExt = ' ' and declPrefix  = ' ')                                                  B01                  005617
 005618      or declPrefix = 'S' or declPrefix = 'U')                                                   B01                  005618
 005619      and declSuffix = ' ';                                                                      B01                  005619
 005620         QpDeclType = %xlate(lo:up:declType);                                                     01                  005620
 005621         QpSavedName = %trim(declName);                                                           01                  005621
 005622      Else;                                                                                      X01                  005622
 005623         QpDeclType = *Blank;                                                                     01                  005623
 005624         QpSavedName = %trim(%subst(fullLine:1:74));                                              01                  005624
 005625      EndIf;                                                                                     E01                  005625
 005626                                                                                                                      005626
 005627      x = %scan(' ':QpSavedName);                                                                                     005627
 005628      If x > 1;                                                                                  B01                  005628
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    180
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005629         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005629
 005630      EndIf;                                                                                     E01                  005630
 005631                                                                                                                      005631
 005632      // If we already have the declaration type, then stop.                                                          005632
 005633      If QpDeclType = 'S'                                                                        B01                  005633
 005634      or QpDeclType = 'DS'                                                                       B01                  005634
 005635      or QpDeclType = 'C'                                                                        B01                  005635
 005636      or QpDeclType = 'B'                                                                        B01                  005636
 005637      or QpDeclType = 'E'                                                                        B01                  005637
 005638      or QpDeclType = 'PR'                                                                       B01                  005638
 005639      or QpDeclType = 'PI'                                                                       B01                  005639
 005640      or QpDeclType = *Blanks and inPrototype;                                                   B01                  005640
 005641         QpDeclLine = SRCSEQ;                                                                     01                  005641
 005642         Return;                                                                                  01                  005642
 005643      EndIf;                                                                                     E01                  005643
 005644                                                                                                                      005644
 005645      savedSRCDTA = SRCDTA;                                                                                           005645
 005646      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005646
 005647      x = 0;                                                                                                          005647
 005648      QpDeclLine = 0;                                                                                                 005648
 005649                                                                                                                      005649
 005650      //   // Name of the variable/routine should be on this line.                                                    005650
 005651      //   savedName = %trim(declOptions);                                                                            005651
 005652                                                                                                                      005652
 005653      // Trim any ellipsis from the name as this is not valid in free-form.                                           005653
 005654      x = %scan('...':QpSavedName);                                                                                   005654
 005655      If x > 0;                                                                                  B01                  005655
 005656         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005656
 005657         x = 0;                                                                                   01                  005657
 005658      ElseIf declFrom <> *Blanks                                                                 X01                  005658
 005659          or declLen <> *Blanks                                                                  X01                  005659
 005660          or declOptions <> *BLanks;                                                             X01                  005660
 005661         // It's not a declaration - it's a subfield.                                                                 005661
 005662         QpDeclType = %xlate(lo:up:declType);                                                     01                  005662
 005663         QpDeclLine = SRCSEQ;                                                                     01                  005663
 005664         Return;                                                                                  01                  005664
 005665      EndIf;                                                                                     E01                  005665
 005666                                                                                                                      005666
 005667      // Read ahead to find the next line with a declaration type.                                                    005667
 005668      Read SRCREC;                                                                                                    005668
 005669      DoW not %eof();                                                                            B01                  005669
 005670         x += 1;     // Keep a track of how many lines we have read.                              01                  005670
 005671                                                                                                                      005671
 005672         lineType = %xlate(lo:up:lineType);                                                       01                  005672
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    181
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005673                                                                                                                      005673
 005674         If lineType <> savedLineType;                                                           B02                  005674
 005675            // End of this declaration.                                                                               005675
 005676            Leave;                                                                                02                  005676
 005677         EndIf;                                                                                  E02                  005677
 005678                                                                                                                      005678
 005679         If declType <> *Blanks;                                                                 B02                  005679
 005680            // We have found the declaration.                                                                         005680
 005681            QpDeclType = %xlate(lo:up:declType);                                                  02                  005681
 005682            QpDeclLine = SRCSEQ;                                                                  02                  005682
 005683            Leave;                                                                                02                  005683
 005684         ElseIf declFrom <> *Blanks                                                              X02                  005684
 005685             or declLen <> *Blanks                                                               X02                  005685
 005686             or declOptions <> *BLanks;                                                          X02                  005686
 005687            // It's not a declaration - it's a subfield.                                                              005687
 005688            QpDeclType = %xlate(lo:up:declType);                                                  02                  005688
 005689            QpDeclLine = SRCSEQ;                                                                  02                  005689
 005690            Leave;                                                                                02                  005690
 005691         EndIf;                                                                                  E02                  005691
 005692                                                                                                                      005692
 005693         Read SRCREC;                                                                             01                  005693
 005694      EndDo;                                                                                     E01                  005694
 005695                                                                                                                      005695
 005696      // End of file breaks the logic!  We need to reposition to the last record before                               005696
 005697      // continuing.                                                                                                  005697
 005698      If %eof(QRPGLESRC);                                                                        B01                  005698
 005699         SetGT *HIVAL SRCREC;                                                                     01                  005699
 005700         ReadP SRCREC;                                                                            01                  005700
 005701      EndIf;                                                                                     E01                  005701
 005702                                                                                                                      005702
 005703      // Return to the previous point.                                                                                005703
 005704      For i = 1 to x;                                                                            B01                  005704
 005705         ReadP SRCREC;                                                                            01                  005705
 005706      EndFor;                                                                                    E01                  005706
 005707                                                                                                                      005707
 005708      SRCDTA = savedSRCDTA;                                                                                           005708
 005709                                                                                                                      005709
 005710      Return;                                                                                                         005710
 005711                                                                                                                      005711
 005712   //------------------------------------------------------------------------------------------                       005712
 005713      End-Proc;                                                                                                       005713
 005714                                                                                                                      005714
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    182
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005716   //==========================================================================================                       005716
 005717   // Split a line at a logical break based on a max length.                                                          005717
 005718   //==========================================================================================                       005718
 005719      Dcl-Proc SplitLine;                                                                                             005719
 005720                                                                                                                      005720
 005721   // -- Procedure Interface ------------------------------------------------------------------                       005721
 005722      Dcl-PI SplitLine;                                                                                               005722
 005723         QpCurrentLine        VarChar(92);                                                                            005723
 005724         QpOverflow           VarChar(92);                                                                            005724
 005725         QpMaxLength           Packed( 3:0 ) CONST;                                                                   005725
 005726      End-PI;                                                                                                         005726
 005727                                                                                                                      005727
 005728   // -- Data Structures ----------------------------------------------------------------------                       005728
 005729                                                                                                                      005729
 005730   // -- Variables ----------------------------------------------------------------------------                       005730
 005731      Dcl-S x                  Packed( 3:0 );                                                                         005731
 005732                                                                                                                      005732
 005733   //-------------------------------------------------------------------------------------------                      005733
 005734                                                                                                                      005734
 005735      QpOverflow = *Blanks;                                                                                           005735
 005736      x = %len(%trim(QpCurrentLine));                                                                                 005736
 005737      If x > QpMaxLength;                                                                        B01                  005737
 005738         x = QpMaxLength;                                                                         01                  005738
 005739      EndIf;                                                                                     E01                  005739
 005740                                                                                                                      005740
 005741      // Scan backwards through the line, looking for a place to break it.                                            005741
 005742      For x = x downto 1;                                                                        B01                  005742
 005743         If %scan(%subst(QpCurrentLine:x:1):' ') > 0;                                            B02                  005743
 005744            // Break here, and put the rest into a new line.                                                          005744
 005745            QpOverflow = %subst(QpCurrentLine:x);                                                 02                  005745
 005746            QpCurrentLine = %subst(QpCurrentLine:1:x-1);                                          02                  005746
 005747            Leave;                                                                                02                  005747
 005748         EndIf;                                                                                  E02                  005748
 005749      EndFor;                                                                                    E01                  005749
 005750                                                                                                                      005750
 005751      Return;                                                                                                         005751
 005752                                                                                                                      005752
 005753   //------------------------------------------------------------------------------------------                       005753
 005754      End-Proc;                                                                                                       005754
 005755                                                                                                                      005755
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    183
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005757   //==========================================================================================                       005757
 005758   // Check for an array definition and adjust the length according to the number of elements.                        005758
 005759   //==========================================================================================                       005759
 005760      Dcl-Proc AdjustArrayLength;                                                                                     005760
 005761                                                                                                                      005761
 005762   // -- Procedure Interface ------------------------------------------------------------------                       005762
 005763      Dcl-PI AdjustArrayLength;                                                                                       005763
 005764      QpLength               Packed( 7:0 );                                                                           005764
 005765      End-PI;                                                                                                         005765
 005766                                                                                                                      005766
 005767   // -- Data Structures ----------------------------------------------------------------------                       005767
 005768                                                                                                                      005768
 005769   // -- Variables ----------------------------------------------------------------------------                       005769
 005770      Dcl-S x                  Packed( 3:0 );                                                                         005770
 005771      Dcl-S i                  Packed( 3:0 );                                                                         005771
 005772      Dcl-S j                  Packed( 3:0 );                                                                         005772
 005773      Dcl-S elements           Packed( 5:0 );                                                                         005773
 005774      Dcl-S savedSRCDTA          Char( 100 );                                                                         005774
 005775                                                                                                                      005775
 005776   //-------------------------------------------------------------------------------------------                      005776
 005777                                                                                                                      005777
 005778      savedSRCDTA = SRCDTA;                                                                                           005778
 005779      x = 0;                                                                                                          005779
 005780                                                                                                                      005780
 005781      // Read ahead to find the next line with a declaration type.                                                    005781
 005782      DoW not %eof();                                                                            B01                  005782
 005783         // Array definition on the current line?                                                                     005783
 005784         i = %scan('DIM(':%xlate(lo:up:declKeywords));                                            01                  005784
 005785                                                                                                                      005785
 005786         If i > 0;                                                                               B02                  005786
 005787            j = %scan(')':declKeywords:i+4);                                                      02                  005787
 005788            elements = %dec(%subst(declKeywords:i + 4:j - i - 4):7:0);                            02                  005788
 005789            // Adjust the length of the variable.                                                                     005789
 005790            If %rem(QpLength:elements) = 0;                                                      B03                  005790
 005791               QpLength = %div(QpLength:elements);                                                03                  005791
 005792            EndIf;                                                                               E03                  005792
 005793            Leave;                                                                                02                  005793
 005794         EndIf;                                                                                  E02                  005794
 005795                                                                                                                      005795
 005796         Read SRCREC;                                                                             01                  005796
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    184
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005797         x += 1;     // Keep a track of how many lines we have read.                              01                  005797
 005798                                                                                                                      005798
 005799         lineType = %xlate(lo:up:lineType);                                                       01                  005799
 005800                                                                                                                      005800
 005801         If lineType <> *Blank                                                                   B02                  005801
 005802         and lineType <> 'D';                                                                    B02                  005802
 005803            // Not part of this definition - stop looking for array definition.                                       005803
 005804            Leave;                                                                                02                  005804
 005805                                                                                                                      005805
 005806         ElseIf lineType = 'D'                                                                   X02                  005806
 005807         and %subst(directive:1:1) <> '*';                       // D-spec and no comment        X02                  005807
 005808            If declName <> *Blanks;                                                              B03                  005808
 005809               // A new declaration - stop looking for array definition.                                              005809
 005810               Leave;                                                                             03                  005810
 005811            EndIf;                                                                               E03                  005811
 005812         EndIf;                                                                                  E02                  005812
 005813      EndDo;                                                                                     E01                  005813
 005814                                                                                                                      005814
 005815      // End of file breaks the logic!  We need to reposition to the last record before                               005815
 005816      // continuing.                                                                                                  005816
 005817      If %eof(QRPGLESRC);                                                                        B01                  005817
 005818         SetGT *HIVAL SRCREC;                                                                     01                  005818
 005819         ReadP SRCREC;                                                                            01                  005819
 005820      EndIf;                                                                                     E01                  005820
 005821                                                                                                                      005821
 005822      // Return to the previous point.                                                                                005822
 005823      For i = 1 to x;                                                                            B01                  005823
 005824         ReadP SRCREC;                                                                            01                  005824
 005825      EndFor;                                                                                    E01                  005825
 005826                                                                                                                      005826
 005827      SRCDTA = savedSRCDTA;                                                                                           005827
 005828                                                                                                                      005828
 005829      Return;                                                                                                         005829
 005830                                                                                                                      005830
 005831   //------------------------------------------------------------------------------------------                       005831
 005832      End-Proc;                                                                                                       005832
 005833   //==========================================================================================                       005833
 005834 O*QRPGLESRC2E            OUTREC                                                                                      005834
 005835 O*                       SRCSEQ                                                                                      005835
 005836 O*                       SRCDAT                                                                                      005836
 005837 O*                       SRCDTA                                                                                      005837
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    185
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv   Statement    Message text
 *RNF7066 00        000032  Record-Format ZL01HDG not used for input or output.
 *RNF7099 00        005486  A COMMIT or ROLBK operation is used in the program with no
                            files defined with commitment control.
 *RNF7086 00        000027  RPG handles blocking for file QRPGLESRC2. INFDS is updated
                            only when blocks of data are transferred.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                  O u t p u t   B u f f e r   P o s i t i o n s
 Line   Start End   Field or Constant
 Number Pos   Pos
    2000002     1     6 SRCSEQ
    2000003     7    12 SRCDAT
    2000004    13   112 SRCDTA
    3000002     1    10 Z1QPGM
    3000003    11    20 Z1QUSR
    3000004    21    60 Z1QTTL
    3000005    61    64 Z1QPAG
    4000002     1    21 ZTFRFL
    4000003    22    42 ZTTOFL
    6000002     1    10 Z1FRMB
    6000003    11    20 Z1TOMB
    6000004    21    27 Z1CTSC
    6000005    28    34 Z1CTTG
    6000006    35    41 Z1CTMV
    6000007    42    48 Z1CTEL
    6000008    49    55 Z1CTCV
    6000009    56    62 Z1CTNV
    6000010    63    67 Z1CNVR
  * * * * *   E N D   O F   O U T P U T   B U F F E R   P O S I T I O N   *  * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    186
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                        C o m p i l e   T i m e   D a t a
 005838 **CTDATA QopCodeUP                                                                                                   005838
         *--------------------------------------------------------------------*
         * Array . . . : QOPCODEUP    Alternating Array  . . . . : QOPCODELO  *
         *--------------------------------------------------------------------*
 005839 ACQ       Acq                                                                                                        005839
 005840 BEGSR     BegSr                                                                                                      005840
 005841 CALLP     CallP                                                                                                      005841
 005842 CHAIN     Chain                                                                                                      005842
 005843 CLEAR     Clear                                                                                                      005843
 005844 CLOSE     Close                                                                                                      005844
 005845 COMMIT    Commit                                                                                                     005845
 005846 DEALLOC   DeAlloc                                                                                                    005846
 005847 DELETE    Delete                                                                                                     005847
 005848 DOU       DoU                                                                                                        005848
 005849 DOW       DoW                                                                                                        005849
 005850 DSPLY     Dsply                                                                                                      005850
 005851 DUMP      Dump                                                                                                       005851
 005852 ELSE      Else                                                                                                       005852
 005853 ELSEIF    ElseIf                                                                                                     005853
 005854 ENDDO     EndDo                                                                                                      005854
 005855 ENDFOR    EndFor                                                                                                     005855
 005856 ENDIF     EndIf                                                                                                      005856
 005857 ENDMON    EndMon                                                                                                     005857
 005858 ENDSL     EndSl                                                                                                      005858
 005859 ENDSR     EndSr                                                                                                      005859
 005860 EVAL      Eval                                                                                                       005860
 005861 EVALR     EvalR                                                                                                      005861
 005862 EVAL-CORR Eval-Corr                                                                                                  005862
 005863 EXCEPT    Except                                                                                                     005863
 005864 EXFMT     Exfmt                                                                                                      005864
 005865 EXSR      Exsr                                                                                                       005865
 005866 EXEC SQL  Exec SQL                                                                                                   005866
 005867 FEOD      FEOD                                                                                                       005867
 005868 FOR       For                                                                                                        005868
 005869 FORCE     Force                                                                                                      005869
 005870 IF        If                                                                                                         005870
 005871 IN        In                                                                                                         005871
 005872 ITER      Iter                                                                                                       005872
 005873 LEAVE     Leave                                                                                                      005873
 005874 LEAVESR   LeaveSr                                                                                                    005874
 005875 MONITOR   Monitor                                                                                                    005875
 005876 NEXT      Next                                                                                                       005876
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    187
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005877 ON-ERROR  On-Error                                                                                                   005877
 005878 OPEN      Open                                                                                                       005878
 005879 OTHER     Other                                                                                                      005879
 005880 OUT       Out                                                                                                        005880
 005881 POST      Post                                                                                                       005881
 005882 READ      Read                                                                                                       005882
 005883 READC     ReadC                                                                                                      005883
 005884 READE     ReadE                                                                                                      005884
 005885 READP     ReadP                                                                                                      005885
 005886 READPE    ReadPE                                                                                                     005886
 005887 REL       Rel                                                                                                        005887
 005888 RESET     Reset                                                                                                      005888
 005889 RETURN    Return                                                                                                     005889
 005890 ROLBK     RolBk                                                                                                      005890
 005891 SELECT    Select                                                                                                     005891
 005892 SETGT     SetGT                                                                                                      005892
 005893 SETLL     SetLL                                                                                                      005893
 005894 SORTA     SortA                                                                                                      005894
 005895 TEST      Test                                                                                                       005895
 005896 UNLOCK    Unlock                                                                                                     005896
 005897 UPDATE    Update                                                                                                     005897
 005898 WHEN      When                                                                                                       005898
 005899 WRITE     Write                                                                                                      005899
 005900 XML-INTO  XML-Into                                                                                                   005900
 005901 XMLSAX    XMLSAX                                                                                                     005901
 005902 ENDCS     ----------                                                                                                 005902
 005903 AND       and                                                                                                        005903
 005904 OR        or                                                                                                         005904
 005905 **CTDATA QdeclUP                                                                                                     005905
         *--------------------------------------------------------------------*
         * Array . . . : QDECLUP      Alternating Array  . . . . : QDECLLO    *
         *--------------------------------------------------------------------*
 005906 DCL-F     Dcl-F                                                                                                      005906
 005907 DCL-S     Dcl-S                                                                                                      005907
 005908 DCL-C     Dcl-C                                                                                                      005908
 005909 DCL-PR    Dcl-PR                                                                                                     005909
 005910 DCL-PI    Dcl-PI                                                                                                     005910
 005911 DCL-PROC  Dcl-Proc                                                                                                   005911
 005912 DCL-DS    Dcl-DS                                                                                                     005912
 005913 END-DS    End-DS                                                                                                     005913
 005914 END-PR    End-PR                                                                                                     005914
 005915 END-PI    End-PI                                                                                                     005915
 005916 END-PROC  End-Proc                                                                                                   005916
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    188
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005917 CTL-OPT   Ctl-Opt                                                                                                    005917
 005918 **CTDATA Qcomments                                                                                                   005918
         *--------------------------------------------------------------------*
         * Array . . . : QCOMMENTS                                            *
         *--------------------------------------------------------------------*
 005919 //===========================================================================================                        005919
 005920 // Start of moved field definitions.                                                                                 005920
 005921 // End of moved field definitions.                                                                                   005921
     * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    189
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          CVTRPGFREP        PRINTER                000032D     005515      005562
            Z1PAGHDG                               000032D     000459     3000001
            Z1TOPPAG                               000032D     000464     4000001
            ZL01HDG                                000032D    5000001
            Z1DETAIL                               000032D     000484     6000001
            Z1ENDRPT                               000032D     005514     7000001
          QRPGLESRC         DISK                   000022D     000425      005114      005197
                                                   005282      005324      005433      005448
                                                   005449      005508      005568      005698
                                                   005817
            SRCREC                                 000024     1000001      000423      000451
                                                   005011      005108      005115      005116
                                                   005121      005175      005192      005198
                                                   005199      005204      005223      005273
                                                   005283      005289      005450      005452
                                                   005668      005693      005699      005700
                                                   005705      005796      005818      005819
                                                   005824
          QRPGLESRC2        DISK                   000027D     005509      005571
            OUTREC                                 000029      005469     2000001
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                   005490M
          ADJUSTARRAYLENGTH PROTOTYPE              002014M     005760      005763
          BLANKS            A(30)                  000209D     003007
          CALLPOFFSET       P(5,0)                 000329D     001050      002854M
          CALLPOPERATOR     A(10)                  000328D     002844      002870M     002872M
          CASEOPERATOR      A(4)                   000312D     002888M     002891      002892M
                                                   002893      002894M     002895      002896M
                                                   002897      002898M     002899      002900M
                                                   002901      002902M     002904M     002910
                                                   002914      002918
          CASESUBROUTINE    A(10)                  000311D     000445      000446      000448M
                                                   002887M
          CATBLANKS         A(14)                  000317D     002976M     002979M     002986
                                                   002988      002995
          CATCOUNT          P(5,0)                 000316D     002988M     002999      003003
                                                   003007
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    190
          CATFACTOR1        A(14)                  000314D     002968M     002970M     002997
                                                   003001      003006
          CATFACTOR2        A(14)                  000315D     002977M     002980M     002998
                                                   003002      003008
          CFGCLOSEDOWN      A(1)                   000195D     005489      005513M     005550M
          CFGCOMMITCONTROL  A(7)                   000193D     005485      005549M
          CHECKLENGTH       P(5,0)                 000278D     002334M     002338M     002341
 *RNF7031 CNDINDICATORS(79) N(1)                   000145D
          CODELINE          A(93)                  000091D     000220      000436M     000438M
                                                   000446M     000507      000613      000616M
                                                   000616      000622      000626      000627
                                                   000634      000637M     000640      000642M
                                                   000725      000726      000727      000731
                                                   000733      000735      000738      000780M
                                                   000788      001033M     001034M     001091M
                                                   001092M     001096M     001099      001113M
                                                   001121M     001122M     001167M     001192
                                                   001613      002230      002346M     002398
                                                   002404      002455      002542M     002553M
                                                   002564M     002575M     002586M     002597M
                                                   002601M     002605M     002613M     002617M
                                                   002621M     002633M     002638M     002643M
                                                   002653M     002656M     002658M     002668M
                                                   002671M     002673M     002683M     002686M
                                                   002688M     003480M     003601      005231
                                                   005232      005239      005244      005245
                                                   005296      005297      005328      005330
                                                   005416M     005418M     005420M     005426M
                                                   005439M     005441M     005443M
          CODESTART         P(6,2)                 000242D     005317M     005451
          COMMENT           A(20)                  000105D     000639      000655      000668
                                                   000680      000692      000704      001797
                                                   001798      001799      001801      001834
                                                   001835      001836      001838      002182
                                                   002183      002184      002186      002323
                                                   002324      002325      002327      002337
                                                   002415      002416      002417      002419
                                                   002491      002492      002493      002495
                                                   005398      005399
          CONDIND           A(2)                   000095D     001208
 *RNF7031 CONDNOT           A(1)                   000094D
          CONVERT           N(1)                   000238D     000504M     000659      000672
                                                   000684      000696      000708      000742
                                                   000760      001094      001108      001194M
                                                   001204M     001615M     001646M     001732M
                                                   001993M     002201M     002218M     002232M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    191
                                                   002266M     002371M     002386M     002400M
                                                   002443M     002457M     002512M     002526M
                                                   002712M     002743M     002799M     002818M
                                                   002831M     002875M     002943M     003017M
                                                   003048M     003099M     003112M     003130M
                                                   003151M     003186M     003207M     003233M
                                                   003263M     003378M     003411M     003428M
                                                   003441M     003454M     003518M     003570M
                                                   003583M     003610M     003636M     003649M
                                                   003699M     003718M     003731M     003744M
                                                   003829M     003853M     003866M     003879M
                                                   003926M     003972M     004014M     004028M
                                                   004049M     004078M     004095M     004114M
                                                   004127M     004151M     004185M     004221M
                                                   004241M     004261M     004295M     004309M
                                                   004330M     004394M     004407M     004425M
                                                   004443M     004477M     004490M     004505M
                                                   004518M     004550M     004634M     004676M
                                                   004700M     004713M     004732M     004758M
                                                   004842M     004873M     004893M     004947M
                                                   004965M     004984M
          COUNTCONV         P(7,0)                 000394D     000474      000480      000743M
                                                   005576M
          COUNTELIGIBLE     P(7,0)                 000393D     000473      000477      000480
                                                   000652M     000665M     000678M     000690M
                                                   000702M     005575M
          COUNTMOVED        P(7,0)                 000396D     000476      005427M
          COUNTNOTCONV      P(7,0)                 000395D     000475      000653M     000666M
                                                   000679M     000691M     000703M     000744M
                                                   005577M
          COUNTSOURCE       P(7,0)                 000391D     000426M     000471      005573M
          COUNTTARGET       P(7,0)                 000392D     000472      005467M     005574M
          CURROFFSET        P(5,0)                 000254D     000731M     001054
 *RNF7031 CVTRPGFREE        PROTOTYPE              000039D
          DCLF              DS(92)                 000175D     002276M     002277M     002278M
                                                   002282M     002291M     002294M     002298M
                                                   002300M     002304M     002308M     002313
                                                   002314M     002314      002319M     002319
                                                   002325M     002327M     002334      002341
                                                   002346      002350M     002351M     002354M
                                                   002354      002360M     002360      002367
                                                   002377M     002378M     002380M     002380
                                                   002382
            COMMENT         A(23)                  000180D     002325      002327
            DECL            A(6)                   000176D     002277
            DEFINITION      A(44)                  000179D     002291      002294      002298
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    192
                                                   002300      002304      002308      002313
                                                   002314      002314      002319      002319
                                                   002334      002341      002351      002354
                                                   002354      002360      002360      002378
                                                   002380      002380
            DEVICE          A(8)                   000178D     002282
 *RNF7031   FILENAME        A(15)                  000177D
          DCLH              DS(93)                 000183D     002411M     002412M     002413M
                                                   002417M     002419M     002424M     002424
                                                   002431      002434M     002435M     002437M
                                                   002437      002439
            COMMENT         A(23)                  000186D     002417      002419
            DECL            A(8)                   000184D     002412
            OPTIONS         A(62)                  000185D     002413      002424      002424
                                                   002435      002437      002437
          DCLP              DS(93)                 000161D     002476M     002479M     002481M
                                                   002483M     002487M     002487      002493M
                                                   002495M     002500M     002500      002507
                                                   002517M     002518M     002520M     002520
                                                   002522
            COMMENT         A(23)                  000164D     002493      002495
            DECL            A(9)                   000162D     002479      002481
            DEFINITION      A(61)                  000163D     002483      002487      002487
                                                   002500      002500      002518      002520
                                                   002520
          DCLPR             DS(92)                 000152D     001870M     001885M     001889M
                                                   001906M     001912      001929      001931M
                                                   001936M     001944M     001948M     001950M
                                                   001955M     001961M     001966M     001972M
                                                   001974M     001976M     001978M     001980M
                                                   001982M     001986M     001989M     002004
                                                   002005M     002015M     002015      002018M
                                                   002018      002023M     002023      002026M
                                                   002026      002081      002084M     002096M
                                                   002105M     002153      002154M     002154
                                                   002156M     002156      002167      002169
                                                   002174      002174      002175M     002177M
                                                   002177      002184M     002186M     002191
            COMMENT         A(23)                  000157D     002184      002186
            DECL            A(7)                   000153D     001885      001929
            DEFINITION      A(37)                  000156D     001955      001966      002005
                                                   002015      002015      002018      002018
                                                   002023      002023      002026      002026
                                                   002156      002156      002167      002169
                                                   002174      002175      002177      002177
            FIELDNAME       A(23)                  000158D     001906
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    193
            PROCNAME        A(16)                  000154D     002081      002084      002096
                                                   002154      002154
            TYPE            A(9)                   000155D     001912      001931      001936
                                                   001944      001948      001950      001961
                                                   001972      001974      001976      001978
                                                   001980      001982      001986      001989
                                                   002004      002153      002174
          DCLS              DS(92)                 000167D     001640M     001651M     001652M
                                                   001657      001676M     001684M     001687M
                                                   001689M     001694M     001700M     001705M
                                                   001711M     001713M     001715M     001717M
                                                   001719M     001721M     001725M     001728M
                                                   001743      001744M     001746M     001746
                                                   001749M     001749      001772M     001772
                                                   001782      001784      001789      001789
                                                   001790M     001792M     001792      001799M
                                                   001801M     001806      001817M     001819M
                                                   001820M     001825      001826M     001828M
                                                   001828      001836M     001838M     001843M
                                                   001843      001850      001851M     001851
                                                   001855      002209M     002210M     002212M
                                                   002212      002214      005321M     005351M
                                                   005356M     005358M     005360M     005362M
                                                   005364M     005364      005367M     005367
                                                   005373M     005375M     005380M     005380
                                                   005383M     005383      005386M     005386
                                                   005389M     005389      005397M     005397
                                                   005399M     005411      005412M     005426
                                                   005428M
            COMMENT         A(23)                  000172D     001799      001801      001836
                                                   001838      005399
            DECL            A(6)                   000168D     001651      001819      001850
                                                   005412
            DEFINITION      A(37)                  000171D     001694      001705      001744
                                                   001746      001746      001749      001749
                                                   001772      001772      001782      001784
                                                   001789      001790      001792      001792
                                                   001825      001826      001828      001828
                                                   001843      001843      001851      002210
                                                   002212      002212      005362      005364
                                                   005364      005367      005367      005375
                                                   005380      005380      005383      005383
                                                   005386      005386      005389      005389
                                                   005397      005397
            FIELDNAME       A(17)                  000169D     005356      005373      005411
                                                   005428
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    194
            TYPE            A(9)                   000170D     001657      001676      001684
                                                   001687      001689      001700      001711
                                                   001713      001715      001717      001719
                                                   001721      001725      001728      001743
                                                   001789      005358      005360
          DEC               A(2)                   000101D     000861M     005357      005363
                                                   005365
          DECLATTR          A(1)                   000121D     001622
          DECLEXT           A(1)                   000115D     005617
          DECLFROM          A(7)                   000119D     002006      002008      002031
                                                   002033      002034      002036      005658
                                                   005684
          DECLKEYWORDS      A(37)                  000123D     001623      002518      005027
                                                   005252      005784      005787      005788
          DECLLEN           A(7)                   000120D     001658      001744      001913
                                                   001930      002007      002019      005026
                                                   005252      005659      005685
          DECLNAME          A(15)                  000114D     001628      002089      002473
                                                   005002      005024      005037      005140
                                                   005248      005255      005621      005808
          DECLOPTIONS       A(73)                  000124D     002032      002413      002435
                                                   005003      005256      005258      005660
                                                   005686
          DECLPREFIX        A(1)                   000116D     002079      002086      005137
                                                   005138      005138      005617      005618
                                                   005618
          DECLSCALE         A(3)                   000122D     001660      001745      001747
                                                   001915      002022      002024
          DECLSUFFIX        A(1)                   000118D     005136      005619
          DECLTYPE          A(2)                   000117D     001899      005025      005139
                                                   005186      005187      005251      005254
                                                   005620      005662      005679      005681
                                                   005688
          DEFSMOVED         N(1)                   000240D     000529M     000904M     000966
                                                   005413      005422M     005436      005455M
          DIRECTIVE         A(10)                  000090D     000501      000554M     000604M
                                                   000606M     000750M     000755M     000767M
                                                   000773M     001112      002345M     005023
                                                   005036      005044      005049      005090
                                                   005095      005101      005243      005294
                                                   005295      005336      005807
          DIVFACTOR1        A(14)                  000356D     003252M     003255M     003260
                                                   004025
          DIVFACTOR2        A(14)                  000357D     003253M     003256M     003261
                                                   004026
          DOCOMPARE         A(2)                   000333D     003300M     003305M     003309M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    195
                                                   003312M     003317      003318M     003319
                                                   003320M     003321      003322M     003323
                                                   003324M     003325      003326M     003327
                                                   003328M     003329      003340M     003360
          DOCOUNT           P(5,0)                 000350D     000886M     000887      000921M
                                                   003492      003493
          DOLEVEL(99)       P(5,0)                 000351D     000887M     003493
          DOOPERATOR        A(10)                  000332D     003275      003373M     003375M
          DROPLINE          N(1)                   000241D     000556M     000559M     000566M
                                                   000660      000673      000685      000697
                                                   000709      000797      000877M     000985
                                                   001107      001127M     001290M     003185M
                                                   004423M     004441M
          DURCODE           A(14)                  000320D     002762M     002765      002765
                                                   002766M     002767      002767      002768M
                                                   002769      002769      002770M     002771
                                                   002771      002772M     002773      002773
                                                   002774M     002775      002775      002776M
                                                   002777      002777      002778M     002790
                                                   003668M     003671      003671      003672M
                                                   003673      003673      003674M     003675
                                                   003675      003676M     003677      003677
                                                   003678M     003679      003679      003680M
                                                   003681      003681      003682M     003683
                                                   003683      003684M     003691      004577M
                                                   004580      004580      004581M     004582
                                                   004582      004583M     004584      004584
                                                   004585M     004586      004586      004587M
                                                   004588      004588      004589M     004590
                                                   004590      004591M     004592      004592
                                                   004593M     004605      004609M     004612
                                                   004612      004613      004613      004614
                                                   004614      004615      004615      004616
                                                   004616      004617      004617      004618
                                                   004618      004625
          DURDURATION       A(14)                  000319D     002761M     002791      003667M
                                                   003690      004576M     004606      004608M
                                                   004624
          DURNEWDATE        N(1)                   000321D     004569M     004572M     004575
          ENDDECLTYPE       A(2)                   000245D     001167      001891M
          ENDDS             N(1)                   000231D     001164      001883M     002075M
          ENDFOUND          N(1)                   000244D     005220M     005292      005300M
          ENDLINE           P(6,2)                 000243D     001162      005219M     005278M
                                                   005301M
          EOFCHECK          N(1)                   000369D     002572      002578M     004212M
                                                   004864M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    196
          EOFFILE           A(14)                  000371D     004214M     004866M
          EOFIND            A(2)                   000370D     002575      004213M     004865M
          EQ                A(2)                   000104D     002936      002938      003092
                                                   003094      003177      003179      003225
                                                   004211      004213      004287      004389
                                                   004391      004421      004439      004468
                                                   004470      004863      004865
          EQCHECK           N(1)                   000383D     002641      002680      002691M
                                                   002937M     003178M
          EQFACTOR1         A(14)                  000385D     002683      002939M     003180M
          EQFACTOR2         A(14)                  000386D     002684      002940M     003181M
          EQIND             A(2)                   000384D     002643      002686      002938M
                                                   003179M
          EQUALCHECK        N(1)                   000388D     002583      002589M     004469M
          EQUALIND          A(2)                   000389D     002586      004470M
          ERRCHECK          N(1)                   000359D     002550      002556M     002708M
                                                   002795M     002814M     003013M     003044M
                                                   003089M     003126M     003147M     003203M
                                                   003229M     003407M     003632M     003695M
                                                   003714M     003849M     004045M     004074M
                                                   004110M     004147M     004181M     004217M
                                                   004237M     004257M     004291M     004326M
                                                   004386M     004473M     004630M     004672M
                                                   004696M     004728M     004754M     004869M
                                                   004943M
          ERRIND            A(2)                   000360D     002553      002709M     002796M
                                                   002815M     003014M     003045M     003090M
                                                   003127M     003148M     003204M     003230M
                                                   003408M     003633M     003696M     003715M
                                                   003850M     004046M     004075M     004111M
                                                   004148M     004182M     004218M     004238M
                                                   004258M     004292M     004327M     004387M
                                                   004474M     004631M     004673M     004697M
                                                   004729M     004755M     004870M     004944M
 *RNF7031 ERRORIND          N(1)                   000149D
          EVALOFFSET        P(5,0)                 000325D     001052
          EVALOPERATOR      A(10)                  000324D     003535      003565M     003567M
          EXTFACTOR2        A(45)                  000107D     002850      002860      003283
                                                   003293      003544      003546      003556
                                                   003710      003729      003742      003764
                                                   003774      004089      004092      004307
                                                   004501      004778      004788      005052
          FACTOR1           A(14)                  000096D     000287      000306      000307
                                                   000314      000347      000356      000375
                                                   000380      000385      002703      002731
                                                   002737      002784      002787      002829
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    197
                                                   002909      002917      002927      002933
                                                   002939      002957      002958      002967
                                                   002970      003028      003078      003082
                                                   003141      003166      003173      003180
                                                   003251      003255      003332      003335
                                                   003338M     003359      003391      003392
                                                   003422      003423      003467      003810
                                                   003840      003841      003949      004002
                                                   004008      004039      004060      004065
                                                   004138      004141      004172      004175
                                                   004196      004197      004252      004274
                                                   004275      004320      004342      004345
                                                   004347      004348      004454      004538
                                                   004544      004599      004602      004624
                                                   004648      004649      004655      004691
                                                   004823      004914      004918      004919
                                                   005374
          FACTOR2           A(14)                  000098D     000288      000308      000315
                                                   000317      000319      000320      000348
                                                   000357      000367      000371      000376
                                                   000381      000386      002704      002734
                                                   002738      002755      002761      002762
                                                   002810      002910      002918      002928
                                                   002934      002940      002974      002977
                                                   002979      002980      003029      003041
                                                   003072      003078      003082      003083
                                                   003123      003167      003174      003181
                                                   003218      003226      003253      003256
                                                   003337      003339M     003361      003393
                                                   003394      003452      003477      003478
                                                   003581      003621      003647      003661
                                                   003667      003668      003812      003842
                                                   003844      003942      003947      003952
                                                   004005      004009      004040      004062
                                                   004064      004106      004139      004142
                                                   004162      004173      004176      004198
                                                   004200      004214      004232      004253
                                                   004278      004279      004288      004352
                                                   004355      004357      004358      004455
                                                   004466      004516      004541      004545
                                                   004562      004576      004577      004625
                                                   004657      004660      004662      004666
                                                   004724      004743      004825      004853
                                                   004866      004885      004890      004923
                                                   004926      004928      004929      004958
                                                   004977      005376      005385      005387
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    198
                                                   005390
          FILEADD           A(1)                   000130D     002240
          FILEDESIG         A(1)                   000129D     002239
          FILEDEVICE        A(7)                   000133D     002241
          FILEEXTERNAL      A(1)                   000131D     002273
          FILEKEYED         A(1)                   000132D     002242
          FILEKEYWORDS      A(37)                  000134D     002332      002335      002351
                                                   002355      002378      005096
          FILENAME          A(10)                  000127D     002271      005096
          FILESPEC          A(100)                 000126D     000127      000128      000129
                                                   000130      000131      000132      000133
                                                   000134
          FILEUSAGE         A(1)                   000128D     002238
          FORCOUNT          P(5,0)                 000345D     000890M     000891      000925M
                                                   003475      003476
          FORFACTOR1        A(14)                  000347D     003333M     003335M     003345
          FORFACTOR2        A(14)                  000348D     003337M     003346
          FORLEVEL(99)      P(5,0)                 000346D     000891M     003476
          FOUNDCHECK        N(1)                   000362D     002539      002545M     004390M
          FOUNDIND          A(2)                   000363D     002542      004391M
          FROMFILELIB       A(21)                  000214D     000461      005567M
          FULLLINE          A(94)                  000092D     000714      000717      001115M
                                                   001619      002236      002461      005143
                                                   005624
          GETDECLARATIONTYPE...
                            PROTOTYPE              000069D     001631M     002468M     005261M
                                                   005598      005601
          HI                A(2)                   000102D     002924      002926      002958
                                                   003038      003040      003163      003165
                                                   003223      004285      004419      004437
                                                   004463      004465      004488      004649
          HICHECK           N(1)                   000373D     002631      002650      002661M
                                                   002925M     003093M     003164M
          HIFACTOR1         A(14)                  000375D     002653      002927M     003095M
                                                   003166M
          HIFACTOR2         A(14)                  000376D     002654      002928M     003096M
                                                   003167M
          HIIND             A(2)                   000374D     002633      002656      002926M
                                                   003094M     003165M
          I                 P(5,0)                 000207D     001757M     001758      001759
                                                   001762      001764      002044M     002045
                                                   002047      002049      002054      002054
                                                   002060      002060      002113M     002114
                                                   002115      002118      002120      002128M
                                                   002129      002130      002133      002135
                                                   002143M     002144      005120      005203
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    199
                                                   005288      005704
          IFCOMPARE         A(2)                   000337D     003786M     003790M     003793M
                                                   003797      003798M     003799      003800M
                                                   003801      003802M     003803      003804M
                                                   003805      003806M     003807      003808M
                                                   003811
          IFOPERATOR        A(10)                  000336D     003757      003824M     003826M
          INARRAYDATA       N(1)                   000223D     000514M     000517      001111
                                                   005583M
          INCALLP           N(1)                   000327D     001049      001143      001152M
                                                   001239      002843      002849      002855M
                                                   002869
          INCASE            N(1)                   000237D     000445      002908      002912M
                                                   003509      003521M
          INCODE            N(1)                   000222D     000512M     000521M     000528M
                                                   000531M     000533M     000535M     000537M
                                                   000539M     000549M     000597      000628
                                                   000719      000834M     000844M     000966
                                                   001029      001111      001139M     005582M
          INCOMMENT         N(1)                   000224D     000498M     000601M     000621M
                                                   000631M     000643M     000648      000659
                                                   000672      000684      000696      000708
                                                   000796      000984      000998M     001063
                                                   001145
          INCREMENT         P(1,0)                 000249D     000499M     000872M     000876M
                                                   000881M     000884M     000889M     000893M
                                                   000897M     000901M     000906M     000909M
                                                   000912M     000917M     000920M     000924M
                                                   000928M     000932M     000936M     000940M
                                                   000944M     000948M     000953M     000957M
                                                   000959M     000973      000974M     001130
          INDATASTRUCTURE   N(1)                   000228D     001161      001163      001164
                                                   001174M     001663      001868      001875
                                                   001882M     001918      002006      002030
          INDECLARATION     N(1)                   000225D     000513M     000746      000763
                                                   000833      000961      001144      001155M
                                                   001176M     001628      001629      001638M
                                                   001644M     001731M     001776M     001815M
                                                   001844M     001869M     001992M     002160M
                                                   002200M     002246      002265M     002274M
                                                   002361M     002370M     002408      002409M
                                                   002425M     002465      002466      002474M
                                                   002501M     002511M
 *RNF7031 INDECLPROC        N(1)                   000234D
          INDENT            N(1)                   000235D     000931M     000935M     000939M
                                                   000943M     000947M     000952M     000956M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    200
                                                   001133      001135M
          INDENTCOUNT       P(5,0)                 000250D     000887      000891      000895
                                                   000899M     000903M     000907M     000973M
                                                   001042      001045      001130M     001134M
                                                   001138M     003476      003493      003502
                                                   005584M     005586M
          INDENTOFFSET      P(5,0)                 000252D     001034      001043M     001045M
                                                   001050M     001052M     001054M     001054
                                                   001058      001059M     001080      001082M
                                                   001082      001086      001087M     001092
                                                   001122      001786M     002171M
          INDENTSIZE        P(1,0)                 000251D     001043      001045
 *RNF7031 INDICATORDS       DS(99)                 000138D
          INDIRECTIVE       N(1)                   000232D     000497M     000548M     000568M
                                                   000572M     000576M     000580M     000584M
                                                   000588M     000592M     000649      000772
                                                   000795      000982
          INDO              N(1)                   000331D     000885M     000950      001073
                                                   001143      001150M     001320      003274
                                                   003282      003287M     003304      003364M
                                                   003366M     003372
          INEVAL            N(1)                   000323D     001051      001143      001153M
                                                   001350      003534      003540      003541M
                                                   003564
          INEXTPROC         N(1)                   000230D     001172M     001177M     001900
                                                   002103      002107M     002146M
          INFREEFORMAT      N(1)                   000233D     000547      000550M     000720M
                                                   000737M     000746      000754M     000763
                                                   000771M     000800      000981
          INIF              N(1)                   000335D     000725      000882M     000950
                                                   001073      001143      001149M     001390
                                                   003756      003763      003768M     003785
                                                   003815M     003817M     003823
          ININTERFACE       N(1)                   000227D     001161      001173M     001866
                                                   001874      001880M
          INITIALCALL       A(1)                   000196D     005512      005530      005531M
                                                   005533M     005561
          INPROTOTYPE       N(1)                   000226D     001161      001171M     001864
                                                   001873      001878M     001897      005154
                                                   005640
          INSPAN            N(1)                   000236D     000728M     000730      000784M
                                                   001053      001074M     001143      001148M
                                                   001175M     001770      001778M     001807
                                                   001842      001846M     001856      001901
                                                   002152      002163M     002192      002211
                                                   002215M     002359      002363M     002379
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    201
                                                   002383M     002423      002427M     002436
                                                   002440M     002499      002503M     002519
                                                   002523M     002851      002856M     002861
                                                   002865M     003284      003288M     003294
                                                   003298M     003362      003367M     003548
                                                   003551M     003557      003560M     003599M
                                                   003602      003606M     003765      003769M
                                                   003775      003780M     003813      003818M
                                                   004779      004783M     004789      004793M
                                                   004826      004831M     004995M     005005M
                                                   005010      005031M     005039M     005045M
                                                   005053M     005058M     005063M     005070M
                                                   005077M     005084M     005091M     005097M
                                                   005247
          INSQL             N(1)                   000343D     000803      000823M     000873M
                                                   000878      001144      001154M     001198
                                                   003598M     003605M
          INWHEN            N(1)                   000339D     000945      000949M     001073
                                                   001143      001151M     001579      004770
                                                   004777      004782M     004798      004828M
                                                   004830M     004836
          J                 P(5,0)                 000208D     002049M     002050      002054
                                                   002055      002060      002061
          LEN               A(5)                   000100D     000860M     005347      005353
                                                   005354      005354      005362      005378
                                                   005378      005379M     005379      005381
          LINEEND           P(5,0)                 000255D     001064M     001065      001066M
                                                   001067      001068M     001069      001071M
                                                   001080      001082      001146M     001147
          LINETYPE          A(1)                   000089D     000502      000542M     000551M
                                                   000569M     000573M     000577M     000581M
                                                   000585M     000589M     000593M     000597
                                                   000609M     000624M     000760      001112
                                                   002344M     004997      005015M     005015
                                                   005017      005018      005022      005035
                                                   005043      005048      005089      005094
                                                   005160      005179M     005179      005181
                                                   005226      005227      005293      005327
                                                   005335      005425M     005646      005672M
                                                   005672      005674      005799M     005799
                                                   005801      005802      005806
          LO                CONST                  000078D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
                                                   001701      001723      001755      001762
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    202
                                                   001820      001934      001951      001962
                                                   001984      002042      002046      002048
                                                   002069      002071      002088      002111
                                                   002118      002126      002133      002141
                                                   002238      002239      002240      002241
                                                   002242      002273      002278      002762
                                                   002958      002958      003303      003668
                                                   003784      003951      004577      004609
                                                   004649      004649      004797      004997
                                                   005015      005050      005139      005160
                                                   005179      005187      005227      005232
                                                   005328      005330      005335      005337
                                                   005350      005371      005374      005385
                                                   005404      005620      005646      005662
                                                   005672      005681      005688      005784
                                                   005799
          LW                A(2)                   000103D     002707      002709      002794
                                                   002796      002813      002815      002930
                                                   002932      003012      003014      003043
                                                   003045      003088      003090      003125
                                                   003127      003146      003148      003170
                                                   003172      003202      003204      003228
                                                   003230      003406      003408      003631
                                                   003633      003694      003696      003713
                                                   003715      003848      003850      004044
                                                   004046      004073      004075      004109
                                                   004111      004146      004148      004180
                                                   004182      004216      004218      004236
                                                   004238      004256      004258      004290
                                                   004292      004325      004327      004385
                                                   004387      004420      004438      004472
                                                   004474      004629      004631      004671
                                                   004673      004695      004697      004727
                                                   004729      004753      004755      004868
                                                   004870      004942      004944
          LWCHECK           N(1)                   000378D     002636      002665      002676M
                                                   002931M     003171M
          LWFACTOR1         A(14)                  000380D     002668      002933M     003173M
          LWFACTOR2         A(14)                  000381D     002669      002934M     003174M
          LWIND             A(2)                   000379D     002638      002671      002932M
                                                   003172M
          MAINLINEINDENT    P(5,0)                 000256D     000898M     000899      000902M
                                                   000903      000907      001138      005586
          MAXINDENT         P(5,0)                 000210D     001042      001043      005579M
          MOVEDDEFS(9999)   A(14)                  000211D     005320M     005350      005403
                                                   005404M     005580M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    203
          MOVEDEF           N(1)                   000212D     005348M     005355M     005372M
                                                   005395      005581M
          NEWOPERATOR       A(10)                  000219D     000989M     000993M     000999M
                            VARYING(2)             001002M     001008      001009      001011
                                                   001026
          NONCONVRSN        A(93)                  000220D     000505M     000660      000661M
                                                   000673      000674M     000685      000697
                                                   000709      000777      000780      001209M
                                                   001645M     002267M     002372M     002757M
                                                   002780M     002959M     003061M     003468M
                                                   003663M     003686M     003955M     003967M
                                                   004067M     004163M     004168M     004566M
                                                   004595M     004620M     004650M
          NONPREFIX         A(95)                  000109D     000434M     001109M     002540M
                                                   002551M     002562M     002573M     002584M
                                                   002595M     002611M     002632M     002637M
                                                   002642M     002651M     002666M     002681M
          NRFCHECK          N(1)                   000365D     002561      002567M     003039M
                                                   003224M     004286M     004464M
          NRFFILE           A(14)                  000367D     003041M     003226M     004288M
                                                   004466M
          NRFIND            A(2)                   000366D     002564      003040M     003225M
                                                   004287M     004465M
          OPCODE            A(10)                  000097D     000324      000328      000332
                                                   000336      000340      000654      000856
                                                   003303M     003303      003305      003306
                                                   003308      003309      003312      003784M
                                                   003784      003786      003789      003790
                                                   003793      004797M     004797      004799
                                                   004802      004803      004806      005050M
                                                   005050      005052      005057      005062
                                                   005067      005068      005069      005074
                                                   005075      005076      005081      005082
                                                   005083      005337M     005337      005339
                                                   005340      005341      005342      005343
                                                   005344      005345      005346      005347
                                                   005371
          OPERATOR          A(10)                  000217D     000654M     000667M     000802M
                                                   000804M     000807M     000808      000810
                                                   000812      000817M     000817      000819
                                                   000822M     000826      000828M     000828
                                                   000832      000836      000840M     000843M
                                                   000854M     000856M     000857      000858
                                                   000867M     000867      000880      000883
                                                   000888      000892      000896      000900
                                                   000905      000908      000910      000914
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    204
                                                   000915M     000918      000922      000926
                                                   000929      000933      000937      000941
                                                   000945      000954      000987      000991
                                                   001000M     001049      001051      001137
                                                   001214      001219      001224      001229
                                                   001234      001239      001244      001249
                                                   001254      001259      001264      001269
                                                   001274      001279      001284      001289
                                                   001294      001299      001304      001305
                                                   001306      001307      001308      001309
                                                   001310      001311      001312      001313
                                                   001314      001315      001316      001317
                                                   001318      001319      001325      001330
                                                   001335      001340      001345      001350
                                                   001355      001360      001365      001370
                                                   001375      001380      001385      001390
                                                   001395      001400      001405      001410
                                                   001415      001421      001426      001431
                                                   001436      001441      001446      001451
                                                   001456      001461      001466      001471
                                                   001476      001481      001486      001491
                                                   001496      001501      001506      001507
                                                   001512      001517      001522      001527
                                                   001532      001537      001542      001547
                                                   001551      001555      001559      001564
                                                   001569      001574      001579      001584
                                                   001589      001594      001599      002703
                                                   002724      002844M     002850      002854
                                                   002870      002888      002955      002964M
                                                   003028      003065      003066M     003068M
                                                   003077      003081      003123      003141
                                                   003197      003218      003245      003275M
                                                   003280      003281      003283      003373
                                                   003389      003423      003425      003466
                                                   003474      003474      003477M     003491
                                                   003491      003494M     003500      003500
                                                   003503M     003508      003510M     003512M
                                                   003516      003520      003535M     003542
                                                   003543      003544      003555      003565
                                                   003581      003621      003710      003729
                                                   003757M     003762      003764      003824
                                                   003841      003844      003864      003877
                                                   003938      003940      003945      003995
                                                   004039      004090      004092      004106
                                                   004139      004141      004173      004175
                                                   004197      004200      004252      004272
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    205
                                                   004306      004320      004454      004501
                                                   004530      004532M     004646      004687
                                                   004688M     004691      004724      004743
                                                   004771M     004776      004778      004837
                                                   004853      004884      004961      004980
                                                   005051      005056      005061      005066
                                                   005073      005080
          OPERATOREND       P(5,0)                 000218D     000808M     000809      000810M
                                                   000811      000812M     000816      000817
                                                   000826M     000827      000828
          OVERFLOW          N(1)                   000033D     000147D     000455      000466M
                                                   005564M
          OVERFLOWLINE      A(92)                  000260D     001120      001122      001123M
                            VARYING(2)             001785      002170
          PADRESULT         N(1)                   000284D     001031      001038M
          PADTARGET         A(14)                  000285D     001035
          PREFIX            A(5)                   000088D     000510
          PREVOFFSET        P(5,0)                 000253D     000733M     001054
          PROCKEYWORDS      A(37)                  000112D     002486      002488      005038
          PROCTYPE          A(1)                   000111D     005038
          QCOMMENTS(3)      A(92)                  000204D     005416      005418      005420
                                                   005439      005441      005443      005918M
          QDECLLO(12)       A(10)                  000203D     000993
          QDECLUP(12)       A(10)                  000202D     000203      000836      000991
                                                   005905M
          QOPCODELO(66)     A(10)                  000201D     000989
          QOPCODEUP(66)     A(10)                  000200D     000201      000832      000987
                                                   003951      005838M
          QPDIRECTIVES      A(1)                   000063D     000553      000747      000764
                            BASED(_QRNL_PRM+)
          QPFROMFILE        A(10)                  000055D     005567
                            BASED(_QRNL_PRM+)
          QPFROMLIB         A(10)                  000056D     005567
                            BASED(_QRNL_PRM+)
          QPFROMMBR         A(10)                  000022      000057D     000469
                            BASED(_QRNL_PRM+)
          QPINDCOMMENT      A(1)                   000061D     000600      000630
                            BASED(_QRNL_PRM+)
          QPRETBLNKCMT      A(1)                   000062D     000613      000634
                            BASED(_QRNL_PRM+)
          QPSHUTDOWN        A(1)                   000054D     005507      005512      005556
                            BASED(_QRNL_PRM+)
          QPTOFILE          A(10)                  000058D     005570
                            BASED(_QRNL_PRM+)
          QPTOLIB           A(10)                  000059D     005570
                            BASED(_QRNL_PRM+)
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    206
          QPTOMBR           A(10)                  000027      000060D     000470
                            BASED(_QRNL_PRM+)
          RESULT            A(14)                  000099D     000211      000285      002732
                                                   002733      002736      002785      002785
                                                   002787      002810      002887      002958
                                                   002968      002997      003001      003006
                                                   003031      003032      003060      003077
                                                   003081      003095      003110      003197
                                                   003252      003259      003341      003342M
                                                   003344      003395      003398      003399
                                                   003624      003625      003690      003942
                                                   003947      003951      003952      004003
                                                   004004      004007      004025      004061
                                                   004063      004167      004204      004205
                                                   004232      004282      004376      004381
                                                   004456      004457      004516      004539
                                                   004540      004543      004564      004600
                                                   004600      004602      004608      004609
                                                   004649      004665      004692      004711
                                                   004746      004747      004856      004857
                                                   004885      004889      004933      004958
                                                   004977      005350      005356      005373
                                                   005404
          SAVEDCOMMENT      A(20)                  000281D     000655M     000668M     000680M
                                                   000692M     000704M     001095      001096
                                                   001097M     002352M
          SAVEDLINETYPE     A(1)                   000247D     004997M     005001      005018
                                                   005160M     005181
          SAVEDNAME         A(80)                  000282D     001631      001650      001652
                                                   001808M     001818      001820      001857M
                                                   001886      001887M     001889      001892
                                                   001898      001902M     001905      001906
                                                   002081      002082M     002161M     002192
                                                   002193M     002271M     002278      002468
                                                   002483      002508M     005140M     005143M
                                                   005168      005170M     005170
          SAVEDSRCDTA       A(100)                 000258D     000748M     000752      000765M
                                                   000769      000778M     000782      001032M
                                                   001037      001090M     001100      001165M
                                                   001169      002343M     002348      003479M
                                                   003484      004996M     005124      005159M
                                                   005207      005218M     005306      005318M
                                                   005456
          SCANBASE          A(14)                  000288D     004355M     004358M     004365
                                                   004371
          SCANLENGTH        A(10)                  000289D     004344M     004347M     004362
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    207
                                                   004370
          SCANNORESULT      N(1)                   000291D     000433      000441M     004377M
                                                   004380M
          SCANSTART         A(10)                  000290D     004354M     004357M     004365
                                                   004371
          SCANSTRING        A(14)                  000287D     004345M     004348M     004364
                                                   004370
          SETOFF            N(1)                   000296D     001094      002594      002608M
                                                   004418M
          SETOFFIND1        A(2)                   000297D     002596      002597      004419M
          SETOFFIND2        A(2)                   000298D     002600      002601      004420M
          SETOFFIND3        A(2)                   000299D     002604      002605      004421M
          SETON             N(1)                   000301D     001094      002610      002624M
                                                   004436M
          SETONIND1         A(2)                   000302D     002612      002613      004437M
          SETONIND2         A(2)                   000303D     002616      002617      004438M
          SETONIND3         A(2)                   000304D     002620      002621      004439M
          SLCOUNT           P(5,0)                 000353D     000894M     000895      000913M
                                                   003501      003502
          SLLEVEL(99)       P(5,0)                 000354D     000895M     003502
 *RNF7031 SOURCEDATA        DS(100)                000086D
          SOURCELINE        A(93)                  000259D     000507M     000714M     000717M
                                                   000735M     000738M     000788M     000801
                                                   000807      000820      000841      000846M
                                                   000846      000853      000983      000996
                                                   001009      001010M     001010      001015M
                                                   001019      001020      001021      001022
                                                   001023      001024M     001024      001026M
                                                   001026      001058      001059      001064
                                                   001066      001069      001071      001092
                                                   001099M     001113      001115      001146
                                                   001193M     001614M     001619M     001806M
                                                   001855M     001893      002191M     002214M
                                                   002231M     002236M     002367M     002382M
                                                   002399M     002404M     002431M     002439M
                                                   002456M     002461M     002507M     002522M
                                                   002703M     002726M     002728M     002732M
                                                   002732      002736M     002736      002741M
                                                   002741      002785M     002787M     002790M
                                                   002790      002810M     002829M     002850M
                                                   002852M     002852      002859M     002860M
                                                   002862M     002862      002909M     002915M
                                                   002917M     002997M     003001M     003006M
                                                   003028M     003032M     003032      003034M
                                                   003034      003077M     003081M     003110M
                                                   003123M     003141M     003143M     003143
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    208
                                                   003197M     003199M     003199      003218M
                                                   003220M     003220      003246M     003248M
                                                   003259M     003259      003283M     003285M
                                                   003285      003291M     003293M     003295M
                                                   003295      003306M     003310M     003313M
                                                   003344M     003359M     003359      003363M
                                                   003363      003389M     003392M     003392
                                                   003394M     003394      003396M     003396
                                                   003399M     003399      003403M     003403
                                                   003423M     003425M     003439M     003452M
                                                   003516M     003544M     003546M     003549M
                                                   003549      003554M     003555M     003558M
                                                   003558      003581M     003597M     003601M
                                                   003603M     003603      003621M     003625M
                                                   003625      003627M     003627      003647M
                                                   003690M     003710M     003729M     003742M
                                                   003764M     003766M     003766      003774M
                                                   003776M     003776      003787M     003791M
                                                   003794M     003810M     003810      003814M
                                                   003814      003841M     003844M     003864M
                                                   003877M     003924M     003942M     003947M
                                                   003952M     003997M     003999M     004003M
                                                   004003      004007M     004007      004012M
                                                   004012      004025M     004039M     004061M
                                                   004064M     004090M     004092M     004106M
                                                   004125M     004139M     004141M     004173M
                                                   004175M     004197M     004200M     004205M
                                                   004205      004207M     004207      004232M
                                                   004252M     004272M     004275M     004275
                                                   004279M     004279      004282M     004282
                                                   004306M     004320M     004322M     004322
                                                   004364M     004369M     004378M     004378
                                                   004381M     004381      004405M     004454M
                                                   004457M     004457      004459M     004459
                                                   004488M     004501M     004503M     004503
                                                   004516M     004533M     004535M     004539M
                                                   004539      004543M     004543      004548M
                                                   004548      004600M     004602M     004605M
                                                   004605      004624M     004665M     004691M
                                                   004711M     004724M     004743M     004747M
                                                   004747      004749M     004749      004778M
                                                   004780M     004780      004788M     004790M
                                                   004790      004800M     004804M     004807M
                                                   004823M     004823      004827M     004827
                                                   004853M     004857M     004857      004859M
                                                   004859      004885M     004889M     004933M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    209
                                                   004937M     004937      004939M     004939
                                                   004958M     004962M     004962      004977M
                                                   004981M     004981
          SPLITLINE         PROTOTYPE              001785M     002170M     005719      005722
          SRCDAT            P(6,0)                1000003M    2000003
          SRCDTA            A(100)                 000087D     000088      000089      000090
                                                   000091      000092      000094      000095
                                                   000096      000097      000098      000099
                                                   000100      000101      000102      000103
                                                   000104      000105      000107      000109
                                                   000111      000112      000114      000115
                                                   000116      000117      000118      000119
                                                   000120      000121      000122      000123
                                                   000124      000126      000258     1000004M
                                                   000511      000748      000749M     000752M
                                                   000765      000766M     000769M     000778
                                                   000779M     000782M     001032      001037M
                                                   001090      001100M     001165      001166M
                                                   001169M     002343      002348M     003479
                                                   003484M     004996      005124M     005159
                                                   005207M     005218      005306M     005318
                                                   005415M     005438M     005456M    2000004
                                                   005645      005708M     005778      005827M
          SRCSEQ            P(6,2)                 000072      000242      000243      000266
                                                   000270     1000002M     001162      005155
                                                   005188      005249      005278      005301
                                                   005317      005451     2000002      005604
                                                   005641      005663      005682      005689
          SUBEXITPROGRAM    BEGSR                  000410      005479D     005557
          SUBINITIALISE     BEGSR                  000404      005527D
          SUBSTLEN          A(10)                  000293D     004655M     004668
          SUBSTSTART        A(10)                  000294D     004659M     004662M     004667
          SUBUSERCHECKSPAN  BEGSR                  001625      002244      002406      002463
                                                   002847      003278      003538      003594
                                                   003760      004774      004993D
          SUBUSERCONVERTC_SPEC...
                            BEGSR                  000657      001188D
          SUBUSERCONVERTD_SPEC...
                            BEGSR                  000682      001610D
          SUBUSERCONVERTF_SPEC...
                            BEGSR                  000694      002227D
          SUBUSERCONVERTH_SPEC...
                            BEGSR                  000706      002395D
          SUBUSERCONVERTP_SPEC...
                            BEGSR                  000670      002452D
          SUBUSERCVT_ACQ    BEGSR                  001215      002701D
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    210
          SUBUSERCVT_ADD    BEGSR                  001225      002721D
          SUBUSERCVT_ADDDUR BEGSR                  001220      002752D
          SUBUSERCVT_ALLOC  BEGSR                  001230      002808D
          SUBUSERCVT_BEGSR  BEGSR                  001235      002827D
          SUBUSERCVT_CALLP  BEGSR                  001240      002840D
          SUBUSERCVT_CASXX  BEGSR                  001245      002884D
          SUBUSERCVT_CAT    BEGSR                  001250      002952D
          SUBUSERCVT_CHAIN  BEGSR                  001255      003026D
          SUBUSERCVT_CHECKX BEGSR                  001260      003057D
          SUBUSERCVT_CLEAR  BEGSR                  001265      003108D
          SUBUSERCVT_CLOSE  BEGSR                  001270      003121D
          SUBUSERCVT_COMMIT BEGSR                  001275      003139D
          SUBUSERCVT_COMP   BEGSR                  001280      003160D
          SUBUSERCVT_DEALLOC...
                            BEGSR                  001285      003195D
          SUBUSERCVT_DELETE BEGSR                  001295      003216D
          SUBUSERCVT_DIV    BEGSR                  001300      003242D
          SUBUSERCVT_DO     BEGSR                  001321      003272D
          SUBUSERCVT_DSPLY  BEGSR                  001326      003387D
          SUBUSERCVT_DUMP   BEGSR                  001331      003420D
          SUBUSERCVT_ELSE   BEGSR                  001336      003437D
          SUBUSERCVT_ELSEIF BEGSR                  001341      003450D
          SUBUSERCVT_ENDXX  BEGSR                  001346      003463D
          SUBUSERCVT_EVALX  BEGSR                  001351      003531D
          SUBUSERCVT_EXCEPT BEGSR                  001356      003579D
          SUBUSERCVT_EXEC_SQL...
                            BEGSR                  001199      003592D
          SUBUSERCVT_EXFMT  BEGSR                  001361      003619D
          SUBUSERCVT_EXSR   BEGSR                  001366      003645D
          SUBUSERCVT_EXTRCT BEGSR                  001371      003658D
          SUBUSERCVT_FEOD   BEGSR                  001376      003708D
          SUBUSERCVT_FOR    BEGSR                  001381      003740D
          SUBUSERCVT_FORCE  BEGSR                  001386      003727D
          SUBUSERCVT_IF     BEGSR                  001391      003753D
          SUBUSERCVT_IN     BEGSR                  001396      003838D
          SUBUSERCVT_ITER   BEGSR                  001401      003862D
          SUBUSERCVT_LEAVE  BEGSR                  001406      003875D
          SUBUSERCVT_LOOKUP BEGSR                  001411      003888D
          SUBUSERCVT_MONITOR...
                            BEGSR                  001422      003922D
          SUBUSERCVT_MOVE   BEGSR                  001427      003935D
          SUBUSERCVT_MOVEA  BEGSR                  001416      003981D
          SUBUSERCVT_MULT   BEGSR                  001432      003992D
          SUBUSERCVT_MVR    BEGSR                  001437      004023D
 *RNF7031 SUBUSERCVT_NEXT   BEGSR                  004037D
          SUBUSERCVT_OCCUR  BEGSR                  001442      004058D
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    211
          SUBUSERCVT_ON_ERROR...
                            BEGSR                  001447      004087D
          SUBUSERCVT_OPEN   BEGSR                  001452      004104D
          SUBUSERCVT_OTHER  BEGSR                  001457      004123D
          SUBUSERCVT_OUT    BEGSR                  001462      004136D
          SUBUSERCVT_POST   BEGSR                  001467      004160D
          SUBUSERCVT_READ   BEGSR                  001472      004194D
 *RNF7031 SUBUSERCVT_REALLOC...
                            BEGSR                  004230D
          SUBUSERCVT_REL    BEGSR                  001477      004250D
          SUBUSERCVT_RESET  BEGSR                  001482      004270D
          SUBUSERCVT_RETURN BEGSR                  001487      004304D
          SUBUSERCVT_ROLBK  BEGSR                  001492      004318D
          SUBUSERCVT_SCAN   BEGSR                  001497      004339D
          SUBUSERCVT_SELECT BEGSR                  001502      004403D
          SUBUSERCVT_SETOFF BEGSR                  001513      004416D
          SUBUSERCVT_SETON  BEGSR                  001518      004434D
          SUBUSERCVT_SETXX  BEGSR                  001508      004452D
          SUBUSERCVT_SHTDN  BEGSR                  001523      004486D
          SUBUSERCVT_SORTA  BEGSR                  001528      004499D
 *RNF7031 SUBUSERCVT_SQRT   BEGSR                  004514D
          SUBUSERCVT_SUB    BEGSR                  001543      004527D
          SUBUSERCVT_SUBDUR BEGSR                  001533      004559D
          SUBUSERCVT_SUBST  BEGSR                  001538      004643D
          SUBUSERCVT_TEST   BEGSR                  001560      004685D
          SUBUSERCVT_TIME   BEGSR                  001565      004709D
          SUBUSERCVT_UNLOCK BEGSR                  001575      004722D
          SUBUSERCVT_UPDATE BEGSR                  001570      004741D
          SUBUSERCVT_WHEN   BEGSR                  001580      004767D
          SUBUSERCVT_WRITE  BEGSR                  001585      004851D
 *RNF7031 SUBUSERCVT_XFOOT  BEGSR                  004882D
          SUBUSERCVT_XLATE  BEGSR                  001590      004902D
          SUBUSERCVT_Z_ADD  BEGSR                  001595      004956D
          SUBUSERCVT_Z_SUB  BEGSR                  001600      004974D
          SUBUSEREXITPROGRAM...
                            BEGSR                  005481      005502D
          SUBUSERFUNCTION   BEGSR                  000407      000417D
 *RNF7031 SUBUSERGETDECLARATIONTYPE...
                            BEGSR                  005133D
          SUBUSERGETENDLINE BEGSR                  001876      005216D
          SUBUSERINITIALISE BEGSR                  005537      005546D
          SUBUSERMOVEDEFS   BEGSR                  000967      005315D
          SUBUSERREFORMATLINE...
                            BEGSR                  000428      000437      000439      000447
                                                   000495D     002543      002554      002565
                                                   002576      002587      002598      002602
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    212
                                                   002606      002614      002618      002622
                                                   002634      002639      002644      002655
                                                   002657      002659      002670      002672
                                                   002674      002685      002687      002689
          SUBUSERSETINDICATORS...
                            BEGSR                  000430      002535D
          SUBUSERWRITELINE  BEGSR                  000751      000768      000781      001036
                                                   001117      001124      001168      002347
                                                   003483      005417      005419      005421
                                                   005430      005440      005442      005444
                                                   005465D
          TEMPDECLLINE      P(6,2)                 000270D     005263
          TEMPDECLTYPE      A(2)                   000269D     005261      005264
          TEMPSAVEDNAME     A(80)                  000271D     005262
          TOFILELIB         A(21)                  000215D     000462      005570M
          UNINDENT          N(1)                   000239D     000875M     000911M     000916M
                                                   000919M     000923M     000927M     000930M
                                                   000934M     000938M     000942M     000946M
                                                   000951M     000955M     000972      000975M
          UP                CONST                  000079D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
                                                   001701      001723      001755      001762
                                                   001820      001934      001951      001962
                                                   001984      002042      002046      002048
                                                   002069      002071      002088      002111
                                                   002118      002126      002133      002141
                                                   002238      002239      002240      002241
                                                   002242      002273      002278      002762
                                                   002958      003303      003668      003784
                                                   003951      004577      004609      004649
                                                   004797      004997      005015      005050
                                                   005139      005160      005179      005187
                                                   005227      005232      005328      005330
                                                   005335      005337      005350      005371
                                                   005374      005385      005404      005620
                                                   005646      005662      005672      005681
                                                   005688      005784      005799
          VALIDSPECS        CONST                  000080D     000540
          WHENCOMPARE       A(2)                   000341D     004799M     004803M     004806M
                                                   004810      004811M     004812      004813M
                                                   004814      004815M     004816      004817M
                                                   004818      004819M     004820      004821M
                                                   004824
          WHENOPERATOR      A(10)                  000340D     004771      004837M     004839M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    213
          WORKDECLATTR      A(1)                   000264D     001622M     001656      001661M
                                                   001664M     001666M     001671      001673
                                                   001686      001688      001699      001710
                                                   001712      001714      001716      001718
                                                   001720      001722      001737      001738
                                                   001739      001740      001741      001742
                                                   001894M     001911      001916M     001919M
                                                   001921M     001926      001928      001947
                                                   001949      001960      001971      001973
                                                   001975      001977      001979      001981
                                                   001983      001998      001999      002000
                                                   002001      002002      002003      002009
                                                   002011
          WORKDECLKEYWORDS  A(92)                  000267D     001623M     001643      001674
                            VARYING(2)             001678M     001678      001680M     001680
                                                   001681      001690      001692      001693
                                                   001695      001697M     001697      001701
                                                   001703      001704      001706      001708M
                                                   001708      001723      001726M     001726
                                                   001755      001757      001759      001760M
                                                   001760      001762      001764      001771
                                                   001774M     001774      001782      001785
                                                   001790      001793      001824      001826
                                                   001829      001934      001938M     001938
                                                   001940M     001940      001941      001951
                                                   001953      001954      001956      001958M
                                                   001958      001962      001964      001965
                                                   001967      001969M     001969      001984
                                                   001987M     001987      002034M     002036M
                                                   002037      002042      002044      002047
                                                   002049      002052M     002054      002055
                                                   002057M     002058      002060      002061
                                                   002069      002071      002080M     002080
                                                   002088      002090M     002091      002093M
                                                   002093      002101      002105      002106M
                                                   002111      002113      002115      002116M
                                                   002116      002118      002120      002126
                                                   002128      002130      002131M     002131
                                                   002133      002135      002141      002143
                                                   002153      002155      002158M     002158
                                                   002167      002170      002175      002178
                                                   002210
          WORKDECLLINE      P(6,2)                 000266D     001631      002468      005155M
                                                   005162M     005188M     005249
          WORKDECLNAME      A(50)                  000265D     001178M     001892M     002048
          WORKDECLTYPE      A(2)                   000263D     001631      001637      001814
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    214
                                                   001863      001865      001867      001877
                                                   001879      001881      001885      001891
                                                   002468      002471      002472      002478
                                                   005139M     005142M     005147      005148
                                                   005149      005150      005151      005152
                                                   005153      005154      005187M
          WORKDIRECTIVE     A(10)                  000261D     000501M     000545      000561
                                                   000567      000571      000575      000579
                                                   000583      000587      000591      000595
                                                   000596      000603      000618      000761
                                                   000871      000874      001198      001203
                                                   003596
          WORKFILEADD       A(1)                   000275D     002240M     002255      002287
                                                   002297
          WORKFILEDESIG     A(1)                   000274D     002239M     002250      002251
                                                   002258      002259      002262
          WORKFILEDEVICE    A(7)                   000277D     002241M     002281      002282
                                                   002288      002289      002290      002303
                                                   002307
          WORKFILEKEYED     A(1)                   000276D     002242M     002318
          WORKFILEUSAGE     A(1)                   000273D     002238M     002249      002252
                                                   002254      002257      002261      002286
                                                   002296      002302      002306
          WORKLENGTH        P(7,0)                 000279D     002007M     002010M     002010
                                                   002012M     002012      002014      002016
          WORKLINETYPE      A(1)                   000262D     000502M     000520      000527
                                                   000530      000532      000534      000536
                                                   000538      000540      000541M     000552M
                                                   000570M     000574M     000578M     000582M
                                                   000586M     000590M     000594M     000600
                                                   000608      000608      000610M     000625M
                                                   000628      000630      000651      000664
                                                   000677      000689      000701      000713
                                                   000716      000719      000845      005227
          X                 P(5,0)                 000205D     000841M     000842      000987M
                                                   000988      000989      000991M     000992
                                                   000993      000996M     000997      001674M
                                                   001675      001677      001678      001680
                                                   001681      001690M     001691      001692M
                                                   001692      001693      001695      001695
                                                   001701M     001702      001703M     001703
                                                   001704      001706      001706      001723M
                                                   001724      001726      001755M     001756
                                                   001757      001759      001759      001760
                                                   001762      001762      001782M     001783
                                                   001784M     001784      001785      001934M
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    215
                                                   001935      001937      001938      001940
                                                   001941      001951M     001952      001953M
                                                   001953      001954      001956      001956
                                                   001962M     001963      001964M     001964
                                                   001965      001967      001967      001984M
                                                   001985      001987      002042M     002043
                                                   002044      002047      002047      002051
                                                   002058      002069M     002070      002071M
                                                   002073      002111M     002112      002113
                                                   002115      002115      002116      002118
                                                   002118      002126M     002127      002128
                                                   002130      002130      002131      002133
                                                   002133      002141M     002142      002143
                                                   002167M     002168      002169M     002169
                                                   002170      002724M     002725      002755M
                                                   002756      002761      002762      002955M
                                                   002956      002974M     002975      002979
                                                   002980      003072M     003075      003082
                                                   003083      003661M     003662      003667
                                                   003668      003938M     003940      003945
                                                   003995M     003996      004342M     004343
                                                   004347      004348      004352M     004353
                                                   004357      004358      004530M     004531
                                                   004562M     004563      004564M     004565
                                                   004576      004577      004608      004609
                                                   004646M     004647      004657M     004658
                                                   004660M     004662      004666      004914M
                                                   004915      004918      004919      004923M
                                                   004924      004928      004929      004998M
                                                   005013M     005120      005161M     005168M
                                                   005169      005170      005171M     005177M
                                                   005203      005224M     005274M     005288
                                                   005403M     005404
          XLATEBASE         A(14)                  000308D     004926M     004929M     004935
          XLATEFROM         A(14)                  000306D     004918M     004934
          XLATESTART        A(10)                  000309D     004925M     004928M     004936
                                                   004937
          XLATETO           A(14)                  000307D     004919M     004934
          Y                 P(5,0)                 000206D     001693M     001695      001697
                                                   001704M     001706      001708      001954M
                                                   001956      001958      001965M     001967
                                                   001969
          ZTFRFL            A(21)                  000461M    4000002
          ZTTOFL            A(21)                  000462M    4000003
          Z1CNVR            P(5,2)                 000478M     000480M    6000010
          Z1CTCV            P(7,0)                 000474M    6000008
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    216
          Z1CTEL            P(7,0)                 000473M    6000007
          Z1CTMV            P(7,0)                 000476M    6000006
          Z1CTNV            P(7,0)                 000475M    6000009
          Z1CTSC            P(7,0)                 000471M    6000004
          Z1CTTG            P(7,0)                 000472M    6000005
          Z1FRMB            A(10)                  000469M    6000002
          Z1QPAG            P(4,0)                 000458M    3000005
          Z1QPGM            A(10)                 3000002
          Z1QTTL            A(40)                  005563M    3000004
          Z1QUSR            A(10)                 3000003
          Z1TOMB            A(10)                  000470M    6000003
       Field References for subprocedure GETDECLARATIONTYPE
          Field             Attributes         References (D=Defined M=Modified)
          QPDECLLINE        P(6,2)                 005604D     005641M     005648M     005663M
                            BASED(_QRNL_PST+)      005682M     005689M
          QPDECLTYPE        A(2)                   005602D     005620M     005623M     005633
                            BASED(_QRNL_PST+)      005634      005635      005636      005637
                                                   005638      005639      005640      005662M
                                                   005681M     005688M
          QPSAVEDNAME       A(80)                  005603D     005621M     005624M     005627
                            BASED(_QRNL_PST+)      005629M     005629      005654      005656M
                                                   005656
          SAVEDLINETYPE     A(1)                   005610D     005646M     005674
          SAVEDSRCDTA       A(100)                 005612D     005645M     005708
          X                 P(3,0)                 005611D     005627M     005628      005629
                                                   005647M     005654M     005655      005656
                                                   005657M     005670M     005704
       Field References for subprocedure SPLITLINE
          Field             Attributes         References (D=Defined M=Modified)
          QPCURRENTLINE     A(92)                  005723D     005736      005743      005745
                            BASED(_QRNL_PST+)      005746M     005746
                            VARYING(2)
          QPMAXLENGTH       P(3,0)                 005725D     005737      005738
                            BASED(_QRNL_PST+)
          QPOVERFLOW        A(92)                  005724D     005735M     005745M
                            BASED(_QRNL_PST+)
                            VARYING(2)
          X                 P(3,0)                 005731D     005736M     005737      005738M
                                                   005742      005742      005743      005745
                                                   005746
       Field References for subprocedure ADJUSTARRAYLENGTH
          Field             Attributes         References (D=Defined M=Modified)
          ELEMENTS          P(5,0)                 005773D     005788M     005790      005791
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    217
          I                 P(3,0)                 005771D     005784M     005786      005787
                                                   005788      005788      005823
          J                 P(3,0)                 005772D     005787M     005788
          QPLENGTH          P(7,0)                 005764D     005790      005791M     005791
                            BASED(_QRNL_PST+)
          SAVEDSRCDTA       A(100)                 005774D     005778M     005827
          X                 P(3,0)                 005770D     005779M     005797M     005823
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                       005490M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    218
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          No references in the source.
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    219
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00     13 The name or indicator is not referenced.
 *RNF7066 00      1 Record-Format name of Externally-Described file is not used.
 *RNF7086 00      1 RPG handles blocking for the file. INFDS is updated only when
                    blocks of data are transferred.
 *RNF7099 00      1 A COMMIT or ROLBK operation is used in the program with no
                    files defined with commitment control.
 *RNF3776 10      1 External program on prototype for main procedure is not the
                    same as program being created.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R1M0  100416 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   10-02-20 11:20:09        Page    220
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :       16
     Warning      (10) . . . . . . . :        1
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :       17
   Source Totals:
     Records . . . . . . . . . . . . :     5851
     Specifications  . . . . . . . . :     3786
     Data records  . . . . . . . . . :       81
     Comments  . . . . . . . . . . . :     1050
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program CVTRPGFRER placed in library CVTRPGFREE. 10 highest severity. Created on 10-02-20 at 11:20:10.
           * * * * *   E N D   O F   C O M P I L A T I O N * * * * *
