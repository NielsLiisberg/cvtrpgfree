  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   CVTRPGFRER
     Library  . . . . . . . . . . . :     CVTRPGFREE
   Text 'description' . . . . . . . :   Convert to RPG free
   Source stream file   . . . . . . :   src/cvtrpgfreR.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   25-06-20  14:41:39
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *NOUNREF   *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                     *FREE            000001
      2   Ctl-Opt Debug                                                                                                      000002
      3           DftActGrp( *No ) ActGrp( *Caller )                                                                         000003
      4           Option( *ShowCpy: *SrcStmt: *NoDebugIO );                                                                  000004
 000005                                                                                                                      000005
 000006   //-------------------------------------------------------------------------------------------                      000006
 000007   // Program Name. . . . . : CVTRPGFREE                                                                              000007
 000008   // Program Description . : Convert RPGILE Source Member to Free-form                                               000008
 000009   // Date Created. . . . . : 30/04/2015                                                                              000009
 000010   // Programmer. . . . . . : Ewarwoowar                                                                              000010
 000011   //                                                                                                                 000011
 000012   // By             Date        Fix                                                                                  000012
 000013   // Niels Liisberg 10.02.2020  Support for source more that 999 lines of code                                       000013
 000014   //-------------------------------------------------------------------------------------------                      000014
 000015   // SYNOPSIS :                                                                                                      000015
 000016   // - Reads through an RPGILE source member and reformats the contents.                                             000016
 000017   //-------------------------------------------------------------------------------------------                      000017
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000019   //-------------------------------------------------------------------------------------------                      000019
 000020   // F I L E S                                                                                                       000020
 000021   //-------------------------------------------------------------------------------------------                      000021
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *                 Convert to RPG free                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *SRCSTMT          *
         *                                       *NODEBUGIO *NOUNREF          *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   *NONE                        *
         *  Activation group . . . . . . . . :   *CALLER                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
 000022   Dcl-F QRPGLESRC              EXTMBR(QpFromMbr)                                                                     000022
 000023                                EXTFILE('QTEMP/QRPGLESRC')                                                            000023
 000024                                RENAME(QRPGLESRC:SRCREC)                                                              000024
 000025                                USROPN;                                                                               000025
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC        CVTRPGFREE/QRPGLESRC                        *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         * Record format(s) . . . . . :  SRCREC           QRPGLESRC                                   *
         *--------------------------------------------------------------------------------------------*
 000026                                                                                                                      000026
 000027   Dcl-F QRPGLESRC2             Usage(*OUTPUT) EXTMBR(QpToMbr)                                                        000027
 000028                                EXTFILE('QTEMP/QRPGLESRC2')                                                           000028
 000029                                RENAME(QRPGLESRC2:OUTREC)                                                             000029
 000030                                USROPN;                                                                               000030
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC2       CVTRPGFREE/QRPGLESRC2                       *
         * Record format(s) . . . . . :  OUTREC           QRPGLESRC2                                  *
         *--------------------------------------------------------------------------------------------*
 000031                                                                                                                      000031
 000032   Dcl-F CVTRPGFREP     PRINTER USROPN                                                                                000032
 000033                                OFLIND(overFlow);                                                                     000033
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  CVTRPGFREP       CVTRPGFREE/CVTRPGFREP                       *
         * Record format(s) . . . . . :  Z1PAGHDG         Z1PAGHDG                                    *
         *                               Z1TOPPAG         Z1TOPPAG                                    *
         *                               ZL01HDG          ZL01HDG                                     *
         *                               Z1DETAIL         Z1DETAIL                                    *
         *                               Z1ENDRPT         Z1ENDRPT                                    *
         *--------------------------------------------------------------------------------------------*
 000034                                                                                                                      000034
 000035   //-------------------------------------------------------------------------------------------                      000035
 000036   // P R O C E D U R E   I N T E R F A C E                                                                           000036
 000037   //-------------------------------------------------------------------------------------------                      000037
 000038                                                                                                                      000038
 000039   Dcl-PR CVTRPGFREE               EXTPGM('CVTRPGFREE');                                                              000039
 000040      QpShutDown               Char(1) CONST;                                                                         000040
 000041      QpFromFile               Char(10) CONST;                                                                        000041
 000042      QpFromLib                Char(10) CONST;                                                                        000042
 000043      QpFromMember             Char(10) CONST;                                                                        000043
 000044      QpToFile                 Char(10) CONST;                                                                        000044
 000045                                                                                                                      000045
 000046      QpToLib                  Char(10) CONST;                                                                        000046
 000047      QpToMbr                  Char(10) CONST;                                                                        000047
 000048      QpIndComment             Char(1) CONST;                                                                         000048
 000049      QpRetBlnkCmt             Char(1) CONST;                                                                         000049
 000050      QpDirectives             Char(1) CONST;                                                                         000050
 000051   End-PR;                                                                                                            000051
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000052                                                                                                                      000052
 000053   Dcl-PI CVTRPGFREE;                                                                                                 000053
 ======>         aaaaaaaaaa
 *RNF3776 10 a      000053  External program on prototype for main procedure is not the
                            same as program being created.
 000054      QpShutDown               Char(1) CONST;                                                                         000054
 000055      QpFromFile               Char(10) CONST;                                                                        000055
 000056      QpFromLib                Char(10) CONST;                                                                        000056
 000057      QpFromMbr                Char(10) CONST;                                                                        000057
 000058      QpToFile                 Char(10) CONST;                                                                        000058
 000059      QpToLib                  Char(10) CONST;                                                                        000059
 000060      QpToMbr                  Char(10) CONST;                                                                        000060
 000061      QpIndComment             Char(1) CONST;                                                                         000061
 000062      QpRetBlnkCmt             Char(1) CONST;                                                                         000062
 000063      QpDirectives             Char(1) CONST;                                                                         000063
 000064   End-PI;                                                                                                            000064
 000065                                                                                                                      000065
 000066   //-------------------------------------------------------------------------------------------                      000066
 000067   // P R O T O T Y P E   I N T E R F A C E S                                                                         000067
 000068   //-------------------------------------------------------------------------------------------                      000068
 000069   Dcl-PR GetDeclarationType;                                                                                         000069
 000070      QpDeclType               Char( 2 );                                                                             000070
 000071      QpSavedName              Char( 80 );                                                                            000071
 000072      QpDeclLine                        Like(SRCSEQ);                                                                 000072
 000073   End-PR;                                                                                                            000073
 000074                                                                                                                      000074
 000075   //-------------------------------------------------------------------------------------------                      000075
 000076   // N A M E D   C O N S T A N T S                                                                                   000076
 000077   //-------------------------------------------------------------------------------------------                      000077
 000078   Dcl-C LO                        'abcdefghijklmnopqrstuvwxyz';                                                      000078
 000079   Dcl-C UP                        'ABCDEFGHIJKLMNOPQRSTUVWXYZ';                                                      000079
 000080   Dcl-C VALIDSPECS                'HFDCP';                                                                           000080
 000081                                                                                                                      000081
 000082   //-------------------------------------------------------------------------------------------                      000082
 000083   // D A T A   S T R U C T U R E S                                                                                   000083
 000084   //-------------------------------------------------------------------------------------------                      000084
 000085                                                                                                                      000085
 000086   Dcl-DS SourceData;                                                                                                 000086
 000087      SRCDTA                   Char(100);                                                                             000087
 000088      prefix                   Char(5) OVERLAY(SRCDTA:1);                                                             000088
 000089      lineType                 Char(1) OVERLAY(SRCDTA:6);                                                             000089
 000090      directive                Char(10) OVERLAY(SRCDTA:7);                                                            000090
 000091      codeLine                 Char(93) OVERLAY(SRCDTA:8);                                                            000091
 000092      fullLine                 Char(94) OVERLAY(SRCDTA:7);                                                            000092
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000093                                                                                                                      000093
 000094      condNot                  Char(1) OVERLAY(SRCDTA:9);                                                             000094
 000095      condInd                  Char(2) OVERLAY(SRCDTA:10);                                                            000095
 000096      factor1                  Char(14) OVERLAY(SRCDTA:12);                                                           000096
 000097      opCode                   Char(10) OVERLAY(SRCDTA:26);                                                           000097
 000098      factor2                  Char(14) OVERLAY(SRCDTA:36);                                                           000098
 000099      result                   Char(14) OVERLAY(SRCDTA:50);                                                           000099
 000100      len                      Char(5) OVERLAY(SRCDTA:64);                                                            000100
 000101      dec                      Char(2) OVERLAY(SRCDTA:69);                                                            000101
 000102      hi                       Char(2) OVERLAY(SRCDTA:71);                                                            000102
 000103      lw                       Char(2) OVERLAY(SRCDTA:73);                                                            000103
 000104      eq                       Char(2) OVERLAY(SRCDTA:75);                                                            000104
 000105      comment                  Char(20) OVERLAY(SRCDTA:81);                                                           000105
 000106                                                                                                                      000106
 000107      extFactor2               Char(45) OVERLAY(SRCDTA:36);                                                           000107
 000108                                                                                                                      000108
 000109      nonPrefix                Char(95) OVERLAY(SRCDTA:6);                                                            000109
 000110                                                                                                                      000110
 000111      procType                 Char(1) OVERLAY(SRCDTA:24);                                                            000111
 000112      procKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000112
 000113                                                                                                                      000113
 000114      declName                 Char(15) OVERLAY(SRCDTA:7);                                                            000114
 000115      declExt                  Char(1) OVERLAY(SRCDTA:22);                                                            000115
 000116      declPrefix               Char(1) OVERLAY(SRCDTA:23);                                                            000116
 000117      declType                 Char(2) OVERLAY(SRCDTA:24);                                                            000117
 000118      declSuffix               Char(1) OVERLAY(SRCDTA:26);                                                            000118
 000119      declFrom                 Char(7) OVERLAY(SRCDTA:26);                                                            000119
 000120      declLen                  Char(7) Overlay(SRCDTA:33);                                                            000120
 000121      declAttr                 Char(1) Overlay(SRCDTA:40);                                                            000121
 000122      declScale                Char(3) Overlay(SRCDTA:41);                                                            000122
 000123      declKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000123
 000124      declOptions              Char(73) Overlay(SRCDTA:7);                                                            000124
 000125                                                                                                                      000125
 000126      FileSpec                 Char(100) Overlay(SRCDTA:1);                                                           000126
 000127      fileName                 Char(10) Overlay(FileSpec:7);                                                          000127
 000128      fileUsage                Char(1) Overlay(FileSpec:17);                                                          000128
 000129      fileDesig                Char(1) Overlay(FileSpec:18);                                                          000129
 000130      fileAdd                  Char(1) Overlay(FileSpec:20);                                                          000130
 000131      fileExternal             Char(1) Overlay(FileSpec:22);                                                          000131
 000132      fileKeyed                Char(1) Overlay(FileSpec:34);                                                          000132
 000133      fileDevice               Char(7) Overlay(FileSpec:36);                                                          000133
 000134      fileKeywords             Char(37) Overlay(FileSpec:44);                                                         000134
 000135   End-DS;                                                                                                            000135
 000136                                                                                                                      000136
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000137   // Display file indicators ------------------------------------------------------------------                      000137
 000138   Dcl-DS IndicatorDS;                                                                                                000138
 000139    // 01-30: Function keys                                                                                           000139
 000140    // 31-59: Conditioning indicators (error)                                                                         000140
 000141    // 60-89: Conditioning indicators (non-error)                                                                     000141
 000142    // 90-99: General indicators                                                                                      000142
 000143   // Report file indicators -------------------------------------------------------------------                      000143
 000144    // 01-79: Conditioning indicators (non-error)                                                                     000144
 000145      cndIndicators             Ind Pos(01) DIM(79);                                                                  000145
 000146    // 80-89: Report control                                                                                          000146
 000147      overFlow                  Ind Pos(80);                                                                          000147
 000148    // 90-99: General indicators                                                                                      000148
 000149      errorInd                  Ind Pos(99) INZ(*OFF);                  // Global error                               000149
 000150   End-DS;                                                                                                            000150
 000151                                                                                                                      000151
 000152   Dcl-DS DCLPR                    QUALIFIED;                                                                         000152
 000153      decl                     Char(7) INZ('Dcl-PR ');                                                                000153
 000154      procName                 Char(16);                                                                              000154
 000155      type                     Char(9);                                                                               000155
 000156      definition               Char(37);                                                                              000156
 000157      comment                  Char(23);                                                                              000157
 000158      fieldName                Char(23) Pos(4);                                                                       000158
 000159   End-DS;                                                                                                            000159
 000160                                                                                                                      000160
 000161   Dcl-DS DCLP                     QUALIFIED;                           // Test comment                               000161
 000162      decl                     Char(9) INZ('Dcl-Proc ');                                                              000162
 000163      definition               Char(61);                                                                              000163
 000164      comment                  Char(23);                                                                              000164
 000165   End-DS;                                                                                                            000165
 000166                                                                                                                      000166
 000167   Dcl-DS DCLS                     QUALIFIED;                                                                         000167
 000168      decl                     Char(6) INZ('Dcl-S ');                                                                 000168
 000169      fieldName                Char(17);                                                                              000169
 000170      type                     Char(9);                                                                               000170
 000171      definition               Char(37);                                                                              000171
 000172      comment                  Char(23);                                                                              000172
 000173   End-DS;                                                                                                            000173
 000174                                                                                                                      000174
 000175   Dcl-DS DCLF                     QUALIFIED;                                                                         000175
 000176      decl                     Char(6) INZ('Dcl-F ');                                                                 000176
 000177      fileName                 Char(15);                                                                              000177
 000178      device                   Char(8);                                                                               000178
 000179      definition               Char(44);                                                                              000179
 000180      comment                  Char(23) Pos(70);                                                                      000180
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000181   End-DS;                                                                                                            000181
 000182                                                                                                                      000182
 000183   Dcl-DS DCLH                     QUALIFIED;                                                                         000183
 000184      decl                     Char(8) INZ('Ctl-Opt ');                                                               000184
 000185      options                  Char(62);                                                                              000185
 000186      comment                  Char(23);                                                                              000186
 000187   End-DS;                                                                                                            000187
 000188                                                                                                                      000188
 000189   //-------------------------------------------------------------------------------------------                      000189
 000190   // S T A N D - A L O N E   V A R I A B L E S                                                                       000190
 000191   //-------------------------------------------------------------------------------------------                      000191
 000192   // Template variables (required - do not alter).                                                                   000192
 000193   Dcl-S cfgCommitControl                                               // Test comment                               000193
 000194                               Char(7) INZ('*SLAVE ');                  // *MASTER/*SLAVE                             000194
 000195   Dcl-S cfgCloseDown          Char(1) INZ('N');                        // Close down program?                        000195
 000196   Dcl-S initialCall           Char(1) INZ(*Blank);                                                                   000196
 000197                                                                                                                      000197
 000198   // End of Template variables (required - do not alter).                                                            000198
 000199   //-------------------------------------------------------------------------------------------                      000199
 000200   Dcl-S QopCodeUP             Char(10) DIM(66) PERRCD(1) CTDATA;                                                     000200
 000201   Dcl-S QopCodeLO             Char(10) DIM(66) ALT(QopCodeUP);                                                       000201
 000202   Dcl-S QdeclUP               Char(10) DIM(12) PERRCD(1) CTDATA;                                                     000202
 000203   Dcl-S QdeclLO               Char(10) DIM(12) ALT(QdeclUP);                                                         000203
 000204   Dcl-S Qcomments             Char(92) DIM(3) CTDATA;                                                                000204
 000205   Dcl-S x                   Packed(5:0);                                                                             000205
 000206   Dcl-S y                   Packed(5:0);                                                                             000206
 000207   Dcl-S i                   Packed(5:0);                                                                             000207
 000208   Dcl-S j                   Packed(5:0);                                                                             000208
 000209   Dcl-S blanks                Char(30) INZ(*Blanks);                                                                 000209
 000210   Dcl-S maxIndent           Packed(5:0) INZ(15);                                                                     000210
 000211   Dcl-S movedDefs                 LIKE(result) DIM(9999);                                                            000211
 000212   Dcl-S moveDef                Ind INZ(*Off);                                                                        000212
 000213                                                                                                                      000213
 000214   Dcl-S fromFileLib           Char(21);                                                                              000214
 000215   Dcl-S toFileLib             Char(21);                                                                              000215
 000216                                                                                                                      000216
 000217   Dcl-S operator              Char(10);                                                                              000217
 000218   Dcl-S operatorEnd         Packed(5:0);                                                                             000218
 000219   Dcl-S newOperator        VarChar(10);                                                                              000219
 000220   Dcl-S nonConvRsn                LIKE(codeLine);                                                                    000220
 000221                                                                                                                      000221
 000222   Dcl-S inCode                 Ind INZ(*Off);                                                                        000222
 000223   Dcl-S inArrayData            Ind INZ(*Off);                                                                        000223
 000224   Dcl-S inComment              Ind INZ(*Off);                                                                        000224
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000225   Dcl-S inDeclaration          Ind INZ(*Off);                                                                        000225
 000226   Dcl-S inPrototype            Ind INZ(*Off);                                                                        000226
 000227   Dcl-S inInterface            Ind INZ(*Off);                                                                        000227
 000228   Dcl-S inDatastructure                                                                                              000228
 000229                                Ind INZ(*Off);                                                                        000229
 000230   Dcl-S inExtProc              Ind INZ(*Off);                                                                        000230
 000231   Dcl-S endDS                  Ind INZ(*Off);                                                                        000231
 000232   Dcl-S inDirective            Ind INZ(*Off);                                                                        000232
 000233   Dcl-S inFreeFormat           Ind INZ(*On);                                                                         000233
 000234   Dcl-S inDeclProc             Ind INZ(*Off);                                                                        000234
 000235   Dcl-S indent                 Ind INZ(*Off);                                                                        000235
 000236   Dcl-S inSpan                 Ind INZ(*Off);                                                                        000236
 000237   Dcl-S inCase                 Ind INZ(*Off);                                                                        000237
 000238   Dcl-S convert                Ind INZ(*Off);                                                                        000238
 000239   Dcl-S unindent               Ind INZ(*Off);                                                                        000239
 000240   Dcl-S defsMoved              Ind INZ(*Off);                                                                        000240
 000241   Dcl-S dropLine               Ind INZ(*Off);                                                                        000241
 000242   Dcl-S codeStart                 LIKE(SRCSEQ) INZ(0);                                                               000242
 000243   Dcl-S endLine                   LIKE(SRCSEQ) INZ(0);                 // Close struct here.                         000243
 000244   Dcl-S endFound               Ind;                                                                                  000244
 000245   Dcl-S endDeclType           Char(2);                                                                               000245
 000246                                                                                                                      000246
 000247   Dcl-S savedLineType         Char(1);                                                                               000247
 000248                                                                                                                      000248
 000249   Dcl-S increment           Packed(1:0) INZ(0);                                                                      000249
 000250   Dcl-S indentCount         Packed(5:0) INZ(0);                                                                      000250
 000251   Dcl-S indentSize          Packed(1:0) INZ(3);                                                                      000251
 000252   Dcl-S indentOffset        Packed(5:0) INZ(0);                                                                      000252
 000253   Dcl-S prevOffset          Packed(5:0) INZ(0);                                                                      000253
 000254   Dcl-S currOffset          Packed(5:0) INZ(0);                                                                      000254
 000255   Dcl-S lineEnd             Packed(5:0) INZ(0);                                                                      000255
 000256   Dcl-S mainlineIndent      Packed(5:0) INZ(1);                                                                      000256
 000257                                                                                                                      000257
 000258   Dcl-S savedSRCDTA               LIKE(SRCDTA);                                                                      000258
 000259   Dcl-S sourceLine            Char(93);                                                                              000259
 000260   Dcl-S overflowLine       VarChar(92);                                                                              000260
 000261   Dcl-S workDirective         Char(10);                                                                              000261
 000262   Dcl-S workLineType          Char(1);                                                                               000262
 000263   Dcl-S workDeclType          Char(2);                                                                               000263
 000264   Dcl-S workDeclAttr          Char(1);                                                                               000264
 000265   Dcl-S workDeclName          Char(50);                                                                              000265
 000266   Dcl-S workDeclLine              LIKE(SRCSEQ);                                                                      000266
 000267   Dcl-S workDeclKeywords   VarChar(92);                                                                              000267
 000268                                                                                                                      000268
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000269   Dcl-S tempDeclType          Char(2);                                                                               000269
 000270   Dcl-S tempDeclLine              LIKE(SRCSEQ);                                                                      000270
 000271   Dcl-S tempSavedName         Char(80);                                                                              000271
 000272                                                                                                                      000272
 000273   Dcl-S workFileUsage         Char(1);                                                                               000273
 000274   Dcl-S workFileDesig         Char(1);                                                                               000274
 000275   Dcl-S workFileAdd           Char(1);                                                                               000275
 000276   Dcl-S workFileKeyed         Char(1);                                                                               000276
 000277   Dcl-S workFileDevice        Char(7);                                                                               000277
 000278   Dcl-S checkLength         Packed(5:0);                                                                             000278
 000279   Dcl-S workLength          Packed(7:0);                                                                             000279
 000280                                                                                                                      000280
 000281   Dcl-S savedComment          Char(20);                                                                              000281
 000282   Dcl-S savedName             Char(80);                                                                              000282
 000283                                                                                                                      000283
 000284   Dcl-S padResult              Ind INZ(*Off);                                                                        000284
 000285   Dcl-S padTarget                 LIKE(result);                                                                      000285
 000286                                                                                                                      000286
 000287   Dcl-S scanString                LIKE(factor1);                                                                     000287
 000288   Dcl-S scanBase                  LIKE(factor2);                                                                     000288
 000289   Dcl-S scanLength            Char(10);                                                                              000289
 000290   Dcl-S scanStart             Char(10);                                                                              000290
 000291   Dcl-S scanNoResult           Ind INZ(*Off);                                                                        000291
 000292                                                                                                                      000292
 000293   Dcl-S substLen              Char(10);                                                                              000293
 000294   Dcl-S substStart            Char(10);                                                                              000294
 000295                                                                                                                      000295
 000296   Dcl-S setOff                 Ind INZ(*Off);                                                                        000296
 000297   Dcl-S setOffInd1            Char(2);                                                                               000297
 000298   Dcl-S setOffInd2            Char(2);                                                                               000298
 000299   Dcl-S setOffInd3            Char(2);                                                                               000299
 000300                                                                                                                      000300
 000301   Dcl-S setOn                  Ind INZ(*Off);                                                                        000301
 000302   Dcl-S setOnInd1             Char(2);                                                                               000302
 000303   Dcl-S setOnInd2             Char(2);                                                                               000303
 000304   Dcl-S setOnInd3             Char(2);                                                                               000304
 000305                                                                                                                      000305
 000306   Dcl-S xlateFrom                 LIKE(factor1);                                                                     000306
 000307   Dcl-S xlateTo                   LIKE(factor1);                                                                     000307
 000308   Dcl-S xlateBase                 LIKE(factor2);                                                                     000308
 000309   Dcl-S xlateStart            Char(10);                                                                              000309
 000310                                                                                                                      000310
 000311   Dcl-S caseSubRoutine        Char(10);                                                                              000311
 000312   Dcl-S caseOperator          Char(4);                                                                               000312
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000313                                                                                                                      000313
 000314   Dcl-S catFactor1                LIKE(factor1);                                                                     000314
 000315   Dcl-S catFactor2                LIKE(factor2);                                                                     000315
 000316   Dcl-S catCount            Packed(5:0) INZ(0);                                                                      000316
 000317   Dcl-S catBlanks                 LIKE(factor2);                                                                     000317
 000318                                                                                                                      000318
 000319   Dcl-S durDuration               LIKE(factor2);                                                                     000319
 000320   Dcl-S durCode                   LIKE(factor2);                                                                     000320
 000321   Dcl-S durNewDate             Ind INZ(*Off);                                                                        000321
 000322                                                                                                                      000322
 000323   Dcl-S inEval                 Ind INZ(*Off);                                                                        000323
 000324   Dcl-S evalOperator              Like(opCode);                                                                      000324
 000325   Dcl-S evalOffset          Packed(5:0);                                                                             000325
 000326                                                                                                                      000326
 000327   Dcl-S inCallP                Ind INZ(*Off);                                                                        000327
 000328   Dcl-S callPOperator             Like(opCode);                                                                      000328
 000329   Dcl-S callPOffset         Packed(5:0);                                                                             000329
 000330                                                                                                                      000330
 000331   Dcl-S inDo                   Ind INZ(*Off);                                                                        000331
 000332   Dcl-S doOperator                Like(opCode);                                                                      000332
 000333   Dcl-S doCompare             Char(2);                                                                               000333
 000334                                                                                                                      000334
 000335   Dcl-S inIf                   Ind INZ(*Off);                                                                        000335
 000336   Dcl-S ifOperator                Like(opCode);                                                                      000336
 000337   Dcl-S ifCompare             Char(2);                                                                               000337
 000338                                                                                                                      000338
 000339   Dcl-S inWhen                 Ind INZ(*Off);                                                                        000339
 000340   Dcl-S whenOperator              Like(opCode);                                                                      000340
 000341   Dcl-S whenCompare           Char(2);                                                                               000341
 000342                                                                                                                      000342
 000343   Dcl-S inSQL                  Ind INZ(*Off);                                                                        000343
 000344                                                                                                                      000344
 000345   Dcl-S forCount            Packed(5:0) INZ(0);                                                                      000345
 000346   Dcl-S forLevel            Packed(5:0) DIM(99);                          // Allow for 99                            000346
 000347   Dcl-S forFactor1                LIKE(factor1);                                                                     000347
 000348   Dcl-S forFactor2                LIKE(factor2);                                                                     000348
 000349                                                                                                                      000349
 000350   Dcl-S doCount             Packed(5:0) INZ(0);                                                                      000350
 000351   Dcl-S doLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000351
 000352                                                                                                                      000352
 000353   Dcl-S slCount             Packed(5:0) INZ(0);                                                                      000353
 000354   Dcl-S slLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000354
 000355                                                                                                                      000355
 000356   Dcl-S divFactor1                LIKE(factor1);                                                                     000356
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000357   Dcl-S divFactor2                LIKE(factor2);                                                                     000357
 000358                                                                                                                      000358
 000359   Dcl-S ERRCheck               Ind INZ(*Off);                                                                        000359
 000360   Dcl-S ERRInd                Char(2);                                                                               000360
 000361                                                                                                                      000361
 000362   Dcl-S foundCheck             Ind INZ(*Off);                                                                        000362
 000363   Dcl-S foundInd              Char(2);                                                                               000363
 000364                                                                                                                      000364
 000365   Dcl-S NRFCheck               Ind INZ(*Off);                                                                        000365
 000366   Dcl-S NRFInd                Char(2);                                                                               000366
 000367   Dcl-S NRFFile                   LIKE(factor2);                                                                     000367
 000368                                                                                                                      000368
 000369   Dcl-S EOFCheck               Ind INZ(*Off);                                                                        000369
 000370   Dcl-S EOFInd                Char(2);                                                                               000370
 000371   Dcl-S EOFFile                   LIKE(factor2);                                                                     000371
 000372                                                                                                                      000372
 000373   Dcl-S HICheck                Ind INZ(*Off);                                                                        000373
 000374   Dcl-S HIInd                 Char(2);                                                                               000374
 000375   Dcl-S HiFactor1                 LIKE(factor1);                                                                     000375
 000376   Dcl-S HiFactor2                 LIKE(factor2);                                                                     000376
 000377                                                                                                                      000377
 000378   Dcl-S LWCheck                Ind INZ(*Off);                                                                        000378
 000379   Dcl-S LWInd                 Char(2);                                                                               000379
 000380   Dcl-S LWFactor1                 LIKE(factor1);                                                                     000380
 000381   Dcl-S LWFactor2                 LIKE(factor2);                                                                     000381
 000382                                                                                                                      000382
 000383   Dcl-S EQCheck                Ind INZ(*Off);                                                                        000383
 000384   Dcl-S EQInd                 Char(2);                                                                               000384
 000385   Dcl-S EQFactor1                 LIKE(factor1);                                                                     000385
 000386   Dcl-S EQFactor2                 LIKE(factor2);                                                                     000386
 000387                                                                                                                      000387
 000388   Dcl-S equalCheck             Ind INZ(*Off);                                                                        000388
 000389   Dcl-S equalInd              Char(2);                                                                               000389
 000390                                                                                                                      000390
 000391   Dcl-S countSource         Packed(7:0) INZ(0);                                                                      000391
 000392   Dcl-S countTarget         Packed(7:0) INZ(0);                                                                      000392
 000393   Dcl-S countEligible       Packed(7:0) INZ(0);                                                                      000393
 000394   Dcl-S countConv           Packed(7:0) INZ(0);                                                                      000394
 000395   Dcl-S countNotConv        Packed(7:0) INZ(0);                                                                      000395
 000396   Dcl-S countMoved          Packed(7:0) INZ(0);                                                                      000396
 000397                                                                                                                      000397
 000398   //Dcl-S testb                   BinDec(2:0);                                                                       000398
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000400   //-------------------------------------------------------------------------------------------                      000400
 000401   // Main Procedure                                                                                                  000401
 000402   //-------------------------------------------------------------------------------------------                      000402
 000403      // Initialize                                                                                                   000403
 000001=ISRCREC                                                                                                             1000001
         *--------------------------------------------------------------------------------------------*                     1
         * RPG record format  . . . . :  SRCREC                                                       *                     1
         * External format  . . . . . :  QRPGLESRC : CVTRPGFREE/QRPGLESRC                             *                     1
         *--------------------------------------------------------------------------------------------*                     1
 000002=I                             S    1    6 2SRCSEQ                                                                   1000002
 000003=I                             S    7   12 0SRCDAT                                                                   1000003
 000004=I                             A   13  112  SRCDTA                                                                   1000004
 000404      Exsr subInitialise;                                                                                             000404
 000405                                                                                                                      000405
 000406      // Perform required function                                                                                    000406
 000407      Exsr subUserFunction;                                                                                           000407
 000408                                                                                                                      000408
 000409      // Terminate the program.                                                                                       000409
 000410      Exsr subExitProgram;                                                                                            000410
 000411   //-------------------------------------------------------------------------------------------                      000411
 000412                                                                                                                      000412
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000414   //-------------------------------------------------------------------------------------------                      000414
 000415   // USER: Perform required function.                                                                                000415
 000416   //-------------------------------------------------------------------------------------------                      000416
 000417   BegSr subUserFunction;                                                                                             000417
 000418                                                                                                                      000418
 000419      // ** Code the necessary processing here.                                                                       000419
 000420      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         000420
 000421                                                                                                                      000421
 000422      // Read through the source member.                                                                              000422
 000423      Read SRCREC;                                                                                                    000423
 000424                                                                                                                      000424
 000425      DoW not %eof(QRPGLESRC);                                                                   B01                  000425
 000426         countSource += 1;                                                                        01                  000426
 000427                                                                                                                      000427
 000428         Exsr subUserReformatLine;                                                                01                  000428
 000429                                                                                                                      000429
 000430         Exsr subUserSetIndicators;                                                               01                  000430
 000431                                                                                                                      000431
 000432         // Old-style SCAN without a result field.                                                                    000432
 000433         If scanNoResult;                                                                        B02                  000433
 000434            Clear nonPrefix;                                                                      02                  000434
 000435                                                                                                                      000435
 000436            codeLine = '// Old-style SCAN without a result!';                                     02                  000436
 000437            Exsr subUserReformatLine;                                                             02                  000437
 000438            codeLine = 'EndIf;';                                                                  02                  000438
 000439            Exsr subUserReformatLine;                                                             02                  000439
 000440                                                                                                                      000440
 000441            scanNoResult = *Off;                                                                  02                  000441
 000442         EndIf;                                                                                  E02                  000442
 000443                                                                                                                      000443
 000444         // If in a CAS statement, record the subroutine to call.                                                     000444
 000445         If inCase and caseSubroutine <> *Blanks;                                                B02                  000445
 000446            codeLine = 'ExSr ' + %trim(caseSubRoutine) + ';';                                     02                  000446
 000447            Exsr subUserReformatLine;                                                             02                  000447
 000448            caseSubRoutine = *Blanks;                                                             02                  000448
 000449         EndIf;                                                                                  E02                  000449
 000450                                                                                                                      000450
 000451         Read SRCREC;                                                                             01                  000451
 000452      EndDo;                                                                                     E01                  000452
 000453                                                                                                                      000453
 000454      // Handle overflow.                                                                                             000454
 000455      If overFlow;                                                                               B01                  000455
 000456                                                                                                                      000456
 000457         // Print page headings.                                                                                      000457
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000458         Z1QPAG += 1;                                                                             01                  000458
 000459         Write Z1PAGHDG;                                                                          01                  000459
 000460                                                                                                                      000460
 000461         ZTFRFL = fromFileLib;                                                                    01                  000461
 000462         ZTTOFL = toFileLib;                                                                      01                  000462
 000463                                                                                                                      000463
 000464         Write Z1TOPPAG;                                                                          01                  000464
 000465                                                                                                                      000465
 000466         overFlow = *Off;                                                                         01                  000466
 000467      EndIf;                                                                                     E01                  000467
 000468                                                                                                                      000468
 000469      Z1FRMB = QpFromMbr;                                                                                             000469
 000470      Z1TOMB = QpToMbr;                                                                                               000470
 000471      Z1CTSC = countSource;                                                                                           000471
 000472      Z1CTTG = countTarget;                                                                                           000472
 000473      Z1CTEL = countEligible;                                                                                         000473
 000474      Z1CTCV = countConv;                                                                                             000474
 000475      Z1CTNV = countNotConv;                                                                                          000475
 000476      Z1CTMV = countMoved;                                                                                            000476
 000477      If countEligible = 0;                                                                      B01                  000477
 000478         Z1CNVR = 0;                                                                              01                  000478
 000479      Else;                                                                                      X01                  000479
 000480         Z1CNVR = countConv * 100 / countEligible;                                                01                  000480
 000481      EndIf;                                                                                     E01                  000481
 000482                                                                                                                      000482
 000483      // Print detail format.                                                                                         000483
 000484      Write Z1DETAIL;                                                                                                 000484
 000485                                                                                                                      000485
 000486      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         000486
 000487                                                                                                                      000487
 000488   EndSr;                                                                                                             000488
 000489   //-------------------------------------------------------------------------------------------                      000489
 000490                                                                                                                      000490
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000492   //-------------------------------------------------------------------------------------------                      000492
 000493   // Perform conversion/reformatting on the current line.                                                            000493
 000494   //-------------------------------------------------------------------------------------------                      000494
 000495   BegSr subUserReformatLine;                                                                                         000495
 000496                                                                                                                      000496
 000497      inDirective = *Off;                                                                                             000497
 000498      inComment = *Off;                                                                                               000498
 000499      increment = 0;                                                                                                  000499
 000500                                                                                                                      000500
 000501      workDirective = %xlate(lo:up:directive);                                                                        000501
 000502      workLineType = %xlate(lo:up:lineType);                                                                          000502
 000503                                                                                                                      000503
 000504      convert = *Off;                                                                                                 000504
 000505      nonConvRsn = *Blanks;                                                                                           000505
 000506                                                                                                                      000506
 000507      sourceLine = codeLine;     // Start with what is already there.                                                 000507
 000508                                                                                                                      000508
 000509      // Array data reached?                                                                                          000509
 000510      If %subst(prefix:1:3) = '** '                                                              B01                  000510
 000511      or %subst(SRCDTA:1:8) = '**CTDATA';                                                        B01                  000511
 000512         inCode = *Off;                                                                           01                  000512
 000513         inDeclaration = *Off;                                                                    01                  000513
 000514         inArrayData = *On;                                                                       01                  000514
 000515      EndIf;                                                                                     E01                  000515
 000516                                                                                                                      000516
 000517      If not inArrayData;                                                                        B01                  000517
 000518         //----------------------------------------------------------------------------------                         000518
 000519         // Determine Line Type                                                                                       000519
 000520         If workLineType = 'C';                  // C-Spec                                       B02                  000520
 000521            inCode = *On;                                                                         02                  000521
 000522            //         ElseIf workLineType = 'P'               // P-Spec                                              000522
 000523            //             or %len(%trim(codeLine)) >= 4                                                              000523
 000524            //            and %xlate(lo:up:%subst(%trim(codeLine):1:4)) = 'DCL-';                                     000524
 000525            //            inCode = *Off;                                                                              000525
 000526            //            defsMoved = *Off;                                                                           000526
 000527         ElseIf workLineType = 'P';              // P-Spec                                       X02                  000527
 000528            inCode = *Off;                                                                        02                  000528
 000529            defsMoved = *Off;                                                                     02                  000529
 000530         ElseIf workLineType = 'D';              // Declaration.                                 X02                  000530
 000531            inCode = *Off;                                                                        02                  000531
 000532         ElseIf workLineType = 'H';              // Header spec.                                 X02                  000532
 000533            inCode = *Off;                                                                        02                  000533
 000534         ElseIf workLineType = 'F';              // File spec.                                   X02                  000534
 000535            inCode = *Off;                                                                        02                  000535
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000536         ElseIf workLineType = 'O';              // O-Spec                                       X02                  000536
 000537            inCode = *Off;                                                                        02                  000537
 000538         ElseIf workLineType = 'I';              // I-Spec                                       X02                  000538
 000539            inCode = *On;                                                                         02                  000539
 000540         ElseIf %check(validSpecs:workLineType) <> 0;    // Invalid spec type.                   X02                  000540
 000541            workLineType = *Blanks;                                                               02                  000541
 000542            lineType = *Blank;                           // Clear it!                             02                  000542
 000543         EndIf;                                                                                  E02                  000543
 000544                                                                                                                      000544
 000545         If %trim(workDirective) = '/FREE';                                                      B02                  000545
 000546            // In a free-format directive, so we must be in code too.                                                 000546
 000547            If not inFreeFormat;                                                                 B03                  000547
 000548               inDirective = *On;                                                                 03                  000548
 000549               inCode = *On;                                                                      03                  000549
 000550               inFreeFormat = *On;                                                                03                  000550
 000551               lineType = ' ';                                                                    03                  000551
 000552               workLineType = ' ';                                                                03                  000552
 000553               If QpDirectives = 'Y';                                                            B04                  000553
 000554                  directive = '/Free';                                                            04                  000554
 000555               Else;                                                                             X04                  000555
 000556                  dropLine = *On;                                                                 04                  000556
 000557               EndIf;                                                                            E04                  000557
 000558            Else;                                                                                X03                  000558
 000559               dropLine = *On;   // Not needed.                                                   03                  000559
 000560            EndIf;                                                                               E03                  000560
 000561         ElseIf %trim(workDirective) = '/END-FREE';                                              X02                  000561
 000562            // At the end of a directive, so we can't be in free format any more.                                     000562
 000563            //inDirective = *On;                                                                                      000563
 000564            //directive = '/End-Free';                                                                                000564
 000565            //inFreeFormat = *Off;                                                                                    000565
 000566            dropLine = *On;                                                                       02                  000566
 000567         ElseIf %trim(workDirective) = '/EJECT';                                                 X02                  000567
 000568            inDirective = *On;                                                                    02                  000568
 000569            lineType = ' ';                                                                       02                  000569
 000570            workLineType = ' ';                                                                   02                  000570
 000571         ElseIf %subst(workDirective:1:5) = '/COPY';                                             X02                  000571
 000572            inDirective = *On;                                                                    02                  000572
 000573            lineType = ' ';                                                                       02                  000573
 000574            workLineType = ' ';                                                                   02                  000574
 000575         ElseIf %subst(workDirective:1:3) = '/IF';                                               X02                  000575
 000576            inDirective = *On;                                                                    02                  000576
 000577            lineType = ' ';                                                                       02                  000577
 000578            workLineType = ' ';                                                                   02                  000578
 000579         ElseIf %subst(workDirective:1:6) = '/ENDIF';                                            X02                  000579
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000580            inDirective = *On;                                                                    02                  000580
 000581            lineType = ' ';                                                                       02                  000581
 000582            workLineType = ' ';                                                                   02                  000582
 000583         ElseIf %subst(workDirective:1:7) = '/DEFINE';                                           X02                  000583
 000584            inDirective = *On;                                                                    02                  000584
 000585            lineType = ' ';                                                                       02                  000585
 000586            workLineType = ' ';                                                                   02                  000586
 000587         ElseIf %subst(workDirective:1:6) = '/SPACE';                                            X02                  000587
 000588            inDirective = *On;                                                                    02                  000588
 000589            lineType = ' ';                                                                       02                  000589
 000590            workLineType = ' ';                                                                   02                  000590
 000591         ElseIf %subst(workDirective:1:6) = '/TITLE';                                            X02                  000591
 000592            inDirective = *On;                                                                    02                  000592
 000593            lineType = ' ';                                                                       02                  000593
 000594            workLineType = ' ';                                                                   02                  000594
 000595         ElseIf (%subst(workDirective:1:1) = '*'                                                 X02                  000595
 000596            or %subst(workDirective:1:2) = '//')                                                 X02                  000596
 000597            and (lineType = *Blank or inCode);                                                   X02                  000597
 000598            //            and inCode;                                                                                 000598
 000599            // This is a comment line.                                                                                000599
 000600            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000600
 000601               inComment = *On;                                                                   03                  000601
 000602            EndIf;                                                                               E03                  000602
 000603            If %subst(workDirective:1:2) = '//';                                                 B03                  000603
 000604               %subst(directive:1:2) = '  ';                                                      03                  000604
 000605            Else;                                                                                X03                  000605
 000606               %subst(directive:1:1) = ' ';                                                       03                  000606
 000607            EndIf;                                                                               E03                  000607
 000608            If workLineType = 'C' or workLineType = 'D';                                         B03                  000608
 000609               lineType = ' ';                                                                    03                  000609
 000610               workLineType = ' ';                                                                03                  000610
 000611            EndIf;                                                                               E03                  000611
 000612            // Retain blank comment markers?                                                                          000612
 000613            If QpRetBlnkCmt = 'N' and %len(%trim(codeLine)) = 0;                                 B03                  000613
 000614               // Leave the line blank, devoid of any marker.                                                         000614
 000615            Else;                                                                                X03                  000615
 000616               codeLine = '//' + codeLine;                                                        03                  000616
 000617            EndIf;                                                                               E03                  000617
 000618         ElseIf %subst(workDirective:1:1) = '*';                                                 X02                  000618
 000619            //            and workLineType = 'O';                                                                     000619
 000620            // Leave the line as it is.                                                                               000620
 000621            inComment = *On;                                                                      02                  000621
 000622         ElseIf %len(%trim(codeLine)) = 0;                                                       X02                  000622
 000623            // Just a 'spacer' line - keep it but drop the line type.                                                 000623
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000624            lineType = ' ';                                                                       02                  000624
 000625            workLineType = ' ';                                                                   02                  000625
 000626         ElseIf %len(%trim(codeLine)) >= 2                                                       X02                  000626
 000627            and %subst(%trim(codeLine):1:2) = '//'                                               X02                  000627
 000628            and (workLineType = *Blank or inCode);                                               X02                  000628
 000629            // This is a comment line.                                                                                000629
 000630            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000630
 000631               inComment = *On;                                                                   03                  000631
 000632            EndIf;                                                                               E03                  000632
 000633            // Retain blank comment markers?                                                                          000633
 000634            If QpRetBlnkCmt = 'N' and %len(%trim(%subst(codeLine:3)))                            B03                  000634
 000635                                              = 0;                                               B03                  000635
 000636               // Leave the line blank, devoid of any marker.                                                         000636
 000637               codeLine = *Blanks;                                                                03                  000637
 000638            EndIf;                                                                               E03                  000638
 000639         ElseIf comment <> *Blanks                                                               X02                  000639
 000640            and %len(%trim(%subst(codeLine:1:73))) = 0;                                          X02                  000640
 000641            // This is a blank line with a comment section.                                                           000641
 000642            %subst(codeLine:71:2) = '//';                                                         02                  000642
 000643            inComment = *On;                                                                      02                  000643
 000644         EndIf;                                                                                  E02                  000644
 000645                                                                                                                      000645
 000646         //----------------------------------------------------------------------------------                         000646
 000647         // Convert fixed-format to free-format?                                                                      000647
 000648         If not inComment                                                                        B02                  000648
 000649         and not inDirective;                                                                    B02                  000649
 000650                                                                                                                      000650
 000651            If workLineType = 'C';                                                               B03                  000651
 000652               countEligible += 1;                                                                03                  000652
 000653               countNotConv += 1;                                                                 03                  000653
 000654               operator = %xlate(lo:up:opCode);                                                   03                  000654
 000655               savedComment = comment;                                                            03                  000655
 000656                                                                                                                      000656
 000657               Exsr subUserConvertC_Spec;                                                         03                  000657
 000658                                                                                                                      000658
 000659               If not inComment and not convert                                                  B04                  000659
 000660               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000660
 000661                  nonConvRsn = 'Conversion not currently supported.';                             04                  000661
 000662               EndIf;                                                                            E04                  000662
 000663                                                                                                                      000663
 000664            ElseIf workLineType = 'P';     // Procedure start/end.                               X03                  000664
 000665               countEligible += 1;                                                                03                  000665
 000666               countNotConv += 1;                                                                 03                  000666
 000667               operator = *Blanks;                                                                03                  000667
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000668               savedComment = comment;                                                            03                  000668
 000669                                                                                                                      000669
 000670               Exsr subUserConvertP_Spec;                                                         03                  000670
 000671                                                                                                                      000671
 000672               If not inComment and not convert                                                  B04                  000672
 000673               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000673
 000674                  nonConvRsn = 'Conversion not currently supported.';                             04                  000674
 000675               EndIf;                                                                            E04                  000675
 000676                                                                                                                      000676
 000677            ElseIf workLineType = 'D';     // Declaration.                                       X03                  000677
 000678               countEligible += 1;                                                                03                  000678
 000679               countNotConv += 1;                                                                 03                  000679
 000680               savedComment = comment;                                                            03                  000680
 000681                                                                                                                      000681
 000682               Exsr subUserConvertD_Spec;                                                         03                  000682
 000683                                                                                                                      000683
 000684               If not inComment and not convert                                                  B04                  000684
 000685               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000685
 000686                  //nonConvRsn = 'Conversion not currently supported.';                                               000686
 000687               EndIf;                                                                            E04                  000687
 000688                                                                                                                      000688
 000689            ElseIf workLineType = 'F';     // File.                                              X03                  000689
 000690               countEligible += 1;                                                                03                  000690
 000691               countNotConv += 1;                                                                 03                  000691
 000692               savedComment = comment;                                                            03                  000692
 000693                                                                                                                      000693
 000694               Exsr subUserConvertF_Spec;                                                         03                  000694
 000695                                                                                                                      000695
 000696               If not inComment and not convert                                                  B04                  000696
 000697               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000697
 000698                  //nonConvRsn = 'Conversion not currently supported.';                                               000698
 000699               EndIf;                                                                            E04                  000699
 000700                                                                                                                      000700
 000701            ElseIf workLineType = 'H';     // Header.                                            X03                  000701
 000702               countEligible += 1;                                                                03                  000702
 000703               countNotConv += 1;                                                                 03                  000703
 000704               savedComment = comment;                                                            03                  000704
 000705                                                                                                                      000705
 000706               Exsr subUserConvertH_Spec;                                                         03                  000706
 000707                                                                                                                      000707
 000708               If not inComment and not convert                                                  B04                  000708
 000709               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000709
 000710                  //nonConvRsn = 'Conversion not currently supported.';                                               000710
 000711               EndIf;                                                                            E04                  000711
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000712                                                                                                                      000712
 000713            ElseIf workLineType = 'O';     // Output spec                                        X03                  000713
 000714               sourceLine = fullLine;                                                             03                  000714
 000715                                                                                                                      000715
 000716            ElseIf workLineType = 'I';     // Input spec                                         X03                  000716
 000717               sourceLine = fullLine;                                                             03                  000717
 000718                                                                                                                      000718
 000719            ElseIf workLineType = ' ' and inCode;                                                X03                  000719
 000720               inFreeFormat = *On;                                                                03                  000720
 000721               // When in an IF we usually want subsequent lines to be pulled back to be                              000721
 000722               // in line with the 'If', but only if those lines start with either 'and'                              000722
 000723               // or 'or'.  Otherwise we retain the existing indentation by turning on                                000723
 000724               // inSpan.                                                                                             000724
 000725               If inIf and %len(%trim(codeLine)) >= 3                                            B04                  000725
 000726               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'AND'                            B04                  000726
 000727               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'OR ';                           B04                  000727
 000728                  inSpan = *On;                                                                   04                  000728
 000729               EndIf;                                                                            E04                  000729
 000730               If inSpan;                                                                        B04                  000730
 000731                  currOffset = %check(' ':codeLine);  // Offset of the continuation line.         04                  000731
 000732               Else;                                                                             X04                  000732
 000733                  prevOffset = %check(' ':codeLine);  // Offset of the parent line.               04                  000733
 000734               EndIf;                                                                            E04                  000734
 000735               sourceLine = %trim(codeLine);         // Free-format already, so trim it.          03                  000735
 000736            Else;                                                                                X03                  000736
 000737               inFreeFormat = *On;                                                                03                  000737
 000738               sourceLine = %trimr(codeLine);        // None of the above, use the raw source     03                  000738
 000739            EndIf;                                                                               E03                  000739
 000740                                                                                                                      000740
 000741            // Converted?                                                                                             000741
 000742            If convert;                                                                          B03                  000742
 000743               countConv += 1;                                                                    03                  000743
 000744               countNotConv -= 1;                                                                 03                  000744
 000745               // Switch to free-format?                                                                              000745
 000746               If not inFreeFormat and not inDeclaration;                                        B04                  000746
 000747                  If QpDirectives = 'Y';                                                         B05                  000747
 000748                     savedSRCDTA = SRCDTA;                                                        05                  000748
 000749                     Clear SRCDTA;                                                                05                  000749
 000750                     directive = '/Free';                                                         05                  000750
 000751                     Exsr subUserWriteLine;                                                       05                  000751
 000752                     SRCDTA = savedSRCDTA;                                                        05                  000752
 000753                  EndIf;                                                                         E05                  000753
 000754                  inFreeFormat = *On;                                                             04                  000754
 000755                  directive = *Blanks;                                                            04                  000755
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000756               EndIf;                                                                            E04                  000756
 000757            EndIf;                                                                               E03                  000757
 000758                                                                                                                      000758
 000759            // Revert to fixed-format?                                                                                000759
 000760            If not convert and (lineType <> *Blanks                                              B03                  000760
 000761            or %subst(workDirective:1:5) = '/COPY');                                             B03                  000761
 000762               //                or  %subst(prefix:1:3) = '** ');        // Array data reached                        000762
 000763               If inFreeFormat and not inDeclaration;                                            B04                  000763
 000764                  If QpDirectives = 'Y';                                                         B05                  000764
 000765                     savedSRCDTA = SRCDTA;                                                        05                  000765
 000766                     Clear SRCDTA;                                                                05                  000766
 000767                     directive = '/End-Free';                                                     05                  000767
 000768                     Exsr subUserWriteLine;                                                       05                  000768
 000769                     SRCDTA = savedSRCDTA;                                                        05                  000769
 000770                  EndIf;                                                                         E05                  000770
 000771                  inFreeFormat = *Off;                                                            04                  000771
 000772                  If not inDirective;                                                            B05                  000772
 000773                     directive = *Blanks;                                                         05                  000773
 000774                  EndIf;                                                                         E05                  000774
 000775               EndIf;                                                                            E04                  000775
 000776               // Record the reason for not converting?                                                               000776
 000777               If nonConvRsn <> *Blanks;                                                         B04                  000777
 000778                  savedSRCDTA = SRCDTA;                                                           04                  000778
 000779                  Clear SRCDTA;                                                                   04                  000779
 000780                  codeLine = '// >>>>> Not converted: ' + nonConvRsn;                             04                  000780
 000781                  Exsr subUserWriteLine;                                                          04                  000781
 000782                  SRCDTA = savedSRCDTA;                                                           04                  000782
 000783               EndIf;                                                                            E04                  000783
 000784               inSpan = *Off;                                                                     03                  000784
 000785            EndIf;                                                                               E03                  000785
 000786         Else;                                                                                   X02                  000786
 000787            // Use source exactly as is.                                                                              000787
 000788            sourceLine = codeLine;                                                                02                  000788
 000789         EndIf;                                                                                  E02                  000789
 000790                                                                                                                      000790
 000791         //----------------------------------------------------------------------------------                         000791
 000792         // If we are in a code section, check if indent is affected at all.                                          000792
 000793         //         If not inDeclaration                                                                              000793
 000794         //         and not inDirective                                                                               000794
 000795         If not inDirective                                                                      B02                  000795
 000796         and not inComment                                                                       B02                  000796
 000797         and not dropLine;                                                                       B02                  000797
 000798            // Isolate the operator to check indentation against.                                                     000798
 000799            //sourceLine = %trimr(codeLine);                                                                          000799
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000800            If inFreeFormat;                                                                     B03                  000800
 000801               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000801
 000802                  operator = *Blanks;                                                             04                  000802
 000803               ElseIf inSQL;                                // Embedded SQL - no operator.       X04                  000803
 000804                  operator = *Blanks;                                                             04                  000804
 000805               Else;                                                                             X04                  000805
 000806                  // Isolate the 'operator' (first word really).                                                      000806
 000807                  operator = %trim(sourceLine);                                                   04                  000807
 000808                  operatorEnd = %scan(' ':%trim(operator)); // Look for end of first 'word'.      04                  000808
 000809                  If operatorEnd = 0;                                                            B05                  000809
 000810                     operatorEnd = %scan(';':operator);  // Only one word - is it an operator     05                  000810
 000811                     If operatorEnd = 0;                                                         B06                  000811
 000812                        operatorEnd = %scan('(':operator);  // Shouldn't match!                   06                  000812
 000813                     EndIf;                                                                      E06                  000813
 000814                  EndIf;                                                                         E05                  000814
 000815                  // If we have an operator, remove any attached extender code.                                       000815
 000816                  If operatorEnd > 0;                                                            B05                  000816
 000817                     operator = %subst(operator:1:operatorEnd - 1);                               05                  000817
 000818                     // Exec SQL?                                                                                     000818
 000819                     If %xlate(lo:up:operator) = 'EXEC';                                         B06                  000819
 000820                        If %scan('SQL':%xlate(lo:up:%trim(sourceLine)):6)                        B07                  000820
 000821                                 > 0;                                                            B07                  000821
 000822                           operator = 'Exec SQL';                                                 07                  000822
 000823                           inSQL = *On;                                                           07                  000823
 000824                        EndIf;                                                                   E07                  000824
 000825                     EndIf;                                                                      E06                  000825
 000826                     operatorEnd = %scan('(':operator);                                           05                  000826
 000827                     If operatorEnd > 1;                                                         B06                  000827
 000828                        operator = %subst(operator:1:operatorEnd - 1);                            06                  000828
 000829                     EndIf;                                                                      E06                  000829
 000830                  EndIf;                                                                         E05                  000830
 000831                                                                                                                      000831
 000832                  If %lookup(%xlate(lo:up:operator):QopCodeUP) > 0                               B05                  000832
 000833                  and not inDeclaration;                                                         B05                  000833
 000834                     inCode = *On;                                                                05                  000834
 000835                  Else;                                                                          X05                  000835
 000836                     If %lookup(%xlate(lo:up:operator):QdeclUP) > 0;                             B06                  000836
 000837                        // Declaration!                                                                               000837
 000838                     Else;                                                                       X06                  000838
 000839                        // Not an operator!                                                                           000839
 000840                        operator = *Blanks;                                                       06                  000840
 000841                        x = %scan('=':sourceLine);                                                06                  000841
 000842                        If x > 0;   // Looks like an assignment.                                 B07                  000842
 000843                           operator = '=';                                                        07                  000843
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000844                           inCode = *On;                                                          07                  000844
 000845                           If workLineType = *Blank;                                             B08                  000845
 000846                              sourceLine = %trim(sourceLine);                                     08                  000846
 000847                           EndIf;                                                                E08                  000847
 000848                        EndIf;                                                                   E07                  000848
 000849                     EndIf;                                                                      E06                  000849
 000850                  EndIf;                                                                         E05                  000850
 000851               EndIf;                                                                            E04                  000851
 000852            Else;                                                                                X03                  000852
 000853               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000853
 000854                  operator = *Blanks;                                                             04                  000854
 000855               Else;                                                                             X04                  000855
 000856                  operator = %xlate(lo:up:opCode);                                                04                  000856
 000857                  If %subst(operator:1:4) <> 'EVAL'                                              B05                  000857
 000858                  and operator <> *Blanks;                                                       B05                  000858
 000859                     // Strip out in-line definitions.                                                                000859
 000860                     len = *Blanks;                                                               05                  000860
 000861                     dec = *Blanks;                                                               05                  000861
 000862                  EndIf;                                                                         E05                  000862
 000863               EndIf;                                                                            E04                  000863
 000864            EndIf;                                                                               E03                  000864
 000865                                                                                                                      000865
 000866            // Convert to upper case for check.                                                                       000866
 000867            operator = %xlate(lo:up:operator);                                                    02                  000867
 000868                                                                                                                      000868
 000869            // Check for indentation level change.                                                                    000869
 000870            Select;                                                                              B03                  000870
 000871               When workDirective = '/EXEC SQL';                                                 X03                  000871
 000872                  increment = 1;                                                                  03                  000872
 000873                  inSQL = *On;                                                                    03                  000873
 000874               When workDirective = '/END-EXEC';                                                 X03                  000874
 000875                  unindent = *On;                                                                 03                  000875
 000876                  increment = -1;                                                                 03                  000876
 000877                  dropLine = *On;                                                                 03                  000877
 000878               When inSQL;                                                                       X03                  000878
 000879                  // Do nothing.                                                                                      000879
 000880               When %subst(operator:1:2) = 'IF';                                                 X03                  000880
 000881                  increment = 1;                                                                  03                  000881
 000882                  inIf = *On;                                                                     03                  000882
 000883               When %subst(operator:1:2) = 'DO';                                                 X03                  000883
 000884                  increment = 1;                                                                  03                  000884
 000885                  inDo = *On;                                                                     03                  000885
 000886                  doCount += 1;                                                                   03                  000886
 000887                  doLevel(doCount) = indentCount;                                                 03                  000887
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000888               When operator = 'FOR';                                                            X03                  000888
 000889                  increment = 1;                                                                  03                  000889
 000890                  forCount += 1;                                                                  03                  000890
 000891                  forLevel(forCount) = indentCount;                                               03                  000891
 000892               When operator = 'SELECT';                                                         X03                  000892
 000893                  increment = 2;                                                                  03                  000893
 000894                  slCount += 1;                                                                   03                  000894
 000895                  slLevel(slCount) = indentCount;                                                 03                  000895
 000896               When operator = 'BEGSR';                                                          X03                  000896
 000897                  increment = 1;                                                                  03                  000897
 000898                  mainlineIndent = 0;                                                             03                  000898
 000899                  indentCount = mainlineIndent;                                                   03                  000899
 000900               When %subst(operator:1:4) = 'DCL-';                                               X03                  000900
 000901                  increment = 0;                                                                  03                  000901
 000902                  mainlineIndent = 1;                                                             03                  000902
 000903                  indentCount = mainlineIndent;                                                   03                  000903
 000904                  defsMoved = *Off;                                                               03                  000904
 000905               When %subst(operator:1:4) = 'END-';                                               X03                  000905
 000906                  increment = 0;                                                                  03                  000906
 000907                  indentCount = mainlineIndent;                                                   03                  000907
 000908               When operator = 'MONITOR';                                                        X03                  000908
 000909                  increment = 1;                                                                  03                  000909
 000910               When operator = 'ENDSL';                                                          X03                  000910
 000911                  unindent = *On;                                                                 03                  000911
 000912                  increment = -2;                                                                 03                  000912
 000913                  slCount -= 1;                                                                   03                  000913
 000914               When operator = 'ENDCS';                                                          X03                  000914
 000915                  Operator = 'ENDIF';                                                             03                  000915
 000916                  unindent = *On;                                                                 03                  000916
 000917                  increment = -1;                                                                 03                  000917
 000918               When operator = 'ENDDO';                                                          X03                  000918
 000919                  unindent = *On;                                                                 03                  000919
 000920                  increment = -1;                                                                 03                  000920
 000921                  doCount -= 1;                                                                   03                  000921
 000922               When operator = 'ENDFOR';                                                         X03                  000922
 000923                  unindent = *On;                                                                 03                  000923
 000924                  increment = -1;                                                                 03                  000924
 000925                  forCount -= 1;                                                                  03                  000925
 000926               When %subst(operator:1:3) = 'END';                                                X03                  000926
 000927                  unindent = *On;                                                                 03                  000927
 000928                  increment = -1;                                                                 03                  000928
 000929               When %subst(operator:1:4) = 'ELSE'; // Unindent ELSE                              X03                  000929
 000930                  unindent = *On;                                                                 03                  000930
 000931                  indent = *On;                                                                   03                  000931
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000932                  increment = -1;                                                                 03                  000932
 000933               When %subst(operator:1:2) = 'OR';   // Unindent OR                                X03                  000933
 000934                  unindent = *On;                                                                 03                  000934
 000935                  indent = *On;                                                                   03                  000935
 000936                  increment = -1;                                                                 03                  000936
 000937               When %subst(operator:1:3) = 'AND';  // Unindent AND                               X03                  000937
 000938                  unindent = *On;                                                                 03                  000938
 000939                  indent = *On;                                                                   03                  000939
 000940                  increment = -1;                                                                 03                  000940
 000941               When operator = 'ON-ERROR';         // Unindent On-Error                          X03                  000941
 000942                  unindent = *On;                                                                 03                  000942
 000943                  indent = *On;                                                                   03                  000943
 000944                  increment = -1;                                                                 03                  000944
 000945               When %subst(operator:1:4) = 'WHEN' or inWhen;                                     X03                  000945
 000946                  unindent = *On;                                                                 03                  000946
 000947                  indent = *On;                                                                   03                  000947
 000948                  increment = -1;                                                                 03                  000948
 000949                  inWhen = *On;                                                                   03                  000949
 000950               When inIF or inDo;                  // Keep conditions in line.                   X03                  000950
 000951                  unindent = *On;                                                                 03                  000951
 000952                  indent = *On;                                                                   03                  000952
 000953                  increment = -1;                                                                 03                  000953
 000954               When operator = 'OTHER';             // Unindent Other                            X03                  000954
 000955                  unindent = *On;                                                                 03                  000955
 000956                  indent = *On;                                                                   03                  000956
 000957                  increment = -1;                                                                 03                  000957
 000958               Other;                                                                            X03                  000958
 000959                  increment = 0;                                                                  03                  000959
 000960            EndSl;                                                                               E03                  000960
 000961         ElseIf inDeclaration;                                                                   X02                  000961
 000962         EndIf;                                                                                  E02                  000962
 000963                                                                                                                      000963
 000964         //----------------------------------------------------------------------------------                         000964
 000965         // Start of code?  If so, pause here and move all field definitions to D-specs.                              000965
 000966         If inCode and not defsMoved;                                                            B02                  000966
 000967            Exsr subUserMoveDefs;                                                                 02                  000967
 000968         EndIf;                                                                                  E02                  000968
 000969                                                                                                                      000969
 000970         //----------------------------------------------------------------------------------                         000970
 000971         // If we need to temporarily unindent, do so to the requested increment.                                     000971
 000972         If unindent;                                                                            B02                  000972
 000973            indentCount += increment;                                                             02                  000973
 000974            increment = 0;                                                                        02                  000974
 000975            unindent = *Off;                                                                      02                  000975
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000976         EndIf;                                                                                  E02                  000976
 000977                                                                                                                      000977
 000978         //----------------------------------------------------------------------------------                         000978
 000979         // If we are in a code section and in free-format, perform reformatting.                                     000979
 000980         //If inCode and inFreeFormat and not inDirective                                                             000980
 000981         If inFreeFormat                                                                         B02                  000981
 000982         and not inDirective                                                                     B02                  000982
 000983         and sourceLine <> *Blanks                                                               B02                  000983
 000984         and not inComment                                                                       B02                  000984
 000985         and not dropLine;       //  and not inSpan                                              B02                  000985
 000986            // Derive reformatted opcode (if any)                                                                     000986
 000987            x = %lookup(operator:QopCodeUP);                                                      02                  000987
 000988            If x > 0;                                                                            B03                  000988
 000989               newOperator = %trim(QopCodeLO(x));                                                 03                  000989
 000990            Else;                                                                                X03                  000990
 000991               x = %lookup(operator:QdeclUP);                                                     03                  000991
 000992               If x > 0;                                                                         B04                  000992
 000993                  newOperator = %trim(QdeclLO(x));                                                04                  000993
 000994               Else;                                                                             X04                  000994
 000995                  // Not a valid operator, check if this is a comment.                                                000995
 000996                  x = %scan('//':%trim(sourceLine));                                              04                  000996
 000997                  If x = 1;                                                                      B05                  000997
 000998                     inComment = *On;                                                             05                  000998
 000999                     newOperator = '';                                                            05                  000999
 001000                     operator = *Blanks;                                                          05                  001000
 001001                  Else;                                                                          X05                  001001
 001002                     newOperator = '';                                                            05                  001002
 001003                  EndIf;                                                                         E05                  001003
 001004               EndIf;                                                                            E04                  001004
 001005            EndIf;                                                                               E03                  001005
 001006                                                                                                                      001006
 001007            // Use new opcode if it exists.                                                                           001007
 001008            If %len(newOperator) > 0;                                                            B03                  001008
 001009               If %len(%trim(sourceLine)) > %len(newOperator);                                   B04                  001009
 001010                  sourceLine = %trim(%subst(%trim(sourceLine)                                     04                  001010
 001011                                   :%len(newOperator) + 1));                                      04                  001011
 001012               Else;                                                                             X04                  001012
 001013                  //                  sourceLine = %trim(%subst(%trim(sourceLine)                                     001013
 001014                  //                                   :%len(newOperator)));                                          001014
 001015                  sourceLine = *Blanks;                                                           04                  001015
 001016               EndIf;                                                                            E04                  001016
 001017               // Insert a spcace after operator if it's not the end of the line                                      001017
 001018               // and there's no operation extender.                                                                  001018
 001019               If %subst(sourceLine:1:1) <> ';'                                                  B04                  001019
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001020               and (%subst(sourceLine:1:1) <> '('                                                B04                  001020
 001021                 or %subst(sourceLine:1:1) = '('                                                 B04                  001021
 001022                and %subst(sourceLine:3:1) <> ')'                                                B04                  001022
 001023                and %subst(sourceLine:4:1) <> ')');                                              B04                  001023
 001024                  sourceLine = ' ' + sourceLine;                                                  04                  001024
 001025               EndIf;                                                                            E04                  001025
 001026               sourceLine = newOperator + sourceLine;                                             03                  001026
 001027            EndIf;                                                                               E03                  001027
 001028                                                                                                                      001028
 001029            If inCode;                                                                           B03                  001029
 001030               // Padding required?                                                                                   001030
 001031               If padResult;                                                                     B04                  001031
 001032                  savedSRCDTA = SRCDTA;                                                           04                  001032
 001033                  Clear codeLine;                                                                 04                  001033
 001034                  %subst(codeLine:indentOffset)                                                   04                  001034
 001035                        = %trim(padTarget) + ' = *Blanks;';                                       04                  001035
 001036                  Exsr subUserWriteLine;                                                          04                  001036
 001037                  SRCDTA = savedSRCDTA;                                                           04                  001037
 001038                  padResult = *Off;                                                               04                  001038
 001039               EndIf;                                                                            E04                  001039
 001040                                                                                                                      001040
 001041               // Determine the indentation to use.                                                                   001041
 001042               If indentCount > maxIndent;                                                       B04                  001042
 001043                  indentOffset = maxIndent * indentSize + 1;                                      04                  001043
 001044               Else;                                                                             X04                  001044
 001045                  indentOffset = indentCount * indentSize + 1;                                    04                  001045
 001046               EndIf;                                                                            E04                  001046
 001047                                                                                                                      001047
 001048               // Adjust for continuation lines.                                                                      001048
 001049               If inCallP and (%subst(operator:1:5) <> 'CALLP');                                 B04                  001049
 001050                  indentOffset += callPOffset;                                                    04                  001050
 001051               ElseIf inEval and (%subst(operator:1:4) <> 'EVAL');                               X04                  001051
 001052                  indentOffset += evalOffset;                                                     04                  001052
 001053               ElseIf inSpan;                                                                    X04                  001053
 001054                  indentOffset = currOffset + (indentOffset - prevOffset);                        04                  001054
 001055               EndIf;                                                                            E04                  001055
 001056                                                                                                                      001056
 001057               // Avoid losing code off of the right hand side (comments mainly).                                     001057
 001058               If %len(%trimr(sourceLine)) + indentOffset > 93;                                  B04                  001058
 001059                  indentOffset = 93 - %len(%trim(sourceLine));                                    04                  001059
 001060               EndIf;                                                                            E04                  001060
 001061                                                                                                                      001061
 001062               // For code lines, check for overflow, and unindent accordingly if it does,                            001062
 001063               If not inComment;                                                                 B04                  001063
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001064                  lineEnd = %scan(';':%trimr(sourceLine));                                        04                  001064
 001065                  If lineEnd = 0;   // Code already spans to next line.                          B05                  001065
 001066                     lineEnd = %scan('//':sourceLine);                                            05                  001066
 001067                     If lineEnd > 0;                                                             B06                  001067
 001068                        lineEnd                                                                   06                  001068
 001069                          = %len(%trimr(%subst(sourceLine:1:lineEnd-1)));                         06                  001069
 001070                     Else;                                                                       X06                  001070
 001071                        lineEnd = %len(%trimr(sourceLine));                                       06                  001071
 001072                     EndIf;                                                                      E06                  001072
 001073                     If not inIf and not inDo and not inWhen;                                    B06                  001073
 001074                        inSpan = *On;                                                             06                  001074
 001075                     EndIf;                                                                      E06                  001075
 001076                  EndIf;                                                                         E05                  001076
 001077               EndIf;                                                                            E04                  001077
 001078                                                                                                                      001078
 001079               // Cater for commented out code that extends into comments.                                            001079
 001080               If indentOffset + lineEnd > 74;                                                   B04                  001080
 001081                  //Exsr subUserWrapLine;                                                                             001081
 001082                  indentOffset -= ((indentOffset + lineEnd) - 74);                                04                  001082
 001083               EndIf;                                                                            E04                  001083
 001084                                                                                                                      001084
 001085               // Ensure that we don't go back too far!                                                               001085
 001086               If indentOffset < 1;                                                              B04                  001086
 001087                  indentOffset = 1;                                                               04                  001087
 001088               EndIf;                                                                            E04                  001088
 001089                                                                                                                      001089
 001090               savedSRCDTA = SRCDTA;                                                              03                  001090
 001091               Clear codeLine;                                                                    03                  001091
 001092               %subst(codeLine:indentOffset) = %trimr(sourceLine);                                03                  001092
 001093               // Append an in-line comment?                                                                          001093
 001094               If (convert or setOn or setOff)                                                   B04                  001094
 001095               and savedComment <> *Blanks;                                                      B04                  001095
 001096                  %subst(codeLine:71) = '// ' + savedComment;                                     04                  001096
 001097                  savedComment = *Blanks;                                                         04                  001097
 001098               EndIf;                                                                            E04                  001098
 001099               sourceLine = codeLine;                                                             03                  001099
 001100               SRCDTA = savedSRCDTA;                                                              03                  001100
 001101               EndIf;   // inCode                                                                E03                  001101
 001102            EndIf;                                                                               E02                  001102
 001103         EndIf;                                                                                  E01                  001103
 001104                                                                                                                      001104
 001105         //----------------------------------------------------------------------------------                         001105
 001106         // Output the formatted line (and any overflows that have occurred.                                          001106
 001107         If not dropLine;                                                                        B01                  001107
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001108            If convert;                                                                          B02                  001108
 001109               Clear nonPrefix;                                                                   02                  001109
 001110            EndIf;                                                                               E02                  001110
 001111            If inCode or inArrayData                                                             B02                  001111
 001112            or lineType = *Blank or %subst(directive:1:1) = '*';                                 B02                  001112
 001113               codeLine = %trimr(sourceLine);                                                     02                  001113
 001114            Else;                                                                                X02                  001114
 001115               fullLine = %trimr(sourceLine);                                                     02                  001115
 001116            EndIf;                                                                               E02                  001116
 001117            Exsr subUserWriteLine;                                                                01                  001117
 001118                                                                                                                      001118
 001119            // Overflow line?                                                                                         001119
 001120            If overFlowLine <> *Blanks;                                                          B02                  001120
 001121               Clear codeLine;                                                                    02                  001121
 001122               %subst(codeLine:indentOffset) = %trimr(overflowLine);                              02                  001122
 001123               overflowLine = *Blanks;                                                            02                  001123
 001124               Exsr subUserWriteLine;                                                             02                  001124
 001125            EndIf;                                                                               E02                  001125
 001126         Else;                                                                                   X01                  001126
 001127            dropLine = *Off;                                                                      01                  001127
 001128         EndIf;                                                                                  E01                  001128
 001129                                                                                                                      001129
 001130         indentCount += increment;                                                                                    001130
 001131                                                                                                                      001131
 001132         // Following a WHEN or ON-ERROR or ELSE, code should be indented again.                                      001132
 001133         If indent;                                                                              B01                  001133
 001134            indentCount += 1;                                                                     01                  001134
 001135            indent = *Off;                                                                        01                  001135
 001136            // Following ENDSR, we should revert to mainline indentation.                                             001136
 001137         ElseIf operator = 'ENDSR';                                                              X01                  001137
 001138            indentCount = mainlineIndent;                                                         01                  001138
 001139            inCode = *Off;                                                                        01                  001139
 001140         EndIf;                                                                                  E01                  001140
 001141                                                                                                                      001141
 001142         // If spanning a line, check if the current line ends the span.                                              001142
 001143         If (inSpan or inIf or inDo or inWhen or inCallP or inEval                               B01                  001143
 001144         or inSQL or inDeclaration)                                                              B01                  001144
 001145         and not inComment;                                                                      B01                  001145
 001146            lineEnd = %scan(';':%trim(sourceLine));                                               01                  001146
 001147            If lineEnd <> 0;                                                                     B02                  001147
 001148               inSpan = *Off;                                                                     02                  001148
 001149               inIf = *Off;                                                                       02                  001149
 001150               inDo = *Off;                                                                       02                  001150
 001151               inWhen = *Off;                                                                     02                  001151
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001152               inCallP = *Off;                                                                    02                  001152
 001153               inEval = *Off;                                                                     02                  001153
 001154               inSQL = *Off;                                                                      02                  001154
 001155               inDeclaration = *Off;                                                              02                  001155
 001156            EndIf;                                                                               E02                  001156
 001157         EndIf;                                                                                  E01                  001157
 001158                                                                                                                      001158
 001159         //----------------------------------------------------------------------------------                         001159
 001160         // Close off Prototype/Interface/Datastructure?                                                              001160
 001161         If (inPrototype or inInterface or inDatastructure)                                      B01                  001161
 001162         and SRCSEQ = endLine;                                                                   B01                  001162
 001163            If not inDatastructure                                                               B02                  001163
 001164            or inDatastructure and endDS;                                                        B02                  001164
 001165               savedSRCDTA = SRCDTA;                                                              02                  001165
 001166               Clear SRCDTA;                                                                      02                  001166
 001167               codeLine = 'End-' + endDeclType + ';';                                             02                  001167
 001168               Exsr subUserWriteLine;                                                             02                  001168
 001169               SRCDTA = savedSRCDTA;                                                              02                  001169
 001170            EndIf;                                                                               E02                  001170
 001171            inPrototype = *Off;                                                                   01                  001171
 001172            inExtProc = *Off;                                                                     01                  001172
 001173            inInterface = *Off;                                                                   01                  001173
 001174            inDatastructure = *Off;                                                               01                  001174
 001175            inSpan = *Off;                                                                        01                  001175
 001176            inDeclaration = *Off;                                                                 01                  001176
 001177            inExtProc = *Off;                                                                     01                  001177
 001178            workDeclName = *Blanks;                                                               01                  001178
 001179         EndIf;                                                                                  E01                  001179
 001180                                                                                                                      001180
 001181      EndSr;                                                                                                          001181
 001182   //-------------------------------------------------------------------------------------------                      001182
 001183                                                                                                                      001183
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     32
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001185   //-------------------------------------------------------------------------------------------                      001185
 001186   // Convert the line to free-format?                                                                                001186
 001187   //-------------------------------------------------------------------------------------------                      001187
 001188   BegSr subUserConvertC_Spec;                                                                                        001188
 001189                                                                                                                      001189
 001190      Select;                                                                                    B01                  001190
 001191            // Keep blank lines.                                                                                      001191
 001192         When codeLine = *Blanks;                                                                X01                  001192
 001193            sourceLine = *Blanks;                                                                 01                  001193
 001194            convert = *On;                                                                        01                  001194
 001195                                                                                                                      001195
 001196           //----------------------------------------------------------------------------------                       001196
 001197            // EXEC SQL                                                                                               001197
 001198         When workDirective = '/EXEC SQL' or inSQL;                                              X01                  001198
 001199            Exsr subUserCvt_EXEC_SQL;                                                             01                  001199
 001200                                                                                                                      001200
 001201           //----------------------------------------------------------------------------------                       001201
 001202            // END-EXEC                                                                                               001202
 001203         When workDirective = '/END-EXEC';                                                       X01                  001203
 001204            convert = *On;                                                                        01                  001204
 001205                                                                                                                      001205
 001206           //----------------------------------------------------------------------------------                       001206
 001207            // Conditioning indicators                                                                                001207
 001208         When condInd <> *Blanks;                                                                X01                  001208
 001209            nonConvRsn = 'Conditioning indicators are not currently '                             01                  001209
 001210                       + 'supported.';                                                            01                  001210
 001211                                                                                                                      001211
 001212           //----------------------------------------------------------------------------------                       001212
 001213            // ACQ.                                                                                                   001213
 001214         When %subst(operator:1:3) = 'ACQ';                                                      X01                  001214
 001215            Exsr subUserCvt_ACQ;                                                                  01                  001215
 001216                                                                                                                      001216
 001217           //----------------------------------------------------------------------------------                       001217
 001218            // ADDDUR.                                                                                                001218
 001219         When %subst(operator:1:6) = 'ADDDUR';                                                   X01                  001219
 001220            Exsr subUserCvt_ADDDUR;                                                               01                  001220
 001221                                                                                                                      001221
 001222           //----------------------------------------------------------------------------------                       001222
 001223            // ADD.                                                                                                   001223
 001224         When %subst(operator:1:3) = 'ADD';                                                      X01                  001224
 001225            Exsr subUserCvt_ADD;                                                                  01                  001225
 001226                                                                                                                      001226
 001227           //----------------------------------------------------------------------------------                       001227
 001228            // ALLOC.                                                                                                 001228
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     33
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001229         When %subst(operator:1:5) = 'ALLOC';                                                    X01                  001229
 001230            Exsr subUserCvt_ALLOC;                                                                01                  001230
 001231                                                                                                                      001231
 001232           //----------------------------------------------------------------------------------                       001232
 001233            // BEGSR                                                                                                  001233
 001234         When operator = 'BEGSR';                                                                X01                  001234
 001235            Exsr subUserCvt_BEGSR;                                                                01                  001235
 001236                                                                                                                      001236
 001237           //----------------------------------------------------------------------------------                       001237
 001238            // CALLP                                                                                                  001238
 001239         When %subst(operator:1:5) = 'CALLP' or inCallP;                                         X01                  001239
 001240            Exsr subUserCvt_CALLP;                                                                01                  001240
 001241                                                                                                                      001241
 001242           //----------------------------------------------------------------------------------                       001242
 001243            // CASxx                                                                                                  001243
 001244         When %subst(operator:1:3) = 'CAS';                                                      X01                  001244
 001245            Exsr subUserCvt_CASxx;                                                                01                  001245
 001246                                                                                                                      001246
 001247           //----------------------------------------------------------------------------------                       001247
 001248            // CAT                                                                                                    001248
 001249         When %subst(operator:1:3) = 'CAT';                                                      X01                  001249
 001250            Exsr subUserCvt_CAT;                                                                  01                  001250
 001251                                                                                                                      001251
 001252           //----------------------------------------------------------------------------------                       001252
 001253            // CHAIN                                                                                                  001253
 001254         When %subst(operator:1:5) = 'CHAIN';                                                    X01                  001254
 001255            Exsr subUserCvt_CHAIN;                                                                01                  001255
 001256                                                                                                                      001256
 001257           //----------------------------------------------------------------------------------                       001257
 001258            // CHECK                                                                                                  001258
 001259         When %subst(operator:1:5) = 'CHECK';                                                    X01                  001259
 001260            Exsr subUserCvt_CHECKx;                                                               01                  001260
 001261                                                                                                                      001261
 001262           //----------------------------------------------------------------------------------                       001262
 001263            // CLEAR                                                                                                  001263
 001264         When %subst(operator:1:5) = 'CLEAR';                                                    X01                  001264
 001265            Exsr subUserCvt_CLEAR;                                                                01                  001265
 001266                                                                                                                      001266
 001267           //----------------------------------------------------------------------------------                       001267
 001268            // CLOSE                                                                                                  001268
 001269         When %subst(operator:1:5) = 'CLOSE';                                                    X01                  001269
 001270            Exsr subUserCvt_CLOSE;                                                                01                  001270
 001271                                                                                                                      001271
 001272           //----------------------------------------------------------------------------------                       001272
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     34
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001273            // COMMIT                                                                                                 001273
 001274         When %subst(operator:1:6) = 'COMMIT';                                                   X01                  001274
 001275            Exsr subUserCvt_COMMIT;                                                               01                  001275
 001276                                                                                                                      001276
 001277           //----------------------------------------------------------------------------------                       001277
 001278            // COMP                                                                                                   001278
 001279         When operator = 'COMP';                                                                 X01                  001279
 001280            Exsr subUserCvt_COMP;                                                                 01                  001280
 001281                                                                                                                      001281
 001282           //----------------------------------------------------------------------------------                       001282
 001283            // DEALLOC.                                                                                               001283
 001284         When %subst(operator:1:7) = 'DEALLOC';                                                  X01                  001284
 001285            Exsr subUserCvt_DEALLOC;                                                              01                  001285
 001286                                                                                                                      001286
 001287           //----------------------------------------------------------------------------------                       001287
 001288            // DEFINE                                                                                                 001288
 001289         When operator = 'DEFINE';                                                               X01                  001289
 001290            dropLine = *On;                                                                       01                  001290
 001291                                                                                                                      001291
 001292           //----------------------------------------------------------------------------------                       001292
 001293            // DELETE                                                                                                 001293
 001294         When %subst(operator:1:6) = 'DELETE';                                                   X01                  001294
 001295            Exsr subUserCvt_DELETE;                                                               01                  001295
 001296                                                                                                                      001296
 001297           //----------------------------------------------------------------------------------                       001297
 001298            // DIV                                                                                                    001298
 001299         When %subst(operator:1:3) = 'DIV';                                                      X01                  001299
 001300            Exsr subUserCvt_DIV;                                                                  01                  001300
 001301                                                                                                                      001301
 001302           //----------------------------------------------------------------------------------                       001302
 001303            // DOxxx                                                                                                  001303
 001304         When %subst(operator:1:2) = 'DO'                                                        X01                  001304
 001305         and (%subst(operator:3:3) = 'WEQ'                                                       X01                  001305
 001306         or %subst(operator:3:2) = 'W '                                                          X01                  001306
 001307         or %subst(operator:3:3) = 'WGT'                                                         X01                  001307
 001308         or %subst(operator:3:3) = 'WLT'                                                         X01                  001308
 001309         or %subst(operator:3:3) = 'WNE'                                                         X01                  001309
 001310         or %subst(operator:3:3) = 'WGE'                                                         X01                  001310
 001311         or %subst(operator:3:3) = 'WLE'                                                         X01                  001311
 001312         or %subst(operator:3:2) = 'U '                                                          X01                  001312
 001313         or %subst(operator:3:3) = 'UEQ'                                                         X01                  001313
 001314         or %subst(operator:3:3) = 'UGT'                                                         X01                  001314
 001315         or %subst(operator:3:3) = 'ULT'                                                         X01                  001315
 001316         or %subst(operator:3:3) = 'UNE'                                                         X01                  001316
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     35
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001317         or %subst(operator:3:3) = 'UGE'                                                         X01                  001317
 001318         or %subst(operator:3:3) = 'ULE'                                                         X01                  001318
 001319         or %subst(operator:3:3) = '   ')                                                        X01                  001319
 001320         or inDo;                                                                                X01                  001320
 001321            Exsr subUserCvt_DO;                                                                   01                  001321
 001322                                                                                                                      001322
 001323           //----------------------------------------------------------------------------------                       001323
 001324            // DSPLY                                                                                                  001324
 001325         When %subst(operator:1:5) = 'DSPLY';                                                    X01                  001325
 001326            Exsr subUserCvt_DSPLY;                                                                01                  001326
 001327                                                                                                                      001327
 001328           //----------------------------------------------------------------------------------                       001328
 001329            // DUMP                                                                                                   001329
 001330         When %subst(operator:1:4) = 'DUMP';                                                     X01                  001330
 001331            Exsr subUserCvt_DUMP;                                                                 01                  001331
 001332                                                                                                                      001332
 001333           //----------------------------------------------------------------------------------                       001333
 001334            // ELSE                                                                                                   001334
 001335         When operator = 'ELSE';                                                                 X01                  001335
 001336            Exsr subUserCvt_ELSE;                                                                 01                  001336
 001337                                                                                                                      001337
 001338           //----------------------------------------------------------------------------------                       001338
 001339            // ELSEIF                                                                                                 001339
 001340         When operator = 'ELSEIF';                                                               X01                  001340
 001341            Exsr subUserCvt_ELSEIF;                                                               01                  001341
 001342                                                                                                                      001342
 001343           //----------------------------------------------------------------------------------                       001343
 001344            // ENDxx                                                                                                  001344
 001345         When %subst(operator:1:3) = 'END';                                                      X01                  001345
 001346            Exsr subUserCvt_ENDxx;                                                                01                  001346
 001347                                                                                                                      001347
 001348           //----------------------------------------------------------------------------------                       001348
 001349            // EVALx                                                                                                  001349
 001350         When %subst(operator:1:4) = 'EVAL' or inEval;                                           X01                  001350
 001351            Exsr subUserCvt_EVALx;                                                                01                  001351
 001352                                                                                                                      001352
 001353           //----------------------------------------------------------------------------------                       001353
 001354            // EXCEPT                                                                                                 001354
 001355         When operator = 'EXCEPT';                                                               X01                  001355
 001356            Exsr subUserCvt_EXCEPT;                                                               01                  001356
 001357                                                                                                                      001357
 001358           //----------------------------------------------------------------------------------                       001358
 001359            // EXFMT                                                                                                  001359
 001360         When %subst(operator:1:5) = 'EXFMT';                                                    X01                  001360
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     36
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001361            Exsr subUserCvt_EXFMT;                                                                01                  001361
 001362                                                                                                                      001362
 001363           //----------------------------------------------------------------------------------                       001363
 001364            // EXSR                                                                                                   001364
 001365         When operator = 'EXSR';                                                                 X01                  001365
 001366            Exsr subUserCvt_EXSR;                                                                 01                  001366
 001367                                                                                                                      001367
 001368           //----------------------------------------------------------------------------------                       001368
 001369            // EXTRCT                                                                                                 001369
 001370         When %subst(operator:1:6) = 'EXTRCT';                                                   X01                  001370
 001371            Exsr subUserCvt_EXTRCT;                                                               01                  001371
 001372                                                                                                                      001372
 001373           //----------------------------------------------------------------------------------                       001373
 001374            // FEOD                                                                                                   001374
 001375         When %subst(operator:1:4) = 'FEOD';                                                     X01                  001375
 001376            Exsr subUserCvt_FEOD;                                                                 01                  001376
 001377                                                                                                                      001377
 001378           //----------------------------------------------------------------------------------                       001378
 001379            // FOR                                                                                                    001379
 001380         When operator = 'FOR';                                                                  X01                  001380
 001381            Exsr subUserCvt_FOR;                                                                  01                  001381
 001382                                                                                                                      001382
 001383           //----------------------------------------------------------------------------------                       001383
 001384            // FORCE                                                                                                  001384
 001385         When operator = 'FORCE';                                                                X01                  001385
 001386            Exsr subUserCvt_FORCE;                                                                01                  001386
 001387                                                                                                                      001387
 001388           //----------------------------------------------------------------------------------                       001388
 001389            // IFxx                                                                                                   001389
 001390         When %subst(operator:1:2) = 'IF' or inIf;                                               X01                  001390
 001391            Exsr subUserCvt_IF;                                                                   01                  001391
 001392                                                                                                                      001392
 001393           //----------------------------------------------------------------------------------                       001393
 001394            // IN                                                                                                     001394
 001395         When %subst(operator:1:2) = 'IN';                                                       X01                  001395
 001396            Exsr subUserCvt_IN;                                                                   01                  001396
 001397                                                                                                                      001397
 001398           //----------------------------------------------------------------------------------                       001398
 001399            // ITER                                                                                                   001399
 001400         When operator = 'ITER';                                                                 X01                  001400
 001401            Exsr subUserCvt_ITER;                                                                 01                  001401
 001402                                                                                                                      001402
 001403           //----------------------------------------------------------------------------------                       001403
 001404            // LEAVExx;                                                                                               001404
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     37
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001405         When %subst(operator:1:5) = 'LEAVE';                                                    X01                  001405
 001406            Exsr subUserCvt_LEAVE;                                                                01                  001406
 001407                                                                                                                      001407
 001408           //----------------------------------------------------------------------------------                       001408
 001409            // LOOKUP                                                                                                 001409
 001410         When operator = 'LOOKUP';                                                               X01                  001410
 001411            Exsr subUserCvt_LOOKUP;                                                               01                  001411
 001412                                                                                                                      001412
 001413           //----------------------------------------------------------------------------------                       001413
 001414            // MOVEA                                                                                                  001414
 001415         When %subst(operator:1:5) = 'MOVEA';                                                    X01                  001415
 001416            Exsr subUserCvt_MOVEA;                                                                01                  001416
 001417            LeaveSr;                                                                              01                  001417
 001418                                                                                                                      001418
 001419           //----------------------------------------------------------------------------------                       001419
 001420            // MOVE/MOVEL                                                                                             001420
 001421         When operator = 'MONITOR';                                                              X01                  001421
 001422            Exsr subUserCvt_MONITOR;                                                              01                  001422
 001423                                                                                                                      001423
 001424           //----------------------------------------------------------------------------------                       001424
 001425            // MOVE/MOVEL                                                                                             001425
 001426         When %subst(operator:1:4) = 'MOVE';                                                     X01                  001426
 001427            Exsr subUserCvt_MOVE;                                                                 01                  001427
 001428                                                                                                                      001428
 001429           //----------------------------------------------------------------------------------                       001429
 001430            // MULT.                                                                                                  001430
 001431         When %subst(operator:1:4) = 'MULT';                                                     X01                  001431
 001432            Exsr subUserCvt_MULT;                                                                 01                  001432
 001433                                                                                                                      001433
 001434           //----------------------------------------------------------------------------------                       001434
 001435            // MVR                                                                                                    001435
 001436         When operator = 'MVR';                                                                  X01                  001436
 001437            Exsr subUserCvt_MVR;                                                                  01                  001437
 001438                                                                                                                      001438
 001439           //----------------------------------------------------------------------------------                       001439
 001440            // OCCUR (but not both set and get).                                                                      001440
 001441         When %subst(operator:1:5) = 'OCCUR';                                                    X01                  001441
 001442            Exsr subUserCvt_OCCUR;                                                                01                  001442
 001443                                                                                                                      001443
 001444           //----------------------------------------------------------------------------------                       001444
 001445            // ON-ERROR                                                                                               001445
 001446         When operator = 'ON-ERROR';                                                             X01                  001446
 001447            Exsr subUserCvt_ON_ERROR;                                                             01                  001447
 001448                                                                                                                      001448
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     38
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001449           //----------------------------------------------------------------------------------                       001449
 001450            // OPEN                                                                                                   001450
 001451         When %subst(operator:1:4) = 'OPEN';                                                     X01                  001451
 001452            Exsr subUserCvt_OPEN;                                                                 01                  001452
 001453                                                                                                                      001453
 001454           //----------------------------------------------------------------------------------                       001454
 001455            // OTHER                                                                                                  001455
 001456         When operator = 'OTHER';                                                                X01                  001456
 001457            Exsr subUserCvt_OTHER;                                                                01                  001457
 001458                                                                                                                      001458
 001459           //----------------------------------------------------------------------------------                       001459
 001460            // OUT                                                                                                    001460
 001461         When %subst(operator:1:3) = 'OUT';                                                      X01                  001461
 001462            Exsr subUserCvt_OUT;                                                                  01                  001462
 001463                                                                                                                      001463
 001464           //----------------------------------------------------------------------------------                       001464
 001465            // POST                                                                                                   001465
 001466         When %subst(operator:1:4) = 'POST';                                                     X01                  001466
 001467            Exsr subUserCvt_POST;                                                                 01                  001467
 001468                                                                                                                      001468
 001469           //----------------------------------------------------------------------------------                       001469
 001470            // READ                                                                                                   001470
 001471         When %subst(operator:1:4) = 'READ';                                                     X01                  001471
 001472            Exsr subUserCvt_READ;                                                                 01                  001472
 001473                                                                                                                      001473
 001474           //----------------------------------------------------------------------------------                       001474
 001475            // REL                                                                                                    001475
 001476         When %subst(operator:1:3) = 'REL';                                                      X01                  001476
 001477            Exsr subUserCvt_REL;                                                                  01                  001477
 001478                                                                                                                      001478
 001479           //----------------------------------------------------------------------------------                       001479
 001480            // RESET                                                                                                  001480
 001481         When %subst(operator:1:5) = 'RESET';                                                    X01                  001481
 001482            Exsr subUserCvt_RESET;                                                                01                  001482
 001483                                                                                                                      001483
 001484           //----------------------------------------------------------------------------------                       001484
 001485            // RETURN                                                                                                 001485
 001486         When %subst(operator:1:6) = 'RETURN';                                                   X01                  001486
 001487            Exsr subUserCvt_RETURN;                                                               01                  001487
 001488                                                                                                                      001488
 001489           //----------------------------------------------------------------------------------                       001489
 001490            // ROLBK                                                                                                  001490
 001491         When %subst(operator:1:5) = 'ROLBK';                                                    X01                  001491
 001492            Exsr subUserCvt_ROLBK;                                                                01                  001492
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     39
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001493                                                                                                                      001493
 001494           //----------------------------------------------------------------------------------                       001494
 001495            // SCAN                                                                                                   001495
 001496         When operator = 'SCAN';                                                                 X01                  001496
 001497            Exsr subUserCvt_SCAN;                                                                 01                  001497
 001498                                                                                                                      001498
 001499           //----------------------------------------------------------------------------------                       001499
 001500            // SELECT                                                                                                 001500
 001501         When operator = 'SELECT';                                                               X01                  001501
 001502            Exsr subUserCvt_SELECT;                                                               01                  001502
 001503                                                                                                                      001503
 001504           //----------------------------------------------------------------------------------                       001504
 001505            // SETLL / SETGT                                                                                          001505
 001506         When %subst(operator:1:5) = 'SETLL'                                                     X01                  001506
 001507         or %subst(operator:1:5) = 'SETGT';                                                      X01                  001507
 001508            Exsr subUserCvt_SETxx;                                                                01                  001508
 001509                                                                                                                      001509
 001510           //----------------------------------------------------------------------------------                       001510
 001511            // SETOFF                                                                                                 001511
 001512         When operator = 'SETOFF';                                                               X01                  001512
 001513            Exsr subUserCvt_SETOFF;                                                               01                  001513
 001514                                                                                                                      001514
 001515           //----------------------------------------------------------------------------------                       001515
 001516            // SETON                                                                                                  001516
 001517         When operator = 'SETON';                                                                X01                  001517
 001518            Exsr subUserCvt_SETON;                                                                01                  001518
 001519                                                                                                                      001519
 001520           //----------------------------------------------------------------------------------                       001520
 001521            // SHTDN                                                                                                  001521
 001522         When operator = 'SHTDN';                                                                X01                  001522
 001523            Exsr subUserCvt_SHTDN;                                                                01                  001523
 001524                                                                                                                      001524
 001525           //----------------------------------------------------------------------------------                       001525
 001526            // SORTA.                                                                                                 001526
 001527         When %subst(operator:1:5) = 'SORTA';                                                    X01                  001527
 001528            Exsr subUserCvt_SORTA;                                                                01                  001528
 001529                                                                                                                      001529
 001530           //----------------------------------------------------------------------------------                       001530
 001531            // SUBDUR.                                                                                                001531
 001532         When %subst(operator:1:6) = 'SUBDUR';                                                   X01                  001532
 001533            Exsr subUserCvt_SUBDUR;                                                               01                  001533
 001534                                                                                                                      001534
 001535           //----------------------------------------------------------------------------------                       001535
 001536            // SUBST.                                                                                                 001536
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     40
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001537         When %subst(operator:1:5) = 'SUBST';                                                    X01                  001537
 001538            Exsr subUserCvt_SUBST;                                                                01                  001538
 001539                                                                                                                      001539
 001540           //----------------------------------------------------------------------------------                       001540
 001541            // SUB                                                                                                    001541
 001542         When %subst(operator:1:3) = 'SUB';                                                      X01                  001542
 001543            Exsr subUserCvt_SUB;                                                                  01                  001543
 001544                                                                                                                      001544
 001545           //----------------------------------------------------------------------------------                       001545
 001546            // TESTB                                                                                                  001546
 001547         When operator = 'TESTB';                                                                X01                  001547
 001548                                                                                                                      001548
 001549           //----------------------------------------------------------------------------------                       001549
 001550            // TESTN                                                                                                  001550
 001551         When operator = 'TESTN';                                                                X01                  001551
 001552                                                                                                                      001552
 001553           //----------------------------------------------------------------------------------                       001553
 001554            // TESTZ                                                                                                  001554
 001555         When operator = 'TESTZ';                                                                X01                  001555
 001556                                                                                                                      001556
 001557           //----------------------------------------------------------------------------------                       001557
 001558            // TEST                                                                                                   001558
 001559         When %subst(operator:1:4) = 'TEST';                                                     X01                  001559
 001560            Exsr subUserCvt_TEST;                                                                 01                  001560
 001561                                                                                                                      001561
 001562           //----------------------------------------------------------------------------------                       001562
 001563            // TIME                                                                                                   001563
 001564         When operator = 'TIME';                                                                 X01                  001564
 001565            Exsr subUserCvt_TIME;                                                                 01                  001565
 001566                                                                                                                      001566
 001567           //----------------------------------------------------------------------------------                       001567
 001568            // UPDATE                                                                                                 001568
 001569         When %subst(operator:1:6) = 'UPDATE';                                                   X01                  001569
 001570            Exsr subUserCvt_UPDATE;                                                               01                  001570
 001571                                                                                                                      001571
 001572           //----------------------------------------------------------------------------------                       001572
 001573            // UNLOCK                                                                                                 001573
 001574         When %subst(operator:1:6) = 'UNLOCK';                                                   X01                  001574
 001575            Exsr subUserCvt_UNLOCK;                                                               01                  001575
 001576                                                                                                                      001576
 001577           //----------------------------------------------------------------------------------                       001577
 001578            // WHENxx                                                                                                 001578
 001579         When %subst(operator:1:4) = 'WHEN' or inWhen;                                           X01                  001579
 001580            Exsr subUserCvt_WHEN;                                                                 01                  001580
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     41
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001581                                                                                                                      001581
 001582           //----------------------------------------------------------------------------------                       001582
 001583            // WRITE                                                                                                  001583
 001584         When %subst(operator:1:5) = 'WRITE';                                                    X01                  001584
 001585            Exsr subUserCvt_WRITE;                                                                01                  001585
 001586                                                                                                                      001586
 001587           //----------------------------------------------------------------------------------                       001587
 001588            // XLATE                                                                                                  001588
 001589         When %subst(operator:1:5) = 'XLATE';                                                    X01                  001589
 001590            Exsr subUserCvt_XLATE;                                                                01                  001590
 001591                                                                                                                      001591
 001592           //----------------------------------------------------------------------------------                       001592
 001593            // Z-ADD (half-adjust not converted).                                                                     001593
 001594         When %subst(operator:1:5) = 'Z-ADD';                                                    X01                  001594
 001595            Exsr subUserCvt_Z_ADD;                                                                01                  001595
 001596                                                                                                                      001596
 001597           //----------------------------------------------------------------------------------                       001597
 001598            // Z-SUB (half-adjust not converted).                                                                     001598
 001599         When %subst(operator:1:5) = 'Z-SUB';                                                    X01                  001599
 001600            Exsr subUserCvt_Z_SUB;                                                                01                  001600
 001601      EndSl;                                                                                     E01                  001601
 001602                                                                                                                      001602
 001603   EndSr;                                                                                                             001603
 001604   //-------------------------------------------------------------------------------------------                      001604
 001605                                                                                                                      001605
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     42
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001607   //-------------------------------------------------------------------------------------------                      001607
 001608   // Convert declaration to free-format.                                                                             001608
 001609   //-------------------------------------------------------------------------------------------                      001609
 001610   BegSr subUserConvertD_Spec;                                                                                        001610
 001611                                                                                                                      001611
 001612      // Keep blank lines.                                                                                            001612
 001613      If codeLine = *Blanks;                                                                     B01                  001613
 001614         sourceLine = *Blanks;                                                                    01                  001614
 001615         convert = *On;                                                                           01                  001615
 001616         LeaveSr;                                                                                 01                  001616
 001617      EndIf;                                                                                     E01                  001617
 001618                                                                                                                      001618
 001619      sourceLine = fullLine;                                                                                          001619
 001620                                                                                                                      001620
 001621      //      declType = %xlate(lo:up:declType);                                                                      001621
 001622      workDeclAttr = %xlate(lo:up:declAttr);                                                                          001622
 001623      workDeclKeywords = declKeywords;       // Use longer work field to cater for expansion.                         001623
 001624                                                                                                                      001624
 001625      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              001625
 001626                                                                                                                      001626
 001627      //If not inDeclaration;                                                                                         001627
 001628      If not inDeclaration or declName = *Blanks;                                                B01                  001628
 001629         If not inDeclaration;                                                                   B02                  001629
 001630            //Exsr subUserGetDeclarationType;                                                                         001630
 001631            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  001631
 001632         EndIf;                                                                                  E02                  001632
 001633                                                                                                                      001633
 001634         //-------------------------------------------------------------------------                                  001634
 001635         // Stand-alone Field Definition.                                                                             001635
 001636         //-------------------------------------------------------------------------                                  001636
 001637         If workDeclType = 'S';      // Stand-alone field.                                       B02                  001637
 001638            inDeclaration = *On;                                                                  02                  001638
 001639                                                                                                                      001639
 001640            Clear DCLS;                                                                           02                  001640
 001641                                                                                                                      001641
 001642            // FROMFILE is not allowed.                                                                               001642
 001643            If %scan('FROMFILE':%xlate(lo:up:workDeclKeywords)) > 0;                             B03                  001643
 001644               inDeclaration = *Off;                                                              03                  001644
 001645               nonConvRsn = 'FROMFILE not allowed in Free-Form';                                  03                  001645
 001646               convert = *Off;                                                                    03                  001646
 001647               LeaveSr;                                                                           03                  001647
 001648            EndIf;                                                                               E03                  001648
 001649                                                                                                                      001649
 001650            If savedName <> *Blanks;                                                             B03                  001650
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     43
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001651               DCLS.decl = 'Dcl-S ';                                                              03                  001651
 001652               %subst(DCLS:7) = savedName;                                                        03                  001652
 001653            EndIf;                                                                               E03                  001653
 001654                                                                                                                      001654
 001655            // Type.                                                                                                  001655
 001656            If workDeclAttr = *Blanks                                                            B03                  001656
 001657            and DCLS.type = *Blanks;                                                             B03                  001657
 001658               If declLen = *Blanks;                                                             B04                  001658
 001659                  // No definition (probably in keywords - e.g. LIKE()).                                              001659
 001660               ElseIf declScale = *Blanks;                                                       X04                  001660
 001661                  workDeclAttr = 'A';                                                             04                  001661
 001662               Else;                                                                             X04                  001662
 001663                  If inDatastructure;                                                            B05                  001663
 001664                     workDeclAttr = 'S';                                                          05                  001664
 001665                  Else;                                                                          X05                  001665
 001666                     workDeclAttr = 'P';                                                          05                  001666
 001667                  EndIf;                                                                         E05                  001667
 001668               EndIf;                                                                            E04                  001668
 001669            EndIf;                                                                               E03                  001669
 001670                                                                                                                      001670
 001671            If workDeclAttr = *Blanks;                                                           B03                  001671
 001672               // No definition (probably in keywords - e.g. LIKE()).                                                 001672
 001673            ElseIf workDeclAttr = 'A';                                                           X03                  001673
 001674               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001674
 001675               If x > 0;                                                                         B04                  001675
 001676                  DCLS.type = '  VarChar';                                                        04                  001676
 001677                  If x = 1;                                                                      B05                  001677
 001678                     workDeclKeywords = %subst(workDeclKeywords:x+7);                             05                  001678
 001679                  Else;                                                                          X05                  001679
 001680                     workDeclKeywords = %subst(workDeclKeywords:1:x-1)                            05                  001680
 001681                                  + %subst(workDeclKeywords:x+7);                                 05                  001681
 001682                  EndIf;                                                                         E05                  001682
 001683               Else;                                                                             X04                  001683
 001684                  DCLS.type = '     Char';                                                        04                  001684
 001685               EndIf;                                                                            E04                  001685
 001686            ElseIf workDeclAttr = 'P';                                                           X03                  001686
 001687               DCLS.type = '   Packed';                                                           03                  001687
 001688            ElseIf workDeclAttr = 'D';                                                           X03                  001688
 001689               DCLS.type = '     Date';                                                           03                  001689
 001690               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001690
 001691               If x > 0;                                                                         B04                  001691
 001692                  x = %scan('(':workDeclKeywords:x);                                              04                  001692
 001693                  y = %scan(')':workDeclKeywords:x);                                              04                  001693
 001694                  DCLS.definition = '('                                                           04                  001694
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     44
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001695                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001695
 001696                            + ')';                                                                04                  001696
 001697                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001697
 001698               EndIf;                                                                            E04                  001698
 001699            ElseIf workDeclAttr = 'T';                                                           X03                  001699
 001700               DCLS.type = '     Time';                                                           03                  001700
 001701               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001701
 001702               If x > 0;                                                                         B04                  001702
 001703                  x = %scan('(':workDeclKeywords:x);                                              04                  001703
 001704                  y = %scan(')':workDeclKeywords:x);                                              04                  001704
 001705                  DCLS.definition = '('                                                           04                  001705
 001706                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001706
 001707                            + ')';                                                                04                  001707
 001708                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001708
 001709               EndIf;                                                                            E04                  001709
 001710            ElseIf workDeclAttr = 'Z';                                                           X03                  001710
 001711               DCLS.type = 'TimeStamp';                                                           03                  001711
 001712            ElseIf workDeclAttr = 'I';                                                           X03                  001712
 001713               DCLS.type = '      Int';                                                           03                  001713
 001714            ElseIf workDeclAttr = 'U';                                                           X03                  001714
 001715               DCLS.type = '      Uns';                                                           03                  001715
 001716            ElseIf workDeclAttr = 'S';                                                           X03                  001716
 001717               DCLS.type = '    Zoned';                                                           03                  001717
 001718            ElseIf workDeclAttr = 'N';                                                           X03                  001718
 001719               DCLS.type = '      Ind';                                                           03                  001719
 001720            ElseIf workDeclAttr = '*';                                                           X03                  001720
 001721               DCLS.type = '  Pointer';                                                           03                  001721
 001722            ElseIf workDeclAttr = 'B';                                                           X03                  001722
 001723               DCLS.type = '   BinDec';                                                           03                  001723
 001724            ElseIf workDeclAttr = 'G';                                                           X03                  001724
 001725               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001725
 001726               If x > 0;                                                                         B04                  001726
 001727                  DCLS.type = ' VarGraph';                                                        04                  001727
 001728                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001728
 001729               Else;                                                                             X04                  001729
 001730                  DCLS.type = '    Graph';                                                        04                  001730
 001731               EndIf;                                                                            E04                  001731
 001732            Else;                                                                                X03                  001732
 001733               inDeclaration = *Off;                                                              03                  001733
 001734               convert = *Off;                                                                    03                  001734
 001735               LeaveSr;                                                                           03                  001735
 001736            EndIf;                                                                               E03                  001736
 001737                                                                                                                      001737
 001738            // Attributes.                                                                                            001738
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     45
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001739            If workDeclAttr <> '*'                                                               B03                  001739
 001740            and workDeclAttr <> 'N'                                                              B03                  001740
 001741            and workDeclAttr <> 'D'                                                              B03                  001741
 001742            and workDeclAttr <> 'T'                                                              B03                  001742
 001743            and workDeclAttr <> 'Z'                                                              B03                  001743
 001744            and workDeclAttr <> *Blank                                                           B03                  001744
 001745            and DCLS.type <> *Blanks;                                                            B03                  001745
 001746               DCLS.definition = '(' + %trim(declLen);                                            03                  001746
 001747               If declScale <> *Blanks;                                                          B04                  001747
 001748                  DCLS.definition = %trimr(DCLS.definition)                                       04                  001748
 001749                                  + ':' + %trim(declScale);                                       04                  001749
 001750               EndIf;                                                                            E04                  001750
 001751               DCLS.definition = %trimr(DCLS.definition) + ')';                                   03                  001751
 001752            EndIf;                                                                               E03                  001752
 001753                                                                                                                      001753
 001754            // Keywords.                                                                                              001754
 001755                                                                                                                      001755
 001756            // Expand DTAARA?                                                                                         001756
 001757            x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                                  02                  001757
 001758            If x > 0;                                                                            B03                  001758
 001759               i = %scan(')':workDeclKeywords:x+1);                                               03                  001759
 001760               If i > 0;                                                                         B04                  001760
 001761                  If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                         B05                  001761
 001762                     workDeclKeywords = %subst(workDeclKeywords:1:x+6)                            05                  001762
 001763                        + ''''                                                                    05                  001763
 001764                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      05                  001764
 001765                        + ''''                                                                    05                  001765
 001766                        + %subst(workDeclKeywords:i);                                             05                  001766
 001767                  EndIf;                                                                         E05                  001767
 001768               EndIf;                                                                            E04                  001768
 001769            EndIf;                                                                               E03                  001769
 001770                                                                                                                      001770
 001771            // Terminate the line?                                                                                    001771
 001772            If not inSpan;                                                                       B03                  001772
 001773               If workDeclKeyWords = *Blanks;                                                    B04                  001773
 001774                  DCLS.definition = %trimr(DCLS.definition) + ';';                                04                  001774
 001775               Else;                                                                             X04                  001775
 001776                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  001776
 001777               EndIf;                                                                            E04                  001777
 001778               inDeclaration = *Off;                                                              03                  001778
 001779            Else;                                                                                X03                  001779
 001780               inSpan = *Off;                                                                     03                  001780
 001781            EndIf;                                                                               E03                  001781
 001782                                                                                                                      001782
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     46
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001783            // Have we encroached on the comments?                                                                    001783
 001784            x = %len(%trimr(DCLS.definition)) + %len(workDeclKeywords);                           02                  001784
 001785            If x >= 37;                                                                          B03                  001785
 001786               x = x - %len(%trimr(DCLS.definition));                                             03                  001786
 001787               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  001787
 001788               indentOffset = 37;                                                                 03                  001788
 001789            EndIf;                                                                               E03                  001789
 001790                                                                                                                      001790
 001791            If DCLS.definition = *Blanks and DCLS.type = *Blanks;                                B03                  001791
 001792               DCLS.definition = %trim(workDeclKeywords);                                         03                  001792
 001793            Else;                                                                                X03                  001793
 001794               DCLS.definition = %trimr(DCLS.definition) + ' '                                    03                  001794
 001795                               + %trim(workDeclKeywords);                                         03                  001795
 001796            EndIf;                                                                               E03                  001796
 001797                                                                                                                      001797
 001798            // Comment.                                                                                               001798
 001799            If comment <> *Blanks;                                                               B03                  001799
 001800               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001800
 001801                  DCLS.comment = '   ' + comment;                                                 04                  001801
 001802               Else;                                                                             X04                  001802
 001803                  DCLS.comment = '// ' + comment;                                                 04                  001803
 001804               EndIf;                                                                            E04                  001804
 001805            EndIf;                                                                               E03                  001805
 001806                                                                                                                      001806
 001807            // Converted line...                                                                                      001807
 001808            sourceLine = DCLS;                                                                    02                  001808
 001809            If not inSpan;                                                                       B03                  001809
 001810               savedName = *Blanks;                                                               03                  001810
 001811            EndIf;                                                                               E03                  001811
 001812                                                                                                                      001812
 001813            //-------------------------------------------------------------------------                               001813
 001814            // Constant Definition.                                                                                   001814
 001815            //-------------------------------------------------------------------------                               001815
 001816         ElseIf workDeclType = 'C';                                                              X02                  001816
 001817            inDeclaration = *On;                                                                  02                  001817
 001818                                                                                                                      001818
 001819            Clear DCLS;                                                                           02                  001819
 001820            If savedName <> *Blanks;                                                             B03                  001820
 001821               DCLS.decl = 'Dcl-C ';                                                              03                  001821
 001822               %subst(DCLS:7) = %xlate(lo:up:savedName);                                          03                  001822
 001823            EndIf;                                                                               E03                  001823
 001824                                                                                                                      001824
 001825            // Keywords.                                                                                              001825
 001826            If workDeclKeywords <> *Blanks;                                                      B03                  001826
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     47
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001827               If DCLS.definition = *Blanks;                                                     B04                  001827
 001828                  DCLS.definition = %trim(workDeclKeywords);                                      04                  001828
 001829               Else;                                                                             X04                  001829
 001830                  DCLS.definition = %trimr(DCLS.definition) + ' '                                 04                  001830
 001831                                  + %trim(workDeclKeywords);                                      04                  001831
 001832               EndIf;                                                                            E04                  001832
 001833            EndIf;                                                                               E03                  001833
 001834                                                                                                                      001834
 001835            // Comment.                                                                                               001835
 001836            If comment <> *Blanks;                                                               B03                  001836
 001837               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001837
 001838                  DCLS.comment = '   ' + comment;                                                 04                  001838
 001839               Else;                                                                             X04                  001839
 001840                  DCLS.comment = '// ' + comment;                                                 04                  001840
 001841               EndIf;                                                                            E04                  001841
 001842            EndIf;                                                                               E03                  001842
 001843                                                                                                                      001843
 001844            If not inSpan;                                                                       B03                  001844
 001845               DCLS.definition = %trimr(DCLS.definition) + ';';                                   03                  001845
 001846               inDeclaration = *Off;                                                              03                  001846
 001847            Else;                                                                                X03                  001847
 001848               inSpan = *Off;                                                                     03                  001848
 001849            EndIf;                                                                               E03                  001849
 001850                                                                                                                      001850
 001851            // Continuation of constant must start at left margin.                                                    001851
 001852            If DCLS.decl = *Blanks;                                                              B03                  001852
 001853               DCLS = DCLS.definition;                                                            03                  001853
 001854            EndIf;                                                                               E03                  001854
 001855                                                                                                                      001855
 001856            // Converted line...                                                                                      001856
 001857            sourceLine = DCLS;                                                                    02                  001857
 001858            If not inSpan;                                                                       B03                  001858
 001859               savedName = *Blanks;                                                               03                  001859
 001860            EndIf;                                                                               E03                  001860
 001861                                                                                                                      001861
 001862            //-------------------------------------------------------------------------                               001862
 001863            // Prototype/Interface/Datastructure Definition.                                                          001863
 001864            //-------------------------------------------------------------------------                               001864
 001865         ElseIf workDeclType = 'PR'                                                              X02                  001865
 001866             or inPrototype                                                                      X02                  001866
 001867             or workDeclType = 'PI'                                                              X02                  001867
 001868             or inInterface                                                                      X02                  001868
 001869             or workDeclType = 'DS'                                                              X02                  001869
 001870             or inDatastructure;                                                                 X02                  001870
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     48
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001871            inDeclaration = *On;                                                                  02                  001871
 001872            Clear DCLPR;                                                                          02                  001872
 001873                                                                                                                      001873
 001874            // Determine where to end the structure.                                                                  001874
 001875            If not inPrototype                                                                   B03                  001875
 001876            and not inInterface                                                                  B03                  001876
 001877            and not inDatastructure;                                                             B03                  001877
 001878               Exsr subUserGetEndLine;                                                            03                  001878
 001879               If workDeclType = 'PR';                                                           B04                  001879
 001880                  inPrototype = *On;                                                              04                  001880
 001881               ElseIf workDeclType = 'PI';                                                       X04                  001881
 001882                  inInterface = *On;                                                              04                  001882
 001883               ElseIf workDeclType = 'DS';                                                       X04                  001883
 001884                  inDatastructure = *On;                                                          04                  001884
 001885                  endDS = *On;                                                                    04                  001885
 001886               EndIf;                                                                            E04                  001886
 001887               DCLPR.decl = 'Dcl-' + workDeclType;                                                03                  001887
 001888               If savedName = *Blanks;                                                           B04                  001888
 001889                  savedName = '*N';                                                               04                  001889
 001890               EndIf;                                                                            E04                  001890
 001891               %subst(DCLPR:8) = savedName;                                                       03                  001891
 001892               //DCLPR.procName = savedName;                                                                          001892
 001893               endDeclType = workDeclType;                                                        03                  001893
 001894               workDeclName = savedName;                                                          03                  001894
 001895               If %scan('...':sourceLine) > 0;  // Long name!                                    B04                  001895
 001896                  workDeclAttr = *Blanks;                                                         04                  001896
 001897               EndIf;                                                                            E04                  001897
 001898            Else;                                                                                X03                  001898
 001899               If inPrototype                                                                    B04                  001899
 001900               and savedName = *Blanks                                                           B04                  001900
 001901               and declType = *Blanks                                                            B04                  001901
 001902               and not inExtProc                                                                 B04                  001902
 001903               and not inSpan;                                                                   B04                  001903
 001904                  savedName = '*N';                                                               04                  001904
 001905               EndIf;                                                                            E04                  001905
 001906                                                                                                                      001906
 001907               If savedName <> '**';                                                             B04                  001907
 001908                  DCLPR.fieldName = savedName;                                                    04                  001908
 001909               EndIf;                                                                            E04                  001909
 001910            EndIf;                                                                               E03                  001910
 001911                                                                                                                      001911
 001912            // Type.                                                                                                  001912
 001913            If workDeclAttr = *Blanks                                                            B03                  001913
 001914            and DCLPR.type = *Blanks;                                                            B03                  001914
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     49
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001915               If declLen = *Blanks;                                                             B04                  001915
 001916                  // No definition (probably in keywords - e.g. LIKE()).                                              001916
 001917               ElseIf declScale = *Blanks;                                                       X04                  001917
 001918                  workDeclAttr = 'A';                                                             04                  001918
 001919               Else;                                                                             X04                  001919
 001920                  If inDatastructure;                                                            B05                  001920
 001921                     workDeclAttr = 'S';                                                          05                  001921
 001922                  Else;                                                                          X05                  001922
 001923                     workDeclAttr = 'P';                                                          05                  001923
 001924                  EndIf;                                                                         E05                  001924
 001925               EndIf;                                                                            E04                  001925
 001926            EndIf;                                                                               E03                  001926
 001927                                                                                                                      001927
 001928            If workDeclAttr = *Blanks;                                                           B03                  001928
 001929               // No definition (probably in keywords - e.g. LIKE()).                                                 001929
 001930            ElseIf workDeclAttr = 'A';                                                           X03                  001930
 001931               If DCLPR.decl = 'Dcl-DS';                                                         B04                  001931
 001932                  If declLen <> *Blanks;                                                         B05                  001932
 001933                     DCLPR.type = '      Len';                                                    05                  001933
 001934                  EndIf;                                                                         E05                  001934
 001935               Else;                                                                             X04                  001935
 001936                  x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                            04                  001936
 001937                  If x > 0;                                                                      B05                  001937
 001938                     DCLPR.type = '  VarChar';                                                    05                  001938
 001939                     If x = 1;                                                                   B06                  001939
 001940                        workDeclKeywords = %subst(workDeclKeywords:x+7);                          06                  001940
 001941                     Else;                                                                       X06                  001941
 001942                        workDeclKeywords = %subst(workDeclKeywords:1:x-1)                         06                  001942
 001943                                     + %subst(workDeclKeywords:x+7);                              06                  001943
 001944                     EndIf;                                                                      E06                  001944
 001945                  Else;                                                                          X05                  001945
 001946                     DCLPR.type = '     Char';                                                    05                  001946
 001947                  EndIf;                                                                         E05                  001947
 001948               EndIf;                                                                            E04                  001948
 001949            ElseIf workDeclAttr = 'P';                                                           X03                  001949
 001950               DCLPR.type = '   Packed';                                                          03                  001950
 001951            ElseIf workDeclAttr = 'D';                                                           X03                  001951
 001952               DCLPR.type = '     Date';                                                          03                  001952
 001953               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001953
 001954               If x > 0;                                                                         B04                  001954
 001955                  x = %scan('(':workDeclKeywords:x);                                              04                  001955
 001956                  y = %scan(')':workDeclKeywords:x);                                              04                  001956
 001957                  DCLPR.definition = '('                                                          04                  001957
 001958                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001958
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     50
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001959                            + ')';                                                                04                  001959
 001960                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001960
 001961               EndIf;                                                                            E04                  001961
 001962            ElseIf workDeclAttr = 'T';                                                           X03                  001962
 001963               DCLPR.type = '     Time';                                                          03                  001963
 001964               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001964
 001965               If x > 0;                                                                         B04                  001965
 001966                  x = %scan('(':workDeclKeywords:x);                                              04                  001966
 001967                  y = %scan(')':workDeclKeywords:x);                                              04                  001967
 001968                  DCLPR.definition = '('                                                          04                  001968
 001969                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001969
 001970                            + ')';                                                                04                  001970
 001971                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001971
 001972               EndIf;                                                                            E04                  001972
 001973            ElseIf workDeclAttr = 'Z';                                                           X03                  001973
 001974               DCLPR.type = 'TimeStamp';                                                          03                  001974
 001975            ElseIf workDeclAttr = 'I';                                                           X03                  001975
 001976               DCLPR.type = '      Int';                                                          03                  001976
 001977            ElseIf workDeclAttr = 'U';                                                           X03                  001977
 001978               DCLPR.type = '      Uns';                                                          03                  001978
 001979            ElseIf workDeclAttr = 'S';                                                           X03                  001979
 001980               DCLPR.type = '    Zoned';                                                          03                  001980
 001981            ElseIf workDeclAttr = 'N';                                                           X03                  001981
 001982               DCLPR.type = '      Ind';                                                          03                  001982
 001983            ElseIf workDeclAttr = '*';                                                           X03                  001983
 001984               DCLPR.type = '  Pointer';                                                          03                  001984
 001985            ElseIf workDeclAttr = 'B';                                                           X03                  001985
 001986               DCLPR.type = '   BinDec';                                                          03                  001986
 001987            ElseIf workDeclAttr = 'G';                                                           X03                  001987
 001988               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001988
 001989               If x > 0;                                                                         B04                  001989
 001990                  DCLPR.type = ' VarGraph';                                                       04                  001990
 001991                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001991
 001992               Else;                                                                             X04                  001992
 001993                  DCLPR.type = '    Graph';                                                       04                  001993
 001994               EndIf;                                                                            E04                  001994
 001995            Else;                                                                                X03                  001995
 001996               inDeclaration = *Off;                                                              03                  001996
 001997               convert = *Off;                                                                    03                  001997
 001998               LeaveSr;                                                                           03                  001998
 001999            EndIf;                                                                               E03                  001999
 002000                                                                                                                      002000
 002001            // Attributes.                                                                                            002001
 002002            If workDeclAttr <> '*'                                                               B03                  002002
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     51
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002003            and workDeclAttr <> 'N'                                                              B03                  002003
 002004            and workDeclAttr <> 'D'                                                              B03                  002004
 002005            and workDeclAttr <> 'T'                                                              B03                  002005
 002006            and workDeclAttr <> 'Z'                                                              B03                  002006
 002007            and workDeclAttr <> *Blank                                                           B03                  002007
 002008            and DCLPR.type <> *Blanks;                                                           B03                  002008
 002009               DCLPR.definition = '(';                                                            03                  002009
 002010               If inDatastructure and declFrom <> *Blanks;                                       B04                  002010
 002011                  workLength = %dec(%trim(declLen):7:0)                                           04                  002011
 002012                             - %dec(%trim(declFrom):7:0) + 1;                                     04                  002012
 002013                  If workDeclAttr = 'B';                                                         B05                  002013
 002014                     workLength = workLength * 2;                                                 05                  002014
 002015                  ElseIf workDeclAttr = 'P';                                                     X05                  002015
 002016                     workLength = (workLength * 2) - 1;                                           05                  002016
 002017                  EndIf;                                                                         E05                  002017
 002018                  AdjustArrayLength(workLength);                                                  04                  002018
 002019                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002019
 002020                                   + %char(workLength);                                           04                  002020
 002021               Else;                                                                             X04                  002021
 002022                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002022
 002023                                   + %trim(declLen);                                              04                  002023
 002024               EndIf;                                                                            E04                  002024
 002025                                                                                                                      002025
 002026               If declScale <> *Blanks;                                                          B04                  002026
 002027                  DCLPR.definition = %trimr(DCLPR.definition)                                     04                  002027
 002028                                  + ':' + %trim(declScale);                                       04                  002028
 002029               EndIf;                                                                            E04                  002029
 002030               DCLPR.definition = %trimr(DCLPR.definition) + ')';                                 03                  002030
 002031            EndIf;                                                                               E03                  002031
 002032                                                                                                                      002032
 002033            // From specified?                                                                                        002033
 002034            If inDatastructure;                                                                  B03                  002034
 002035               If declFrom <> *Blanks                                                            B04                  002035
 002036               and %scan('...':declOptions) = 0;                                                 B04                  002036
 002037                  If %subst(declFrom:1:1) = '*';                                                 B05                  002037
 002038                     workDeclKeywords = %trim(declFrom) + ' ';                                    05                  002038
 002039                  Else;                                                                          X05                  002039
 002040                  workDeclKeywords = 'Pos(' + %trim(declFrom) + ') '                              05                  002040
 002041                               + workDeclKeywords;                                                05                  002041
 002042                  EndIf;                                                                         E05                  002042
 002043               Else;                                                                             X04                  002043
 002044                  // Overlay specified using the base datastructure name?                                             002044
 002045                  // This is not permitted in free-form, so convert it to 'POS'.                                      002045
 002046                  x = %scan('OVERLAY(':%xlate(lo:up:workDeclKeywords));                           04                  002046
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     52
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002047                  If x > 0;                                                                      B05                  002047
 002048                     i = %scan(':':workDeclKeywords:x);                                           05                  002048
 002049                     If i > 0;                                                                   B06                  002049
 002050                        If %trim(%xlate(lo:up                                                    B07                  002050
 002051                                :%subst(workDeclKeywords:x+8:i-x-8))) =                          B07                  002051
 002052                           %xlate(lo:up:workDeclName);                                           B07                  002052
 002053                           j = %scan(')':workDeclKeywords:i);                                     07                  002053
 002054                           If j > 0;                                                             B08                  002054
 002055                              If x = 1;                                                          B09                  002055
 002056                                 workDeclKeywords                                                 09                  002056
 002057                                  = 'Pos('                                                        09                  002057
 002058                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002058
 002059                                 + %subst(workDeclKeywords:j);                                    09                  002059
 002060                              Else;                                                              X09                  002060
 002061                                 workDeclKeywords                                                 09                  002061
 002062                                   = %trim(%subst(workDeclKeywords:1:x-1))                        09                  002062
 002063                                   + ' Pos('                                                      09                  002063
 002064                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002064
 002065                                 + %subst(workDeclKeywords:j);                                    09                  002065
 002066                              EndIf;                                                             E09                  002066
 002067                           EndIf;                                                                E08                  002067
 002068                        EndIf;                                                                   E07                  002068
 002069                     EndIf;                                                                      E06                  002069
 002070                  EndIf;                                                                         E05                  002070
 002071               EndIf;                                                                            E04                  002071
 002072               // Require End-DS?                                                                                     002072
 002073               x = %scan('LIKEDS(':%xlate(lo:up:workDeclKeywords));                               03                  002073
 002074               If x = 0;                                                                         B04                  002074
 002075                  x = %scan('LIKEREC(':%xlate(lo:up:workDeclKeywords));                           04                  002075
 002076               EndIf;                                                                            E04                  002076
 002077               If x > 0;                                                                         B04                  002077
 002078                  // Nope.                                                                                            002078
 002079                  endDS = *Off;                                                                   04                  002079
 002080               EndIf;                                                                            E04                  002080
 002081                                                                                                                      002081
 002082               // Datastructure type?                                                                                 002082
 002083               If declPrefix = 'S';       // Program Status                                      B04                  002083
 002084                  workDeclKeywords = 'PSDS ' + workDeclKeywords;                                  04                  002084
 002085                  If savedName = DCLPR.procName;                                                 B05                  002085
 002086                     %subst(savedName:16:1) = *Blank;                                             05                  002086
 002087                  EndIf;                                                                         E05                  002087
 002088                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002088
 002089                                                                                                                      002089
 002090               ElseIf declPrefix = 'U';   // Dataarea                                            X04                  002090
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     53
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002091                  // If not already defined as a data area, do it now.                                                002091
 002092                  If %scan('DTAARA':%xlate(lo:up:workDeclKeywords)) = 0;                         B05                  002092
 002093                     If declName = *Blanks;                                                      B06                  002093
 002094                        workDeclKeywords = 'DTAARA(*AUTO) '                                       06                  002094
 002095                                                     + workDeclKeywords;                          06                  002095
 002096                     Else;                                                                       X06                  002096
 002097                        workDeclKeywords = 'DTAARA ' + workDeclKeywords;                          06                  002097
 002098                     EndIf;                                                                      E06                  002098
 002099                  EndIf;                                                                         E05                  002099
 002100                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002100
 002101               EndIf;                                                                            E04                  002101
 002102            EndIf;                                                                               E03                  002102
 002103                                                                                                                      002103
 002104            // Keywords.                                                                                              002104
 002105            If workDeclKeywords <> *Blanks;                                                      B03                  002105
 002106               // ExtProc name has extended to a second line.                                                         002106
 002107               If inExtProc;                                                                     B04                  002107
 002108                  // Continuation of name must start at left margin.                                                  002108
 002109                  DCLPR = workDeclKeywords;                                                       04                  002109
 002110                  workDeclKeywords = *Blanks;                                                     04                  002110
 002111                  inExtProc = *Off;                                                               04                  002111
 002112               EndIf;                                                                            E04                  002112
 002113                                                                                                                      002113
 002114               // Expand EXTNAME?                                                                                     002114
 002115               x = %scan('EXTNAME(':%xlate(lo:up:workDeclKeywords));                              03                  002115
 002116               If x > 0;                                                                         B04                  002116
 002117                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002117
 002118                  If i > 0;                                                                      B05                  002118
 002119                     If %scan('''':%subst(workDeclKeywords:x+8:i-x-8)) = 0;                      B06                  002119
 002120                        workDeclKeywords = %subst(workDeclKeywords:1:x+7)                         06                  002120
 002121                           + ''''                                                                 06                  002121
 002122                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+8:i-x-8)))                      06                  002122
 002123                           + ''''                                                                 06                  002123
 002124                           + %subst(workDeclKeywords:i);                                          06                  002124
 002125                     EndIf;                                                                      E06                  002125
 002126                  EndIf;                                                                         E05                  002126
 002127               EndIf;                                                                            E04                  002127
 002128                                                                                                                      002128
 002129               // Expand DTAARA?                                                                                      002129
 002130               x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                               03                  002130
 002131               If x > 0;                                                                         B04                  002131
 002132                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002132
 002133                  If i > 0;                                                                      B05                  002133
 002134                     If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                      B06                  002134
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     54
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002135                        workDeclKeywords = %subst(workDeclKeywords:1:x+6)                         06                  002135
 002136                           + ''''                                                                 06                  002136
 002137                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      06                  002137
 002138                           + ''''                                                                 06                  002138
 002139                           + %subst(workDeclKeywords:i);                                          06                  002139
 002140                     EndIf;                                                                      E06                  002140
 002141                  EndIf;                                                                         E05                  002141
 002142               EndIf;                                                                            E04                  002142
 002143                                                                                                                      002143
 002144               // EXTPROC?                                                                                            002144
 002145               x = %scan('EXTPROC(':%xlate(lo:up:workDeclKeywords));                              03                  002145
 002146               If x > 0;                                                                         B04                  002146
 002147                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002147
 002148                  If i = 0;                                                                      B05                  002148
 002149                     // Name extends onto next line.                                                                  002149
 002150                     inExtProc = *On;                                                             05                  002150
 002151                  EndIf;                                                                         E05                  002151
 002152               EndIf;                                                                            E04                  002152
 002153            EndIf;                                                                               E03                  002153
 002154                                                                                                                      002154
 002155            // Terminate the line?                                                                                    002155
 002156            If not inSpan;                                                                       B03                  002156
 002157               If workDeclKeywords = *Blanks and DCLPR.type = *Blanks;                           B04                  002157
 002158                  DCLPR.procName = %trimr(DCLPR.procName) + ';';                                  04                  002158
 002159               ElseIf workDeclKeywords = *Blanks;                                                X04                  002159
 002160                  DCLPR.definition = %trimr(DCLPR.definition) + ';';                              04                  002160
 002161               Else;                                                                             X04                  002161
 002162                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  002162
 002163               EndIf;                                                                            E04                  002163
 002164               inDeclaration = *Off;                                                              03                  002164
 002165               savedName = *Blanks;                                                               03                  002165
 002166            Else;                                                                                X03                  002166
 002167               inSpan = *Off;                                                                     03                  002167
 002168            EndIf;                                                                               E03                  002168
 002169                                                                                                                      002169
 002170            // Have we encroached on the comments?                                                                    002170
 002171            x = %len(%trimr(DCLPR.definition)) + %len(workDeclKeywords);                          02                  002171
 002172            If x >= 37;                                                                          B03                  002172
 002173               x = x - %len(%trimr(DCLPR.definition));                                            03                  002173
 002174               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  002174
 002175               indentOffset = 37;                                                                 03                  002175
 002176            EndIf;                                                                               E03                  002176
 002177                                                                                                                      002177
 002178            If DCLPR.definition = *Blanks and DCLPR.type = *Blanks;                              B03                  002178
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     55
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002179               DCLPR.definition = %trim(workDeclKeywords);                                        03                  002179
 002180            Else;                                                                                X03                  002180
 002181               DCLPR.definition = %trimr(DCLPR.definition) + ' '                                  03                  002181
 002182                               + %trim(workDeclKeywords);                                         03                  002182
 002183            EndIf;                                                                               E03                  002183
 002184                                                                                                                      002184
 002185            // Comment.                                                                                               002185
 002186            If comment <> *Blanks;                                                               B03                  002186
 002187               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  002187
 002188                  DCLPR.comment = '   ' + comment;                                                04                  002188
 002189               Else;                                                                             X04                  002189
 002190                  DCLPR.comment = '// ' + comment;                                                04                  002190
 002191               EndIf;                                                                            E04                  002191
 002192            EndIf;                                                                               E03                  002192
 002193                                                                                                                      002193
 002194            // Converted line...                                                                                      002194
 002195            sourceLine = DCLPR;                                                                   02                  002195
 002196            If not inSpan and savedName <> *Blanks;                                              B03                  002196
 002197               savedName = '**';                                                                  03                  002197
 002198            EndIf;                                                                               E03                  002198
 002199                                                                                                                      002199
 002200            //-------------------------------------------------------------------------                               002200
 002201            // Unsupported.                                                                                           002201
 002202            //-------------------------------------------------------------------------                               002202
 002203         Else;                                                                                   X02                  002203
 002204            inDeclaration = *Off;                                                                 02                  002204
 002205            convert = *Off;                                                                       02                  002205
 002206            LeaveSr;                                                                              02                  002206
 002207         EndIf;                                                                                  E02                  002207
 002208                                                                                                                      002208
 002209         //-------------------------------------------------------------------------                                  002209
 002210         // Second+ line of declaration.                                                                              002210
 002211         //-------------------------------------------------------------------------                                  002211
 002212      Else;                                                                                      X01                  002212
 002213         Clear DCLS;                                                                              01                  002213
 002214         DCLS.definition = %trim(workDeclKeywords);                                               01                  002214
 002215         If not inSpan;                                                                          B02                  002215
 002216            DCLS.definition = %trim(DCLS.definition) + ';';                                       02                  002216
 002217         EndIf;                                                                                  E02                  002217
 002218         sourceLine = DCLS;                                                                       01                  002218
 002219         inSpan = *Off;                                                                           01                  002219
 002220      EndIf;                                                                                     E01                  002220
 002221                                                                                                                      002221
 002222      convert = *On;                                                                                                  002222
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     56
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002223                                                                                                                      002223
 002224   EndSr;                                                                                                             002224
 002225   //-------------------------------------------------------------------------------------------                      002225
 002226                                                                                                                      002226
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     57
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002228   //-------------------------------------------------------------------------------------------                      002228
 002229   // Convert file spec to free-format.                                                                               002229
 002230   //-------------------------------------------------------------------------------------------                      002230
 002231   BegSr subUserConvertF_Spec;                                                                                        002231
 002232                                                                                                                      002232
 002233      // Keep blank lines.                                                                                            002233
 002234      If codeLine = *Blanks;                                                                     B01                  002234
 002235         sourceLine = *Blanks;                                                                    01                  002235
 002236         convert = *On;                                                                           01                  002236
 002237         LeaveSr;                                                                                 01                  002237
 002238      EndIf;                                                                                     E01                  002238
 002239                                                                                                                      002239
 002240      sourceLine = fullLine;                                                                                          002240
 002241                                                                                                                      002241
 002242      workFileUsage  = %xlate(lo:up:fileUsage);                                                                       002242
 002243      workFileDesig  = %xlate(lo:up:fileDesig);                                                                       002243
 002244      workFileAdd    = %xlate(lo:up:fileAdd);                                                                         002244
 002245      workFileDevice = %xlate(lo:up:fileDevice);                                                                      002245
 002246      workFileKeyed  = %xlate(lo:up:fileKeyed);                                                                       002246
 002247                                                                                                                      002247
 002248      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002248
 002249                                                                                                                      002249
 002250      If not inDeclaration;                                                                      B01                  002250
 002251                                                                                                                      002251
 002252         // Validate whether this can be converted.                                                                   002252
 002253         If workFileUsage = 'I'                                                                  B02                  002253
 002254         and (workFileDesig = 'P'                                                                B02                  002254
 002255         or workFileDesig = 'S'                                                                  B02                  002255
 002256         or workFileUsage = 'T')                                                                 B02                  002256
 002257                                                                                                 B02                  002257
 002258         or workFileUsage = 'O'                                                                  B02                  002258
 002259         and workFileAdd = 'A'                                                                   B02                  002259
 002260                                                                                                 B02                  002260
 002261         or workFileUsage = 'U'                                                                  B02                  002261
 002262         and (workFileDesig = 'P'                                                                B02                  002262
 002263         or workFileDesig = 'S')                                                                 B02                  002263
 002264                                                                                                 B02                  002264
 002265         or workFileUsage = 'C'                                                                  B02                  002265
 002266         and workFileDesig = 'T';                                                                B02                  002266
 002267                                                                                                                      002267
 002268            // Not supported in free-form.                                                                            002268
 002269            inDeclaration = *Off;                                                                 02                  002269
 002270            convert = *Off;                                                                       02                  002270
 002271            nonConvRsn = 'File usage not supported in free-form';                                 02                  002271
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     58
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002272            LeaveSr;                                                                              02                  002272
 002273         EndIf;                                                                                  E02                  002273
 002274                                                                                                                      002274
 002275         savedName = %trim(fileName);                                                             01                  002275
 002276                                                                                                                      002276
 002277         If %xlate(lo:up:fileExternal) = 'E';       // Externally-described file.                B02                  002277
 002278            inDeclaration = *On;                                                                  02                  002278
 002279                                                                                                                      002279
 002280            Clear DCLF;                                                                           02                  002280
 002281            DCLF.decl = 'Dcl-F ';                                                                 02                  002281
 002282            %subst(DCLF:7) = %xlate(lo:up:savedName);                                             02                  002282
 002283                                                                                                                      002283
 002284            // Set device type.                                                                                       002284
 002285            If workFileDevice <> 'DISK';                                                         B03                  002285
 002286               DCLF.device = workFileDevice;                                                      03                  002286
 002287            EndIf;                                                                               E03                  002287
 002288                                                                                                                      002288
 002289            // Set usage.                                                                                             002289
 002290            If workFileUsage = 'I';                                                              B03                  002290
 002291               If workFileAdd = ' ';                                                             B04                  002291
 002292                  If workFileDevice <> 'DISK'                                                    B05                  002292
 002293                  and workFileDevice <> 'SEQ'                                                    B05                  002293
 002294                  and workFileDevice <> 'SPECIAL';                                               B05                  002294
 002295                     DCLF.definition = '*INPUT';                                                  05                  002295
 002296                  EndIf;                                                                         E05                  002296
 002297               Else;                                                                             X04                  002297
 002298                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002298
 002299               EndIf;                                                                            E04                  002299
 002300            ElseIf workFileUsage = 'U';                                                          X03                  002300
 002301               If workFileAdd = ' ';                                                             B04                  002301
 002302                  DCLF.definition = '*UPDATE:*DELETE';                                            04                  002302
 002303               Else;                                                                             X04                  002303
 002304                  DCLF.definition = '*UPDATE:*DELETE:*OUTPUT';                                    04                  002304
 002305               EndIf;                                                                            E04                  002305
 002306            ElseIf workFileUsage = 'O';                                                          X03                  002306
 002307               If workFileDevice <> 'PRINTER';                                                   B04                  002307
 002308                  DCLF.definition = '*OUTPUT';                                                    04                  002308
 002309               EndIf;                                                                            E04                  002309
 002310            ElseIf workFileUsage = 'C';                                                          X03                  002310
 002311               If workFileDevice <> 'WORKSTN';                                                   B04                  002311
 002312                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002312
 002313               EndIf;                                                                            E04                  002313
 002314            EndIf;                                                                               E03                  002314
 002315                                                                                                                      002315
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     59
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002316            // Pad out usage.                                                                                         002316
 002317            If DCLF.definition <> *Blanks;                                                       B03                  002317
 002318               DCLF.definition = 'Usage(' + %trim(DCLF.definition) + ')';                         03                  002318
 002319            EndIf;                                                                               E03                  002319
 002320                                                                                                                      002320
 002321            // Keyed file?                                                                                            002321
 002322            If workFileKeyed = 'K';                                                              B03                  002322
 002323               DCLF.definition = %trim(%trim(DCLF.definition)                                     03                  002323
 002324                                       + ' ' + 'Keyed');                                          03                  002324
 002325            EndIf;                                                                               E03                  002325
 002326                                                                                                                      002326
 002327            If comment <> *Blanks;                                                               B03                  002327
 002328               If %subst(%trim(comment):1:2) = '//';                                             B04                  002328
 002329                  DCLF.comment = '   ' + comment;                                                 04                  002329
 002330               Else;                                                                             X04                  002330
 002331                  DCLF.comment = '// ' + comment;                                                 04                  002331
 002332               EndIf;                                                                            E04                  002332
 002333            EndIf;                                                                               E03                  002333
 002334                                                                                                                      002334
 002335            // Keywords.                                                                                              002335
 002336            If fileKeyWords <> *Blanks;                                                          B03                  002336
 002337               // Do we have room to insert the keywords here?                                                        002337
 002338               checkLength = %len(%trim(%trim(DCLF.definition)                                    03                  002338
 002339                                       + ' ' + %trim(fileKeyWords))) + 1;                         03                  002339
 002340                                                                                                                      002340
 002341               If comment <> *Blanks;                                                            B04                  002341
 002342                  checkLength += 3;                                                               04                  002342
 002343               EndIf;                                                                            E04                  002343
 002344                                                                                                                      002344
 002345               If checkLength > %len(DCLF.definition);                                           B04                  002345
 002346                  // Not enoungh room for the keywords, so output the current line.                                   002346
 002347                  savedSRCDTA = SRCDTA;                                                           04                  002347
 002348                  lineType = *Blank;                                                              04                  002348
 002349                  directive = *Blanks;                                                            04                  002349
 002350                  codeLine = DCLF;                                                                04                  002350
 002351                  Exsr subUserWriteLine;                                                          04                  002351
 002352                  SRCDTA = savedSRCDTA;                                                           04                  002352
 002353                  // ...and move the keywords to their own line.                                                      002353
 002354                  Clear DCLF;                                                                     04                  002354
 002355                  DCLF.definition = fileKeywords;                                                 04                  002355
 002356                  savedComment = *Blanks;                                                         04                  002356
 002357               Else;                                                                             X04                  002357
 002358                  DCLF.definition = %trim(%trim(DCLF.definition)                                  04                  002358
 002359                                          + ' ' + %trim(fileKeyWords));                           04                  002359
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     60
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002360               EndIf;                                                                            E04                  002360
 002361            EndIf;                                                                               E03                  002361
 002362                                                                                                                      002362
 002363            If not inSpan;                                                                       B03                  002363
 002364               DCLF.definition = %trimr(DCLF.definition) + ';';                                   03                  002364
 002365               inDeclaration = *Off;                                                              03                  002365
 002366            Else;                                                                                X03                  002366
 002367               inSpan = *Off;                                                                     03                  002367
 002368            EndIf;                                                                               E03                  002368
 002369                                                                                                                      002369
 002370            // Converted line...                                                                                      002370
 002371            sourceLine = DCLF;                                                                    02                  002371
 002372                                                                                                                      002372
 002373         Else;                                                                                   X02                  002373
 002374            inDeclaration = *Off;                                                                 02                  002374
 002375            convert = *Off;                                                                       02                  002375
 002376            nonConvRsn = 'File not externally-described';                                         02                  002376
 002377            LeaveSr;                                                                              02                  002377
 002378         EndIf;                                                                                  E02                  002378
 002379                                                                                                                      002379
 002380      Else;                   // Second+ line of declaration                                     X01                  002380
 002381         Clear DCLF;                                                                              01                  002381
 002382         DCLF.definition = %trim(fileKeyWords);                                                   01                  002382
 002383         If not inSpan;                                                                          B02                  002383
 002384            DCLF.definition = %trim(DCLF.definition) + ';';                                       02                  002384
 002385         EndIf;                                                                                  E02                  002385
 002386         sourceLine = DCLF;                                                                       01                  002386
 002387         inSpan = *Off;                                                                           01                  002387
 002388      EndIf;                                                                                     E01                  002388
 002389                                                                                                                      002389
 002390      convert = *On;                                                                                                  002390
 002391                                                                                                                      002391
 002392   EndSr;                                                                                                             002392
 002393   //-------------------------------------------------------------------------------------------                      002393
 002394                                                                                                                      002394
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     61
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002396   //-------------------------------------------------------------------------------------------                      002396
 002397   // Convert Header spec to free-format.                                                                             002397
 002398   //-------------------------------------------------------------------------------------------                      002398
 002399   BegSr subUserConvertH_Spec;                                                                                        002399
 002400                                                                                                                      002400
 002401      // Keep blank lines.                                                                                            002401
 002402      If codeLine = *Blanks;                                                                     B01                  002402
 002403         sourceLine = *Blanks;                                                                    01                  002403
 002404         convert = *On;                                                                           01                  002404
 002405         LeaveSr;                                                                                 01                  002405
 002406      EndIf;                                                                                     E01                  002406
 002407                                                                                                                      002407
 002408      sourceLine = codeLine;                                                                                          002408
 002409                                                                                                                      002409
 002410      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002410
 002411                                                                                                                      002411
 002412      If not inDeclaration;                                                                      B01                  002412
 002413         inDeclaration = *On;                                                                     01                  002413
 002414                                                                                                                      002414
 002415         Clear DCLH;                                                                              01                  002415
 002416         DCLH.decl = 'Ctl-Opt ';                                                                  01                  002416
 002417         DCLH.options = %trim(declOptions);                                                       01                  002417
 002418                                                                                                                      002418
 002419         If comment <> *Blanks;                                                                  B02                  002419
 002420            If %subst(%trim(comment):1:2) = '//';                                                B03                  002420
 002421               DCLH.comment = '   ' + comment;                                                    03                  002421
 002422            Else;                                                                                X03                  002422
 002423               DCLH.comment = '// ' + comment;                                                    03                  002423
 002424            EndIf;                                                                               E03                  002424
 002425         EndIf;                                                                                  E02                  002425
 002426                                                                                                                      002426
 002427         If not inSpan;                                                                          B02                  002427
 002428            DCLH.options = %trimr(DCLH.options) + ';';                                            02                  002428
 002429            inDeclaration = *Off;                                                                 02                  002429
 002430         Else;                                                                                   X02                  002430
 002431            inSpan = *Off;                                                                        02                  002431
 002432         EndIf;                                                                                  E02                  002432
 002433                                                                                                                      002433
 002434         // Converted line...                                                                                         002434
 002435         sourceLine = DCLH;                                                                       01                  002435
 002436                                                                                                                      002436
 002437      Else;                   // Second+ line of declaration                                     X01                  002437
 002438         Clear DCLH;                                                                              01                  002438
 002439         DCLH.options = %trim(declOptions);                                                       01                  002439
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     62
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002440         If not inSpan;                                                                          B02                  002440
 002441            DCLH.options = %trim(DCLH.options) + ';';                                             02                  002441
 002442         EndIf;                                                                                  E02                  002442
 002443         sourceLine = DCLH;                                                                       01                  002443
 002444         inSpan = *Off;                                                                           01                  002444
 002445      EndIf;                                                                                     E01                  002445
 002446                                                                                                                      002446
 002447      convert = *On;                                                                                                  002447
 002448                                                                                                                      002448
 002449   EndSr;                                                                                                             002449
 002450   //-------------------------------------------------------------------------------------------                      002450
 002451                                                                                                                      002451
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     63
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002453   //-------------------------------------------------------------------------------------------                      002453
 002454   // Convert procedure declaration to free-format?                                                                   002454
 002455   //-------------------------------------------------------------------------------------------                      002455
 002456   BegSr subUserConvertP_Spec;                                                                                        002456
 002457                                                                                                                      002457
 002458      // Keep blank lines.                                                                                            002458
 002459      If codeLine = *Blanks;                                                                     B01                  002459
 002460         sourceLine = *Blanks;                                                                    01                  002460
 002461         convert = *On;                                                                           01                  002461
 002462         LeaveSr;                                                                                 01                  002462
 002463      EndIf;                                                                                     E01                  002463
 002464                                                                                                                      002464
 002465      sourceLine = fullLine;                                                                                          002465
 002466                                                                                                                      002466
 002467      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002467
 002468                                                                                                                      002468
 002469      If not inDeclaration;   // First line of procedure start/end.                              B01                  002469
 002470         If not inDeclaration;                                                                   B02                  002470
 002471            //Exsr subUserGetDeclarationType;                                                                         002471
 002472            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  002472
 002473         EndIf;                                                                                  E02                  002473
 002474                                                                                                                      002474
 002475         If workDeclType = 'B'       // Begin.                                                   B02                  002475
 002476         or workDeclType = 'E'       // End.                                                     B02                  002476
 002477         or declName <> *Blanks;                                                                 B02                  002477
 002478            inDeclaration = *On;                                                                  02                  002478
 002479                                                                                                                      002479
 002480            Clear DCLP;                                                                           02                  002480
 002481            //            If savedName <> *Blanks;                                                                    002481
 002482            If workDeclType = 'B';                                                               B03                  002482
 002483               DCLP.decl = 'Dcl-Proc ';                                                           03                  002483
 002484            Else;                                                                                X03                  002484
 002485               DCLP.decl = 'End-Proc ';                                                           03                  002485
 002486            EndIf;                                                                               E03                  002486
 002487            DCLP.definition = savedName;                                                          02                  002487
 002488            //            EndIf;                                                                                      002488
 002489                                                                                                                      002489
 002490            If procKeyWords <> *Blanks;                                                          B03                  002490
 002491               DCLP.definition = %trimr(DCLP.definition)                                          03                  002491
 002492                               + ' ' + %trim(procKeyWords);                                       03                  002492
 002493            EndIf;                                                                               E03                  002493
 002494                                                                                                                      002494
 002495            If comment <> *Blanks;                                                               B03                  002495
 002496               If %subst(%trim(comment):1:2) = '//';                                             B04                  002496
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     64
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002497                  DCLP.comment = '   ' + comment;                                                 04                  002497
 002498               Else;                                                                             X04                  002498
 002499                  DCLP.comment = '// ' + comment;                                                 04                  002499
 002500               EndIf;                                                                            E04                  002500
 002501            EndIf;                                                                               E03                  002501
 002502                                                                                                                      002502
 002503            If not inSpan;                                                                       B03                  002503
 002504               DCLP.definition = %trimr(DCLP.definition) + ';';                                   03                  002504
 002505               inDeclaration = *Off;                                                              03                  002505
 002506            Else;                                                                                X03                  002506
 002507               inSpan = *Off;                                                                     03                  002507
 002508            EndIf;                                                                               E03                  002508
 002509                                                                                                                      002509
 002510            // Converted line...                                                                                      002510
 002511            sourceLine = DCLP;                                                                    02                  002511
 002512            savedName = *Blanks;                                                                  02                  002512
 002513                                                                                                                      002513
 002514         Else;                                                                                   X02                  002514
 002515            inDeclaration = *Off;                                                                 02                  002515
 002516            convert = *Off;                                                                       02                  002516
 002517            LeaveSr;                                                                              02                  002517
 002518         EndIf;                                                                                  E02                  002518
 002519                                                                                                                      002519
 002520      Else;                   // Second+ line of procedure start/end.                            X01                  002520
 002521         Clear DCLP;                                                                              01                  002521
 002522         DCLP.definition = %trim(declKeyWords);                                                   01                  002522
 002523         If not inSpan;                                                                          B02                  002523
 002524            DCLP.definition = %trimr(DCLP.definition) + ';';                                      02                  002524
 002525         EndIf;                                                                                  E02                  002525
 002526         sourceLine = DCLP;                                                                       01                  002526
 002527         inSpan = *Off;                                                                           01                  002527
 002528      EndIf;                                                                                     E01                  002528
 002529                                                                                                                      002529
 002530      convert = *On;                                                                                                  002530
 002531                                                                                                                      002531
 002532   EndSr;                                                                                                             002532
 002533   //-------------------------------------------------------------------------------------------                      002533
 002534                                                                                                                      002534
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     65
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002536   //-------------------------------------------------------------------------------------------                      002536
 002537   // Set Resulting Indicators.                                                                                       002537
 002538   //-------------------------------------------------------------------------------------------                      002538
 002539   BegSr subUserSetIndicators;                                                                                        002539
 002540                                                                                                                      002540
 002541      //-----------------------------------------------------------------------                                       002541
 002542      // Scan found.                                                                                                  002542
 002543      If foundCheck;                                                                             B01                  002543
 002544         Clear nonPrefix;                                                                         01                  002544
 002545                                                                                                                      002545
 002546         codeLine = '*IN' + foundInd + ' = %found();';                                            01                  002546
 002547         Exsr subUserReformatLine;                                                                01                  002547
 002548                                                                                                                      002548
 002549         foundCheck = *Off;                                                                       01                  002549
 002550      EndIf;                                                                                     E01                  002550
 002551                                                                                                                      002551
 002552      //-----------------------------------------------------------------------                                       002552
 002553      // Error indicator check.                                                                                       002553
 002554      If ERRCheck;                                                                               B01                  002554
 002555         Clear nonPrefix;                                                                         01                  002555
 002556                                                                                                                      002556
 002557         codeLine = '*IN' + ERRInd + ' = %error();';                                              01                  002557
 002558         Exsr subUserReformatLine;                                                                01                  002558
 002559                                                                                                                      002559
 002560         ERRCheck = *Off;                                                                         01                  002560
 002561      EndIf;                                                                                     E01                  002561
 002562                                                                                                                      002562
 002563      //-----------------------------------------------------------------------                                       002563
 002564      // Record not found check.                                                                                      002564
 002565      If NRFCheck;                                                                               B01                  002565
 002566         Clear nonPrefix;                                                                         01                  002566
 002567                                                                                                                      002567
 002568         codeLine = '*IN' + NRFInd + ' = not %found();';                                          01                  002568
 002569         Exsr subUserReformatLine;                                                                01                  002569
 002570                                                                                                                      002570
 002571         NRFCheck = *Off;                                                                         01                  002571
 002572      EndIf;                                                                                     E01                  002572
 002573                                                                                                                      002573
 002574      //-----------------------------------------------------------------------                                       002574
 002575      // End of File check.                                                                                           002575
 002576      If EOFCheck;                                                                               B01                  002576
 002577         Clear nonPrefix;                                                                         01                  002577
 002578                                                                                                                      002578
 002579         codeLine = '*IN' + EOFInd + ' = %eof();';                                                01                  002579
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     66
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002580         Exsr subUserReformatLine;                                                                01                  002580
 002581                                                                                                                      002581
 002582         EOFCheck = *Off;                                                                         01                  002582
 002583      EndIf;                                                                                     E01                  002583
 002584                                                                                                                      002584
 002585      //-----------------------------------------------------------------------                                       002585
 002586      // Matching Key check.                                                                                          002586
 002587      If equalCheck;                                                                             B01                  002587
 002588         Clear nonPrefix;                                                                         01                  002588
 002589                                                                                                                      002589
 002590         codeLine = '*IN' + equalInd + ' = %equal();';                                            01                  002590
 002591         Exsr subUserReformatLine;                                                                01                  002591
 002592                                                                                                                      002592
 002593         equalCheck = *Off;                                                                       01                  002593
 002594      EndIf;                                                                                     E01                  002594
 002595                                                                                                                      002595
 002596      //-----------------------------------------------------------------------                                       002596
 002597      // Perform SETOFF / SETON Expansion.                                                                            002597
 002598      If setOff;                                                                                 B01                  002598
 002599         Clear nonPrefix;                                                                         01                  002599
 002600         If setOffInd1 <> *Blanks;                                                               B02                  002600
 002601            codeLine = '*IN' + setOffInd1 + ' = *Off;';                                           02                  002601
 002602            Exsr subUserReformatLine;                                                             02                  002602
 002603         EndIf;                                                                                  E02                  002603
 002604         If setOffInd2 <> *Blanks;                                                               B02                  002604
 002605            codeLine = '*IN' + setOffInd2 + ' = *Off;';                                           02                  002605
 002606            Exsr subUserReformatLine;                                                             02                  002606
 002607         EndIf;                                                                                  E02                  002607
 002608         If setOffInd3 <> *Blanks;                                                               B02                  002608
 002609            codeLine = '*IN' + setOffInd3 + ' = *Off;';                                           02                  002609
 002610            Exsr subUserReformatLine;                                                             02                  002610
 002611         EndIf;                                                                                  E02                  002611
 002612         setOff = *Off;                                                                           01                  002612
 002613      EndIf;                                                                                     E01                  002613
 002614      If setOn;                                                                                  B01                  002614
 002615         Clear nonPrefix;                                                                         01                  002615
 002616         If setOnInd1 <> *Blanks;                                                                B02                  002616
 002617            codeLine = '*IN' + setOnInd1 + ' = *On;';                                             02                  002617
 002618            Exsr subUserReformatLine;                                                             02                  002618
 002619         EndIf;                                                                                  E02                  002619
 002620         If setOnInd2 <> *Blanks;                                                                B02                  002620
 002621            codeLine = '*IN' + setOnInd2 + ' = *On;';                                             02                  002621
 002622            Exsr subUserReformatLine;                                                             02                  002622
 002623         EndIf;                                                                                  E02                  002623
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     67
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002624         If setOnInd3 <> *Blanks;                                                                B02                  002624
 002625            codeLine = '*IN' + setOnInd3 + ' = *On;';                                             02                  002625
 002626            Exsr subUserReformatLine;                                                             02                  002626
 002627         EndIf;                                                                                  E02                  002627
 002628         setOn = *Off;                                                                            01                  002628
 002629      EndIf;                                                                                     E01                  002629
 002630                                                                                                                      002630
 002631      //-----------------------------------------------------------------------                                       002631
 002632      // Resulting indicators...                                                                                      002632
 002633                                                                                                                      002633
 002634      // Turn off all specified indicators first.                                                                     002634
 002635      If HICheck;                                                                                B01                  002635
 002636         Clear nonPrefix;                                                                         01                  002636
 002637         codeLine = '*IN' + HIInd + ' = *Off;';                                                   01                  002637
 002638         Exsr subUserReformatLine;                                                                01                  002638
 002639      EndIf;                                                                                     E01                  002639
 002640      If LWCheck;                                                                                B01                  002640
 002641         Clear nonPrefix;                                                                         01                  002641
 002642         codeLine = '*IN' + LWInd + ' = *Off;';                                                   01                  002642
 002643         Exsr subUserReformatLine;                                                                01                  002643
 002644      EndIf;                                                                                     E01                  002644
 002645      If EQCheck;                                                                                B01                  002645
 002646         Clear nonPrefix;                                                                         01                  002646
 002647         codeLine = '*IN' + EQInd + ' = *Off;';                                                   01                  002647
 002648         Exsr subUserReformatLine;                                                                01                  002648
 002649      EndIf;                                                                                     E01                  002649
 002650                                                                                                                      002650
 002651      // And now turn on those specified accordingly.                                                                 002651
 002652                                                                                                                      002652
 002653      // HI check.                                                                                                    002653
 002654      If HICheck;                                                                                B01                  002654
 002655         Clear nonPrefix;                                                                         01                  002655
 002656                                                                                                                      002656
 002657         codeLine = 'If ' + %trim(HIFactor1) + ' > '                                              01                  002657
 002658                  + %trim(HIFactor2) + ';';                                                       01                  002658
 002659         Exsr subUserReformatLine;                                                                01                  002659
 002660         codeLine = '*IN' + HIInd + ' = *On;';                                                    01                  002660
 002661         Exsr subUserReformatLine;                                                                01                  002661
 002662         codeLine = 'EndIf;';                                                                     01                  002662
 002663         Exsr subUserReformatLine;                                                                01                  002663
 002664                                                                                                                      002664
 002665         HICheck = *Off;                                                                          01                  002665
 002666      EndIf;                                                                                     E01                  002666
 002667                                                                                                                      002667
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     68
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002668      // LO check.                                                                                                    002668
 002669      If LWCheck;                                                                                B01                  002669
 002670         Clear nonPrefix;                                                                         01                  002670
 002671                                                                                                                      002671
 002672         codeLine = 'If ' + %trim(LWFactor1) + ' < '                                              01                  002672
 002673                  + %trim(LWFactor2) + ';';                                                       01                  002673
 002674         Exsr subUserReformatLine;                                                                01                  002674
 002675         codeLine = '*IN' + LWInd + ' = *On;';                                                    01                  002675
 002676         Exsr subUserReformatLine;                                                                01                  002676
 002677         codeLine = 'EndIf;';                                                                     01                  002677
 002678         Exsr subUserReformatLine;                                                                01                  002678
 002679                                                                                                                      002679
 002680         LWCheck = *Off;                                                                          01                  002680
 002681      EndIf;                                                                                     E01                  002681
 002682                                                                                                                      002682
 002683      // EQ check.                                                                                                    002683
 002684      If EQCheck;                                                                                B01                  002684
 002685         Clear nonPrefix;                                                                         01                  002685
 002686                                                                                                                      002686
 002687         codeLine = 'If ' + %trim(EQFactor1) + ' = '                                              01                  002687
 002688                  + %trim(EQFactor2) + ';';                                                       01                  002688
 002689         Exsr subUserReformatLine;                                                                01                  002689
 002690         codeLine = '*IN' + EQInd + ' = *On;';                                                    01                  002690
 002691         Exsr subUserReformatLine;                                                                01                  002691
 002692         codeLine = 'EndIf;';                                                                     01                  002692
 002693         Exsr subUserReformatLine;                                                                01                  002693
 002694                                                                                                                      002694
 002695         EQCheck = *Off;                                                                          01                  002695
 002696      EndIf;                                                                                     E01                  002696
 002697                                                                                                                      002697
 002698   EndSr;                                                                                                             002698
 002699   //-------------------------------------------------------------------------------------------                      002699
 002700                                                                                                                      002700
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     69
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002702   //-------------------------------------------------------------------------------------------                      002702
 002703   // Convert ACQ.                                                                                                    002703
 002704   //-------------------------------------------------------------------------------------------                      002704
 002705   BegSr subUserCvt_ACQ;                                                                                              002705
 002706                                                                                                                      002706
 002707      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             002707
 002708                 + ' ' + %trim(factor2) + ';';                                                                        002708
 002709                                                                                                                      002709
 002710      // Set resulting indicators?                                                                                    002710
 002711      If lw <> *Blanks;                                                                          B01                  002711
 002712         ERRCheck = *On;                                                                          01                  002712
 002713         ERRInd = lw;                                                                             01                  002713
 002714      EndIf;                                                                                     E01                  002714
 002715                                                                                                                      002715
 002716      convert = *On;                                                                                                  002716
 002717                                                                                                                      002717
 002718   EndSr;                                                                                                             002718
 002719   //-------------------------------------------------------------------------------------------                      002719
 002720                                                                                                                      002720
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     70
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002722   //-------------------------------------------------------------------------------------------                      002722
 002723   // Convert ADD.                                                                                                    002723
 002724   //-------------------------------------------------------------------------------------------                      002724
 002725   BegSr subUserCvt_ADD;                                                                                              002725
 002726                                                                                                                      002726
 002727      // Half-adjust?                                                                                                 002727
 002728      x = %scan('H':operator:4);                                                                                      002728
 002729      If x > 0;                                                                                  B01                  002729
 002730         sourceLine = 'Eval(H)';                                                                  01                  002730
 002731      Else;                                                                                      X01                  002731
 002732         sourceLine = *Blanks;                                                                    01                  002732
 002733      EndIf;                                                                                     E01                  002733
 002734                                                                                                                      002734
 002735      If factor1 = *Blanks;                                                                      B01                  002735
 002736         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002736
 002737                    + ' = ' + %trim(result)                                                       01                  002737
 002738                    + ' + ' + %trim(factor2) +';';                                                01                  002738
 002739      Else;                                                                                      X01                  002739
 002740         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002740
 002741                    + ' = ' + %trim(factor1)                                                      01                  002741
 002742                    + ' + ' + %trim(factor2) + ';';                                               01                  002742
 002743      EndIf;                                                                                     E01                  002743
 002744                                                                                                                      002744
 002745      sourceLine = %trim(sourceLine);                                                                                 002745
 002746                                                                                                                      002746
 002747      convert = *On;                                                                                                  002747
 002748                                                                                                                      002748
 002749   EndSr;                                                                                                             002749
 002750   //-------------------------------------------------------------------------------------------                      002750
 002751                                                                                                                      002751
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     71
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002753   //-------------------------------------------------------------------------------------------                      002753
 002754   // Convert ADDDUR.                                                                                                 002754
 002755   //-------------------------------------------------------------------------------------------                      002755
 002756   BegSr subUserCvt_ADDDUR;                                                                                           002756
 002757                                                                                                                      002757
 002758      // Split out duration and code.                                                                                 002758
 002759      x = %scan(':':factor2);                                                                                         002759
 002760      If x = 0;                                                                                  B01                  002760
 002761         nonConvRsn =  'No duration code specified.';                                             01                  002761
 002762         LeaveSr;                                                                                 01                  002762
 002763      EndIf;                                                                                     E01                  002763
 002764                                                                                                                      002764
 002765      durDuration = %trim(%subst(factor2:1:x-1));                                                                     002765
 002766      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         002766
 002767                                                                                                                      002767
 002768      Select;                                                                                    B01                  002768
 002769         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  002769
 002770            durCode = '%years';                                                                   01                  002770
 002771         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  002771
 002772            durCode = '%months';                                                                  01                  002772
 002773         When durCode = '*D' or durCode = '*DAYS';                                               X01                  002773
 002774            durCode = '%days';                                                                    01                  002774
 002775         When durCode = '*H' or durCode = '*HOURS';                                              X01                  002775
 002776            durCode = '%hours';                                                                   01                  002776
 002777         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  002777
 002778            durCode = '%minutes';                                                                 01                  002778
 002779         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  002779
 002780            durCode = '%seconds';                                                                 01                  002780
 002781         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  002781
 002782            durCode = '%mseconds';                                                                01                  002782
 002783         Other;                                                                                  X01                  002783
 002784            nonConvRsn = 'Invalid duration code specified.';                                      01                  002784
 002785            LeaveSr;                                                                              01                  002785
 002786      EndSl;                                                                                     E01                  002786
 002787                                                                                                                      002787
 002788      If factor1 = *Blanks;                                                                      B01                  002788
 002789         sourceLine = %trim(result) + ' = ' + %trim(result);                                      01                  002789
 002790      Else;                                                                                      X01                  002790
 002791         sourceLine = %trim(result) + ' = ' + %trim(factor1);                                     01                  002791
 002792      EndIf;                                                                                     E01                  002792
 002793                                                                                                                      002793
 002794      sourceLine = %trimr(sourceLine) + ' + ' + %trim(durCode)                                                        002794
 002795                 + '(' + %trim(durDuration) + ');';                                                                   002795
 002796                                                                                                                      002796
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     72
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002797      // Set resulting indicators?                                                                                    002797
 002798      If lw <> *Blanks;                                                                          B01                  002798
 002799         ERRCheck = *On;                                                                          01                  002799
 002800         ERRInd = lw;                                                                             01                  002800
 002801      EndIf;                                                                                     E01                  002801
 002802                                                                                                                      002802
 002803      convert = *On;                                                                                                  002803
 002804                                                                                                                      002804
 002805   EndSr;                                                                                                             002805
 002806   //-------------------------------------------------------------------------------------------                      002806
 002807                                                                                                                      002807
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     73
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002809   //-------------------------------------------------------------------------------------------                      002809
 002810   // Convert ALLOC.                                                                                                  002810
 002811   //-------------------------------------------------------------------------------------------                      002811
 002812   BegSr subUserCvt_ALLOC;                                                                                            002812
 002813                                                                                                                      002813
 002814      sourceLine = %trim(result) + ' = %alloc(' + %trim(factor2) + ');';                                              002814
 002815                                                                                                                      002815
 002816      // Set resulting indicators?                                                                                    002816
 002817      If lw <> *Blanks;                                                                          B01                  002817
 002818         ERRCheck = *On;                                                                          01                  002818
 002819         ERRInd = lw;                                                                             01                  002819
 002820      EndIf;                                                                                     E01                  002820
 002821                                                                                                                      002821
 002822      convert = *On;                                                                                                  002822
 002823                                                                                                                      002823
 002824   EndSr;                                                                                                             002824
 002825   //-------------------------------------------------------------------------------------------                      002825
 002826                                                                                                                      002826
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     74
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002828   //-------------------------------------------------------------------------------------------                      002828
 002829   // Convert BEGSR.                                                                                                  002829
 002830   //-------------------------------------------------------------------------------------------                      002830
 002831   BegSr subUserCvt_BEGSR;                                                                                            002831
 002832                                                                                                                      002832
 002833      sourceLine = 'BegSr ' + %trim(factor1) + ';';                                                                   002833
 002834                                                                                                                      002834
 002835      convert = *On;                                                                                                  002835
 002836                                                                                                                      002836
 002837   EndSr;                                                                                                             002837
 002838   //-------------------------------------------------------------------------------------------                      002838
 002839                                                                                                                      002839
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     75
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002841   //-------------------------------------------------------------------------------------------                      002841
 002842   // Convert CALLP.                                                                                                  002842
 002843   //-------------------------------------------------------------------------------------------                      002843
 002844   BegSr subUserCvt_CALLP;                                                                                            002844
 002845                                                                                                                      002845
 002846      // Returning for a multi-line CALLP - restore the original opcode.                                              002846
 002847      If inCallP;                                                                                B01                  002847
 002848         operator = callPOperator;                                                                01                  002848
 002849      EndIf;                                                                                     E01                  002849
 002850                                                                                                                      002850
 002851      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002851
 002852                                                                                                                      002852
 002853      If not inCallP;         // First line of CALLP.                                            B01                  002853
 002854         sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                                 01                  002854
 002855         If not inSpan;                                                                          B02                  002855
 002856            sourceLine = %trim(sourceLine) + ';';                                                 02                  002856
 002857         Else;                                                                                   X02                  002857
 002858            callPOffset = %len(%trim(operator)) + 2;                                              02                  002858
 002859            inCallP = *On;                                                                        02                  002859
 002860            inSpan = *Off;                                                                        02                  002860
 002861         EndIf;                                                                                  E02                  002861
 002862      Else;                   // Second+ line of CALLP.                                          X01                  002862
 002863         sourceLine = *Blanks;                                                                    01                  002863
 002864         sourceLine = %trim(extFactor2);                                                          01                  002864
 002865         If not inSpan;                                                                          B02                  002865
 002866            sourceLine = %trimr(sourceLine) + ';';                                                02                  002866
 002867            //            inCallP = *Off;                                                                             002867
 002868         EndIf;                                                                                  E02                  002868
 002869         inSpan = *Off;                                                                           01                  002869
 002870      EndIf;                                                                                     E01                  002870
 002871                                                                                                                      002871
 002872      // Multi-line CALLP?  Save the opcode.                                                                          002872
 002873      If inCallP;                                                                                B01                  002873
 002874         callPOperator = operator;                                                                01                  002874
 002875      Else;                                                                                      X01                  002875
 002876         callPOperator = *Blanks;                                                                 01                  002876
 002877      EndIf;                                                                                     E01                  002877
 002878                                                                                                                      002878
 002879      convert = *On;                                                                                                  002879
 002880                                                                                                                      002880
 002881   EndSr;                                                                                                             002881
 002882   //-------------------------------------------------------------------------------------------                      002882
 002883                                                                                                                      002883
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     76
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002885   //-------------------------------------------------------------------------------------------                      002885
 002886   // Convert CASxx.                                                                                                  002886
 002887   //-------------------------------------------------------------------------------------------                      002887
 002888   BegSr subUserCvt_CASxx;                                                                                            002888
 002889                                                                                                                      002889
 002890      // Extract components.                                                                                          002890
 002891      caseSubRoutine = %trim(result);                                                                                 002891
 002892      caseOperator = %subst(operator:4:2);                                                                            002892
 002893                                                                                                                      002893
 002894      // Determine comparator.                                                                                        002894
 002895      If caseOperator = 'EQ';                                                                    B01                  002895
 002896         caseOperator = '=';                                                                      01                  002896
 002897      ElseIf caseOperator = 'GT';                                                                X01                  002897
 002898         caseOperator = '>';                                                                      01                  002898
 002899      ElseIf caseOperator = 'LT';                                                                X01                  002899
 002900         caseOperator = '<';                                                                      01                  002900
 002901      ElseIf caseOperator = 'GE';                                                                X01                  002901
 002902         caseOperator = '>=';                                                                     01                  002902
 002903      ElseIf caseOperator = 'LE';                                                                X01                  002903
 002904         caseOperator = '<=';                                                                     01                  002904
 002905      ElseIf caseOperator = 'NE';                                                                X01                  002905
 002906         caseOperator = '<>';                                                                     01                  002906
 002907      Else;                                                                                      X01                  002907
 002908         caseOperator = 'Else';                                                                   01                  002908
 002909      EndIf;                                                                                     E01                  002909
 002910                                                                                                                      002910
 002911      // Build 'If' statement.                                                                                        002911
 002912      If not inCase;                                                                             B01                  002912
 002913         sourceLine = 'If ' +  %trim(factor1) + ' '                                               01                  002913
 002914                    + %trim(caseOperator) + ' ' + %trim(factor2)                                  01                  002914
 002915                    + ';';                                                                        01                  002915
 002916         inCase = *On;                                                                            01                  002916
 002917      Else;                                                                                      X01                  002917
 002918         If caseOperator = 'Else';                                                               B02                  002918
 002919            sourceLine = 'Else;';                                                                 02                  002919
 002920         Else;                                                                                   X02                  002920
 002921            sourceLine = 'ElseIf ' +  %trim(factor1) + ' '                                        02                  002921
 002922                       + %trim(caseOperator) + ' ' + %trim(factor2)                               02                  002922
 002923                       + ';';                                                                     02                  002923
 002924         EndIf;                                                                                  E02                  002924
 002925      EndIf;                                                                                     E01                  002925
 002926                                                                                                                      002926
 002927      // Do we need to set Resulting indicators?                                                                      002927
 002928      If hi <> *Blanks;                                                                          B01                  002928
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     77
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002929         HICheck = *On;                                                                           01                  002929
 002930         HIInd = hi;                                                                              01                  002930
 002931         HIFactor1 = %trim(factor1);                                                              01                  002931
 002932         HIFactor2 = %trim(factor2);                                                              01                  002932
 002933      EndIf;                                                                                     E01                  002933
 002934      If lw <> *Blanks;                                                                          B01                  002934
 002935         LWCheck = *On;                                                                           01                  002935
 002936         LWInd = lw;                                                                              01                  002936
 002937         LWFactor1 = %trim(factor1);                                                              01                  002937
 002938         LWFactor2 = %trim(factor2);                                                              01                  002938
 002939      EndIf;                                                                                     E01                  002939
 002940      If eq <> *Blanks;                                                                          B01                  002940
 002941         EQCheck = *On;                                                                           01                  002941
 002942         EQInd = eq;                                                                              01                  002942
 002943         EQFactor1 = %trim(factor1);                                                              01                  002943
 002944         EQFactor2 = %trim(factor2);                                                              01                  002944
 002945      EndIf;                                                                                     E01                  002945
 002946                                                                                                                      002946
 002947      convert = *On;                                                                                                  002947
 002948                                                                                                                      002948
 002949   EndSr;                                                                                                             002949
 002950   //-------------------------------------------------------------------------------------------                      002950
 002951                                                                                                                      002951
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     78
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002953   //-------------------------------------------------------------------------------------------                      002953
 002954   // Convert CAT.                                                                                                    002954
 002955   //-------------------------------------------------------------------------------------------                      002955
 002956   BegSr subUserCvt_CAT;                                                                                              002956
 002957                                                                                                                      002957
 002958      // Pad the result?                                                                                              002958
 002959      x = %scan('P':operator:4);                                                                                      002959
 002960      If x = 0                                              // Not padding.                      B01                  002960
 002961      and factor1 <> *Blanks                                // Factor1 specified.                B01                  002961
 002962      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  002962
 002963         nonConvRsn =  'No padding specified, result unpredictable.';                             01                  002963
 002964         LeaveSr;    // Don't convert - too difficult to get right.                               01                  002964
 002965      EndIf;                                                                                     E01                  002965
 002966                                                                                                                      002966
 002967      // Drop the extender.                                                                                           002967
 002968      operator = 'CAT';                                                                                               002968
 002969                                                                                                                      002969
 002970      // Determine first part of string.                                                                              002970
 002971      If factor1 = *Blanks;                                                                      B01                  002971
 002972         catFactor1 = %trim(result);                                                              01                  002972
 002973      Else;                                                                                      X01                  002973
 002974         catFactor1 = %trim(factor1);                                                             01                  002974
 002975      EndIf;                                                                                     E01                  002975
 002976                                                                                                                      002976
 002977      // Determine number of blanks.                                                                                  002977
 002978      x = %scan(':':factor2);                                                                                         002978
 002979      If x = 0;   // No trimming required;                                                       B01                  002979
 002980         catBlanks = *Blanks;                                                                     01                  002980
 002981         catFactor2 = %trim(factor2);                                                             01                  002981
 002982      Else;                                                                                      X01                  002982
 002983         catBlanks = %subst(factor2:x+1);                                                         01                  002983
 002984         catFactor2 = %subst(factor2:1:x-1);                                                      01                  002984
 002985      EndIf;                                                                                     E01                  002985
 002986                                                                                                                      002986
 002987      // Determine second part of String.                                                                             002987
 002988                                                                                                                      002988
 002989      // Blanks zero?                                                                                                 002989
 002990      If catBlanks <> *blanks;                                                                   B01                  002990
 002991         Monitor;                                                                                B02                  002991
 002992            catCount = %dec(catBlanks:3:0);                                                       02                  002992
 002993         On-Error;                                                                               X02                  002993
 002994            LeaveSr; // Uses a field to vary the number of blanks - don't convert.                02                  002994
 002995         EndMon;                                                                                 E02                  002995
 002996      EndIf;                                                                                     E01                  002996
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     79
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002997                                                                                                                      002997
 002998      // Build the new line.                                                                                          002998
 002999      If catBlanks = *Blanks;                                                                    B01                  002999
 003000         // No trimming.                                                                                              003000
 003001         sourceLine = %trim(result) + ' = ' + %trim(catFactor1)                                   01                  003001
 003002                    + ' + ' + %trim(catFactor2) + ';';                                            01                  003002
 003003      ElseIf catCount = 0;                                                                       X01                  003003
 003004         // No spaces.                                                                                                003004
 003005         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003005
 003006                    + ') + %trim(' + %trim(catFactor2) + ');';                                    01                  003006
 003007      ElseIf catCount > 25;                                                                      X01                  003007
 003008         LeaveSr; // Arbitrary upper limit - don't convert.                                       01                  003008
 003009      Else;                                                                                      X01                  003009
 003010         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003010
 003011                    + ') + ''' + %str(%addr(blanks):catCount)                                     01                  003011
 003012                    + ''' + %trim(' + %trim(catFactor2) + ');';                                   01                  003012
 003013      EndIf;                                                                                     E01                  003013
 003014                                                                                                                      003014
 003015      // Set resulting indicators?                                                                                    003015
 003016      If lw <> *Blanks;                                                                          B01                  003016
 003017         ERRCheck = *On;                                                                          01                  003017
 003018         ERRInd = lw;                                                                             01                  003018
 003019      EndIf;                                                                                     E01                  003019
 003020                                                                                                                      003020
 003021      convert = *On;                                                                                                  003021
 003022                                                                                                                      003022
 003023   EndSr;                                                                                                             003023
 003024   //-------------------------------------------------------------------------------------------                      003024
 003025                                                                                                                      003025
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     80
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003027   //-------------------------------------------------------------------------------------------                      003027
 003028   // Convert CHAIN.                                                                                                  003028
 003029   //-------------------------------------------------------------------------------------------                      003029
 003030   BegSr subUserCvt_CHAIN;                                                                                            003030
 003031                                                                                                                      003031
 003032      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       003032
 003033                 + %trim(factor2);                                                                                    003033
 003034                                                                                                                      003034
 003035      If result <> *Blanks;                                                                      B01                  003035
 003036         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003036
 003037      Else;                                                                                      X01                  003037
 003038         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003038
 003039      EndIf;                                                                                     E01                  003039
 003040                                                                                                                      003040
 003041      // Set resulting indicators?                                                                                    003041
 003042      If hi <> *Blanks;                                                                          B01                  003042
 003043         NRFCheck = *On;                                                                          01                  003043
 003044         NRFInd = hi;                                                                             01                  003044
 003045         NRFFile = %trim(factor2);                                                                01                  003045
 003046      EndIf;                                                                                     E01                  003046
 003047      If lw <> *Blanks;                                                                          B01                  003047
 003048         ERRCheck = *On;                                                                          01                  003048
 003049         ERRInd = lw;                                                                             01                  003049
 003050      EndIf;                                                                                     E01                  003050
 003051                                                                                                                      003051
 003052      convert = *On;                                                                                                  003052
 003053                                                                                                                      003053
 003054   EndSr;                                                                                                             003054
 003055   //-------------------------------------------------------------------------------------------                      003055
 003056                                                                                                                      003056
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     81
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003058   //-------------------------------------------------------------------------------------------                      003058
 003059   // Convert CHECK.                                                                                                  003059
 003060   //-------------------------------------------------------------------------------------------                      003060
 003061   BegSr subUserCvt_CHECKx;                                                                                           003061
 003062                                                                                                                      003062
 003063      // Don't convert of no result specified.                                                                        003063
 003064      If result = *Blanks;                                                                       B01                  003064
 003065         nonConvRsn = 'No result field specified.';                                               01                  003065
 003066         LeaveSr;                                                                                 01                  003066
 003067      EndIf;                                                                                     E01                  003067
 003068                                                                                                                      003068
 003069      If %subst(operator:1:5) = 'CHECKR';                                                        B01                  003069
 003070         operator = '%checkr(';                                                                   01                  003070
 003071      Else;                                                                                      X01                  003071
 003072         operator = '%check(';                                                                    01                  003072
 003073      EndIf;                                                                                     E01                  003073
 003074                                                                                                                      003074
 003075      // Determine starting point.                                                                                    003075
 003076      x = %scan(':':factor2);                                                                                         003076
 003077                                                                                                                      003077
 003078      // Build the new line.                                                                                          003078
 003079      If x = 0;                                                                                  B01                  003079
 003080         // No start specified.                                                                                       003080
 003081         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003081
 003082                    + %trim(factor1) + ':' + %trim(factor2) + ');';                               01                  003082
 003083      Else;                                                                                      X01                  003083
 003084         // Start from a specified point.                                                                             003084
 003085         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003085
 003086                    + %trim(factor1) + ':' + %subst(factor2:1:x-1)                                01                  003086
 003087                    + ':' + %trim(%subst(factor2:x+1))                                            01                  003087
 003088                    + ');';                                                                       01                  003088
 003089      EndIf;                                                                                     E01                  003089
 003090                                                                                                                      003090
 003091      // Set resulting indicators?                                                                                    003091
 003092      If lw <> *Blanks;                                                                          B01                  003092
 003093         ERRCheck = *On;                                                                          01                  003093
 003094         ERRInd = lw;                                                                             01                  003094
 003095      EndIf;                                                                                     E01                  003095
 003096      If eq <> *Blanks;                                                                          B01                  003096
 003097         HICheck = *On;                                                                           01                  003097
 003098         HIInd = eq;                                                                              01                  003098
 003099         HIFactor1 = result;                                                                      01                  003099
 003100         HIFactor2 = '0';                                                                         01                  003100
 003101      EndIf;                                                                                     E01                  003101
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     82
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003102                                                                                                                      003102
 003103      convert = *On;                                                                                                  003103
 003104                                                                                                                      003104
 003105   EndSr;                                                                                                             003105
 003106   //-------------------------------------------------------------------------------------------                      003106
 003107                                                                                                                      003107
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     83
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003109   //-------------------------------------------------------------------------------------------                      003109
 003110   // Convert CLEAR.                                                                                                  003110
 003111   //-------------------------------------------------------------------------------------------                      003111
 003112   BegSr subUserCvt_CLEAR;                                                                                            003112
 003113                                                                                                                      003113
 003114      sourceLine = 'Clear ' + %trim(result) + ';';                                                                    003114
 003115                                                                                                                      003115
 003116      convert = *On;                                                                                                  003116
 003117                                                                                                                      003117
 003118   EndSr;                                                                                                             003118
 003119   //-------------------------------------------------------------------------------------------                      003119
 003120                                                                                                                      003120
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     84
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003122   //-------------------------------------------------------------------------------------------                      003122
 003123   // Convert CLOSE.                                                                                                  003123
 003124   //-------------------------------------------------------------------------------------------                      003124
 003125   BegSr subUserCvt_CLOSE;                                                                                            003125
 003126                                                                                                                      003126
 003127      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003127
 003128                                                                                                                      003128
 003129      If lw <> *Blanks;                                                                          B01                  003129
 003130         ERRCheck = *On;                                                                          01                  003130
 003131         ERRInd = lw;                                                                             01                  003131
 003132      EndIf;                                                                                     E01                  003132
 003133                                                                                                                      003133
 003134      convert = *On;                                                                                                  003134
 003135                                                                                                                      003135
 003136   EndSr;                                                                                                             003136
 003137   //-------------------------------------------------------------------------------------------                      003137
 003138                                                                                                                      003138
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     85
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003140   //-------------------------------------------------------------------------------------------                      003140
 003141   // Convert COMMIT.                                                                                                 003141
 003142   //-------------------------------------------------------------------------------------------                      003142
 003143   BegSr subUserCvt_COMMIT;                                                                                           003143
 003144                                                                                                                      003144
 003145      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            003145
 003146                                                                                                                      003146
 003147      sourceLine = %trim(sourceLine)  + ';';                                                                          003147
 003148                                                                                                                      003148
 003149      // Check indicators?                                                                                            003149
 003150      If lw <> *Blanks;                                                                          B01                  003150
 003151         ERRCheck = *On;                                                                          01                  003151
 003152         ERRInd = lw;                                                                             01                  003152
 003153      EndIf;                                                                                     E01                  003153
 003154                                                                                                                      003154
 003155      convert = *On;                                                                                                  003155
 003156                                                                                                                      003156
 003157   EndSr;                                                                                                             003157
 003158   //-------------------------------------------------------------------------------------------                      003158
 003159                                                                                                                      003159
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     86
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003161   //-------------------------------------------------------------------------------------------                      003161
 003162   // Convert COMP.                                                                                                   003162
 003163   //-------------------------------------------------------------------------------------------                      003163
 003164   BegSr subUserCvt_COMP;                                                                                             003164
 003165                                                                                                                      003165
 003166      // Set resulting indicators to check.                                                                           003166
 003167      If hi <> *Blanks;                                                                          B01                  003167
 003168         HICheck = *On;                                                                           01                  003168
 003169         HIInd = hi;                                                                              01                  003169
 003170         HIFactor1 = factor1;                                                                     01                  003170
 003171         HIFactor2 = factor2;                                                                     01                  003171
 003172      EndIf;                                                                                     E01                  003172
 003173                                                                                                                      003173
 003174      If lw <> *Blanks;                                                                          B01                  003174
 003175         LWCheck = *On;                                                                           01                  003175
 003176         LWInd = lw;                                                                              01                  003176
 003177         LWFactor1 = factor1;                                                                     01                  003177
 003178         LWFactor2 = factor2;                                                                     01                  003178
 003179      EndIf;                                                                                     E01                  003179
 003180                                                                                                                      003180
 003181      If eq <> *Blanks;                                                                          B01                  003181
 003182         EQCheck = *On;                                                                           01                  003182
 003183         EQInd = eq;                                                                              01                  003183
 003184         EQFactor1 = factor1;                                                                     01                  003184
 003185         EQFactor2 = factor2;                                                                     01                  003185
 003186      EndIf;                                                                                     E01                  003186
 003187                                                                                                                      003187
 003188      // Drop the current line.                                                                                       003188
 003189      dropLine = *On;                                                                                                 003189
 003190      convert = *On;                                                                                                  003190
 003191                                                                                                                      003191
 003192   EndSr;                                                                                                             003192
 003193   //-------------------------------------------------------------------------------------------                      003193
 003194                                                                                                                      003194
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     87
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003196   //-------------------------------------------------------------------------------------------                      003196
 003197   // Convert DEALLOC.                                                                                                003197
 003198   //-------------------------------------------------------------------------------------------                      003198
 003199   BegSr subUserCvt_DEALLOC;                                                                                          003199
 003200                                                                                                                      003200
 003201      sourceLine = %trim(operator) + ' ' + %trim(result);                                                             003201
 003202                                                                                                                      003202
 003203      sourceLine = %trim(sourceLine)  + ';';                                                                          003203
 003204                                                                                                                      003204
 003205      // Set resulting indicators?                                                                                    003205
 003206      If lw <> *Blanks;                                                                          B01                  003206
 003207         ERRCheck = *On;                                                                          01                  003207
 003208         ERRInd = lw;                                                                             01                  003208
 003209      EndIf;                                                                                     E01                  003209
 003210                                                                                                                      003210
 003211      convert = *On;                                                                                                  003211
 003212                                                                                                                      003212
 003213   EndSr;                                                                                                             003213
 003214   //-------------------------------------------------------------------------------------------                      003214
 003215                                                                                                                      003215
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     88
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003217   //-------------------------------------------------------------------------------------------                      003217
 003218   // Convert DELETE.                                                                                                 003218
 003219   //-------------------------------------------------------------------------------------------                      003219
 003220   BegSr subUserCvt_DELETE;                                                                                           003220
 003221                                                                                                                      003221
 003222      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003222
 003223                                                                                                                      003223
 003224      sourceLine = %trim(sourceLine)  + ';';                                                                          003224
 003225                                                                                                                      003225
 003226      // Check indicators?                                                                                            003226
 003227      If hi <> *Blanks;                                                                          B01                  003227
 003228         NRFCheck = *On;                                                                          01                  003228
 003229         NRFInd = eq;                                                                             01                  003229
 003230         NRFFile = %trim(factor2);                                                                01                  003230
 003231      EndIf;                                                                                     E01                  003231
 003232      If lw <> *Blanks;                                                                          B01                  003232
 003233         ERRCheck = *On;                                                                          01                  003233
 003234         ERRInd = lw;                                                                             01                  003234
 003235      EndIf;                                                                                     E01                  003235
 003236                                                                                                                      003236
 003237      convert = *On;                                                                                                  003237
 003238                                                                                                                      003238
 003239   EndSr;                                                                                                             003239
 003240   //-------------------------------------------------------------------------------------------                      003240
 003241                                                                                                                      003241
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     89
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003243   //-------------------------------------------------------------------------------------------                      003243
 003244   // Convert DIV.                                                                                                    003244
 003245   //-------------------------------------------------------------------------------------------                      003245
 003246   BegSr subUserCvt_DIV;                                                                                              003246
 003247                                                                                                                      003247
 003248      // Half-adjust?                                                                                                 003248
 003249      If %scan('H':operator:4) > 0;                                                              B01                  003249
 003250         sourceLine = 'Eval(H) ';                                                                 01                  003250
 003251      Else;                                                                                      X01                  003251
 003252         sourceLine = *Blanks;                                                                    01                  003252
 003253      EndIf;                                                                                     E01                  003253
 003254                                                                                                                      003254
 003255      If factor1 = *Blanks;                                                                      B01                  003255
 003256         divFactor1 = result;                                                                     01                  003256
 003257         divFactor2 = factor2;                                                                    01                  003257
 003258      Else;                                                                                      X01                  003258
 003259         divFactor1 = factor1;                                                                    01                  003259
 003260         divFactor2 = factor2;                                                                    01                  003260
 003261      EndIf;                                                                                     E01                  003261
 003262                                                                                                                      003262
 003263      sourceLine = %trim( %trimr(sourceLine) + ' ' + %trim(result)                                                    003263
 003264                 + ' = ' + %trim(divFactor1) + ' / '                                                                  003264
 003265                 + %trim(divFactor2) + ';');                                                                          003265
 003266                                                                                                                      003266
 003267      convert = *On;                                                                                                  003267
 003268                                                                                                                      003268
 003269   EndSr;                                                                                                             003269
 003270   //-------------------------------------------------------------------------------------------                      003270
 003271                                                                                                                      003271
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     90
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003273   //-------------------------------------------------------------------------------------------                      003273
 003274   // Convert DO.                                                                                                     003274
 003275   //-------------------------------------------------------------------------------------------                      003275
 003276   BegSr subUserCvt_DO;                                                                                               003276
 003277                                                                                                                      003277
 003278      If inDo;                                                                                   B01                  003278
 003279         operator = doOperator;                                                                   01                  003279
 003280      EndIf;                                                                                     E01                  003280
 003281                                                                                                                      003281
 003282      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003282
 003283                                                                                                                      003283
 003284      If operator = 'DOW'     // Use Extended Factor2.                                           B01                  003284
 003285      or operator = 'DOU';    // Use Extended Factor2.                                           B01                  003285
 003286         If not inDo;         // First line of DO.                                               B02                  003286
 003287            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003287
 003288            If not inSpan;                                                                       B03                  003288
 003289               sourceLine = %trim(sourceLine) + ';';                                              03                  003289
 003290            Else;                                                                                X03                  003290
 003291               inDo = *On;                                                                        03                  003291
 003292               inSpan = *Off;                                                                     03                  003292
 003293            EndIf;                                                                               E03                  003293
 003294         Else;                   // Second line of DO.                                           X02                  003294
 003295            sourceLine = *Blanks;                                                                 02                  003295
 003296            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003296
 003297            sourceLine = %trim(extFactor2);                                                       02                  003297
 003298            If not inSpan;                                                                       B03                  003298
 003299               sourceLine = %trimr(sourceLine) + ';';                                             03                  003299
 003300               //               inDo = *Off;                                                                          003300
 003301            EndIf;                                                                               E03                  003301
 003302            inSpan = *Off;                                                                        02                  003302
 003303         EndIf;                                                                                  E02                  003303
 003304         doCompare = '!!';    // Just a regular DO.                                               01                  003304
 003305      Else;                                                                                      X01                  003305
 003306         // Fixed format.                                                                                             003306
 003307         opCode = %xlate(lo:up:opCode);                                                           01                  003307
 003308         If not inDo;         // First line of DO.                                               B02                  003308
 003309            doCompare = %subst(opCode:4:2);                                                       02                  003309
 003310            sourceLine = %subst(opcode:1:3);                                                      02                  003310
 003311         Else;                // Second line of DO.                                              X02                  003311
 003312            If %subst(opCode:1:3) = 'AND';                                                       B03                  003312
 003313               doCompare = %subst(opCode:4:2);                                                    03                  003313
 003314               sourceLine = 'And';                                                                03                  003314
 003315            Else;                                                                                X03                  003315
 003316               doCompare = %subst(opCode:3:2);                                                    03                  003316
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     91
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003317               sourceLine = 'Or';                                                                 03                  003317
 003318            EndIf;                                                                               E03                  003318
 003319         EndIf;                                                                                  E02                  003319
 003320                                                                                                                      003320
 003321         If doCompare = 'EQ';                                                                    B02                  003321
 003322            doCompare = '=';                                                                      02                  003322
 003323         ElseIf doCompare = 'GT';                                                                X02                  003323
 003324            doCompare = '>';                                                                      02                  003324
 003325         ElseIf doCompare = 'GE';                                                                X02                  003325
 003326            doCompare = '>=';                                                                     02                  003326
 003327         ElseIf doCompare = 'LT';                                                                X02                  003327
 003328            doCompare = '<';                                                                      02                  003328
 003329         ElseIf doCompare = 'LE';                                                                X02                  003329
 003330            doCompare = '<=';                                                                     02                  003330
 003331         ElseIf doCompare = 'NE';                                                                X02                  003331
 003332            doCompare = '<>';                                                                     02                  003332
 003333         ElseIf doCompare = '!!';                                                                X02                  003333
 003334            // Do nothing.                                                                                            003334
 003335            Else;    // Just DO - convert to FOR.                                                X02                  003335
 003336            If factor1 = *Blanks;                                                                B03                  003336
 003337               forFactor1 = '1';                                                                  03                  003337
 003338            Else;                                                                                X03                  003338
 003339               forFactor1 = factor1;                                                              03                  003339
 003340            EndIf;                                                                               E03                  003340
 003341            forFactor2 = factor2;                                                                 02                  003341
 003342            factor1 = *Blanks;                                                                    02                  003342
 003343            factor2 = *Blanks;                                                                    02                  003343
 003344            doCompare = *Blanks;                                                                  02                  003344
 003345            If result = *Blanks;                                                                 B03                  003345
 003346               result = '???';                                                                    03                  003346
 003347            EndIf;                                                                               E03                  003347
 003348            sourceLine = 'For ' + %trim(result) + ' = '                                           02                  003348
 003349                       + %trim(forFactor1) + ' To '                                               02                  003349
 003350                       + %trim(forFactor2);                                                       02                  003350
 003351         EndIf;                                                                                  E02                  003351
 003352                                                                                                                      003352
 003353         //         If doCompare = *Blanks;                                                                           003353
 003354     //            // Save current indentation level to match up to the associated ENDDO later.                       003354
 003355         //            forCount += 1;                                                                                 003355
 003356         //            forLevel(forCount) = indentCount;                                                              003356
 003357         //         Else;                                                                                             003357
 003358     //            // Save current indentation level to match up to the associated ENDDO later.                       003358
 003359         //            doCount += 1;                                                                                  003359
 003360         //            doLevel(doCount) = indentCount;                                                                003360
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     92
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003361         //         EndIf;                                                                                            003361
 003362                                                                                                                      003362
 003363         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003363
 003364                            + ' ' + %trim(doCompare) + ' '                                        01                  003364
 003365                            + %trim(factor2);                                                     01                  003365
 003366         If not inSpan;                                                                          B02                  003366
 003367            sourceLine = %trimr(sourceLine) + ';';                                                02                  003367
 003368            inDo = *Off;                                                                          02                  003368
 003369         Else;                                                                                   X02                  003369
 003370            inDo = *On;                                                                           02                  003370
 003371            inSpan = *Off;                                                                        02                  003371
 003372         EndIf;                                                                                  E02                  003372
 003373      EndIf;                                                                                     E01                  003373
 003374                                                                                                                      003374
 003375      // If multi-line, retain the original opcode.                                                                   003375
 003376      If inDo;                                                                                   B01                  003376
 003377         doOperator = operator;                                                                   01                  003377
 003378      Else;                                                                                      X01                  003378
 003379         doOperator = *Blanks;                                                                    01                  003379
 003380      EndIf;                                                                                     E01                  003380
 003381                                                                                                                      003381
 003382      convert = *On;                                                                                                  003382
 003383                                                                                                                      003383
 003384   EndSr;                                                                                                             003384
 003385   //-------------------------------------------------------------------------------------------                      003385
 003386                                                                                                                      003386
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     93
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003388   //-------------------------------------------------------------------------------------------                      003388
 003389   // Convert DSPLY.                                                                                                  003389
 003390   //-------------------------------------------------------------------------------------------                      003390
 003391   BegSr subUserCvt_DSPLY;                                                                                            003391
 003392                                                                                                                      003392
 003393      sourceLine = %trim(operator);                                                                                   003393
 003394                                                                                                                      003394
 003395      If factor1 <> *Blanks;                                                                     B01                  003395
 003396         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  003396
 003397         If factor2 <> *Blanks;                                                                  B02                  003397
 003398            sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                               02                  003398
 003399         ElseIf result <> *Blanks;                                                               X02                  003399
 003400            sourceLine = %trimr(sourceLine) + ' ''''';                                            02                  003400
 003401         EndIf;                                                                                  E02                  003401
 003402         If result <> *Blanks;                                                                   B02                  003402
 003403            sourceLine = %trimr(sourceLine) + ' ' + %trim(result);                                02                  003403
 003404         EndIf;                                                                                  E02                  003404
 003405      EndIf;                                                                                     E01                  003405
 003406                                                                                                                      003406
 003407      sourceLine = %trimr(sourceLine) + ';';                                                                          003407
 003408                                                                                                                      003408
 003409      // Set resulting indicators?                                                                                    003409
 003410      If lw <> *Blanks;                                                                          B01                  003410
 003411         ERRCheck = *On;                                                                          01                  003411
 003412         ERRInd = lw;                                                                             01                  003412
 003413      EndIf;                                                                                     E01                  003413
 003414                                                                                                                      003414
 003415      convert = *On;                                                                                                  003415
 003416                                                                                                                      003416
 003417   EndSr;                                                                                                             003417
 003418   //-------------------------------------------------------------------------------------------                      003418
 003419                                                                                                                      003419
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     94
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003421   //-------------------------------------------------------------------------------------------                      003421
 003422   // Convert DUMP.                                                                                                   003422
 003423   //-------------------------------------------------------------------------------------------                      003423
 003424   BegSr subUserCvt_DUMP;                                                                                             003424
 003425                                                                                                                      003425
 003426      If factor1 <> *Blanks;                                                                     B01                  003426
 003427         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ';';                               01                  003427
 003428      Else;                                                                                      X01                  003428
 003429         sourceLine = %trim(operator) + ';';                                                      01                  003429
 003430      EndIf;                                                                                     E01                  003430
 003431                                                                                                                      003431
 003432      convert = *On;                                                                                                  003432
 003433                                                                                                                      003433
 003434   EndSr;                                                                                                             003434
 003435   //-------------------------------------------------------------------------------------------                      003435
 003436                                                                                                                      003436
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     95
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003438   //-------------------------------------------------------------------------------------------                      003438
 003439   // Convert ELSE.                                                                                                   003439
 003440   //-------------------------------------------------------------------------------------------                      003440
 003441   BegSr subUserCvt_ELSE;                                                                                             003441
 003442                                                                                                                      003442
 003443      sourceLine = 'Else;';                                                                                           003443
 003444                                                                                                                      003444
 003445      convert = *On;                                                                                                  003445
 003446                                                                                                                      003446
 003447   EndSr;                                                                                                             003447
 003448   //-------------------------------------------------------------------------------------------                      003448
 003449                                                                                                                      003449
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     96
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003451   //-------------------------------------------------------------------------------------------                      003451
 003452   // Convert ELSEIF.                                                                                                 003452
 003453   //-------------------------------------------------------------------------------------------                      003453
 003454   BegSr subUserCvt_ELSEIF;                                                                                           003454
 003455                                                                                                                      003455
 003456      sourceLine = 'ElseIf ' + %trim(factor2) + ';';                                                                  003456
 003457                                                                                                                      003457
 003458      convert = *On;                                                                                                  003458
 003459                                                                                                                      003459
 003460   EndSr;                                                                                                             003460
 003461   //-------------------------------------------------------------------------------------------                      003461
 003462                                                                                                                      003462
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     97
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003464   //-------------------------------------------------------------------------------------------                      003464
 003465   // Convert ENDxx.                                                                                                  003465
 003466   //-------------------------------------------------------------------------------------------                      003466
 003467   BegSr subUserCvt_ENDxx;                                                                                            003467
 003468                                                                                                                      003468
 003469      // Catch labels on ENDSR.                                                                                       003469
 003470      If %trim(operator) = 'ENDSR';                                                              B01                  003470
 003471         If %len(%trim(factor1)) > 0;                                                            B02                  003471
 003472            nonConvRsn = 'Label on ENDSR is not supported in free-form';                          02                  003472
 003473            LeaveSr;                                                                              02                  003473
 003474         EndIf;                                                                                  E02                  003474
 003475      EndIf;                                                                                     E01                  003475
 003476                                                                                                                      003476
 003477      // Do we need to convert an ENDDO to ENDFOR?                                                                    003477
 003478      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003478
 003479         If forCount > 0;                                                                        B02                  003479
 003480            If forLevel(forCount) = indentCount - 1;                                             B03                  003480
 003481               operator = 'ENDFOR' + ' ' + %trim(factor2);                                        03                  003481
 003482               If factor2 <> *Blanks;                                                            B04                  003482
 003483                  savedSRCDTA = SRCDTA;                                                           04                  003483
 003484                  codeLine = '* CHECK: This is a converted ENDDO -'                               04                  003484
 003485                           + ' Please add ''BY'' to the corresponding'                            04                  003485
 003486                           + ' FOR';                                                              04                  003486
 003487                  Exsr subUserWriteLine;                                                          04                  003487
 003488                  SRCDTA = savedSRCDTA;                                                           04                  003488
 003489               EndIf;                                                                            E04                  003489
 003490            EndIf;                                                                               E03                  003490
 003491         EndIf;                                                                                  E02                  003491
 003492      EndIf;                                                                                     E01                  003492
 003493                                                                                                                      003493
 003494      // Convert END to ENDDO?                                                                                        003494
 003495      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003495
 003496         If doCount > 0;                                                                         B02                  003496
 003497            If doLevel(doCount) = indentCount - 1;                                               B03                  003497
 003498               operator = 'ENDDO';                                                                03                  003498
 003499            EndIf;                                                                               E03                  003499
 003500         EndIf;                                                                                  E02                  003500
 003501      EndIf;                                                                                     E01                  003501
 003502                                                                                                                      003502
 003503      // Convert END to ENDSL?                                                                                        003503
 003504      If %trim(operator) = 'ENDSL' or %trim(operator) = 'END';                                   B01                  003504
 003505         If slCount > 0;                                                                         B02                  003505
 003506            If slLevel(slCount) = indentCount - 2;                                               B03                  003506
 003507               operator = 'ENDSL';                                                                03                  003507
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     98
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003508            EndIf;                                                                               E03                  003508
 003509         EndIf;                                                                                  E02                  003509
 003510      EndIf;                                                                                     E01                  003510
 003511                                                                                                                      003511
 003512      If %trim(operator) = 'END';                                                                B01                  003512
 003513         If inCase;                                                                              B02                  003513
 003514            operator = 'ENDCS';                                                                   02                  003514
 003515         Else;                                                                                   X02                  003515
 003516            operator = 'ENDIF';                                                                   02                  003516
 003517         EndIf;                                                                                  E02                  003517
 003518      EndIf;                                                                                     E01                  003518
 003519                                                                                                                      003519
 003520      sourceLine = %trim(operator) + ';';                                                                             003520
 003521                                                                                                                      003521
 003522      convert = *On;                                                                                                  003522
 003523                                                                                                                      003523
 003524      If operator = 'ENDCS';                                                                     B01                  003524
 003525         inCase = *Off;                                                                           01                  003525
 003526      EndIf;                                                                                     E01                  003526
 003527                                                                                                                      003527
 003528   EndSr;                                                                                                             003528
 003529   //-------------------------------------------------------------------------------------------                      003529
 003530                                                                                                                      003530
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page     99
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003532   //-------------------------------------------------------------------------------------------                      003532
 003533   // Convert EVALx.                                                                                                  003533
 003534   //-------------------------------------------------------------------------------------------                      003534
 003535   BegSr subUserCvt_EVALx;                                                                                            003535
 003536                                                                                                                      003536
 003537      // Returning for a multi-line EVAL - restore the original opcode.                                               003537
 003538      If inEval;                                                                                 B01                  003538
 003539         operator = evalOperator;                                                                 01                  003539
 003540      EndIf;                                                                                     E01                  003540
 003541                                                                                                                      003541
 003542      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003542
 003543                                                                                                                      003543
 003544      If not inEval;          // First line of EVAL.                                             B01                  003544
 003545         inEval = *On;                                                                            01                  003545
 003546         If %scan('H':operator:5) > 0  // Half-adjust.                                           B02                  003546
 003547         or %scan('R':operator:1) > 0; // EVALR.                                                 B02                  003547
 003548            sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                              02                  003548
 003549         Else;                                                                                   X02                  003549
 003550            sourceLine = %trim(extFactor2);                                                       02                  003550
 003551         EndIf;                                                                                  E02                  003551
 003552         If not inSpan;                                                                          B02                  003552
 003553            sourceLine = %trim(sourceLine) + ';';                                                 02                  003553
 003554         Else;                                                                                   X02                  003554
 003555            inSpan = *Off;                                                                        02                  003555
 003556         EndIf;                                                                                  E02                  003556
 003557      Else;                   // Second+ line of EVAL.                                           X01                  003557
 003558         sourceLine = *Blanks;                                                                    01                  003558
 003559         %subst(sourceLine:%len(%trim(operator)) + 2)                                             01                  003559
 003560               = %trim(extFactor2);                                                               01                  003560
 003561         If not inSpan;                                                                          B02                  003561
 003562            sourceLine = %trimr(sourceLine) + ';';                                                02                  003562
 003563         EndIf;                                                                                  E02                  003563
 003564         inSpan = *Off;                                                                           01                  003564
 003565      EndIf;                                                                                     E01                  003565
 003566                                                                                                                      003566
 003567      // Multi-line EVAL?  Save the opcode.                                                                           003567
 003568      If inEval;                                                                                 B01                  003568
 003569         evalOperator = operator;                                                                 01                  003569
 003570      Else;                                                                                      X01                  003570
 003571         evalOperator = *Blanks;                                                                  01                  003571
 003572      EndIf;                                                                                     E01                  003572
 003573                                                                                                                      003573
 003574      convert = *On;                                                                                                  003574
 003575                                                                                                                      003575
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    100
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003576   EndSr;                                                                                                             003576
 003577   //-------------------------------------------------------------------------------------------                      003577
 003578                                                                                                                      003578
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    101
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003580   //-------------------------------------------------------------------------------------------                      003580
 003581   // Convert EXCEPT.                                                                                                 003581
 003582   //-------------------------------------------------------------------------------------------                      003582
 003583   BegSr subUserCvt_EXCEPT;                                                                                           003583
 003584                                                                                                                      003584
 003585      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003585
 003586                                                                                                                      003586
 003587      convert = *On;                                                                                                  003587
 003588                                                                                                                      003588
 003589   EndSr;                                                                                                             003589
 003590   //-------------------------------------------------------------------------------------------                      003590
 003591                                                                                                                      003591
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    102
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003593   //-------------------------------------------------------------------------------------------                      003593
 003594   // Convert Embedded SQL.                                                                                           003594
 003595   //-------------------------------------------------------------------------------------------                      003595
 003596   BegSr subUserCvt_EXEC_SQL;                                                                                         003596
 003597                                                                                                                      003597
 003598      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003598
 003599                                                                                                                      003599
 003600      If workDirective = '/EXEC SQL';                                                            B01                  003600
 003601         sourceLine = 'Exec SQL';                                                                 01                  003601
 003602         inSQL = *On;                                                                             01                  003602
 003603         inSpan = *Off;                                                                           01                  003603
 003604      Else;                                                                                      X01                  003604
 003605         sourceLine = %trimr(%subst(codeLine:2));                                                 01                  003605
 003606         If not inSpan;                                                                          B02                  003606
 003607            sourceLine = %trim(sourceLine) + ';';                                                 02                  003607
 003608         Else;                                                                                   X02                  003608
 003609            inSQL = *On;                                                                          02                  003609
 003610            inSpan = *Off;                                                                        02                  003610
 003611         EndIf;                                                                                  E02                  003611
 003612      EndIf;                                                                                     E01                  003612
 003613                                                                                                                      003613
 003614      convert = *On;                                                                                                  003614
 003615                                                                                                                      003615
 003616   EndSr;                                                                                                             003616
 003617   //-------------------------------------------------------------------------------------------                      003617
 003618                                                                                                                      003618
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    103
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003620   //-------------------------------------------------------------------------------------------                      003620
 003621   // Convert EXFMT.                                                                                                  003621
 003622   //-------------------------------------------------------------------------------------------                      003622
 003623   BegSr subUserCvt_EXFMT;                                                                                            003623
 003624                                                                                                                      003624
 003625      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003625
 003626                                                                                                                      003626
 003627      // Append datastructure?                                                                                        003627
 003628      If result <> *Blanks;                                                                      B01                  003628
 003629         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003629
 003630      Else;                                                                                      X01                  003630
 003631         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003631
 003632      EndIf;                                                                                     E01                  003632
 003633                                                                                                                      003633
 003634      // Check indicators?                                                                                            003634
 003635      If lw <> *Blanks;                                                                          B01                  003635
 003636         ERRCheck = *On;                                                                          01                  003636
 003637         ERRInd = lw;                                                                             01                  003637
 003638      EndIf;                                                                                     E01                  003638
 003639                                                                                                                      003639
 003640      convert = *On;                                                                                                  003640
 003641                                                                                                                      003641
 003642   EndSr;                                                                                                             003642
 003643   //-------------------------------------------------------------------------------------------                      003643
 003644                                                                                                                      003644
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    104
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003646   //-------------------------------------------------------------------------------------------                      003646
 003647   // Convert EXSR.                                                                                                   003647
 003648   //-------------------------------------------------------------------------------------------                      003648
 003649   BegSr subUserCvt_EXSR;                                                                                             003649
 003650                                                                                                                      003650
 003651      sourceLine = 'ExSr ' + %trim(factor2) + ';';                                                                    003651
 003652                                                                                                                      003652
 003653      convert = *On;                                                                                                  003653
 003654                                                                                                                      003654
 003655   EndSr;                                                                                                             003655
 003656   //-------------------------------------------------------------------------------------------                      003656
 003657                                                                                                                      003657
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    105
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003659   //-------------------------------------------------------------------------------------------                      003659
 003660   // Convert EXTRCT                                                                                                  003660
 003661   //-------------------------------------------------------------------------------------------                      003661
 003662   BegSr subUserCvt_EXTRCT;                                                                                           003662
 003663                                                                                                                      003663
 003664      // Split out duration and code.                                                                                 003664
 003665      x = %scan(':':factor2);                                                                                         003665
 003666      If x = 0;                                                                                  B01                  003666
 003667         nonConvRsn =  'No duration code specified.';                                             01                  003667
 003668         LeaveSr;                                                                                 01                  003668
 003669      EndIf;                                                                                     E01                  003669
 003670                                                                                                                      003670
 003671      durDuration = %trim(%subst(factor2:1:x-1));                                                                     003671
 003672      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         003672
 003673                                                                                                                      003673
 003674      Select;                                                                                    B01                  003674
 003675         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  003675
 003676            durCode = '%years';                                                                   01                  003676
 003677         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  003677
 003678            durCode = '%months';                                                                  01                  003678
 003679         When durCode = '*D' or durCode = '*DAYS';                                               X01                  003679
 003680            durCode = '%days';                                                                    01                  003680
 003681         When durCode = '*H' or durCode = '*HOURS';                                              X01                  003681
 003682            durCode = '%hours';                                                                   01                  003682
 003683         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  003683
 003684            durCode = '%minutes';                                                                 01                  003684
 003685         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  003685
 003686            durCode = '%seconds';                                                                 01                  003686
 003687         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  003687
 003688            durCode = '%mseconds';                                                                01                  003688
 003689         Other;                                                                                  X01                  003689
 003690            nonConvRsn = 'Invalid duration code specified.';                                      01                  003690
 003691            LeaveSr;                                                                              01                  003691
 003692      EndSl;                                                                                     E01                  003692
 003693                                                                                                                      003693
 003694      sourceLine = %trim(result) + ' = %subdt(' + %trim(durDuration)                                                  003694
 003695                 + ':' + %trim(durCode) + ');';                                                                       003695
 003696                                                                                                                      003696
 003697      // Check indicators?                                                                                            003697
 003698      If lw <> *Blanks;                                                                          B01                  003698
 003699         ERRCheck = *On;                                                                          01                  003699
 003700         ERRInd = lw;                                                                             01                  003700
 003701      EndIf;                                                                                     E01                  003701
 003702                                                                                                                      003702
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    106
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003703      convert = *On;                                                                                                  003703
 003704                                                                                                                      003704
 003705   EndSr;                                                                                                             003705
 003706   //-------------------------------------------------------------------------------------------                      003706
 003707                                                                                                                      003707
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    107
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003709   //-------------------------------------------------------------------------------------------                      003709
 003710   // Convert FEOD.                                                                                                   003710
 003711   //-------------------------------------------------------------------------------------------                      003711
 003712   BegSr subUserCvt_FEOD;                                                                                             003712
 003713                                                                                                                      003713
 003714      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003714
 003715                                                                                                                      003715
 003716      // Check indicators?                                                                                            003716
 003717      If lw <> *Blanks;                                                                          B01                  003717
 003718         ERRCheck = *On;                                                                          01                  003718
 003719         ERRInd = lw;                                                                             01                  003719
 003720      EndIf;                                                                                     E01                  003720
 003721                                                                                                                      003721
 003722      convert = *On;                                                                                                  003722
 003723                                                                                                                      003723
 003724   EndSr;                                                                                                             003724
 003725   //-------------------------------------------------------------------------------------------                      003725
 003726                                                                                                                      003726
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    108
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003728   //-------------------------------------------------------------------------------------------                      003728
 003729   // Convert FORCE.                                                                                                  003729
 003730   //-------------------------------------------------------------------------------------------                      003730
 003731   BegSr subUserCvt_FORCE;                                                                                            003731
 003732                                                                                                                      003732
 003733      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003733
 003734                                                                                                                      003734
 003735      convert = *On;                                                                                                  003735
 003736                                                                                                                      003736
 003737   EndSr;                                                                                                             003737
 003738   //-------------------------------------------------------------------------------------------                      003738
 003739                                                                                                                      003739
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    109
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003741   //-------------------------------------------------------------------------------------------                      003741
 003742   // Convert FOR.                                                                                                    003742
 003743   //-------------------------------------------------------------------------------------------                      003743
 003744   BegSr subUserCvt_FOR;                                                                                              003744
 003745                                                                                                                      003745
 003746      sourceLine = 'For ' + %trim(extFactor2) + ';';                                                                  003746
 003747                                                                                                                      003747
 003748      convert = *On;                                                                                                  003748
 003749                                                                                                                      003749
 003750   EndSr;                                                                                                             003750
 003751   //-------------------------------------------------------------------------------------------                      003751
 003752                                                                                                                      003752
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    110
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003754   //-------------------------------------------------------------------------------------------                      003754
 003755   // Convert IF.                                                                                                     003755
 003756   //-------------------------------------------------------------------------------------------                      003756
 003757   BegSr subUserCvt_IF;                                                                                               003757
 003758                                                                                                                      003758
 003759      // Returning for a multi-line IF?  Reinstate original opcode.                                                   003759
 003760      If inIf;                                                                                   B01                  003760
 003761         operator = ifOperator;                                                                   01                  003761
 003762      EndIf;                                                                                     E01                  003762
 003763                                                                                                                      003763
 003764      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003764
 003765                                                                                                                      003765
 003766      If operator = 'IF';     // Use Extended Factor2.                                           B01                  003766
 003767         If not inIf;            // First line of IF.                                            B02                  003767
 003768            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003768
 003769            If not inSpan;                                                                       B03                  003769
 003770               sourceLine = %trim(sourceLine) + ';';                                              03                  003770
 003771            Else;                                                                                X03                  003771
 003772               inIf = *On;                                                                        03                  003772
 003773               inSpan = *Off;                                                                     03                  003773
 003774            EndIf;                                                                               E03                  003774
 003775         Else;                   // Second line of IF.                                           X02                  003775
 003776            //            sourceLine = *Blanks;                                                                       003776
 003777            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003777
 003778            sourceLine = %trim(extFactor2);                                                       02                  003778
 003779            If not inSpan;                                                                       B03                  003779
 003780               sourceLine = %trimr(sourceLine) + ';';                                             03                  003780
 003781               //               inIf = *Off;                                                                          003781
 003782            EndIf;                                                                               E03                  003782
 003783            //            inSpan = *On;                                                                               003783
 003784            inSpan = *Off;                                                                        02                  003784
 003785         EndIf;                                                                                  E02                  003785
 003786      Else;                                                                                      X01                  003786
 003787         // Fixed format.                                                                                             003787
 003788         opCode = %xlate(lo:up:opCode);                                                           01                  003788
 003789         If not inIf;         // First line of IF.                                               B02                  003789
 003790            ifCompare = %subst(opCode:3:2);                                                       02                  003790
 003791            sourceLine = 'If';                                                                    02                  003791
 003792         Else;                // Second line of IF.                                              X02                  003792
 003793            If %subst(opCode:1:3) = 'AND';                                                       B03                  003793
 003794               ifCompare = %subst(opCode:4:2);                                                    03                  003794
 003795               sourceLine = 'And';                                                                03                  003795
 003796            Else;                                                                                X03                  003796
 003797               ifCompare = %subst(opCode:3:2);                                                    03                  003797
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    111
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003798               sourceLine = 'Or';                                                                 03                  003798
 003799            EndIf;                                                                               E03                  003799
 003800         EndIf;                                                                                  E02                  003800
 003801         If ifCompare = 'EQ';                                                                    B02                  003801
 003802            ifCompare = '=';                                                                      02                  003802
 003803         ElseIf ifCompare = 'GT';                                                                X02                  003803
 003804            ifCompare = '>';                                                                      02                  003804
 003805         ElseIf ifCompare = 'GE';                                                                X02                  003805
 003806            ifCompare = '>=';                                                                     02                  003806
 003807         ElseIf ifCompare = 'LT';                                                                X02                  003807
 003808            ifCompare = '<';                                                                      02                  003808
 003809         ElseIf ifCompare = 'LE';                                                                X02                  003809
 003810            ifCompare = '<=';                                                                     02                  003810
 003811         ElseIf ifCompare = 'NE';                                                                X02                  003811
 003812            ifCompare = '<>';                                                                     02                  003812
 003813         EndIf;                                                                                  E02                  003813
 003814         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003814
 003815                            + ' ' + %trim(ifCompare) + ' '                                        01                  003815
 003816                            + %trim(factor2);                                                     01                  003816
 003817         If not inSpan;                                                                          B02                  003817
 003818            sourceLine = %trimr(sourceLine) + ';';                                                02                  003818
 003819            inIf = *Off;                                                                          02                  003819
 003820         Else;                                                                                   X02                  003820
 003821            inIf = *On;                                                                           02                  003821
 003822            inSpan = *Off;                                                                        02                  003822
 003823         EndIf;                                                                                  E02                  003823
 003824      EndIf;                                                                                     E01                  003824
 003825                                                                                                                      003825
 003826      // Multi-line IF?  Retain original opcode.                                                                      003826
 003827      If inIf;                                                                                   B01                  003827
 003828         ifOperator = operator;                                                                   01                  003828
 003829      Else;                                                                                      X01                  003829
 003830         ifOperator = *Blanks;                                                                    01                  003830
 003831      EndIf;                                                                                     E01                  003831
 003832                                                                                                                      003832
 003833      convert = *On;                                                                                                  003833
 003834                                                                                                                      003834
 003835   EndSr;                                                                                                             003835
 003836   //-------------------------------------------------------------------------------------------                      003836
 003837                                                                                                                      003837
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    112
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003839   //-------------------------------------------------------------------------------------------                      003839
 003840   // Convert IN.                                                                                                     003840
 003841   //-------------------------------------------------------------------------------------------                      003841
 003842   BegSr subUserCvt_IN;                                                                                               003842
 003843                                                                                                                      003843
 003844      If factor1 <> *Blanks;                                                                     B01                  003844
 003845         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  003845
 003846                    + %trim(factor2) + ';';                                                       01                  003846
 003847      Else;                                                                                      X01                  003847
 003848         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  003848
 003849      EndIf;                                                                                     E01                  003849
 003850                                                                                                                      003850
 003851      // Set resulting indicators?                                                                                    003851
 003852      If lw <> *Blanks;                                                                          B01                  003852
 003853         ERRCheck = *On;                                                                          01                  003853
 003854         ERRInd = lw;                                                                             01                  003854
 003855      EndIf;                                                                                     E01                  003855
 003856                                                                                                                      003856
 003857      convert = *On;                                                                                                  003857
 003858                                                                                                                      003858
 003859   EndSr;                                                                                                             003859
 003860   //-------------------------------------------------------------------------------------------                      003860
 003861                                                                                                                      003861
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    113
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003863   //-------------------------------------------------------------------------------------------                      003863
 003864   // Convert ITER.                                                                                                   003864
 003865   //-------------------------------------------------------------------------------------------                      003865
 003866   BegSr subUserCvt_ITER;                                                                                             003866
 003867                                                                                                                      003867
 003868      sourceLine = %trim(operator) + ';';                                                                             003868
 003869                                                                                                                      003869
 003870      convert = *On;                                                                                                  003870
 003871                                                                                                                      003871
 003872   EndSr;                                                                                                             003872
 003873   //-------------------------------------------------------------------------------------------                      003873
 003874                                                                                                                      003874
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    114
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003876   //-------------------------------------------------------------------------------------------                      003876
 003877   // Convert LEAVExx.                                                                                                003877
 003878   //-------------------------------------------------------------------------------------------                      003878
 003879   BegSr subUserCvt_LEAVE;                                                                                            003879
 003880                                                                                                                      003880
 003881      sourceLine = %trim(operator) + ';';                                                                             003881
 003882                                                                                                                      003882
 003883      convert = *On;                                                                                                  003883
 003884                                                                                                                      003884
 003885   EndSr;                                                                                                             003885
 003886   //-------------------------------------------------------------------------------------------                      003886
 003887                                                                                                                      003887
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    115
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003889   //-------------------------------------------------------------------------------------------                      003889
 003890   // Convert LOOKUP.                                                                                                 003890
 003891   //-------------------------------------------------------------------------------------------                      003891
 003892   BegSr subUserCvt_LOOKUP;                                                                                           003892
 003893                                                                                                                      003893
 003894      //            If %subst(factor2:1:3) = 'TAB';  // Table lookup.                                                 003894
 003895      //            Else;                            // Array lookup.                                                 003895
 003896      //               // Extract element variable.                                                                   003896
 003897      //               x = %scan('(':factor2);                                                                        003897
 003898      //               If x = 0;   // No variable specified, so use a substitute.                                     003898
 003899      //                  lookupVar = 'lookupIndex';                                                                  003899
 003900      //               Else;                                                                                          003900
 003901      //                  lookupVar = %subst(factor2:x+1:%scan(')':factor2:x)-x-1);                                   003901
 003902      //               EndIf;                                                                                         003902
 003903      //               If eq <> *Blanks and lw <> *Blanks;                                                            003903
 003904      //                  sourceLine = '%lookupLE(';                                                                  003904
 003905      //               ElseIf eq <> *Blanks and hi <> *Blanks;                                                        003905
 003906      //                  sourceLine = '%lookupGE(';                                                                  003906
 003907      //               ElseIf lw <> *Blanks;                                                                          003907
 003908      //                  sourceLine = '%lookupLT(';                                                                  003908
 003909      //               ElseIf hi <> *Blanks;                                                                          003909
 003910      //                  sourceLine = '%lookupGT(';                                                                  003910
 003911      //               Else;                                                                                          003911
 003912      //                  sourceLine = '%lookup(';                                                                    003912
 003913      //               EndIf;                                                                                         003913
 003914      //               sourceLine = %trim(sourceLine) + %trim(factor1) + ':'                                          003914
 003915      //                          + %trim(factor2) + ');';                                                            003915
 003916      //            EndIf;                                                                                            003916
 003917      //            convert = *On;                                                                                    003917
 003918                                                                                                                      003918
 003919   EndSr;                                                                                                             003919
 003920   //-------------------------------------------------------------------------------------------                      003920
 003921                                                                                                                      003921
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    116
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003923   //-------------------------------------------------------------------------------------------                      003923
 003924   // Convert MONITOR.                                                                                                003924
 003925   //-------------------------------------------------------------------------------------------                      003925
 003926   BegSr subUserCvt_MONITOR;                                                                                          003926
 003927                                                                                                                      003927
 003928      sourceLine = 'Monitor;';                                                                                        003928
 003929                                                                                                                      003929
 003930      convert = *On;                                                                                                  003930
 003931                                                                                                                      003931
 003932   EndSr;                                                                                                             003932
 003933   //-------------------------------------------------------------------------------------------                      003933
 003934                                                                                                                      003934
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    117
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003936   //-------------------------------------------------------------------------------------------                      003936
 003937   // Convert MOVE.                                                                                                   003937
 003938   //-------------------------------------------------------------------------------------------                      003938
 003939   BegSr subUserCvt_MOVE;                                                                                             003939
 003940                                                                                                                      003940
 003941      // Pad the result?                                                                                              003941
 003942      x = %scan('P':operator:5);                                                                                      003942
 003943                                                                                                                      003943
 003944      If x > 0 and %subst(operator:5:1) <> 'L';                                                  B01                  003944
 003945         // Move right and pad left.                                                                                  003945
 003946         sourceLine = 'EvalR ' + %trim(result) + ' = ' + %trim(factor2)                           01                  003946
 003947                    + ';';                                                                        01                  003947
 003948                                                                                                                      003948
 003949      ElseIf x > 0 and %subst(operator:5:1) = 'L';                                               X01                  003949
 003950         // Move left and pad right.                                                                                  003950
 003951         sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                               01                  003951
 003952                                                                                                                      003952
 003953      ElseIf factor1 = *Blanks;                                                                  X01                  003953
 003954         // Straight move.                                                                                            003954
 003955         If %lookup(%xlate(lo:up:%trim(result)):QopCodeUp) = 0;                                  B02                  003955
 003956            sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                            02                  003956
 003957         Else;                                                                                   X02                  003957
 003958            // Result is a reserved word - don't convert.                                                             003958
 003959            nonConvRsn = 'Result field name is a reserved word.';                                 02                  003959
 003960            LeaveSr;                                                                              02                  003960
 003961         EndIf;                                                                                  E02                  003961
 003962                                                                                                                      003962
 003963      Else;                                                                                      X01                  003963
 003964         // Conversion from one format to another...                                                                  003964
 003965         //         sourceLine = %xlate(lo:up:factor1);                                                               003965
 003966                                                                                                                      003966
 003967         //         If sourceLine = '*CYMD';   // Date.                                                               003967
 003968         //            sourceLine = %trim(result) + ' = %dec(' + %trim(factor2)                                       003968
 003969         //                       + ':*CYMD);';                                                                       003969
 003970         //         Else;                                                                                             003970
 003971         nonConvRsn = 'Data conversion is needed.';                                               01                  003971
 003972         LeaveSr; // Don't convert.                                                               01                  003972
 003973         //         EndIf;                                                                                            003973
 003974      EndIf;                                                                                     E01                  003974
 003975                                                                                                                      003975
 003976      convert = *On;                                                                                                  003976
 003977                                                                                                                      003977
 003978   EndSr;                                                                                                             003978
 003979   //-------------------------------------------------------------------------------------------                      003979
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    118
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003980                                                                                                                      003980
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    119
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003982   //-------------------------------------------------------------------------------------------                      003982
 003983   // Convert MOVEA.                                                                                                  003983
 003984   //-------------------------------------------------------------------------------------------                      003984
 003985   BegSr subUserCvt_MOVEA;                                                                                            003985
 003986                                                                                                                      003986
 003987      // Not supported.                                                                                               003987
 003988                                                                                                                      003988
 003989   EndSr;                                                                                                             003989
 003990   //-------------------------------------------------------------------------------------------                      003990
 003991                                                                                                                      003991
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    120
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003993   //-------------------------------------------------------------------------------------------                      003993
 003994   // Convert MULT.                                                                                                   003994
 003995   //-------------------------------------------------------------------------------------------                      003995
 003996   BegSr subUserCvt_MULT;                                                                                             003996
 003997                                                                                                                      003997
 003998      // Half-adjust?                                                                                                 003998
 003999      x = %scan('H':operator:4);                                                                                      003999
 004000      If x > 0;                                                                                  B01                  004000
 004001         sourceLine = 'Eval(H)';                                                                  01                  004001
 004002      Else;                                                                                      X01                  004002
 004003         sourceLine = *Blanks;                                                                    01                  004003
 004004      EndIf;                                                                                     E01                  004004
 004005                                                                                                                      004005
 004006      If factor1 = *Blanks;                                                                      B01                  004006
 004007         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004007
 004008                    + ' = ' + %trim(result)                                                       01                  004008
 004009                    + ' * ' + %trim(factor2) +';';                                                01                  004009
 004010      Else;                                                                                      X01                  004010
 004011         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004011
 004012                    + ' = ' + %trim(factor1)                                                      01                  004012
 004013                    + ' * ' + %trim(factor2) + ';';                                               01                  004013
 004014      EndIf;                                                                                     E01                  004014
 004015                                                                                                                      004015
 004016      sourceLine = %trim(sourceLine);                                                                                 004016
 004017                                                                                                                      004017
 004018      convert = *On;                                                                                                  004018
 004019                                                                                                                      004019
 004020   EndSr;                                                                                                             004020
 004021   //-------------------------------------------------------------------------------------------                      004021
 004022                                                                                                                      004022
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    121
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004024   //-------------------------------------------------------------------------------------------                      004024
 004025   // Convert MVR.                                                                                                    004025
 004026   //-------------------------------------------------------------------------------------------                      004026
 004027   BegSr subUserCvt_MVR;                                                                                              004027
 004028                                                                                                                      004028
 004029      sourceLine = %trim(result) + ' = %rem(' + %trim(divFactor1)                                                     004029
 004030                 + ':' + %trim(divFactor2) + ');';                                                                    004030
 004031                                                                                                                      004031
 004032      convert = *On;                                                                                                  004032
 004033                                                                                                                      004033
 004034   EndSr;                                                                                                             004034
 004035   //-------------------------------------------------------------------------------------------                      004035
 004036                                                                                                                      004036
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    122
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004038   //-------------------------------------------------------------------------------------------                      004038
 004039   // Convert NEXT.                                                                                                   004039
 004040   //-------------------------------------------------------------------------------------------                      004040
 004041   BegSr subUserCvt_NEXT;                                                                                             004041
 004042                                                                                                                      004042
 004043      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004043
 004044                 + %trim(factor2) + ';';                                                                              004044
 004045                                                                                                                      004045
 004046                                                                                                                      004046
 004047      // Check indicators?                                                                                            004047
 004048      If lw <> *Blanks;                                                                          B01                  004048
 004049         ERRCheck = *On;                                                                          01                  004049
 004050         ERRInd = lw;                                                                             01                  004050
 004051      EndIf;                                                                                     E01                  004051
 004052                                                                                                                      004052
 004053      convert = *On;                                                                                                  004053
 004054                                                                                                                      004054
 004055   EndSr;                                                                                                             004055
 004056   //-------------------------------------------------------------------------------------------                      004056
 004057                                                                                                                      004057
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    123
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004059   //-------------------------------------------------------------------------------------------                      004059
 004060   // Convert OCCUR.                                                                                                  004060
 004061   //-------------------------------------------------------------------------------------------                      004061
 004062   BegSr subUserCvt_OCCUR;                                                                                            004062
 004063                                                                                                                      004063
 004064      If factor1 = *Blanks;      // Get occurrence.                                              B01                  004064
 004065         sourceLine = %trim(result) + ' = ' + '%occur('                                           01                  004065
 004066                    + %trim(factor2) + ');';                                                      01                  004066
 004067      ElseIf result = *Blanks;   // Set occurrent.                                               X01                  004067
 004068         sourceLine = '%occur(' + %trim(factor2) + ') = '                                         01                  004068
 004069                    + %trim(factor1) + ';';                                                       01                  004069
 004070      Else;                                                                                      X01                  004070
 004071         nonConvRsn = 'Cannot determine of OCCUR is used to set or '                              01                  004071
 004072                    + 'get the occurrence.';                                                      01                  004072
 004073         LeaveSr;                                                                                 01                  004073
 004074      EndIf;                                                                                     E01                  004074
 004075                                                                                                                      004075
 004076      // Check resulting indicators?                                                                                  004076
 004077      If lw <> *Blanks;                                                                          B01                  004077
 004078         ERRCheck = *On;                                                                          01                  004078
 004079         ERRInd = lw;                                                                             01                  004079
 004080      EndIf;                                                                                     E01                  004080
 004081                                                                                                                      004081
 004082      convert = *On;                                                                                                  004082
 004083                                                                                                                      004083
 004084   EndSr;                                                                                                             004084
 004085   //-------------------------------------------------------------------------------------------                      004085
 004086                                                                                                                      004086
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    124
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004088   //-------------------------------------------------------------------------------------------                      004088
 004089   // Convert ON-ERROR.                                                                                               004089
 004090   //-------------------------------------------------------------------------------------------                      004090
 004091   BegSr subUserCvt_ON_ERROR;                                                                                         004091
 004092                                                                                                                      004092
 004093      If extFactor2 = *Blanks;                                                                   B01                  004093
 004094         sourceLine = %trim(operator) + ';';                                                      01                  004094
 004095      Else;                                                                                      X01                  004095
 004096         sourceLine = %trim(operator) + ' ' + %trim(extFactor2) + ';';                            01                  004096
 004097      EndIf;                                                                                     E01                  004097
 004098                                                                                                                      004098
 004099      convert = *On;                                                                                                  004099
 004100                                                                                                                      004100
 004101   EndSr;                                                                                                             004101
 004102   //-------------------------------------------------------------------------------------------                      004102
 004103                                                                                                                      004103
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    125
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004105   //-------------------------------------------------------------------------------------------                      004105
 004106   // Convert OPEN.                                                                                                   004106
 004107   //-------------------------------------------------------------------------------------------                      004107
 004108   BegSr subUserCvt_OPEN;                                                                                             004108
 004109                                                                                                                      004109
 004110      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004110
 004111                                                                                                                      004111
 004112      // Check resulting indicators?                                                                                  004112
 004113      If lw <> *Blanks;                                                                          B01                  004113
 004114         ERRCheck = *On;                                                                          01                  004114
 004115         ERRInd = lw;                                                                             01                  004115
 004116      EndIf;                                                                                     E01                  004116
 004117                                                                                                                      004117
 004118      convert = *On;                                                                                                  004118
 004119                                                                                                                      004119
 004120   EndSr;                                                                                                             004120
 004121   //-------------------------------------------------------------------------------------------                      004121
 004122                                                                                                                      004122
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    126
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004124   //-------------------------------------------------------------------------------------------                      004124
 004125   // Convert OTHER.                                                                                                  004125
 004126   //-------------------------------------------------------------------------------------------                      004126
 004127   BegSr subUserCvt_OTHER;                                                                                            004127
 004128                                                                                                                      004128
 004129      sourceLine = 'Other;';                                                                                          004129
 004130                                                                                                                      004130
 004131      convert = *On;                                                                                                  004131
 004132                                                                                                                      004132
 004133   EndSr;                                                                                                             004133
 004134   //-------------------------------------------------------------------------------------------                      004134
 004135                                                                                                                      004135
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    127
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004137   //-------------------------------------------------------------------------------------------                      004137
 004138   // Convert OUT.                                                                                                    004138
 004139   //-------------------------------------------------------------------------------------------                      004139
 004140   BegSr subUserCvt_OUT;                                                                                              004140
 004141                                                                                                                      004141
 004142      If factor1 = *Blanks;                                                                      B01                  004142
 004143         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004143
 004144      Else;                                                                                      X01                  004144
 004145         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004145
 004146                    + %trim(factor2) + ';';                                                       01                  004146
 004147      EndIf;                                                                                     E01                  004147
 004148                                                                                                                      004148
 004149      // Set resulting indicators?                                                                                    004149
 004150      If lw <> *Blanks;                                                                          B01                  004150
 004151         ERRCheck = *On;                                                                          01                  004151
 004152         ERRInd = lw;                                                                             01                  004152
 004153      EndIf;                                                                                     E01                  004153
 004154                                                                                                                      004154
 004155      convert = *On;                                                                                                  004155
 004156                                                                                                                      004156
 004157   EndSr;                                                                                                             004157
 004158   //-------------------------------------------------------------------------------------------                      004158
 004159                                                                                                                      004159
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    128
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004161   //-------------------------------------------------------------------------------------------                      004161
 004162   // Convert POST.                                                                                                   004162
 004163   //-------------------------------------------------------------------------------------------                      004163
 004164   BegSr subUserCvt_POST;                                                                                             004164
 004165                                                                                                                      004165
 004166      If factor2 = *Blanks;                                                                      B01                  004166
 004167         nonConvRsn =  'No filename specified in Factor2.';                                       01                  004167
 004168         LeaveSr;                                                                                 01                  004168
 004169      EndIf;                                                                                     E01                  004169
 004170                                                                                                                      004170
 004171      If result <> *Blanks;                                                                      B01                  004171
 004172         nonConvRsn =  'INFDS specified in result.';                                              01                  004172
 004173         LeaveSr;                                                                                 01                  004173
 004174      EndIf;                                                                                     E01                  004174
 004175                                                                                                                      004175
 004176      If factor1 = *Blanks;                                                                      B01                  004176
 004177         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004177
 004178      Else;                                                                                      X01                  004178
 004179         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004179
 004180                    + %trim(factor2) + ';';                                                       01                  004180
 004181      EndIf;                                                                                     E01                  004181
 004182                                                                                                                      004182
 004183      // Set resulting indicators?                                                                                    004183
 004184      If lw <> *Blanks;                                                                          B01                  004184
 004185         ERRCheck = *On;                                                                          01                  004185
 004186         ERRInd = lw;                                                                             01                  004186
 004187      EndIf;                                                                                     E01                  004187
 004188                                                                                                                      004188
 004189      convert = *On;                                                                                                  004189
 004190                                                                                                                      004190
 004191   EndSr;                                                                                                             004191
 004192   //-------------------------------------------------------------------------------------------                      004192
 004193                                                                                                                      004193
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    129
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004195   //-------------------------------------------------------------------------------------------                      004195
 004196   // Convert READ.                                                                                                   004196
 004197   //-------------------------------------------------------------------------------------------                      004197
 004198   BegSr subUserCvt_READ;                                                                                             004198
 004199                                                                                                                      004199
 004200      If factor1 <> *Blanks;                                                                     B01                  004200
 004201         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004201
 004202                    + %trim(factor2);                                                             01                  004202
 004203      Else;                                                                                      X01                  004203
 004204         sourceLine = %trim(operator) + ' ' + %trim(factor2);                                     01                  004204
 004205      EndIf;                                                                                     E01                  004205
 004206                                                                                                                      004206
 004207      // Append datastructure?                                                                                        004207
 004208      If result <> *Blanks;                                                                      B01                  004208
 004209         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004209
 004210      Else;                                                                                      X01                  004210
 004211         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004211
 004212      EndIf;                                                                                     E01                  004212
 004213                                                                                                                      004213
 004214      // Check indicators?                                                                                            004214
 004215      If eq <> *Blanks;                                                                          B01                  004215
 004216         EOFCheck = *On;                                                                          01                  004216
 004217         EOFInd = eq;                                                                             01                  004217
 004218         EOFFile = %trim(factor2);                                                                01                  004218
 004219      EndIf;                                                                                     E01                  004219
 004220      If lw <> *Blanks;                                                                          B01                  004220
 004221         ERRCheck = *On;                                                                          01                  004221
 004222         ERRInd = lw;                                                                             01                  004222
 004223      EndIf;                                                                                     E01                  004223
 004224                                                                                                                      004224
 004225      convert = *On;                                                                                                  004225
 004226                                                                                                                      004226
 004227   EndSr;                                                                                                             004227
 004228   //-------------------------------------------------------------------------------------------                      004228
 004229                                                                                                                      004229
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    130
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004231   //-------------------------------------------------------------------------------------------                      004231
 004232   // Convert REALLOC.                                                                                                004232
 004233   //-------------------------------------------------------------------------------------------                      004233
 004234   BegSr subUserCvt_REALLOC;                                                                                          004234
 004235                                                                                                                      004235
 004236      sourceLine = %trim(result) + ' = %realloc(' + %trim(factor2)                                                    004236
 004237                 + ');';                                                                                              004237
 004238                                                                                                                      004238
 004239      // Set resulting indicators?                                                                                    004239
 004240      If lw <> *Blanks;                                                                          B01                  004240
 004241         ERRCheck = *On;                                                                          01                  004241
 004242         ERRInd = lw;                                                                             01                  004242
 004243      EndIf;                                                                                     E01                  004243
 004244                                                                                                                      004244
 004245      convert = *On;                                                                                                  004245
 004246                                                                                                                      004246
 004247   EndSr;                                                                                                             004247
 004248   //-------------------------------------------------------------------------------------------                      004248
 004249                                                                                                                      004249
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    131
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004251   //-------------------------------------------------------------------------------------------                      004251
 004252   // Convert REL.                                                                                                    004252
 004253   //-------------------------------------------------------------------------------------------                      004253
 004254   BegSr subUserCvt_REL;                                                                                              004254
 004255                                                                                                                      004255
 004256      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             004256
 004257                 + ' ' + %trim(factor2) + ';';                                                                        004257
 004258                                                                                                                      004258
 004259      // Check resulting indicators?                                                                                  004259
 004260      If lw <> *Blanks;                                                                          B01                  004260
 004261         ERRCheck = *On;                                                                          01                  004261
 004262         ERRInd = lw;                                                                             01                  004262
 004263      EndIf;                                                                                     E01                  004263
 004264                                                                                                                      004264
 004265      convert = *On;                                                                                                  004265
 004266                                                                                                                      004266
 004267   EndSr;                                                                                                             004267
 004268   //-------------------------------------------------------------------------------------------                      004268
 004269                                                                                                                      004269
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    132
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004271   //-------------------------------------------------------------------------------------------                      004271
 004272   // Convert RESET.                                                                                                  004272
 004273   //-------------------------------------------------------------------------------------------                      004273
 004274   BegSr subUserCvt_RESET;                                                                                            004274
 004275                                                                                                                      004275
 004276      sourceLine = %trim(operator);                                                                                   004276
 004277                                                                                                                      004277
 004278      If factor1 <> *Blanks;                                                                     B01                  004278
 004279         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  004279
 004280      EndIf;                                                                                     E01                  004280
 004281                                                                                                                      004281
 004282      If factor2 <> *Blanks;                                                                     B01                  004282
 004283         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                                  01                  004283
 004284      EndIf;                                                                                     E01                  004284
 004285                                                                                                                      004285
 004286      sourceLine = %trimr(sourceLine) + ' ' + %trim(result) + ';';                                                    004286
 004287                                                                                                                      004287
 004288      // Check indicators?                                                                                            004288
 004289      If hi <> *Blanks;                                                                          B01                  004289
 004290         NRFCheck = *On;                                                                          01                  004290
 004291         NRFInd = eq;                                                                             01                  004291
 004292         NRFFile = %trim(factor2);                                                                01                  004292
 004293      EndIf;                                                                                     E01                  004293
 004294      If lw <> *Blanks;                                                                          B01                  004294
 004295         ERRCheck = *On;                                                                          01                  004295
 004296         ERRInd = lw;                                                                             01                  004296
 004297      EndIf;                                                                                     E01                  004297
 004298                                                                                                                      004298
 004299      convert = *On;                                                                                                  004299
 004300                                                                                                                      004300
 004301   EndSr;                                                                                                             004301
 004302   //-------------------------------------------------------------------------------------------                      004302
 004303                                                                                                                      004303
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    133
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004305   //-------------------------------------------------------------------------------------------                      004305
 004306   // Convert RETURN;                                                                                                 004306
 004307   //-------------------------------------------------------------------------------------------                      004307
 004308   BegSr subUserCvt_RETURN;                                                                                           004308
 004309                                                                                                                      004309
 004310      sourceLine = 'Return ' + %trim(%subst(operator:7))                                                              004310
 004311                 + ' ' + %trim(extFactor2) + ';';                                                                     004311
 004312                                                                                                                      004312
 004313      convert = *On;                                                                                                  004313
 004314                                                                                                                      004314
 004315   EndSr;                                                                                                             004315
 004316   //-------------------------------------------------------------------------------------------                      004316
 004317                                                                                                                      004317
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    134
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004319   //-------------------------------------------------------------------------------------------                      004319
 004320   // Convert ROLBK.                                                                                                  004320
 004321   //-------------------------------------------------------------------------------------------                      004321
 004322   BegSr subUserCvt_ROLBK;                                                                                            004322
 004323                                                                                                                      004323
 004324      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            004324
 004325                                                                                                                      004325
 004326      sourceLine = %trim(sourceLine)  + ';';                                                                          004326
 004327                                                                                                                      004327
 004328      // Check indicators?                                                                                            004328
 004329      If lw <> *Blanks;                                                                          B01                  004329
 004330         ERRCheck = *On;                                                                          01                  004330
 004331         ERRInd = lw;                                                                             01                  004331
 004332      EndIf;                                                                                     E01                  004332
 004333                                                                                                                      004333
 004334      convert = *On;                                                                                                  004334
 004335                                                                                                                      004335
 004336   EndSr;                                                                                                             004336
 004337   //-------------------------------------------------------------------------------------------                      004337
 004338                                                                                                                      004338
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    135
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004340   //-------------------------------------------------------------------------------------------                      004340
 004341   // Convert SCAN.                                                                                                   004341
 004342   //-------------------------------------------------------------------------------------------                      004342
 004343   BegSr subUserCvt_SCAN;                                                                                             004343
 004344                                                                                                                      004344
 004345      // Determine length of comparator.                                                                              004345
 004346      x = %scan(':':factor1);                                                                                         004346
 004347      If x = 0;   // No length specified.                                                        B01                  004347
 004348         scanLength = *Blanks;               // Scan length                                       01                  004348
 004349         scanString = %trim(factor1);        // Scan string                                       01                  004349
 004350      Else;                                                                                      X01                  004350
 004351         scanLength = %subst(factor1:x+1);   // Scan length                                       01                  004351
 004352         scanString = %subst(factor1:1:x-1); // Scan string                                       01                  004352
 004353      EndIf;                                                                                     E01                  004353
 004354                                                                                                                      004354
 004355      // Determine starting point.                                                                                    004355
 004356      x = %scan(':':factor2);                                                                                         004356
 004357      If x = 0;   // No start specified.                                                         B01                  004357
 004358         scanStart = '1';                    // Start position                                    01                  004358
 004359         scanBase = %trim(factor2);          // Base string                                       01                  004359
 004360      Else;                                                                                      X01                  004360
 004361         scanStart = %subst(factor2:x+1);    // Start position                                    01                  004361
 004362         scanBase = %subst(factor2:1:x-1);   // Base string                                       01                  004362
 004363      EndIf;                                                                                     E01                  004363
 004364                                                                                                                      004364
 004365      // Build the new line.                                                                                          004365
 004366      If scanLength = *Blanks;                                                                   B01                  004366
 004367         // No length specified.                                                                                      004367
 004368         sourceLine = '%scan(' + %trim(scanString)                                                01                  004368
 004369                    + ':' + %trim(scanBase) + ':' + %trim(scanStart)                              01                  004369
 004370                    + ')';                                                                        01                  004370
 004371      Else;                                                                                      X01                  004371
 004372         // Use a subset of the scan string.                                                                          004372
 004373         sourceLine = '%scan(%subst('                                                             01                  004373
 004374                    + %trim(scanString) + ':1:' + %trim(scanLength)                               01                  004374
 004375                    + '):' + %trim(scanBase) + ':' + %trim(scanStart)                             01                  004375
 004376                    + ')';                                                                        01                  004376
 004377      EndIf;                                                                                     E01                  004377
 004378                                                                                                                      004378
 004379      // Result specified?                                                                                            004379
 004380      If result = *Blanks;                                                                       B01                  004380
 004381         scanNoResult = *On;                                                                      01                  004381
 004382         sourceLine = 'If ' + %trimr(sourceLine) + ' = 0;';                                       01                  004382
 004383      Else;                                                                                      X01                  004383
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    136
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004384         scanNoResult = *Off;                                                                     01                  004384
 004385         sourceLine = %trim(result) + ' = ' + %trimr(sourceLine) + ';';                           01                  004385
 004386      EndIf;                                                                                     E01                  004386
 004387                                                                                                                      004387
 004388      // Set resulting indicators?                                                                                    004388
 004389      If lw <> *Blanks;                                                                          B01                  004389
 004390         ERRCheck = *On;                                                                          01                  004390
 004391         ERRInd = lw;                                                                             01                  004391
 004392      EndIf;                                                                                     E01                  004392
 004393      If eq <> *Blanks;                                                                          B01                  004393
 004394         foundCheck = *On;                                                                        01                  004394
 004395         foundInd = eq;                                                                           01                  004395
 004396      EndIf;                                                                                     E01                  004396
 004397                                                                                                                      004397
 004398      convert = *On;                                                                                                  004398
 004399                                                                                                                      004399
 004400   EndSr;                                                                                                             004400
 004401   //-------------------------------------------------------------------------------------------                      004401
 004402                                                                                                                      004402
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    137
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004404   //-------------------------------------------------------------------------------------------                      004404
 004405   // Convert SELECT                                                                                                  004405
 004406   //-------------------------------------------------------------------------------------------                      004406
 004407   BegSr subUserCvt_SELECT;                                                                                           004407
 004408                                                                                                                      004408
 004409      sourceLine = 'Select;';                                                                                         004409
 004410                                                                                                                      004410
 004411      convert = *On;                                                                                                  004411
 004412                                                                                                                      004412
 004413   EndSr;                                                                                                             004413
 004414   //-------------------------------------------------------------------------------------------                      004414
 004415                                                                                                                      004415
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    138
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004417   //-------------------------------------------------------------------------------------------                      004417
 004418   // Convert SETOFF                                                                                                  004418
 004419   //-------------------------------------------------------------------------------------------                      004419
 004420   BegSr subUserCvt_SETOFF;                                                                                           004420
 004421                                                                                                                      004421
 004422      setOff = *On;                                                                                                   004422
 004423      setOffInd1 = hi;                                                                                                004423
 004424      setOffInd2 = lw;                                                                                                004424
 004425      setOffInd3 = eq;                                                                                                004425
 004426                                                                                                                      004426
 004427      dropLine = *On;                                                                                                 004427
 004428                                                                                                                      004428
 004429      convert = *On;                                                                                                  004429
 004430                                                                                                                      004430
 004431   EndSr;                                                                                                             004431
 004432   //-------------------------------------------------------------------------------------------                      004432
 004433                                                                                                                      004433
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    139
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004435   //-------------------------------------------------------------------------------------------                      004435
 004436   // Convert SETON                                                                                                   004436
 004437   //-------------------------------------------------------------------------------------------                      004437
 004438   BegSr subUserCvt_SETON;                                                                                            004438
 004439                                                                                                                      004439
 004440      setOn = *On;                                                                                                    004440
 004441      setOnInd1 = hi;                                                                                                 004441
 004442      setOnInd2 = lw;                                                                                                 004442
 004443      setOnInd3 = eq;                                                                                                 004443
 004444                                                                                                                      004444
 004445      dropLine = *On;                                                                                                 004445
 004446                                                                                                                      004446
 004447      convert = *On;                                                                                                  004447
 004448                                                                                                                      004448
 004449   EndSr;                                                                                                             004449
 004450   //-------------------------------------------------------------------------------------------                      004450
 004451                                                                                                                      004451
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    140
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004453   //-------------------------------------------------------------------------------------------                      004453
 004454   // Convert SETxx.                                                                                                  004454
 004455   //-------------------------------------------------------------------------------------------                      004455
 004456   BegSr subUserCvt_SETxx;                                                                                            004456
 004457                                                                                                                      004457
 004458      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004458
 004459                 + %trim(factor2);                                                                                    004459
 004460      If result <> *Blanks;                                                                      B01                  004460
 004461         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004461
 004462      Else;                                                                                      X01                  004462
 004463         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004463
 004464      EndIf;                                                                                     E01                  004464
 004465                                                                                                                      004465
 004466      // Check resulting indicators.                                                                                  004466
 004467      If hi <> *Blanks;                                                                          B01                  004467
 004468         NRFCheck = *On;                                                                          01                  004468
 004469         NRFInd = hi;                                                                             01                  004469
 004470         NRFFile = %trim(factor2);                                                                01                  004470
 004471      EndIf;                                                                                     E01                  004471
 004472      If eq <> *Blanks;                                                                          B01                  004472
 004473         equalCheck = *On;                                                                        01                  004473
 004474         equalInd = eq;                                                                           01                  004474
 004475      EndIf;                                                                                     E01                  004475
 004476      If lw <> *Blanks;                                                                          B01                  004476
 004477         ERRCheck = *On;                                                                          01                  004477
 004478         ERRInd = lw;                                                                             01                  004478
 004479      EndIf;                                                                                     E01                  004479
 004480                                                                                                                      004480
 004481      convert = *On;                                                                                                  004481
 004482                                                                                                                      004482
 004483   EndSr;                                                                                                             004483
 004484   //-------------------------------------------------------------------------------------------                      004484
 004485                                                                                                                      004485
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    141
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004487   //-------------------------------------------------------------------------------------------                      004487
 004488   // Convert SHTDN                                                                                                   004488
 004489   //-------------------------------------------------------------------------------------------                      004489
 004490   BegSr subUserCvt_SHTDN;                                                                                            004490
 004491                                                                                                                      004491
 004492      sourceLine = '*IN' + hi + ' = %shtdn();';                                                                       004492
 004493                                                                                                                      004493
 004494      convert = *On;                                                                                                  004494
 004495                                                                                                                      004495
 004496   EndSr;                                                                                                             004496
 004497   //-------------------------------------------------------------------------------------------                      004497
 004498                                                                                                                      004498
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    142
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004500   //-------------------------------------------------------------------------------------------                      004500
 004501   // Convert SORTA.                                                                                                  004501
 004502   //-------------------------------------------------------------------------------------------                      004502
 004503   BegSr subUserCvt_SORTA;                                                                                            004503
 004504                                                                                                                      004504
 004505      sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                                                         004505
 004506                                                                                                                      004506
 004507      sourceLine = %trim(sourceLine)  + ';';                                                                          004507
 004508                                                                                                                      004508
 004509      convert = *On;                                                                                                  004509
 004510                                                                                                                      004510
 004511   EndSr;                                                                                                             004511
 004512   //-------------------------------------------------------------------------------------------                      004512
 004513                                                                                                                      004513
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    143
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004515   //-------------------------------------------------------------------------------------------                      004515
 004516   // Convert SQRT.                                                                                                   004516
 004517   //-------------------------------------------------------------------------------------------                      004517
 004518   BegSr subUserCvt_SQRT;                                                                                             004518
 004519                                                                                                                      004519
 004520      sourceLine = %trim(result) + ' = %sqrt(' + %trim(factor2) + ');';                                               004520
 004521                                                                                                                      004521
 004522      convert = *On;                                                                                                  004522
 004523                                                                                                                      004523
 004524   EndSr;                                                                                                             004524
 004525   //-------------------------------------------------------------------------------------------                      004525
 004526                                                                                                                      004526
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    144
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004528   //-------------------------------------------------------------------------------------------                      004528
 004529   // Convert SUB.                                                                                                    004529
 004530   //-------------------------------------------------------------------------------------------                      004530
 004531   BegSr subUserCvt_SUB;                                                                                              004531
 004532                                                                                                                      004532
 004533      // Half-adjust?                                                                                                 004533
 004534      x = %scan('H':operator:4);                                                                                      004534
 004535      If x > 0;                                                                                  B01                  004535
 004536         operator = 'SUB';                                                                        01                  004536
 004537         sourceLine = 'Eval(H)';                                                                  01                  004537
 004538      Else;                                                                                      X01                  004538
 004539         sourceLine = *Blanks;                                                                    01                  004539
 004540      EndIf;                                                                                     E01                  004540
 004541                                                                                                                      004541
 004542      If factor1 = *Blanks;                                                                      B01                  004542
 004543         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004543
 004544                    + ' = ' + %trim(result)                                                       01                  004544
 004545                    + ' - ' + %trim(factor2) +';';                                                01                  004545
 004546      Else;                                                                                      X01                  004546
 004547         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004547
 004548                    + ' = ' + %trim(factor1)                                                      01                  004548
 004549                    + ' - ' + %trim(factor2) + ';';                                               01                  004549
 004550      EndIf;                                                                                     E01                  004550
 004551                                                                                                                      004551
 004552      sourceLine = %trim(sourceLine);                                                                                 004552
 004553                                                                                                                      004553
 004554      convert = *On;                                                                                                  004554
 004555                                                                                                                      004555
 004556   EndSr;                                                                                                             004556
 004557   //-------------------------------------------------------------------------------------------                      004557
 004558                                                                                                                      004558
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    145
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004560   //-------------------------------------------------------------------------------------------                      004560
 004561   // Convert SUBDUR.                                                                                                 004561
 004562   //-------------------------------------------------------------------------------------------                      004562
 004563   BegSr subUserCvt_SUBDUR;                                                                                           004563
 004564                                                                                                                      004564
 004565      // Split out duration and code.                                                                                 004565
 004566      x = %scan(':':factor2);                                                                                         004566
 004567      If x = 0;                                                                                  B01                  004567
 004568         x = %scan(':':result);                                                                   01                  004568
 004569         If x = 0;                                                                               B02                  004569
 004570            nonConvRsn =  'No duration code specified.';                                          02                  004570
 004571            LeaveSr;                                                                              02                  004571
 004572         Else;                                                                                   X02                  004572
 004573            durNewDate = *Off;                                                                    02                  004573
 004574         EndIf;                                                                                  E02                  004574
 004575      Else;                                                                                      X01                  004575
 004576         durNewDate = *On;                                                                        01                  004576
 004577      EndIf;                                                                                     E01                  004577
 004578                                                                                                                      004578
 004579      If durNewDate;                                                                             B01                  004579
 004580         durDuration = %trim(%subst(factor2:1:x-1));                                              01                  004580
 004581         durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                  01                  004581
 004582                                                                                                                      004582
 004583         Select;                                                                                 B02                  004583
 004584            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004584
 004585               durCode = '%years';                                                                02                  004585
 004586            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004586
 004587               durCode = '%months';                                                               02                  004587
 004588            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004588
 004589               durCode = '%days';                                                                 02                  004589
 004590            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004590
 004591               durCode = '%hours';                                                                02                  004591
 004592            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004592
 004593               durCode = '%minutes';                                                              02                  004593
 004594            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004594
 004595               durCode = '%seconds';                                                              02                  004595
 004596            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004596
 004597               durCode = '%mseconds';                                                             02                  004597
 004598            Other;                                                                               X02                  004598
 004599               nonConvRsn = 'Invalid duration code specified.';                                   02                  004599
 004600               LeaveSr;                                                                           02                  004600
 004601         EndSl;                                                                                  E02                  004601
 004602                                                                                                                      004602
 004603         If factor1 = *Blanks;                                                                   B02                  004603
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    146
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004604            sourceLine = %trim(result) + ' = ' + %trim(result);                                   02                  004604
 004605         Else;                                                                                   X02                  004605
 004606            sourceLine = %trim(result) + ' = ' + %trim(factor1);                                  02                  004606
 004607         EndIf;                                                                                  E02                  004607
 004608                                                                                                                      004608
 004609         sourceLine = %trimr(sourceLine) + ' - ' + %trim(durCode)                                 01                  004609
 004610                    + '(' + %trim(durDuration) + ');';                                            01                  004610
 004611      Else;                                                                                      X01                  004611
 004612         durDuration = %trim(%subst(result:1:x-1));                                               01                  004612
 004613         durCode     = %xlate(lo:up:%trim(%subst(result:x+1)));                                   01                  004613
 004614                                                                                                                      004614
 004615         Select;                                                                                 B02                  004615
 004616            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004616
 004617            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004617
 004618            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004618
 004619            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004619
 004620            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004620
 004621            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004621
 004622            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004622
 004623            Other;                                                                               X02                  004623
 004624               nonConvRsn = 'Invalid duration code specified.';                                   02                  004624
 004625               LeaveSr;                                                                           02                  004625
 004626         EndSl;                                                                                  E02                  004626
 004627                                                                                                                      004627
 004628         sourceLine = %trim(durDuration) + ' = %diff(' + %trim(factor1)                           01                  004628
 004629                    + ':' + %trim(factor2) + ':' + %trim(durCode) + ');';                         01                  004629
 004630      EndIf;                                                                                     E01                  004630
 004631                                                                                                                      004631
 004632      // Set resulting indicators?                                                                                    004632
 004633      If lw <> *Blanks;                                                                          B01                  004633
 004634         ERRCheck = *On;                                                                          01                  004634
 004635         ERRInd = lw;                                                                             01                  004635
 004636      EndIf;                                                                                     E01                  004636
 004637                                                                                                                      004637
 004638      convert = *On;                                                                                                  004638
 004639                                                                                                                      004639
 004640   EndSr;                                                                                                             004640
 004641   //-------------------------------------------------------------------------------------------                      004641
 004642                                                                                                                      004642
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    147
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004644   //-------------------------------------------------------------------------------------------                      004644
 004645   // Convert SUBST.                                                                                                  004645
 004646   //-------------------------------------------------------------------------------------------                      004646
 004647   BegSr subUserCvt_SUBST;                                                                                            004647
 004648                                                                                                                      004648
 004649      // Pad the result?                                                                                              004649
 004650      x = %scan('P':operator:4);                                                                                      004650
 004651      If x = 0                                              // Not padding.                      B01                  004651
 004652      and factor1 <> *Blanks                                // Factor1 specified.                B01                  004652
 004653      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  004653
 004654         nonConvRsn = 'No padding specified, and factor1 and result '                             01                  004654
 004655                    + 'are not the same.';                                                        01                  004655
 004656         LeaveSr;    // Don't convert - too difficult to get right.                               01                  004656
 004657      EndIf;                                                                                     E01                  004657
 004658                                                                                                                      004658
 004659      substLen = %trim(factor1);                                                                                      004659
 004660                                                                                                                      004660
 004661      x = %scan(':':factor2);                                                                                         004661
 004662      If x = 0;                                                                                  B01                  004662
 004663         substStart = '1';                                                                        01                  004663
 004664         x = %len(%trim(factor2)) + 1;                                                            01                  004664
 004665      Else;                                                                                      X01                  004665
 004666         substStart = %subst(factor2:x+1);                                                        01                  004666
 004667      EndIf;                                                                                     E01                  004667
 004668                                                                                                                      004668
 004669      sourceLine = %trim(result) + ' = %subst('                                                                       004669
 004670                 + %subst(factor2:1:x-1) + ':'                                                                        004670
 004671                 + %trim(substStart)                                                                                  004671
 004672                 + ':' + %trim(substLen) + ');';                                                                      004672
 004673                                                                                                                      004673
 004674      // Set resulting indicators?                                                                                    004674
 004675      If lw <> *Blanks;                                                                          B01                  004675
 004676         ERRCheck = *On;                                                                          01                  004676
 004677         ERRInd = lw;                                                                             01                  004677
 004678      EndIf;                                                                                     E01                  004678
 004679                                                                                                                      004679
 004680      convert = *On;                                                                                                  004680
 004681                                                                                                                      004681
 004682   EndSr;                                                                                                             004682
 004683   //-------------------------------------------------------------------------------------------                      004683
 004684                                                                                                                      004684
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    148
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004686   //-------------------------------------------------------------------------------------------                      004686
 004687   // Convert TEST.                                                                                                   004687
 004688   //-------------------------------------------------------------------------------------------                      004688
 004689   BegSr subUserCvt_TEST;                                                                                             004689
 004690                                                                                                                      004690
 004691      If operator = 'TEST';                                                                      B01                  004691
 004692         operator = 'Test(E)';                                                                    01                  004692
 004693      EndIf;                                                                                     E01                  004693
 004694                                                                                                                      004694
 004695      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004695
 004696                 + %trim(result) + ';';                                                                               004696
 004697                                                                                                                      004697
 004698      // Set resulting indicators?                                                                                    004698
 004699      If lw <> *Blanks;                                                                          B01                  004699
 004700         ERRCheck = *On;                                                                          01                  004700
 004701         ERRInd = lw;                                                                             01                  004701
 004702      EndIf;                                                                                     E01                  004702
 004703                                                                                                                      004703
 004704      convert = *On;                                                                                                  004704
 004705                                                                                                                      004705
 004706   EndSr;                                                                                                             004706
 004707   //-------------------------------------------------------------------------------------------                      004707
 004708                                                                                                                      004708
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    149
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004710   //-------------------------------------------------------------------------------------------                      004710
 004711   // Convert TIME.                                                                                                   004711
 004712   //-------------------------------------------------------------------------------------------                      004712
 004713   BegSr subUserCvt_TIME;                                                                                             004713
 004714                                                                                                                      004714
 004715      sourceLine = %trim(result) + ' = %time();';                                                                     004715
 004716                                                                                                                      004716
 004717      convert = *On;                                                                                                  004717
 004718                                                                                                                      004718
 004719   EndSr;                                                                                                             004719
 004720   //-------------------------------------------------------------------------------------------                      004720
 004721                                                                                                                      004721
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    150
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004723   //-------------------------------------------------------------------------------------------                      004723
 004724   // Convert UNLOCK.                                                                                                 004724
 004725   //-------------------------------------------------------------------------------------------                      004725
 004726   BegSr subUserCvt_UNLOCK;                                                                                           004726
 004727                                                                                                                      004727
 004728      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004728
 004729                                                                                                                      004729
 004730      // Check indicators?                                                                                            004730
 004731      If lw <> *Blanks;                                                                          B01                  004731
 004732         ERRCheck = *On;                                                                          01                  004732
 004733         ERRInd = lw;                                                                             01                  004733
 004734      EndIf;                                                                                     E01                  004734
 004735                                                                                                                      004735
 004736      convert = *On;                                                                                                  004736
 004737                                                                                                                      004737
 004738   EndSr;                                                                                                             004738
 004739   //-------------------------------------------------------------------------------------------                      004739
 004740                                                                                                                      004740
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    151
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004742   //-------------------------------------------------------------------------------------------                      004742
 004743   // Convert UPDATE.                                                                                                 004743
 004744   //-------------------------------------------------------------------------------------------                      004744
 004745   BegSr subUserCvt_UPDATE;                                                                                           004745
 004746                                                                                                                      004746
 004747      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004747
 004748                                                                                                                      004748
 004749      // Append datastructure?                                                                                        004749
 004750      If result <> *Blanks;                                                                      B01                  004750
 004751         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004751
 004752      Else;                                                                                      X01                  004752
 004753         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004753
 004754      EndIf;                                                                                     E01                  004754
 004755                                                                                                                      004755
 004756      // Check indicators?                                                                                            004756
 004757      If lw <> *Blanks;                                                                          B01                  004757
 004758         ERRCheck = *On;                                                                          01                  004758
 004759         ERRInd = lw;                                                                             01                  004759
 004760      EndIf;                                                                                     E01                  004760
 004761                                                                                                                      004761
 004762      convert = *On;                                                                                                  004762
 004763                                                                                                                      004763
 004764   EndSr;                                                                                                             004764
 004765   //-------------------------------------------------------------------------------------------                      004765
 004766                                                                                                                      004766
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    152
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004768   //-------------------------------------------------------------------------------------------                      004768
 004769   // Convert WHEN.                                                                                                   004769
 004770   //-------------------------------------------------------------------------------------------                      004770
 004771   BegSr subUserCvt_WHEN;                                                                                             004771
 004772                                                                                                                      004772
 004773      // Returning for a multi-line IF?  Reinstate original opcode.                                                   004773
 004774      If inWhen;                                                                                 B01                  004774
 004775         operator = whenOperator;                                                                 01                  004775
 004776      EndIf;                                                                                     E01                  004776
 004777                                                                                                                      004777
 004778      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              004778
 004779                                                                                                                      004779
 004780      If operator = 'WHEN';     // Use Extended Factor2.                                         B01                  004780
 004781         If not inWhen;            // First line of IF.                                          B02                  004781
 004782            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  004782
 004783            If not inSpan;                                                                       B03                  004783
 004784               sourceLine = %trim(sourceLine) + ';';                                              03                  004784
 004785            Else;                                                                                X03                  004785
 004786               inWhen = *On;                                                                      03                  004786
 004787               inSpan = *Off;                                                                     03                  004787
 004788            EndIf;                                                                               E03                  004788
 004789         Else;                   // Second line of WHEN.                                         X02                  004789
 004790            //            sourceLine = *Blanks;                                                                       004790
 004791            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  004791
 004792            sourceLine = %trim(extFactor2);                                                       02                  004792
 004793            If not inSpan;                                                                       B03                  004793
 004794               sourceLine = %trimr(sourceLine) + ';';                                             03                  004794
 004795               //               inWhen = *Off;                                                                        004795
 004796            EndIf;                                                                               E03                  004796
 004797            inSpan = *Off;                                                                        02                  004797
 004798         EndIf;                                                                                  E02                  004798
 004799      Else;                                                                                      X01                  004799
 004800         // Fixed format.                                                                                             004800
 004801         opCode = %xlate(lo:up:opCode);                                                           01                  004801
 004802         If not inWhen;         // First line of WHEN.                                           B02                  004802
 004803            whenCompare = %subst(opCode:5:2);                                                     02                  004803
 004804            sourceLine = 'When';                                                                  02                  004804
 004805         Else;                // Second line of WHEN.                                            X02                  004805
 004806            If %subst(opCode:1:3) = 'AND';                                                       B03                  004806
 004807               whenCompare = %subst(opCode:4:2);                                                  03                  004807
 004808               sourceLine = 'And';                                                                03                  004808
 004809            Else;                                                                                X03                  004809
 004810               whenCompare = %subst(opCode:3:2);                                                  03                  004810
 004811               sourceLine = 'Or';                                                                 03                  004811
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    153
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004812            EndIf;                                                                               E03                  004812
 004813         EndIf;                                                                                  E02                  004813
 004814         If whenCompare = 'EQ';                                                                  B02                  004814
 004815            whenCompare = '=';                                                                    02                  004815
 004816         ElseIf whenCompare = 'GT';                                                              X02                  004816
 004817            whenCompare = '>';                                                                    02                  004817
 004818         ElseIf whenCompare = 'GE';                                                              X02                  004818
 004819            whenCompare = '>=';                                                                   02                  004819
 004820         ElseIf whenCompare = 'LT';                                                              X02                  004820
 004821            whenCompare = '<';                                                                    02                  004821
 004822         ElseIf whenCompare = 'LE';                                                              X02                  004822
 004823            whenCompare = '<=';                                                                   02                  004823
 004824         ElseIf whenCompare = 'NE';                                                              X02                  004824
 004825            whenCompare = '<>';                                                                   02                  004825
 004826         EndIf;                                                                                  E02                  004826
 004827         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  004827
 004828                            + ' ' + %trim(whenCompare) + ' '                                      01                  004828
 004829                            + %trim(factor2);                                                     01                  004829
 004830         If not inSpan;                                                                          B02                  004830
 004831            sourceLine = %trimr(sourceLine) + ';';                                                02                  004831
 004832            inWhen = *Off;                                                                        02                  004832
 004833         Else;                                                                                   X02                  004833
 004834            inWhen = *On;                                                                         02                  004834
 004835            inSpan = *Off;                                                                        02                  004835
 004836         EndIf;                                                                                  E02                  004836
 004837      EndIf;                                                                                     E01                  004837
 004838                                                                                                                      004838
 004839      // Multi-line IF?  Retain original opcode.                                                                      004839
 004840      If inWhen;                                                                                 B01                  004840
 004841         whenOperator = operator;                                                                 01                  004841
 004842      Else;                                                                                      X01                  004842
 004843         whenOperator = *Blanks;                                                                  01                  004843
 004844      EndIf;                                                                                     E01                  004844
 004845                                                                                                                      004845
 004846      convert = *On;                                                                                                  004846
 004847                                                                                                                      004847
 004848   EndSr;                                                                                                             004848
 004849   //-------------------------------------------------------------------------------------------                      004849
 004850                                                                                                                      004850
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    154
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004852   //-------------------------------------------------------------------------------------------                      004852
 004853   // Convert WRITE.                                                                                                  004853
 004854   //-------------------------------------------------------------------------------------------                      004854
 004855   BegSr subUserCvt_WRITE;                                                                                            004855
 004856                                                                                                                      004856
 004857      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004857
 004858                                                                                                                      004858
 004859      // Append datastructure?                                                                                        004859
 004860      If result <> *Blanks;                                                                      B01                  004860
 004861         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004861
 004862      Else;                                                                                      X01                  004862
 004863         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004863
 004864      EndIf;                                                                                     E01                  004864
 004865                                                                                                                      004865
 004866      // Check indicators?                                                                                            004866
 004867      If eq <> *Blanks;                                                                          B01                  004867
 004868         EOFCheck = *On;                                                                          01                  004868
 004869         EOFInd = eq;                                                                             01                  004869
 004870         EOFFile = %trim(factor2);                                                                01                  004870
 004871      EndIf;                                                                                     E01                  004871
 004872      If lw <> *Blanks;                                                                          B01                  004872
 004873         ERRCheck = *On;                                                                          01                  004873
 004874         ERRInd = lw;                                                                             01                  004874
 004875      EndIf;                                                                                     E01                  004875
 004876                                                                                                                      004876
 004877      convert = *On;                                                                                                  004877
 004878                                                                                                                      004878
 004879   EndSr;                                                                                                             004879
 004880   //-------------------------------------------------------------------------------------------                      004880
 004881                                                                                                                      004881
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    155
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004883   //-------------------------------------------------------------------------------------------                      004883
 004884   // Convert XFOOT.                                                                                                  004884
 004885   //-------------------------------------------------------------------------------------------                      004885
 004886   BegSr subUserCvt_XFOOT;                                                                                            004886
 004887                                                                                                                      004887
 004888      If %scan('H':operator) = 0;                                                                B01                  004888
 004889         sourceLine = %trim(result) + ' = %xfoot(' + %trim(factor2)                               01                  004889
 004890                    + ');';                                                                       01                  004890
 004891      Else;                                                                                      X01                  004891
 004892         // Half-adjust.                                                                                              004892
 004893         sourceLine = 'Eval(H) ' + %trim(result) + ' = %xfoot('                                   01                  004893
 004894                    + %trim(factor2) + ');';                                                      01                  004894
 004895      EndIf;                                                                                     E01                  004895
 004896                                                                                                                      004896
 004897      convert = *On;                                                                                                  004897
 004898                                                                                                                      004898
 004899   EndSr;                                                                                                             004899
 004900   //-------------------------------------------------------------------------------------------                      004900
 004901                                                                                                                      004901
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    156
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004903   //-------------------------------------------------------------------------------------------                      004903
 004904   // Convert XLATE.                                                                                                  004904
 004905   //-------------------------------------------------------------------------------------------                      004905
 004906   BegSr subUserCvt_XLATE;                                                                                            004906
 004907                                                                                                                      004907
 004908      //      // Pad the result?                                                                                      004908
 004909      //      x = %scan('P':operator:6);                                                                              004909
 004910      //      If x > 0;                                                                                               004910
 004911      //         padResult = *On;                                                                                     004911
 004912      //         padTarget = result;                                                                                  004912
 004913      //         // Drop the extender.                                                                                004913
 004914      //         operator = 'XLATE';                                                                                  004914
 004915      //      EndIf;                                                                                                  004915
 004916                                                                                                                      004916
 004917      // Derive from and to.                                                                                          004917
 004918      x = %scan(':':factor1);                                                                                         004918
 004919      If x = 0;                                                                                  B01                  004919
 004920         LeaveSr;    // Invalid specification - there MUST be a from and to - don't convert.      01                  004920
 004921      Else;                                                                                      X01                  004921
 004922         xlateFrom = %subst(factor1:1:x-1);                                                       01                  004922
 004923         xlateTo = %subst(factor1:x+1);                                                           01                  004923
 004924      EndIf;                                                                                     E01                  004924
 004925                                                                                                                      004925
 004926      // Check for start position.                                                                                    004926
 004927      x = %scan(':':factor2);                                                                                         004927
 004928      If x = 0;                                                                                  B01                  004928
 004929         xlateStart = *Blanks;                                                                    01                  004929
 004930         xlateBase = factor2;                                                                     01                  004930
 004931      Else;                                                                                      X01                  004931
 004932         xlateStart = %subst(factor2:x+1);                                                        01                  004932
 004933         xlateBase = %subst(factor2:1:x-1);                                                       01                  004933
 004934      EndIf;                                                                                     E01                  004934
 004935                                                                                                                      004935
 004936      // Build new line.                                                                                              004936
 004937      sourceLine = %trim(result) + ' = %xlate('                                                                       004937
 004938                 + %trim(xlateFrom) + ':' + %trim(xlateTo) + ':'                                                      004938
 004939                 + %trim(xlateBase);                                                                                  004939
 004940      If xlateStart <> *Blanks;                                                                  B01                  004940
 004941         sourceLine = %trimr(sourceLine) + ':' + %trim(xlateStart);                               01                  004941
 004942      EndIf;                                                                                     E01                  004942
 004943      sourceLine = %trimr(sourceLine) + ');';                                                                         004943
 004944                                                                                                                      004944
 004945      // Set resulting indicators?                                                                                    004945
 004946      If lw <> *Blanks;                                                                          B01                  004946
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    157
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004947         ERRCheck = *On;                                                                          01                  004947
 004948         ERRInd = lw;                                                                             01                  004948
 004949      EndIf;                                                                                     E01                  004949
 004950                                                                                                                      004950
 004951      convert = *On;                                                                                                  004951
 004952                                                                                                                      004952
 004953   EndSr;                                                                                                             004953
 004954   //-------------------------------------------------------------------------------------------                      004954
 004955                                                                                                                      004955
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    158
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004957   //-------------------------------------------------------------------------------------------                      004957
 004958   // Convert Z-ADD.                                                                                                  004958
 004959   //-------------------------------------------------------------------------------------------                      004959
 004960   BegSr subUserCvt_Z_ADD;                                                                                            004960
 004961                                                                                                                      004961
 004962      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                                                      004962
 004963                                                                                                                      004963
 004964      // Half-adjust required?                                                                                        004964
 004965      If %len(%trim(operator)) > 5;                                                              B01                  004965
 004966         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004966
 004967      EndIf;                                                                                     E01                  004967
 004968                                                                                                                      004968
 004969      convert = *On;                                                                                                  004969
 004970                                                                                                                      004970
 004971   EndSr;                                                                                                             004971
 004972   //-------------------------------------------------------------------------------------------                      004972
 004973                                                                                                                      004973
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    159
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004975   //-------------------------------------------------------------------------------------------                      004975
 004976   // Convert Z-SUB.                                                                                                  004976
 004977   //-------------------------------------------------------------------------------------------                      004977
 004978   BegSr subUserCvt_Z_SUB;                                                                                            004978
 004979                                                                                                                      004979
 004980                                                                                                                      004980
 004981      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ' * -1;';                                                 004981
 004982                                                                                                                      004982
 004983      // Half-adjust required?                                                                                        004983
 004984      If %len(%trim(operator)) > 5;                                                              B01                  004984
 004985         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004985
 004986      EndIf;                                                                                     E01                  004986
 004987                                                                                                                      004987
 004988      convert = *On;                                                                                                  004988
 004989                                                                                                                      004989
 004990   EndSr;                                                                                                             004990
 004991   //-------------------------------------------------------------------------------------------                      004991
 004992                                                                                                                      004992
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    160
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004994   //-------------------------------------------------------------------------------------------                      004994
 004995   // Check if the next line is a continuation of the current line.                                                   004995
 004996   //-------------------------------------------------------------------------------------------                      004996
 004997   BegSr subUserCheckSpan;                                                                                            004997
 004998                                                                                                                      004998
 004999      inspan = *Off;                                                                                                  004999
 005000      savedSRCDTA = SRCDTA;                                                                                           005000
 005001      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005001
 005002      x = 0;                                                                                                          005002
 005003                                                                                                                      005003
 005004      // Is the current line a continuation line?                                                                     005004
 005005      If savedLineType = 'D';                                                                    B01                  005005
 005006         If declName <> *Blanks;                                                                 B02                  005006
 005007            If %scan('...':%trim(declOptions)) > 0;                                              B03                  005007
 005008               // Yes - so we must be in a span.                                                                      005008
 005009               inSpan = *On;                                                                      03                  005009
 005010            EndIf;                                                                               E03                  005010
 005011         EndIf;                                                                                  E02                  005011
 005012      EndIf;                                                                                     E01                  005012
 005013                                                                                                                      005013
 005014      If not inSpan;                                                                             B01                  005014
 005015         Read SRCREC;                                                                             01                  005015
 005016         DoW not %eof();                                                                         B02                  005016
 005017            x += 1;     // Keep a track of how many lines we have read.                           02                  005017
 005018                                                                                                                      005018
 005019            lineType = %xlate(lo:up:lineType);                                                    02                  005019
 005020                                                                                                                      005020
 005021            If lineType <> *Blank                                                                B03                  005021
 005022            and lineType <> savedLineType;                                                       B03                  005022
 005023               // Not a spanned line.                                                                                 005023
 005024               Leave;                                                                             03                  005024
 005025                                                                                                                      005025
 005026            ElseIf lineType = 'D'                                                                X03                  005026
 005027            and %subst(directive:1:1) <> '*';                       // D-spec and no comment     X03                  005027
 005028               If declName = *Blanks                                                             B04                  005028
 005029               and declType = *Blanks                                                            B04                  005029
 005030               and declLen = *Blanks                                                             B04                  005030
 005031               and declKeyWords <> *Blanks;                                                      B04                  005031
 005032                  //               and ((declType <> *Blanks and workDeclType = *Blanks)                              005032
 005033                  //                    or (declType <> *Blanks and declType <> workDeclType)                         005033
 005034                  //                    or (declType = *Blanks and declKeyWords <> *Blanks));                         005034
 005035                  inSpan = *On;                                                                   04                  005035
 005036               EndIf;                                                                            E04                  005036
 005037               Leave;                                                                             03                  005037
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    161
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005038                                                                                                                      005038
 005039            ElseIf lineType = 'P'                                                                X03                  005039
 005040            and %subst(directive:1:1) <> '*';                       // P-spec and no comment     X03                  005040
 005041               If declName = *Blanks                                                             B04                  005041
 005042               and (procType <> *Blanks or procKeyWords <> *Blanks);                             B04                  005042
 005043                  inSpan = *On;                                                                   04                  005043
 005044               EndIf;                                                                            E04                  005044
 005045               Leave;                                                                             03                  005045
 005046                                                                                                                      005046
 005047            ElseIf lineType = 'H'                                                                X03                  005047
 005048            and %subst(directive:1:1) = *Blank;                     // H-spec and no comment     X03                  005048
 005049               inSpan = *On;                                                                      03                  005049
 005050               Leave;                                                                             03                  005050
 005051                                                                                                                      005051
 005052            ElseIf lineType = 'C'                                                                X03                  005052
 005053            and %subst(directive:1:1) = *Blank;                      // C-spec and no comment    X03                  005053
 005054               opCode = %xlate(lo:up:opCode);                                                     03                  005054
 005055               If %subst(operator:1:4) = 'EVAL';                                                 B04                  005055
 005056                  If opCode = *Blanks and extFactor2 <> *Blanks;     // EVAL continues.          B05                  005056
 005057                     inSpan = *On;                                                                05                  005057
 005058                  EndIf;                                                                         E05                  005058
 005059                  Leave;                                                                          04                  005059
 005060               ElseIf %subst(operator:1:6) = 'CALLP';                                            X04                  005060
 005061                  If opCode = *Blanks;                               // CALLP continues.         B05                  005061
 005062                     inSpan = *On;                                                                05                  005062
 005063                  EndIf;                                                                         E05                  005063
 005064                  Leave;                                                                          04                  005064
 005065               ElseIf operator = 'IF';                               // IF Continues.            X04                  005065
 005066                  If opCode = *Blanks;                                                           B05                  005066
 005067                     inSpan = *On;                                                                05                  005067
 005068                  EndIf;                                                                         E05                  005068
 005069                  Leave;                                                                          04                  005069
 005070               ElseIf %subst(operator:1:2) = 'IF';                   // IF Continues.            X04                  005070
 005071                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005071
 005072                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005072
 005073                  or opCode = *Blanks;                                                           B05                  005073
 005074                     inSpan = *On;                                                                05                  005074
 005075                  EndIf;                                                                         E05                  005075
 005076                  Leave;                                                                          04                  005076
 005077               ElseIf %subst(operator:1:2) = 'DO';                   // DO Continues.            X04                  005077
 005078                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005078
 005079                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005079
 005080                  or opCode = *Blanks;                                                           B05                  005080
 005081                     inSpan = *On;                                                                05                  005081
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    162
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005082                  EndIf;                                                                         E05                  005082
 005083                  Leave;                                                                          04                  005083
 005084               ElseIf %subst(operator:1:4) = 'WHEN';                 // WHEN Continues.          X04                  005084
 005085                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005085
 005086                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005086
 005087                  or opCode = *Blanks;                                                           B05                  005087
 005088                     inSpan = *On;                                                                05                  005088
 005089                  EndIf;                                                                         E05                  005089
 005090                  Leave;                                                                          04                  005090
 005091               EndIf;                                                                            E04                  005091
 005092                                                                                                                      005092
 005093            ElseIf lineType = 'C'                                                                X03                  005093
 005094            and %subst(directive:1:1) = '+';                        // Embedded SQL              X03                  005094
 005095               inSpan = *On;                                                                      03                  005095
 005096               Leave;                                                                             03                  005096
 005097                                                                                                                      005097
 005098            ElseIf lineType = 'F'                                                                X03                  005098
 005099            and %subst(directive:1:1) <> '*';                       // F-spec and no comment     X03                  005099
 005100               If fileName = *Blanks and fileKeyWords <> *Blanks;                                B04                  005100
 005101                  inSpan = *On;                                                                   04                  005101
 005102               EndIf;                                                                            E04                  005102
 005103               Leave;                                                                             03                  005103
 005104                                                                                                                      005104
 005105            ElseIf %subst(directive:1:1) = '/';          // Directive, so line must end here.    X03                  005105
 005106               Leave;                                                                             03                  005106
 005107               //            ElseIf lineType = ' '                                                                    005107
 005108               //            and opCode <> *Blanks;                                                                   005108
 005109             //               Leave;                                       // Free-format line.                       005109
 005110            EndIf;                                                                               E03                  005110
 005111                                                                                                                      005111
 005112            Read SRCREC;                                                                          02                  005112
 005113         EndDo;                                                                                  E02                  005113
 005114      EndIf;                                                                                     E01                  005114
 005115                                                                                                                      005115
 005116      // End of file breaks the logic!  We need to reposition to the last record before                               005116
 005117      // continuing.                                                                                                  005117
 005118      If %eof(QRPGLESRC);                                                                        B01                  005118
 005119         SetGT *HIVAL SRCREC;                                                                     01                  005119
 005120         ReadP SRCREC;                                                                            01                  005120
 005121      EndIf;                                                                                     E01                  005121
 005122                                                                                                                      005122
 005123      // Return to the previous point.                                                                                005123
 005124      For i = 1 to x;                                                                            B01                  005124
 005125         ReadP SRCREC;                                                                            01                  005125
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    163
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005126      EndFor;                                                                                    E01                  005126
 005127                                                                                                                      005127
 005128      SRCDTA = savedSRCDTA;                                                                                           005128
 005129                                                                                                                      005129
 005130   EndSr;                                                                                                             005130
 005131   //-------------------------------------------------------------------------------------------                      005131
 005132                                                                                                                      005132
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    164
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005134   //-------------------------------------------------------------------------------------------                      005134
 005135   // Get the type of declaration encountered - it may not be on the current line!                                    005135
 005136   //-------------------------------------------------------------------------------------------                      005136
 005137   BegSr subUserGetDeclarationType;                                                                                   005137
 005138                                                                                                                      005138
 005139      // Start with what we've got.                                                                                   005139
 005140      If declSuffix  = ' '                                                                       B01                  005140
 005141      and (declPrefix = ' '                                                                      B01                  005141
 005142      or declPrefix = 'U' or declPrefix = 'S');                                                  B01                  005142
 005143         workDeclType = %xlate(lo:up:declType);                                                   01                  005143
 005144         savedName = %trim(declName);                                                             01                  005144
 005145      Else;                                                                                      X01                  005145
 005146         workDeclType = *Blank;                                                                   01                  005146
 005147         savedName = %trim(%subst(fullLine:1:74));                                                01                  005147
 005148      EndIf;                                                                                     E01                  005148
 005149                                                                                                                      005149
 005150      // If we already have the declaration type, then stop.                                                          005150
 005151      If workDeclType = 'S'                                                                      B01                  005151
 005152      or workDeclType = 'DS'                                                                     B01                  005152
 005153      or workDeclType = 'C'                                                                      B01                  005153
 005154      or workDeclType = 'B'                                                                      B01                  005154
 005155      or workDeclType = 'E'                                                                      B01                  005155
 005156      or workDeclType = 'PR'                                                                     B01                  005156
 005157      or workDeclType = 'PI'                                                                     B01                  005157
 005158      or workDeclType = *Blanks and inPrototype;                                                 B01                  005158
 005159         workDeclLine = SRCSEQ;                                                                   01                  005159
 005160         LeaveSr;                                                                                 01                  005160
 005161      EndIf;                                                                                     E01                  005161
 005162                                                                                                                      005162
 005163      savedSRCDTA = SRCDTA;                                                                                           005163
 005164      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005164
 005165      x = 0;                                                                                                          005165
 005166      workDeclLine = 0;                                                                                               005166
 005167                                                                                                                      005167
 005168      //      // Name of the variable/routine should be on this line.                                                 005168
 005169      //      savedName = %trim(declOptions);                                                                         005169
 005170                                                                                                                      005170
 005171      // Trim any ellipsis from the name as this is not valid in free-form.                                           005171
 005172      x = %scan('...':savedName);                                                                                     005172
 005173      If x > 0;                                                                                  B01                  005173
 005174         savedName = %subst(savedName:1:x-1);                                                     01                  005174
 005175         x = 0;                                                                                   01                  005175
 005176      EndIf;                                                                                     E01                  005176
 005177                                                                                                                      005177
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    165
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005178      // Read ahead to find the next line with a declaration type.                                                    005178
 005179      Read SRCREC;                                                                                                    005179
 005180      DoW not %eof();                                                                            B01                  005180
 005181         x += 1;     // Keep a track of how many lines we have read.                              01                  005181
 005182                                                                                                                      005182
 005183         lineType = %xlate(lo:up:lineType);                                                       01                  005183
 005184                                                                                                                      005184
 005185         If lineType <> savedLineType;                                                           B02                  005185
 005186            // End of this declaration.                                                                               005186
 005187            Leave;                                                                                02                  005187
 005188         EndIf;                                                                                  E02                  005188
 005189                                                                                                                      005189
 005190         If declType <> *Blanks;                                                                 B02                  005190
 005191            workDeclType = %xlate(lo:up:declType);                                                02                  005191
 005192            workDeclLine = SRCSEQ;                                                                02                  005192
 005193            Leave;                                                                                02                  005193
 005194         EndIf;                                                                                  E02                  005194
 005195                                                                                                                      005195
 005196         Read SRCREC;                                                                             01                  005196
 005197      EndDo;                                                                                     E01                  005197
 005198                                                                                                                      005198
 005199      // End of file breaks the logic!  We need to reposition to the last record before                               005199
 005200      // continuing.                                                                                                  005200
 005201      If %eof(QRPGLESRC);                                                                        B01                  005201
 005202         SetGT *HIVAL SRCREC;                                                                     01                  005202
 005203         ReadP SRCREC;                                                                            01                  005203
 005204      EndIf;                                                                                     E01                  005204
 005205                                                                                                                      005205
 005206      // Return to the previous point.                                                                                005206
 005207      For i = 1 to x;                                                                            B01                  005207
 005208         ReadP SRCREC;                                                                            01                  005208
 005209      EndFor;                                                                                    E01                  005209
 005210                                                                                                                      005210
 005211      SRCDTA = savedSRCDTA;                                                                                           005211
 005212                                                                                                                      005212
 005213   EndSr;                                                                                                             005213
 005214   //-------------------------------------------------------------------------------------------                      005214
 005215                                                                                                                      005215
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    166
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005217   //-------------------------------------------------------------------------------------------                      005217
 005218   // Get the line number at which the current structure ends.                                                        005218
 005219   //-------------------------------------------------------------------------------------------                      005219
 005220   BegSr subUserGetEndLine;                                                                                           005220
 005221                                                                                                                      005221
 005222      savedSRCDTA = SRCDTA;                                                                                           005222
 005223      endLine = 0;                                                                                                    005223
 005224      endFound = *Off;                                                                                                005224
 005225                                                                                                                      005225
 005226      // Read ahead to find the start of the next declaration.                                                        005226
 005227      Read SRCREC;                                                                                                    005227
 005228      x = 1;                                                                                                          005228
 005229      DoW not %eof();                                                                            B01                  005229
 005230         If lineType <> *Blanks                                                                  B02                  005230
 005231         and %xlate(lo:up:lineType) <> workLineType;                                             B02                  005231
 005232            // We've found a different line type.                                                                     005232
 005233            Leave;                                                                                02                  005233
 005234         Else;                                                                                   X02                  005234
 005235            If %len(%trim(codeLine)) >= 4;                                                       B03                  005235
 005236               If %xlate(lo:up:%subst(codeLine:1:4)) = 'DCL-';                                   B04                  005236
 005237                  // We've found a different line type.                                                               005237
 005238                  Leave;                                                                          04                  005238
 005239               EndIf;                                                                            E04                  005239
 005240            EndIf;                                                                               E03                  005240
 005241         EndIf;                                                                                  E02                  005241
 005242                                                                                                                      005242
 005243         If codeLine = *Blanks;                                                                  B02                  005243
 005244            // Ignore empty lines.                                                                                    005244
 005245   //      ElseIf %subst(directive:1:1) = '/';                                                                        005245
 005246   //         // Ignore directives.                                                                                   005246
 005247         ElseIf %subst(directive:2:1) = '*'                                                      X02                  005247
 005248             or %len(%trim(codeLine)) >= 2                                                       X02                  005248
 005249            and %subst(%trim(codeLine):1:2) = '//';                                              X02                  005249
 005250            // Ignore comment.                                                                                        005250
 005251         ElseIf inSpan                                                                           X02                  005251
 005252            and declName = *Blanks                                                               X02                  005252
 005253            and SRCSEQ = workDeclLine;                                                           X02                  005253
 005254            // Ignore the curent declaration.                                                                         005254
 005255         ElseIf declType = *Blanks                                                               X02                  005255
 005256            and (declLen <> *Blanks or declKeywords <> *Blanks);                                 X02                  005256
 005257            // Ignore sub-field definition.                                                                           005257
 005258         ElseIf declType = *Blanks                                                               X02                  005258
 005259            and declName <> *Blanks                                                              X02                  005259
 005260            and %scan('...':declOptions) = 0;                                                    X02                  005260
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    167
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005261            // Ignore sub-field definition.                                                                           005261
 005262         ElseIf %scan('...':declOptions) > 0;                                                    X02                  005262
 005263            // We have a continuation line, but is it a sub-field or a new                                            005263
 005264            // delcaration?                                                                                           005264
 005265            GetDeclarationType(tempDeclType                                                       02                  005265
 005266                              :tempSavedName                                                      02                  005266
 005267                              :tempDeclLine);                                                     02                  005267
 005268            If tempDeclType <> *Blanks;                                                          B03                  005268
 005269               // We've hit the next declaration or code.                                                             005269
 005270               Leave;                                                                             03                  005270
 005271            EndIf;                                                                               E03                  005271
 005272         Else;                                                                                   X02                  005272
 005273            // We've hit the next declaration or code.                                                                005273
 005274            Leave;                                                                                02                  005274
 005275         EndIf;                                                                                  E02                  005275
 005276                                                                                                                      005276
 005277         Read SRCREC;                                                                             01                  005277
 005278         x += 1;     // Keep a track of how many lines we have read.                              01                  005278
 005279      EndDo;                                                                                     E01                  005279
 005280                                                                                                                      005280
 005281      // We are now at the start of the next declaration.                                                             005281
 005282      endLine = SRCSEQ;                                                                                               005282
 005283                                                                                                                      005283
 005284      // End of file breaks the logic!  We need to reposition to the last record before                               005284
 005285      // continuing.                                                                                                  005285
 005286      If %eof(QRPGLESRC);                                                                        B01                  005286
 005287         SetGT *HIVAL SRCREC;                                                                     01                  005287
 005288         //ReadP SRCREC;                                                                                              005288
 005289      EndIf;                                                                                     E01                  005289
 005290                                                                                                                      005290
 005291      // Return to the previous point.                                                                                005291
 005292      For i = 1 to x;                                                                            B01                  005292
 005293         ReadP SRCREC;                                                                            01                  005293
 005294                                                                                                                      005294
 005295         // Move the end point for blank lines or comments.                                                           005295
 005296         If not endFound;                                                                        B02                  005296
 005297            If (lineType = *Blanks                                                               B03                  005297
 005298            or %subst(directive:1:1) = '*'                                                       B03                  005298
 005299            or %subst(directive:1:2) = '//'                                                      B03                  005299
 005300            or (%len(%trim(codeLine)) > 0                                                        B03                  005300
 005301            and %subst(%trim(codeLine):1:2) = '//'));                                            B03                  005301
 005302               //            and %subst(directive:1:1) <> '/';                                                        005302
 005303            Else;                                                                                X03                  005303
 005304               endFound = *On;                                                                    03                  005304
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    168
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005305               endLine = SRCSEQ;                                                                  03                  005305
 005306            EndIf;                                                                               E03                  005306
 005307         EndIf;                                                                                  E02                  005307
 005308      EndFor;                                                                                    E01                  005308
 005309                                                                                                                      005309
 005310      SRCDTA = savedSRCDTA;                                                                                           005310
 005311                                                                                                                      005311
 005312   EndSr;                                                                                                             005312
 005313   //-------------------------------------------------------------------------------------------                      005313
 005314                                                                                                                      005314
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    169
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005316   //-------------------------------------------------------------------------------------------                      005316
 005317   // Move field definitions to D-specs.                                                                              005317
 005318   //-------------------------------------------------------------------------------------------                      005318
 005319   BegSr subUserMoveDefs;                                                                                             005319
 005320                                                                                                                      005320
 005321      codeStart = SRCSEQ;   // Save the start of the source.                                                          005321
 005322      savedSRCDTA = SRCDTA;                                                                                           005322
 005323                                                                                                                      005323
 005324      Clear movedDefs;                                                                                                005324
 005325      Reset DCLS;                                                                                                     005325
 005326                                                                                                                      005326
 005327      // Read through the source and create a D-spec for every field definition found.                                005327
 005328      DoW not %eof(QRPGLESRC);                                                                   B01                  005328
 005329         // Stop if we hit either the start or end of a procedure (to preserve local                                  005329
 005330         // definitions of variables).                                                                                005330
 005331         If lineType = 'P'                                                                       B02                  005331
 005332         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005332
 005333                                                      = 'DCL-PROC'                               B02                  005333
 005334         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005334
 005335                                                      = 'END-PROC';                              B02                  005335
 005336            Leave;                                                                                02                  005336
 005337         EndIf;                                                                                  E02                  005337
 005338                                                                                                                      005338
 005339         If %xlate(lo:up:lineType) = 'C'                                                         B02                  005339
 005340         and %subst(directive:1:1) = ' ';                                                        B02                  005340
 005341            opCode = %xlate(lo:up:opCode);                                                        02                  005341
 005342            // C-Spec with a size definition.                                                                         005342
 005343            If opCode <> *Blanks                                                                 B03                  005343
 005344            and %subst(opCode:1:4) <> 'EVAL'                                                     B03                  005344
 005345            and opCode <> 'IF'                                                                   B03                  005345
 005346            and opCode <> 'WHEN'                                                                 B03                  005346
 005347            and opCode <> 'DOW'                                                                  B03                  005347
 005348            and opCode <> 'DOU'                                                                  B03                  005348
 005349            and opCode <> 'DSPLY'                                                                B03                  005349
 005350            and opCode <> 'CALLP'                                                                B03                  005350
 005351            and (len <> *Blanks or opCode = 'DEFINE');                                           B03                  005351
 005352               moveDef = *Off;                                                                    03                  005352
 005353               // Only do if not already moved.                                                                       005353
 005354               If %lookup(%xlate(lo:up:result):movedDefs) = 0;                                   B04                  005354
 005355                  Reset DCLS;                                                                     04                  005355
 005356                  // In-line definition.                                                                              005356
 005357                  If len <> *Blanks                                                              B05                  005357
 005358                  and %scan('+':len) = 0 and %scan('-':len) = 0;                                 B05                  005358
 005359                     moveDef = *On;                                                               05                  005359
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    170
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005360                     DCLS.fieldName = result;                                                     05                  005360
 005361                     If dec = *Blanks;                                                           B06                  005361
 005362                        DCLS.type = '     Char';                                                  06                  005362
 005363                     Else;                                                                       X06                  005363
 005364                        DCLS.type = '   Packed';                                                  06                  005364
 005365                     EndIf;                                                                      E06                  005365
 005366                     DCLS.definition = '(' + %trim(len);                                          05                  005366
 005367                     If dec <> *Blanks;                                                          B06                  005367
 005368                        DCLS.definition = %trimr(DCLS.definition)                                 06                  005368
 005369                                        + ':' + %trim(dec);                                       06                  005369
 005370                     EndIf;                                                                      E06                  005370
 005371                     DCLS.definition = %trimr(DCLS.definition) + ')';                             05                  005371
 005372                  EndIf;                                                                         E05                  005372
 005373                                                                                                                      005373
 005374                  // *LIKE Definition                                                                                 005374
 005375                  If %xlate(lo:up:opCode) = 'DEFINE';                                            B05                  005375
 005376                     moveDef = *On;                                                               05                  005376
 005377                     DCLS.fieldName = result;                                                     05                  005377
 005378                     If %xlate(lo:up:factor1) = '*LIKE';                                         B06                  005378
 005379                        %subst(DCLS.definition:8)                                                 06                  005379
 005380                                    = 'LIKE(' + %trimr(factor2);                                  06                  005380
 005381                        // Length adjustment?                                                                         005381
 005382                        If %scan('+':len) > 0 or %scan('-':len) > 0;                             B07                  005382
 005383                           len = %scanrpl(' ':'':len);                                            07                  005383
 005384                           DCLS.definition = %trimr(DCLS.definition)                              07                  005384
 005385                                           + ':' + %trim(len);                                    07                  005385
 005386                        EndIf;                                                                   E07                  005386
 005387                        DCLS.definition = %trimr(DCLS.definition) + ')';                          06                  005387
 005388                     Else;                                                                       X06                  005388
 005389                        If %xlate(lo:up:%trim(factor2)) = '*LDA';                                B07                  005389
 005390                           DCLS.definition = %trimr(DCLS.definition)                              07                  005390
 005391                                 + ' DTAARA(' + %trimr(factor2) + ')';                            07                  005391
 005392                        Else;                                                                    X07                  005392
 005393                           DCLS.definition = %trimr(DCLS.definition)                              07                  005393
 005394                             + ' DTAARA(''' + %trimr(factor2) + ''')';                            07                  005394
 005395                        EndIf;                                                                   E07                  005395
 005396                     EndIf;                                                                      E06                  005396
 005397                  EndIf;                                                                         E05                  005397
 005398                                                                                                                      005398
 005399                  If moveDef;                                                                    B05                  005399
 005400                     // Put any additional keywords needed here!                                                      005400
 005401                     DCLS.definition = %trimr(DCLS.definition) + ';';                             05                  005401
 005402                     If comment <> *Blanks;                                                      B06                  005402
 005403                        DCLS.comment = '// ' + comment;                                           06                  005403
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    171
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005404                     EndIf;                                                                      E06                  005404
 005405                                                                                                                      005405
 005406                     // Store the moved definition.                                                                   005406
 005407                     x = %lookup(' ':movedDefs);                                                  05                  005407
 005408                     movedDefs(x) = %xlate(lo:up:result);                                         05                  005408
 005409                  EndIf;                                                                         E05                  005409
 005410               EndIf;                                                                            E04                  005410
 005411            EndIf;                                                                               E03                  005411
 005412         EndIf;                                                                                  E02                  005412
 005413                                                                                                                      005413
 005414         // Anything to output?                                                                                       005414
 005415         If DCLS.fieldName <> *Blanks;                                                           B02                  005415
 005416            DCLS.decl = 'Dcl-S ';                                                                 02                  005416
 005417            If not defsMoved;                                                                    B03                  005417
 005418               // Log start of moved field block;                                                                     005418
 005419               SRCDTA = *Blanks;                                                                  03                  005419
 005420               codeLine = Qcomments(1);                                                           03                  005420
 005421               Exsr subUserWriteLine;                                                             03                  005421
 005422               codeLine = Qcomments(2);                                                           03                  005422
 005423               Exsr subUserWriteLine;                                                             03                  005423
 005424               codeLine = Qcomments(1);                                                           03                  005424
 005425               Exsr subUserWriteLine;                                                             03                  005425
 005426               defsMoved = *On;                                                                   03                  005426
 005427            EndIf;                                                                               E03                  005427
 005428                                                                                                                      005428
 005429            lineType = ' ';                                                                       02                  005429
 005430            codeLine = DCLS;                                                                      02                  005430
 005431            countMoved += 1;                                                                      02                  005431
 005432            Clear DCLS.fieldName;                                                                 02                  005432
 005433                                                                                                                      005433
 005434            Exsr subUserWriteLine;                                                                02                  005434
 005435         EndIf;                                                                                  E02                  005435
 005436                                                                                                                      005436
 005437         Read QRPGLESRC;                                                                          01                  005437
 005438      EndDo;                                                                                     E01                  005438
 005439                                                                                                                      005439
 005440      If defsMoved;                                                                              B01                  005440
 005441         // Log end of moved field block;                                                                             005441
 005442         SRCDTA = *Blanks;                                                                        01                  005442
 005443         codeLine = Qcomments(1);                                                                 01                  005443
 005444         Exsr subUserWriteLine;                                                                   01                  005444
 005445         codeLine = Qcomments(3);                                                                 01                  005445
 005446         Exsr subUserWriteLine;                                                                   01                  005446
 005447         codeLine = Qcomments(1);                                                                 01                  005447
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    172
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005448         Exsr subUserWriteLine;                                                                   01                  005448
 005449      EndIf;                                                                                     E01                  005449
 005450                                                                                                                      005450
 005451      // Reposition source file pointer to the start of the source again.                                             005451
 005452      Close QRPGLESRC;                                                                                                005452
 005453      Open QRPGLESRC;                                                                                                 005453
 005454      Read SRCREC;                                                                                                    005454
 005455      DoW SRCSEQ <> codeStart;                                                                   B01                  005455
 005456         Read SRCREC;                                                                             01                  005456
 005457      EndDo;                                                                                     E01                  005457
 005458                                                                                                                      005458
 005459      defsMoved = *On;                                                                                                005459
 005460      SRCDTA = savedSRCDTA;                                                                                           005460
 005461                                                                                                                      005461
 005462   EndSr;                                                                                                             005462
 005463   //-------------------------------------------------------------------------------------------                      005463
 005464                                                                                                                      005464
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    173
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005466   //-------------------------------------------------------------------------------------------                      005466
 005467   // Output the current line.                                                                                        005467
 005468   //-------------------------------------------------------------------------------------------                      005468
 005469   BegSr subUserWriteLine;                                                                                            005469
 005470                                                                                                                      005470
 005471      countTarget += 1;                                                                                               005471
 005472                                                                                                                      005472
 005473      Write OUTREC;                                                                                                   005473
 005474      //Except OUTREC;                                                                                                005474
 005475                                                                                                                      005475
 005476   EndSr;                                                                                                             005476
 005477   //-------------------------------------------------------------------------------------------                      005477
 005478                                                                                                                      005478
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    174
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005480   //-------------------------------------------------------------------------------------------                      005480
 005481   // Exit the program directly.                                                                                      005481
 005482   //-------------------------------------------------------------------------------------------                      005482
 005483   BegSr subExitProgram;                                                                                              005483
 005484                                                                                                                      005484
 005485      Exsr subUserExitProgram;     // Perform any user-specified exit processing.                                     005485
 005486                                                                                                                      005486
 005487      // If commitment control is active, a commit should have been done if everything                                005487
 005488      // was OK, so issue a rollback here to catch and remove any uncommitted changes.                                005488
 005489      If cfgCommitControl = '*MASTER';                                                           B01                  005489
 005490         RolBk;                                                                                   01                  005490
 005491      EndIf;                                                                                     E01                  005491
 005492                                                                                                                      005492
 005493      If cfgCloseDown = 'Y';                                                                     B01                  005493
 005494         *INLR = *On;                  // Close down the program.                                 01                  005494
 005495      EndIf;                                                                                     E01                  005495
 005496                                                                                                                      005496
 005497      Return;                          // Exit the program.                                                           005497
 005498                                                                                                                      005498
 005499   EndSr;                                                                                                             005499
 005500   //-------------------------------------------------------------------------------------------                      005500
 005501                                                                                                                      005501
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    175
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005503   //-------------------------------------------------------------------------------------------                      005503
 005504   // USER: Exit processing.                                                                                          005504
 005505   //-------------------------------------------------------------------------------------------                      005505
 005506   BegSr subUserExitProgram;                                                                                          005506
 005507                                                                                                                      005507
 005508      // ** Place any program-specific exit code here.                                                                005508
 005509      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005509
 005510                                                                                                                      005510
 005511      If QpShutDown <> 'Y';                                                                      B01                  005511
 005512         Close QRPGLESRC;                                                                         01                  005512
 005513         Close QRPGLESRC2;                                                                        01                  005513
 005514      EndIf;                                                                                     E01                  005514
 005515                                                                                                                      005515
 005516      If QpShutDown = 'Y' and initialCall <> 'Y';                                                B01                  005516
 005517         cfgCloseDown = 'Y';                                                                      01                  005517
 005518         Write Z1ENDRPT;                                                                          01                  005518
 005519         Close CVTRPGFREP;                                                                        01                  005519
 005520      EndIf;                                                                                     E01                  005520
 005521                                                                                                                      005521
 005522      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005522
 005523                                                                                                                      005523
 005524   EndSr;                                                                                                             005524
 005525   //-------------------------------------------------------------------------------------------                      005525
 005526                                                                                                                      005526
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    176
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005528   //-------------------------------------------------------------------------------------------                      005528
 005529   // Initialisation                                                                                                  005529
 005530   //-------------------------------------------------------------------------------------------                      005530
 005531   BegSr subInitialise;                                                                                               005531
 005532                                                                                                                      005532
 005533      // Flag initial call.                                                                                           005533
 005534      If initialCall = *Blank;                                                                   B01                  005534
 005535         initialCall = 'Y';                                                                       01                  005535
 005536      Else;                                                                                      X01                  005536
 005537         initialCall = 'N';                                                                       01                  005537
 005538      EndIf;                                                                                     E01                  005538
 005539                                                                                                                      005539
 005540      // Perform user-specified intialisation processing.                                                             005540
 005541      Exsr subUserInitialise;                                                                                         005541
 005542                                                                                                                      005542
 005543   EndSr;                                                                                                             005543
 005544   //-------------------------------------------------------------------------------------------                      005544
 005545                                                                                                                      005545
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    177
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005547   //-------------------------------------------------------------------------------------------                      005547
 005548   // USER: Initialisation                                                                                            005548
 005549   //-------------------------------------------------------------------------------------------                      005549
 005550   BegSr subUserInitialise;                                                                                           005550
 005551                                                                                                                      005551
 005552      // Set configuration/processing options:                                                                        005552
 005553      cfgCommitControl   = '*NONE  '; // Commitment control setting: *MASTER/*SLAVE                                   005553
 005554      cfgCloseDown       = 'N';       // Close down the program on exit?                                              005554
 005555                                                                                                                      005555
 005556                                                                                                                      005556
 005557      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005557
 005558                                                                                                                      005558
 005559      // Shut down?                                                                                                   005559
 005560      If QpShutDown = 'Y';                                                                       B01                  005560
 005561         Exsr subExitProgram;                                                                     01                  005561
 005562      EndIf;                                                                                     E01                  005562
 005563                                                                                                                      005563
 005564      // Open audit report.                                                                                           005564
 005565      If initialCall = 'Y';                                                                      B01                  005565
 005566         Open CVTRPGFREP;                                                                         01                  005566
 005567         Z1QTTL = 'RPG/ILE to Free-Format Conversion Report';                                     01                  005567
 005568         overflow = *On;                                                                          01                  005568
 005569      EndIf;                                                                                     E01                  005569
 005570                                                                                                                      005570
 005571      fromFileLib = %trim(QpFromLib) + '/' + %trim(QpFromFile);                                                       005571
 005572      Open QRPGLESRC;                                                                                                 005572
 005573                                                                                                                      005573
 005574      toFileLib = %trim(QpToLib) + '/' + %trim(QpToFile);                                                             005574
 005575      Open QRPGLESRC2;                                                                                                005575
 005576                                                                                                                      005576
 005577      Reset countSource;                                                                                              005577
 005578      Reset countTarget;                                                                                              005578
 005579      Reset countEligible;                                                                                            005579
 005580      Reset countConv;                                                                                                005580
 005581      Reset CountNotConv;                                                                                             005581
 005582                                                                                                                      005582
 005583      Reset maxIndent;                                                                                                005583
 005584      Reset movedDefs;                                                                                                005584
 005585      Reset moveDef;                                                                                                  005585
 005586      Reset inCode;                                                                                                   005586
 005587      Reset inArrayData;                                                                                              005587
 005588      Reset indentCount;                                                                                              005588
 005589                                                                                                                      005589
 005590      indentCount = mainlineIndent;                                                                                   005590
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    178
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005591                                                                                                                      005591
 005592      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005592
 005593                                                                                                                      005593
 005594   EndSr;                                                                                                             005594
 005595   //-------------------------------------------------------------------------------------------                      005595
 005596   //===========================================================================================                      005596
 005597                                                                                                                      005597
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    179
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005599   //==========================================================================================                       005599
 005600   // Get the type of declaration encountered - it may not be on the current line!                                    005600
 005601   //==========================================================================================                       005601
 000001=OOUTREC                                                                                                             2000001
         *--------------------------------------------------------------------------------------------*                     2
         * RPG record format  . . . . :  OUTREC                                                       *                     2
         * External format  . . . . . :  QRPGLESRC2 : CVTRPGFREE/QRPGLESRC2                           *                     2
         *--------------------------------------------------------------------------------------------*                     2
 000002=O                       SRCSEQ               6S ZONE      6,2                                                       2000002
 000003=O                       SRCDAT              12S ZONE      6,0                                                       2000003
 000004=O                       SRCDTA             112A CHAR      100                                                       2000004
 000001=OZ1PAGHDG                                                                                                           3000001
         *--------------------------------------------------------------------------------------------*                     3
         * RPG record format  . . . . :  Z1PAGHDG                                                     *                     3
         * External format  . . . . . :  Z1PAGHDG : CVTRPGFREE/CVTRPGFREP                             *                     3
         *--------------------------------------------------------------------------------------------*                     3
 000002=O                       Z1QPGM              10A CHAR       10                                                       3000002
 000003=O                       Z1QUSR              20A CHAR       10                                                       3000003
 000004=O                       Z1QTTL              60A CHAR       40                                                       3000004
 000005=O                       Z1QPAG              64S ZONE      4,0                                                       3000005
 000001=OZ1TOPPAG                                                                                                           4000001
         *--------------------------------------------------------------------------------------------*                     4
         * RPG record format  . . . . :  Z1TOPPAG                                                     *                     4
         * External format  . . . . . :  Z1TOPPAG : CVTRPGFREE/CVTRPGFREP                             *                     4
         *--------------------------------------------------------------------------------------------*                     4
 000002=O                       ZTFRFL              21A CHAR       21                                                       4000002
 000003=O                       ZTTOFL              42A CHAR       21                                                       4000003
 000001=OZL01HDG                                                                                                            5000001
         *--------------------------------------------------------------------------------------------*                     5
         * RPG record format  . . . . :  ZL01HDG                                                      *                     5
         * External format  . . . . . :  ZL01HDG : CVTRPGFREE/CVTRPGFREP                              *                     5
         *--------------------------------------------------------------------------------------------*                     5
 000001=OZ1DETAIL                                                                                                           6000001
         *--------------------------------------------------------------------------------------------*                     6
         * RPG record format  . . . . :  Z1DETAIL                                                     *                     6
         * External format  . . . . . :  Z1DETAIL : CVTRPGFREE/CVTRPGFREP                             *                     6
         *--------------------------------------------------------------------------------------------*                     6
 000002=O                       Z1FRMB              10A CHAR       10                                                       6000002
 000003=O                       Z1TOMB              20A CHAR       10                                                       6000003
 000004=O                       Z1CTSC              27S ZONE      7,0                                                       6000004
 000005=O                       Z1CTTG              34S ZONE      7,0                                                       6000005
 000006=O                       Z1CTMV              41S ZONE      7,0                                                       6000006
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    180
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000007=O                       Z1CTEL              48S ZONE      7,0                                                       6000007
 000008=O                       Z1CTCV              55S ZONE      7,0                                                       6000008
 000009=O                       Z1CTNV              62S ZONE      7,0                                                       6000009
 000010=O                       Z1CNVR              67S ZONE      5,2                                                       6000010
 000001=OZ1ENDRPT                                                                                                           7000001
         *--------------------------------------------------------------------------------------------*                     7
         * RPG record format  . . . . :  Z1ENDRPT                                                     *                     7
         * External format  . . . . . :  Z1ENDRPT : CVTRPGFREE/CVTRPGFREP                             *                     7
         *--------------------------------------------------------------------------------------------*                     7
 005602   Dcl-Proc GetDeclarationType;                                                                                       005602
 005603                                                                                                                      005603
 005604   // -- Procedure Interface ------------------------------------------------------------------                       005604
 005605   Dcl-PI GetDeclarationType;                                                                                         005605
 005606      QpDeclType               Char( 2 );                                                                             005606
 005607      QpSavedName              Char( 80 );                                                                            005607
 005608      QpDeclLine                        Like(SRCSEQ);                                                                 005608
 005609   End-PI;                                                                                                            005609
 005610                                                                                                                      005610
 005611   // -- Data Structures ----------------------------------------------------------------------                       005611
 005612                                                                                                                      005612
 005613   // -- Variables ----------------------------------------------------------------------------                       005613
 005614   Dcl-S savedLineType        Char(  1 );                                                                             005614
 005615   Dcl-S x                  Packed( 3:0 );                                                                            005615
 005616   Dcl-S savedSRCDTA          Char( 100 );                                                                            005616
 005617                                                                                                                      005617
 005618   //-------------------------------------------------------------------------------------------                      005618
 005619                                                                                                                      005619
 005620      // Start with what we've got.                                                                                   005620
 005621      If ((declExt = ' ' and declPrefix  = ' ')                                                  B01                  005621
 005622      or declPrefix = 'S' or declPrefix = 'U')                                                   B01                  005622
 005623      and declSuffix = ' ';                                                                      B01                  005623
 005624         QpDeclType = %xlate(lo:up:declType);                                                     01                  005624
 005625         QpSavedName = %trim(declName);                                                           01                  005625
 005626      Else;                                                                                      X01                  005626
 005627         QpDeclType = *Blank;                                                                     01                  005627
 005628         QpSavedName = %trim(%subst(fullLine:1:74));                                              01                  005628
 005629      EndIf;                                                                                     E01                  005629
 005630                                                                                                                      005630
 005631      x = %scan(' ':QpSavedName);                                                                                     005631
 005632      If x > 1;                                                                                  B01                  005632
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    181
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005633         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005633
 005634      EndIf;                                                                                     E01                  005634
 005635                                                                                                                      005635
 005636      // If we already have the declaration type, then stop.                                                          005636
 005637      If QpDeclType = 'S'                                                                        B01                  005637
 005638      or QpDeclType = 'DS'                                                                       B01                  005638
 005639      or QpDeclType = 'C'                                                                        B01                  005639
 005640      or QpDeclType = 'B'                                                                        B01                  005640
 005641      or QpDeclType = 'E'                                                                        B01                  005641
 005642      or QpDeclType = 'PR'                                                                       B01                  005642
 005643      or QpDeclType = 'PI'                                                                       B01                  005643
 005644      or QpDeclType = *Blanks and inPrototype;                                                   B01                  005644
 005645         QpDeclLine = SRCSEQ;                                                                     01                  005645
 005646         Return;                                                                                  01                  005646
 005647      EndIf;                                                                                     E01                  005647
 005648                                                                                                                      005648
 005649      savedSRCDTA = SRCDTA;                                                                                           005649
 005650      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005650
 005651      x = 0;                                                                                                          005651
 005652      QpDeclLine = 0;                                                                                                 005652
 005653                                                                                                                      005653
 005654      //   // Name of the variable/routine should be on this line.                                                    005654
 005655      //   savedName = %trim(declOptions);                                                                            005655
 005656                                                                                                                      005656
 005657      // Trim any ellipsis from the name as this is not valid in free-form.                                           005657
 005658      x = %scan('...':QpSavedName);                                                                                   005658
 005659      If x > 0;                                                                                  B01                  005659
 005660         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005660
 005661         x = 0;                                                                                   01                  005661
 005662      ElseIf declFrom <> *Blanks                                                                 X01                  005662
 005663          or declLen <> *Blanks                                                                  X01                  005663
 005664          or declOptions <> *BLanks;                                                             X01                  005664
 005665         // It's not a declaration - it's a subfield.                                                                 005665
 005666         QpDeclType = %xlate(lo:up:declType);                                                     01                  005666
 005667         QpDeclLine = SRCSEQ;                                                                     01                  005667
 005668         Return;                                                                                  01                  005668
 005669      EndIf;                                                                                     E01                  005669
 005670                                                                                                                      005670
 005671      // Read ahead to find the next line with a declaration type.                                                    005671
 005672      Read SRCREC;                                                                                                    005672
 005673      DoW not %eof();                                                                            B01                  005673
 005674         x += 1;     // Keep a track of how many lines we have read.                              01                  005674
 005675                                                                                                                      005675
 005676         lineType = %xlate(lo:up:lineType);                                                       01                  005676
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    182
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005677                                                                                                                      005677
 005678         If lineType <> savedLineType;                                                           B02                  005678
 005679            // End of this declaration.                                                                               005679
 005680            Leave;                                                                                02                  005680
 005681         EndIf;                                                                                  E02                  005681
 005682                                                                                                                      005682
 005683         If declType <> *Blanks;                                                                 B02                  005683
 005684            // We have found the declaration.                                                                         005684
 005685            QpDeclType = %xlate(lo:up:declType);                                                  02                  005685
 005686            QpDeclLine = SRCSEQ;                                                                  02                  005686
 005687            Leave;                                                                                02                  005687
 005688         ElseIf declFrom <> *Blanks                                                              X02                  005688
 005689             or declLen <> *Blanks                                                               X02                  005689
 005690             or declOptions <> *BLanks;                                                          X02                  005690
 005691            // It's not a declaration - it's a subfield.                                                              005691
 005692            QpDeclType = %xlate(lo:up:declType);                                                  02                  005692
 005693            QpDeclLine = SRCSEQ;                                                                  02                  005693
 005694            Leave;                                                                                02                  005694
 005695         EndIf;                                                                                  E02                  005695
 005696                                                                                                                      005696
 005697         Read SRCREC;                                                                             01                  005697
 005698      EndDo;                                                                                     E01                  005698
 005699                                                                                                                      005699
 005700      // End of file breaks the logic!  We need to reposition to the last record before                               005700
 005701      // continuing.                                                                                                  005701
 005702      If %eof(QRPGLESRC);                                                                        B01                  005702
 005703         SetGT *HIVAL SRCREC;                                                                     01                  005703
 005704         ReadP SRCREC;                                                                            01                  005704
 005705      EndIf;                                                                                     E01                  005705
 005706                                                                                                                      005706
 005707      // Return to the previous point.                                                                                005707
 005708      For i = 1 to x;                                                                            B01                  005708
 005709         ReadP SRCREC;                                                                            01                  005709
 005710      EndFor;                                                                                    E01                  005710
 005711                                                                                                                      005711
 005712      SRCDTA = savedSRCDTA;                                                                                           005712
 005713                                                                                                                      005713
 005714      Return;                                                                                                         005714
 005715                                                                                                                      005715
 005716   //------------------------------------------------------------------------------------------                       005716
 005717      End-Proc;                                                                                                       005717
 005718                                                                                                                      005718
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    183
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005720   //==========================================================================================                       005720
 005721   // Split a line at a logical break based on a max length.                                                          005721
 005722   //==========================================================================================                       005722
 005723      Dcl-Proc SplitLine;                                                                                             005723
 005724                                                                                                                      005724
 005725   // -- Procedure Interface ------------------------------------------------------------------                       005725
 005726      Dcl-PI SplitLine;                                                                                               005726
 005727         QpCurrentLine        VarChar(92);                                                                            005727
 005728         QpOverflow           VarChar(92);                                                                            005728
 005729         QpMaxLength           Packed( 3:0 ) CONST;                                                                   005729
 005730      End-PI;                                                                                                         005730
 005731                                                                                                                      005731
 005732   // -- Data Structures ----------------------------------------------------------------------                       005732
 005733                                                                                                                      005733
 005734   // -- Variables ----------------------------------------------------------------------------                       005734
 005735      Dcl-S x                  Packed( 3:0 );                                                                         005735
 005736                                                                                                                      005736
 005737   //-------------------------------------------------------------------------------------------                      005737
 005738                                                                                                                      005738
 005739      QpOverflow = *Blanks;                                                                                           005739
 005740      x = %len(%trim(QpCurrentLine));                                                                                 005740
 005741      If x > QpMaxLength;                                                                        B01                  005741
 005742         x = QpMaxLength;                                                                         01                  005742
 005743      EndIf;                                                                                     E01                  005743
 005744                                                                                                                      005744
 005745      // Scan backwards through the line, looking for a place to break it.                                            005745
 005746      For x = x downto 1;                                                                        B01                  005746
 005747         If %scan(%subst(QpCurrentLine:x:1):' ') > 0;                                            B02                  005747
 005748            // Break here, and put the rest into a new line.                                                          005748
 005749            QpOverflow = %subst(QpCurrentLine:x);                                                 02                  005749
 005750            QpCurrentLine = %subst(QpCurrentLine:1:x-1);                                          02                  005750
 005751            Leave;                                                                                02                  005751
 005752         EndIf;                                                                                  E02                  005752
 005753      EndFor;                                                                                    E01                  005753
 005754                                                                                                                      005754
 005755      Return;                                                                                                         005755
 005756                                                                                                                      005756
 005757   //------------------------------------------------------------------------------------------                       005757
 005758      End-Proc;                                                                                                       005758
 005759                                                                                                                      005759
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    184
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005761   //==========================================================================================                       005761
 005762   // Check for an array definition and adjust the length according to the number of elements.                        005762
 005763   //==========================================================================================                       005763
 005764      Dcl-Proc AdjustArrayLength;                                                                                     005764
 005765                                                                                                                      005765
 005766   // -- Procedure Interface ------------------------------------------------------------------                       005766
 005767      Dcl-PI AdjustArrayLength;                                                                                       005767
 005768      QpLength               Packed( 7:0 );                                                                           005768
 005769      End-PI;                                                                                                         005769
 005770                                                                                                                      005770
 005771   // -- Data Structures ----------------------------------------------------------------------                       005771
 005772                                                                                                                      005772
 005773   // -- Variables ----------------------------------------------------------------------------                       005773
 005774      Dcl-S x                  Packed( 3:0 );                                                                         005774
 005775      Dcl-S i                  Packed( 3:0 );                                                                         005775
 005776      Dcl-S j                  Packed( 3:0 );                                                                         005776
 005777      Dcl-S elements           Packed( 5:0 );                                                                         005777
 005778      Dcl-S savedSRCDTA          Char( 100 );                                                                         005778
 005779                                                                                                                      005779
 005780   //-------------------------------------------------------------------------------------------                      005780
 005781                                                                                                                      005781
 005782      savedSRCDTA = SRCDTA;                                                                                           005782
 005783      x = 0;                                                                                                          005783
 005784                                                                                                                      005784
 005785      // Read ahead to find the next line with a declaration type.                                                    005785
 005786      DoW not %eof();                                                                            B01                  005786
 005787         // Array definition on the current line?                                                                     005787
 005788         i = %scan('DIM(':%xlate(lo:up:declKeywords));                                            01                  005788
 005789                                                                                                                      005789
 005790         If i > 0;                                                                               B02                  005790
 005791            j = %scan(')':declKeywords:i+4);                                                      02                  005791
 005792            elements = %dec(%subst(declKeywords:i + 4:j - i - 4):7:0);                            02                  005792
 005793            // Adjust the length of the variable.                                                                     005793
 005794            If %rem(QpLength:elements) = 0;                                                      B03                  005794
 005795               QpLength = %div(QpLength:elements);                                                03                  005795
 005796            EndIf;                                                                               E03                  005796
 005797            Leave;                                                                                02                  005797
 005798         EndIf;                                                                                  E02                  005798
 005799                                                                                                                      005799
 005800         Read SRCREC;                                                                             01                  005800
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    185
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005801         x += 1;     // Keep a track of how many lines we have read.                              01                  005801
 005802                                                                                                                      005802
 005803         lineType = %xlate(lo:up:lineType);                                                       01                  005803
 005804                                                                                                                      005804
 005805         If lineType <> *Blank                                                                   B02                  005805
 005806         and lineType <> 'D';                                                                    B02                  005806
 005807            // Not part of this definition - stop looking for array definition.                                       005807
 005808            Leave;                                                                                02                  005808
 005809                                                                                                                      005809
 005810         ElseIf lineType = 'D'                                                                   X02                  005810
 005811         and %subst(directive:1:1) <> '*';                       // D-spec and no comment        X02                  005811
 005812            If declName <> *Blanks;                                                              B03                  005812
 005813               // A new declaration - stop looking for array definition.                                              005813
 005814               Leave;                                                                             03                  005814
 005815            EndIf;                                                                               E03                  005815
 005816         EndIf;                                                                                  E02                  005816
 005817      EndDo;                                                                                     E01                  005817
 005818                                                                                                                      005818
 005819      // End of file breaks the logic!  We need to reposition to the last record before                               005819
 005820      // continuing.                                                                                                  005820
 005821      If %eof(QRPGLESRC);                                                                        B01                  005821
 005822         SetGT *HIVAL SRCREC;                                                                     01                  005822
 005823         ReadP SRCREC;                                                                            01                  005823
 005824      EndIf;                                                                                     E01                  005824
 005825                                                                                                                      005825
 005826      // Return to the previous point.                                                                                005826
 005827      For i = 1 to x;                                                                            B01                  005827
 005828         ReadP SRCREC;                                                                            01                  005828
 005829      EndFor;                                                                                    E01                  005829
 005830                                                                                                                      005830
 005831      SRCDTA = savedSRCDTA;                                                                                           005831
 005832                                                                                                                      005832
 005833      Return;                                                                                                         005833
 005834                                                                                                                      005834
 005835   //------------------------------------------------------------------------------------------                       005835
 005836      End-Proc;                                                                                                       005836
 005837   //==========================================================================================                       005837
 005838 O*QRPGLESRC2E            OUTREC                                                                                      005838
 005839 O*                       SRCSEQ                                                                                      005839
 005840 O*                       SRCDAT                                                                                      005840
 005841 O*                       SRCDTA                                                                                      005841
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    186
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv   Statement    Message text
 *RNF7066 00        000032  Record-Format ZL01HDG not used for input or output.
 *RNF7099 00        005490  A COMMIT or ROLBK operation is used in the program with no
                            files defined with commitment control.
 *RNF7086 00        000027  RPG handles blocking for file QRPGLESRC2. INFDS is updated
                            only when blocks of data are transferred.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                  O u t p u t   B u f f e r   P o s i t i o n s
 Line   Start End   Field or Constant
 Number Pos   Pos
    2000002     1     6 SRCSEQ
    2000003     7    12 SRCDAT
    2000004    13   112 SRCDTA
    3000002     1    10 Z1QPGM
    3000003    11    20 Z1QUSR
    3000004    21    60 Z1QTTL
    3000005    61    64 Z1QPAG
    4000002     1    21 ZTFRFL
    4000003    22    42 ZTTOFL
    6000002     1    10 Z1FRMB
    6000003    11    20 Z1TOMB
    6000004    21    27 Z1CTSC
    6000005    28    34 Z1CTTG
    6000006    35    41 Z1CTMV
    6000007    42    48 Z1CTEL
    6000008    49    55 Z1CTCV
    6000009    56    62 Z1CTNV
    6000010    63    67 Z1CNVR
  * * * * *   E N D   O F   O U T P U T   B U F F E R   P O S I T I O N   *  * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    187
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                        C o m p i l e   T i m e   D a t a
 005842 **CTDATA QopCodeUP                                                                                                   005842
         *--------------------------------------------------------------------*
         * Array . . . : QOPCODEUP    Alternating Array  . . . . : QOPCODELO  *
         *--------------------------------------------------------------------*
 005843 ACQ       Acq                                                                                                        005843
 005844 BEGSR     BegSr                                                                                                      005844
 005845 CALLP     CallP                                                                                                      005845
 005846 CHAIN     Chain                                                                                                      005846
 005847 CLEAR     Clear                                                                                                      005847
 005848 CLOSE     Close                                                                                                      005848
 005849 COMMIT    Commit                                                                                                     005849
 005850 DEALLOC   DeAlloc                                                                                                    005850
 005851 DELETE    Delete                                                                                                     005851
 005852 DOU       DoU                                                                                                        005852
 005853 DOW       DoW                                                                                                        005853
 005854 DSPLY     Dsply                                                                                                      005854
 005855 DUMP      Dump                                                                                                       005855
 005856 ELSE      Else                                                                                                       005856
 005857 ELSEIF    ElseIf                                                                                                     005857
 005858 ENDDO     EndDo                                                                                                      005858
 005859 ENDFOR    EndFor                                                                                                     005859
 005860 ENDIF     EndIf                                                                                                      005860
 005861 ENDMON    EndMon                                                                                                     005861
 005862 ENDSL     EndSl                                                                                                      005862
 005863 ENDSR     EndSr                                                                                                      005863
 005864 EVAL      Eval                                                                                                       005864
 005865 EVALR     EvalR                                                                                                      005865
 005866 EVAL-CORR Eval-Corr                                                                                                  005866
 005867 EXCEPT    Except                                                                                                     005867
 005868 EXFMT     Exfmt                                                                                                      005868
 005869 EXSR      Exsr                                                                                                       005869
 005870 EXEC SQL  Exec SQL                                                                                                   005870
 005871 FEOD      FEOD                                                                                                       005871
 005872 FOR       For                                                                                                        005872
 005873 FORCE     Force                                                                                                      005873
 005874 IF        If                                                                                                         005874
 005875 IN        In                                                                                                         005875
 005876 ITER      Iter                                                                                                       005876
 005877 LEAVE     Leave                                                                                                      005877
 005878 LEAVESR   LeaveSr                                                                                                    005878
 005879 MONITOR   Monitor                                                                                                    005879
 005880 NEXT      Next                                                                                                       005880
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    188
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005881 ON-ERROR  On-Error                                                                                                   005881
 005882 OPEN      Open                                                                                                       005882
 005883 OTHER     Other                                                                                                      005883
 005884 OUT       Out                                                                                                        005884
 005885 POST      Post                                                                                                       005885
 005886 READ      Read                                                                                                       005886
 005887 READC     ReadC                                                                                                      005887
 005888 READE     ReadE                                                                                                      005888
 005889 READP     ReadP                                                                                                      005889
 005890 READPE    ReadPE                                                                                                     005890
 005891 REL       Rel                                                                                                        005891
 005892 RESET     Reset                                                                                                      005892
 005893 RETURN    Return                                                                                                     005893
 005894 ROLBK     RolBk                                                                                                      005894
 005895 SELECT    Select                                                                                                     005895
 005896 SETGT     SetGT                                                                                                      005896
 005897 SETLL     SetLL                                                                                                      005897
 005898 SORTA     SortA                                                                                                      005898
 005899 TEST      Test                                                                                                       005899
 005900 UNLOCK    Unlock                                                                                                     005900
 005901 UPDATE    Update                                                                                                     005901
 005902 WHEN      When                                                                                                       005902
 005903 WRITE     Write                                                                                                      005903
 005904 XML-INTO  XML-Into                                                                                                   005904
 005905 XMLSAX    XMLSAX                                                                                                     005905
 005906 ENDCS     ----------                                                                                                 005906
 005907 AND       and                                                                                                        005907
 005908 OR        or                                                                                                         005908
 005909 **CTDATA QdeclUP                                                                                                     005909
         *--------------------------------------------------------------------*
         * Array . . . : QDECLUP      Alternating Array  . . . . : QDECLLO    *
         *--------------------------------------------------------------------*
 005910 DCL-F     Dcl-F                                                                                                      005910
 005911 DCL-S     Dcl-S                                                                                                      005911
 005912 DCL-C     Dcl-C                                                                                                      005912
 005913 DCL-PR    Dcl-PR                                                                                                     005913
 005914 DCL-PI    Dcl-PI                                                                                                     005914
 005915 DCL-PROC  Dcl-Proc                                                                                                   005915
 005916 DCL-DS    Dcl-DS                                                                                                     005916
 005917 END-DS    End-DS                                                                                                     005917
 005918 END-PR    End-PR                                                                                                     005918
 005919 END-PI    End-PI                                                                                                     005919
 005920 END-PROC  End-Proc                                                                                                   005920
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    189
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005921 CTL-OPT   Ctl-Opt                                                                                                    005921
 005922 **CTDATA Qcomments                                                                                                   005922
         *--------------------------------------------------------------------*
         * Array . . . : QCOMMENTS                                            *
         *--------------------------------------------------------------------*
 005923 //===========================================================================================                        005923
 005924 // Start of moved field definitions.                                                                                 005924
 005925 // End of moved field definitions.                                                                                   005925
     * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    190
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          CVTRPGFREP        PRINTER                000032D     005519      005566
            Z1PAGHDG                               000032D     000459     3000001
            Z1TOPPAG                               000032D     000464     4000001
            ZL01HDG                                000032D    5000001
            Z1DETAIL                               000032D     000484     6000001
            Z1ENDRPT                               000032D     005518     7000001
          QRPGLESRC         DISK                   000022D     000425      005118      005201
                                                   005286      005328      005437      005452
                                                   005453      005512      005572      005702
                                                   005821
            SRCREC                                 000024     1000001      000423      000451
                                                   005015      005112      005119      005120
                                                   005125      005179      005196      005202
                                                   005203      005208      005227      005277
                                                   005287      005293      005454      005456
                                                   005672      005697      005703      005704
                                                   005709      005800      005822      005823
                                                   005828
          QRPGLESRC2        DISK                   000027D     005513      005575
            OUTREC                                 000029      005473     2000001
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                   005494M
          ADJUSTARRAYLENGTH PROTOTYPE              002018M     005764      005767
          BLANKS            A(30)                  000209D     003011
          CALLPOFFSET       P(5,0)                 000329D     001050      002858M
          CALLPOPERATOR     A(10)                  000328D     002848      002874M     002876M
          CASEOPERATOR      A(4)                   000312D     002892M     002895      002896M
                                                   002897      002898M     002899      002900M
                                                   002901      002902M     002903      002904M
                                                   002905      002906M     002908M     002914
                                                   002918      002922
          CASESUBROUTINE    A(10)                  000311D     000445      000446      000448M
                                                   002891M
          CATBLANKS         A(14)                  000317D     002980M     002983M     002990
                                                   002992      002999
          CATCOUNT          P(5,0)                 000316D     002992M     003003      003007
                                                   003011
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    191
          CATFACTOR1        A(14)                  000314D     002972M     002974M     003001
                                                   003005      003010
          CATFACTOR2        A(14)                  000315D     002981M     002984M     003002
                                                   003006      003012
          CFGCLOSEDOWN      A(1)                   000195D     005493      005517M     005554M
          CFGCOMMITCONTROL  A(7)                   000193D     005489      005553M
          CHECKLENGTH       P(5,0)                 000278D     002338M     002342M     002345
 *RNF7031 CNDINDICATORS(79) N(1)                   000145D
          CODELINE          A(93)                  000091D     000220      000436M     000438M
                                                   000446M     000507      000613      000616M
                                                   000616      000622      000626      000627
                                                   000634      000637M     000640      000642M
                                                   000725      000726      000727      000731
                                                   000733      000735      000738      000780M
                                                   000788      001033M     001034M     001091M
                                                   001092M     001096M     001099      001113M
                                                   001121M     001122M     001167M     001192
                                                   001613      002234      002350M     002402
                                                   002408      002459      002546M     002557M
                                                   002568M     002579M     002590M     002601M
                                                   002605M     002609M     002617M     002621M
                                                   002625M     002637M     002642M     002647M
                                                   002657M     002660M     002662M     002672M
                                                   002675M     002677M     002687M     002690M
                                                   002692M     003484M     003605      005235
                                                   005236      005243      005248      005249
                                                   005300      005301      005332      005334
                                                   005420M     005422M     005424M     005430M
                                                   005443M     005445M     005447M
          CODESTART         P(6,2)                 000242D     005321M     005455
          COMMENT           A(20)                  000105D     000639      000655      000668
                                                   000680      000692      000704      001799
                                                   001800      001801      001803      001836
                                                   001837      001838      001840      002186
                                                   002187      002188      002190      002327
                                                   002328      002329      002331      002341
                                                   002419      002420      002421      002423
                                                   002495      002496      002497      002499
                                                   005402      005403
          CONDIND           A(2)                   000095D     001208
 *RNF7031 CONDNOT           A(1)                   000094D
          CONVERT           N(1)                   000238D     000504M     000659      000672
                                                   000684      000696      000708      000742
                                                   000760      001094      001108      001194M
                                                   001204M     001615M     001646M     001734M
                                                   001997M     002205M     002222M     002236M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    192
                                                   002270M     002375M     002390M     002404M
                                                   002447M     002461M     002516M     002530M
                                                   002716M     002747M     002803M     002822M
                                                   002835M     002879M     002947M     003021M
                                                   003052M     003103M     003116M     003134M
                                                   003155M     003190M     003211M     003237M
                                                   003267M     003382M     003415M     003432M
                                                   003445M     003458M     003522M     003574M
                                                   003587M     003614M     003640M     003653M
                                                   003703M     003722M     003735M     003748M
                                                   003833M     003857M     003870M     003883M
                                                   003930M     003976M     004018M     004032M
                                                   004053M     004082M     004099M     004118M
                                                   004131M     004155M     004189M     004225M
                                                   004245M     004265M     004299M     004313M
                                                   004334M     004398M     004411M     004429M
                                                   004447M     004481M     004494M     004509M
                                                   004522M     004554M     004638M     004680M
                                                   004704M     004717M     004736M     004762M
                                                   004846M     004877M     004897M     004951M
                                                   004969M     004988M
          COUNTCONV         P(7,0)                 000394D     000474      000480      000743M
                                                   005580M
          COUNTELIGIBLE     P(7,0)                 000393D     000473      000477      000480
                                                   000652M     000665M     000678M     000690M
                                                   000702M     005579M
          COUNTMOVED        P(7,0)                 000396D     000476      005431M
          COUNTNOTCONV      P(7,0)                 000395D     000475      000653M     000666M
                                                   000679M     000691M     000703M     000744M
                                                   005581M
          COUNTSOURCE       P(7,0)                 000391D     000426M     000471      005577M
          COUNTTARGET       P(7,0)                 000392D     000472      005471M     005578M
          CURROFFSET        P(5,0)                 000254D     000731M     001054
 *RNF7031 CVTRPGFREE        PROTOTYPE              000039D
          DCLF              DS(92)                 000175D     002280M     002281M     002282M
                                                   002286M     002295M     002298M     002302M
                                                   002304M     002308M     002312M     002317
                                                   002318M     002318      002323M     002323
                                                   002329M     002331M     002338      002345
                                                   002350      002354M     002355M     002358M
                                                   002358      002364M     002364      002371
                                                   002381M     002382M     002384M     002384
                                                   002386
            COMMENT         A(23)                  000180D     002329      002331
            DECL            A(6)                   000176D     002281
            DEFINITION      A(44)                  000179D     002295      002298      002302
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    193
                                                   002304      002308      002312      002317
                                                   002318      002318      002323      002323
                                                   002338      002345      002355      002358
                                                   002358      002364      002364      002382
                                                   002384      002384
            DEVICE          A(8)                   000178D     002286
 *RNF7031   FILENAME        A(15)                  000177D
          DCLH              DS(93)                 000183D     002415M     002416M     002417M
                                                   002421M     002423M     002428M     002428
                                                   002435      002438M     002439M     002441M
                                                   002441      002443
            COMMENT         A(23)                  000186D     002421      002423
            DECL            A(8)                   000184D     002416
            OPTIONS         A(62)                  000185D     002417      002428      002428
                                                   002439      002441      002441
          DCLP              DS(93)                 000161D     002480M     002483M     002485M
                                                   002487M     002491M     002491      002497M
                                                   002499M     002504M     002504      002511
                                                   002521M     002522M     002524M     002524
                                                   002526
            COMMENT         A(23)                  000164D     002497      002499
            DECL            A(9)                   000162D     002483      002485
            DEFINITION      A(61)                  000163D     002487      002491      002491
                                                   002504      002504      002522      002524
                                                   002524
          DCLPR             DS(92)                 000152D     001872M     001887M     001891M
                                                   001908M     001914      001931      001933M
                                                   001938M     001946M     001950M     001952M
                                                   001957M     001963M     001968M     001974M
                                                   001976M     001978M     001980M     001982M
                                                   001984M     001986M     001990M     001993M
                                                   002008      002009M     002019M     002019
                                                   002022M     002022      002027M     002027
                                                   002030M     002030      002085      002088M
                                                   002100M     002109M     002157      002158M
                                                   002158      002160M     002160      002171
                                                   002173      002178      002178      002179M
                                                   002181M     002181      002188M     002190M
                                                   002195
            COMMENT         A(23)                  000157D     002188      002190
            DECL            A(7)                   000153D     001887      001931
            DEFINITION      A(37)                  000156D     001957      001968      002009
                                                   002019      002019      002022      002022
                                                   002027      002027      002030      002030
                                                   002160      002160      002171      002173
                                                   002178      002179      002181      002181
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    194
            FIELDNAME       A(23)                  000158D     001908
            PROCNAME        A(16)                  000154D     002085      002088      002100
                                                   002158      002158
            TYPE            A(9)                   000155D     001914      001933      001938
                                                   001946      001950      001952      001963
                                                   001974      001976      001978      001980
                                                   001982      001984      001986      001990
                                                   001993      002008      002157      002178
          DCLS              DS(92)                 000167D     001640M     001651M     001652M
                                                   001657      001676M     001684M     001687M
                                                   001689M     001694M     001700M     001705M
                                                   001711M     001713M     001715M     001717M
                                                   001719M     001721M     001723M     001727M
                                                   001730M     001745      001746M     001748M
                                                   001748      001751M     001751      001774M
                                                   001774      001784      001786      001791
                                                   001791      001792M     001794M     001794
                                                   001801M     001803M     001808      001819M
                                                   001821M     001822M     001827      001828M
                                                   001830M     001830      001838M     001840M
                                                   001845M     001845      001852      001853M
                                                   001853      001857      002213M     002214M
                                                   002216M     002216      002218      005325M
                                                   005355M     005360M     005362M     005364M
                                                   005366M     005368M     005368      005371M
                                                   005371      005377M     005379M     005384M
                                                   005384      005387M     005387      005390M
                                                   005390      005393M     005393      005401M
                                                   005401      005403M     005415      005416M
                                                   005430      005432M
            COMMENT         A(23)                  000172D     001801      001803      001838
                                                   001840      005403
            DECL            A(6)                   000168D     001651      001821      001852
                                                   005416
            DEFINITION      A(37)                  000171D     001694      001705      001746
                                                   001748      001748      001751      001751
                                                   001774      001774      001784      001786
                                                   001791      001792      001794      001794
                                                   001827      001828      001830      001830
                                                   001845      001845      001853      002214
                                                   002216      002216      005366      005368
                                                   005368      005371      005371      005379
                                                   005384      005384      005387      005387
                                                   005390      005390      005393      005393
                                                   005401      005401
            FIELDNAME       A(17)                  000169D     005360      005377      005415
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    195
                                                   005432
            TYPE            A(9)                   000170D     001657      001676      001684
                                                   001687      001689      001700      001711
                                                   001713      001715      001717      001719
                                                   001721      001723      001727      001730
                                                   001745      001791      005362      005364
          DEC               A(2)                   000101D     000861M     005361      005367
                                                   005369
          DECLATTR          A(1)                   000121D     001622
          DECLEXT           A(1)                   000115D     005621
          DECLFROM          A(7)                   000119D     002010      002012      002035
                                                   002037      002038      002040      005662
                                                   005688
          DECLKEYWORDS      A(37)                  000123D     001623      002522      005031
                                                   005256      005788      005791      005792
          DECLLEN           A(7)                   000120D     001658      001746      001915
                                                   001932      002011      002023      005030
                                                   005256      005663      005689
          DECLNAME          A(15)                  000114D     001628      002093      002477
                                                   005006      005028      005041      005144
                                                   005252      005259      005625      005812
          DECLOPTIONS       A(73)                  000124D     002036      002417      002439
                                                   005007      005260      005262      005664
                                                   005690
          DECLPREFIX        A(1)                   000116D     002083      002090      005141
                                                   005142      005142      005621      005622
                                                   005622
          DECLSCALE         A(3)                   000122D     001660      001747      001749
                                                   001917      002026      002028
          DECLSUFFIX        A(1)                   000118D     005140      005623
          DECLTYPE          A(2)                   000117D     001901      005029      005143
                                                   005190      005191      005255      005258
                                                   005624      005666      005683      005685
                                                   005692
          DEFSMOVED         N(1)                   000240D     000529M     000904M     000966
                                                   005417      005426M     005440      005459M
          DIRECTIVE         A(10)                  000090D     000501      000554M     000604M
                                                   000606M     000750M     000755M     000767M
                                                   000773M     001112      002349M     005027
                                                   005040      005048      005053      005094
                                                   005099      005105      005247      005298
                                                   005299      005340      005811
          DIVFACTOR1        A(14)                  000356D     003256M     003259M     003264
                                                   004029
          DIVFACTOR2        A(14)                  000357D     003257M     003260M     003265
                                                   004030
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    196
          DOCOMPARE         A(2)                   000333D     003304M     003309M     003313M
                                                   003316M     003321      003322M     003323
                                                   003324M     003325      003326M     003327
                                                   003328M     003329      003330M     003331
                                                   003332M     003333      003344M     003364
          DOCOUNT           P(5,0)                 000350D     000886M     000887      000921M
                                                   003496      003497
          DOLEVEL(99)       P(5,0)                 000351D     000887M     003497
          DOOPERATOR        A(10)                  000332D     003279      003377M     003379M
          DROPLINE          N(1)                   000241D     000556M     000559M     000566M
                                                   000660      000673      000685      000697
                                                   000709      000797      000877M     000985
                                                   001107      001127M     001290M     003189M
                                                   004427M     004445M
          DURCODE           A(14)                  000320D     002766M     002769      002769
                                                   002770M     002771      002771      002772M
                                                   002773      002773      002774M     002775
                                                   002775      002776M     002777      002777
                                                   002778M     002779      002779      002780M
                                                   002781      002781      002782M     002794
                                                   003672M     003675      003675      003676M
                                                   003677      003677      003678M     003679
                                                   003679      003680M     003681      003681
                                                   003682M     003683      003683      003684M
                                                   003685      003685      003686M     003687
                                                   003687      003688M     003695      004581M
                                                   004584      004584      004585M     004586
                                                   004586      004587M     004588      004588
                                                   004589M     004590      004590      004591M
                                                   004592      004592      004593M     004594
                                                   004594      004595M     004596      004596
                                                   004597M     004609      004613M     004616
                                                   004616      004617      004617      004618
                                                   004618      004619      004619      004620
                                                   004620      004621      004621      004622
                                                   004622      004629
          DURDURATION       A(14)                  000319D     002765M     002795      003671M
                                                   003694      004580M     004610      004612M
                                                   004628
          DURNEWDATE        N(1)                   000321D     004573M     004576M     004579
          ENDDECLTYPE       A(2)                   000245D     001167      001893M
          ENDDS             N(1)                   000231D     001164      001885M     002079M
          ENDFOUND          N(1)                   000244D     005224M     005296      005304M
          ENDLINE           P(6,2)                 000243D     001162      005223M     005282M
                                                   005305M
          EOFCHECK          N(1)                   000369D     002576      002582M     004216M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    197
                                                   004868M
          EOFFILE           A(14)                  000371D     004218M     004870M
          EOFIND            A(2)                   000370D     002579      004217M     004869M
          EQ                A(2)                   000104D     002940      002942      003096
                                                   003098      003181      003183      003229
                                                   004215      004217      004291      004393
                                                   004395      004425      004443      004472
                                                   004474      004867      004869
          EQCHECK           N(1)                   000383D     002645      002684      002695M
                                                   002941M     003182M
          EQFACTOR1         A(14)                  000385D     002687      002943M     003184M
          EQFACTOR2         A(14)                  000386D     002688      002944M     003185M
          EQIND             A(2)                   000384D     002647      002690      002942M
                                                   003183M
          EQUALCHECK        N(1)                   000388D     002587      002593M     004473M
          EQUALIND          A(2)                   000389D     002590      004474M
          ERRCHECK          N(1)                   000359D     002554      002560M     002712M
                                                   002799M     002818M     003017M     003048M
                                                   003093M     003130M     003151M     003207M
                                                   003233M     003411M     003636M     003699M
                                                   003718M     003853M     004049M     004078M
                                                   004114M     004151M     004185M     004221M
                                                   004241M     004261M     004295M     004330M
                                                   004390M     004477M     004634M     004676M
                                                   004700M     004732M     004758M     004873M
                                                   004947M
          ERRIND            A(2)                   000360D     002557      002713M     002800M
                                                   002819M     003018M     003049M     003094M
                                                   003131M     003152M     003208M     003234M
                                                   003412M     003637M     003700M     003719M
                                                   003854M     004050M     004079M     004115M
                                                   004152M     004186M     004222M     004242M
                                                   004262M     004296M     004331M     004391M
                                                   004478M     004635M     004677M     004701M
                                                   004733M     004759M     004874M     004948M
 *RNF7031 ERRORIND          N(1)                   000149D
          EVALOFFSET        P(5,0)                 000325D     001052
          EVALOPERATOR      A(10)                  000324D     003539      003569M     003571M
          EXTFACTOR2        A(45)                  000107D     002854      002864      003287
                                                   003297      003548      003550      003560
                                                   003714      003733      003746      003768
                                                   003778      004093      004096      004311
                                                   004505      004782      004792      005056
          FACTOR1           A(14)                  000096D     000287      000306      000307
                                                   000314      000347      000356      000375
                                                   000380      000385      002707      002735
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    198
                                                   002741      002788      002791      002833
                                                   002913      002921      002931      002937
                                                   002943      002961      002962      002971
                                                   002974      003032      003082      003086
                                                   003145      003170      003177      003184
                                                   003255      003259      003336      003339
                                                   003342M     003363      003395      003396
                                                   003426      003427      003471      003814
                                                   003844      003845      003953      004006
                                                   004012      004043      004064      004069
                                                   004142      004145      004176      004179
                                                   004200      004201      004256      004278
                                                   004279      004324      004346      004349
                                                   004351      004352      004458      004542
                                                   004548      004603      004606      004628
                                                   004652      004653      004659      004695
                                                   004827      004918      004922      004923
                                                   005378
          FACTOR2           A(14)                  000098D     000288      000308      000315
                                                   000317      000319      000320      000348
                                                   000357      000367      000371      000376
                                                   000381      000386      002708      002738
                                                   002742      002759      002765      002766
                                                   002814      002914      002922      002932
                                                   002938      002944      002978      002981
                                                   002983      002984      003033      003045
                                                   003076      003082      003086      003087
                                                   003127      003171      003178      003185
                                                   003222      003230      003257      003260
                                                   003341      003343M     003365      003397
                                                   003398      003456      003481      003482
                                                   003585      003625      003651      003665
                                                   003671      003672      003816      003846
                                                   003848      003946      003951      003956
                                                   004009      004013      004044      004066
                                                   004068      004110      004143      004146
                                                   004166      004177      004180      004202
                                                   004204      004218      004236      004257
                                                   004282      004283      004292      004356
                                                   004359      004361      004362      004459
                                                   004470      004520      004545      004549
                                                   004566      004580      004581      004629
                                                   004661      004664      004666      004670
                                                   004728      004747      004829      004857
                                                   004870      004889      004894      004927
                                                   004930      004932      004933      004962
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    199
                                                   004981      005380      005389      005391
                                                   005394
          FILEADD           A(1)                   000130D     002244
          FILEDESIG         A(1)                   000129D     002243
          FILEDEVICE        A(7)                   000133D     002245
          FILEEXTERNAL      A(1)                   000131D     002277
          FILEKEYED         A(1)                   000132D     002246
          FILEKEYWORDS      A(37)                  000134D     002336      002339      002355
                                                   002359      002382      005100
          FILENAME          A(10)                  000127D     002275      005100
          FILESPEC          A(100)                 000126D     000127      000128      000129
                                                   000130      000131      000132      000133
                                                   000134
          FILEUSAGE         A(1)                   000128D     002242
          FORCOUNT          P(5,0)                 000345D     000890M     000891      000925M
                                                   003479      003480
          FORFACTOR1        A(14)                  000347D     003337M     003339M     003349
          FORFACTOR2        A(14)                  000348D     003341M     003350
          FORLEVEL(99)      P(5,0)                 000346D     000891M     003480
          FOUNDCHECK        N(1)                   000362D     002543      002549M     004394M
          FOUNDIND          A(2)                   000363D     002546      004395M
          FROMFILELIB       A(21)                  000214D     000461      005571M
          FULLLINE          A(94)                  000092D     000714      000717      001115M
                                                   001619      002240      002465      005147
                                                   005628
          GETDECLARATIONTYPE...
                            PROTOTYPE              000069D     001631M     002472M     005265M
                                                   005602      005605
          HI                A(2)                   000102D     002928      002930      002962
                                                   003042      003044      003167      003169
                                                   003227      004289      004423      004441
                                                   004467      004469      004492      004653
          HICHECK           N(1)                   000373D     002635      002654      002665M
                                                   002929M     003097M     003168M
          HIFACTOR1         A(14)                  000375D     002657      002931M     003099M
                                                   003170M
          HIFACTOR2         A(14)                  000376D     002658      002932M     003100M
                                                   003171M
          HIIND             A(2)                   000374D     002637      002660      002930M
                                                   003098M     003169M
          I                 P(5,0)                 000207D     001759M     001760      001761
                                                   001764      001766      002048M     002049
                                                   002051      002053      002058      002058
                                                   002064      002064      002117M     002118
                                                   002119      002122      002124      002132M
                                                   002133      002134      002137      002139
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    200
                                                   002147M     002148      005124      005207
                                                   005292      005708
          IFCOMPARE         A(2)                   000337D     003790M     003794M     003797M
                                                   003801      003802M     003803      003804M
                                                   003805      003806M     003807      003808M
                                                   003809      003810M     003811      003812M
                                                   003815
          IFOPERATOR        A(10)                  000336D     003761      003828M     003830M
          INARRAYDATA       N(1)                   000223D     000514M     000517      001111
                                                   005587M
          INCALLP           N(1)                   000327D     001049      001143      001152M
                                                   001239      002847      002853      002859M
                                                   002873
          INCASE            N(1)                   000237D     000445      002912      002916M
                                                   003513      003525M
          INCODE            N(1)                   000222D     000512M     000521M     000528M
                                                   000531M     000533M     000535M     000537M
                                                   000539M     000549M     000597      000628
                                                   000719      000834M     000844M     000966
                                                   001029      001111      001139M     005586M
          INCOMMENT         N(1)                   000224D     000498M     000601M     000621M
                                                   000631M     000643M     000648      000659
                                                   000672      000684      000696      000708
                                                   000796      000984      000998M     001063
                                                   001145
          INCREMENT         P(1,0)                 000249D     000499M     000872M     000876M
                                                   000881M     000884M     000889M     000893M
                                                   000897M     000901M     000906M     000909M
                                                   000912M     000917M     000920M     000924M
                                                   000928M     000932M     000936M     000940M
                                                   000944M     000948M     000953M     000957M
                                                   000959M     000973      000974M     001130
          INDATASTRUCTURE   N(1)                   000228D     001161      001163      001164
                                                   001174M     001663      001870      001877
                                                   001884M     001920      002010      002034
          INDECLARATION     N(1)                   000225D     000513M     000746      000763
                                                   000833      000961      001144      001155M
                                                   001176M     001628      001629      001638M
                                                   001644M     001733M     001778M     001817M
                                                   001846M     001871M     001996M     002164M
                                                   002204M     002250      002269M     002278M
                                                   002365M     002374M     002412      002413M
                                                   002429M     002469      002470      002478M
                                                   002505M     002515M
 *RNF7031 INDECLPROC        N(1)                   000234D
          INDENT            N(1)                   000235D     000931M     000935M     000939M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    201
                                                   000943M     000947M     000952M     000956M
                                                   001133      001135M
          INDENTCOUNT       P(5,0)                 000250D     000887      000891      000895
                                                   000899M     000903M     000907M     000973M
                                                   001042      001045      001130M     001134M
                                                   001138M     003480      003497      003506
                                                   005588M     005590M
          INDENTOFFSET      P(5,0)                 000252D     001034      001043M     001045M
                                                   001050M     001052M     001054M     001054
                                                   001058      001059M     001080      001082M
                                                   001082      001086      001087M     001092
                                                   001122      001788M     002175M
          INDENTSIZE        P(1,0)                 000251D     001043      001045
 *RNF7031 INDICATORDS       DS(99)                 000138D
          INDIRECTIVE       N(1)                   000232D     000497M     000548M     000568M
                                                   000572M     000576M     000580M     000584M
                                                   000588M     000592M     000649      000772
                                                   000795      000982
          INDO              N(1)                   000331D     000885M     000950      001073
                                                   001143      001150M     001320      003278
                                                   003286      003291M     003308      003368M
                                                   003370M     003376
          INEVAL            N(1)                   000323D     001051      001143      001153M
                                                   001350      003538      003544      003545M
                                                   003568
          INEXTPROC         N(1)                   000230D     001172M     001177M     001902
                                                   002107      002111M     002150M
          INFREEFORMAT      N(1)                   000233D     000547      000550M     000720M
                                                   000737M     000746      000754M     000763
                                                   000771M     000800      000981
          INIF              N(1)                   000335D     000725      000882M     000950
                                                   001073      001143      001149M     001390
                                                   003760      003767      003772M     003789
                                                   003819M     003821M     003827
          ININTERFACE       N(1)                   000227D     001161      001173M     001868
                                                   001876      001882M
          INITIALCALL       A(1)                   000196D     005516      005534      005535M
                                                   005537M     005565
          INPROTOTYPE       N(1)                   000226D     001161      001171M     001866
                                                   001875      001880M     001899      005158
                                                   005644
          INSPAN            N(1)                   000236D     000728M     000730      000784M
                                                   001053      001074M     001143      001148M
                                                   001175M     001772      001780M     001809
                                                   001844      001848M     001858      001903
                                                   002156      002167M     002196      002215
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    202
                                                   002219M     002363      002367M     002383
                                                   002387M     002427      002431M     002440
                                                   002444M     002503      002507M     002523
                                                   002527M     002855      002860M     002865
                                                   002869M     003288      003292M     003298
                                                   003302M     003366      003371M     003552
                                                   003555M     003561      003564M     003603M
                                                   003606      003610M     003769      003773M
                                                   003779      003784M     003817      003822M
                                                   004783      004787M     004793      004797M
                                                   004830      004835M     004999M     005009M
                                                   005014      005035M     005043M     005049M
                                                   005057M     005062M     005067M     005074M
                                                   005081M     005088M     005095M     005101M
                                                   005251
          INSQL             N(1)                   000343D     000803      000823M     000873M
                                                   000878      001144      001154M     001198
                                                   003602M     003609M
          INWHEN            N(1)                   000339D     000945      000949M     001073
                                                   001143      001151M     001579      004774
                                                   004781      004786M     004802      004832M
                                                   004834M     004840
          J                 P(5,0)                 000208D     002053M     002054      002058
                                                   002059      002064      002065
          LEN               A(5)                   000100D     000860M     005351      005357
                                                   005358      005358      005366      005382
                                                   005382      005383M     005383      005385
          LINEEND           P(5,0)                 000255D     001064M     001065      001066M
                                                   001067      001068M     001069      001071M
                                                   001080      001082      001146M     001147
          LINETYPE          A(1)                   000089D     000502      000542M     000551M
                                                   000569M     000573M     000577M     000581M
                                                   000585M     000589M     000593M     000597
                                                   000609M     000624M     000760      001112
                                                   002348M     005001      005019M     005019
                                                   005021      005022      005026      005039
                                                   005047      005052      005093      005098
                                                   005164      005183M     005183      005185
                                                   005230      005231      005297      005331
                                                   005339      005429M     005650      005676M
                                                   005676      005678      005803M     005803
                                                   005805      005806      005810
          LO                CONST                  000078D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    203
                                                   001701      001725      001757      001764
                                                   001822      001936      001953      001964
                                                   001988      002046      002050      002052
                                                   002073      002075      002092      002115
                                                   002122      002130      002137      002145
                                                   002242      002243      002244      002245
                                                   002246      002277      002282      002766
                                                   002962      002962      003307      003672
                                                   003788      003955      004581      004613
                                                   004653      004653      004801      005001
                                                   005019      005054      005143      005164
                                                   005183      005191      005231      005236
                                                   005332      005334      005339      005341
                                                   005354      005375      005378      005389
                                                   005408      005624      005650      005666
                                                   005676      005685      005692      005788
                                                   005803
          LW                A(2)                   000103D     002711      002713      002798
                                                   002800      002817      002819      002934
                                                   002936      003016      003018      003047
                                                   003049      003092      003094      003129
                                                   003131      003150      003152      003174
                                                   003176      003206      003208      003232
                                                   003234      003410      003412      003635
                                                   003637      003698      003700      003717
                                                   003719      003852      003854      004048
                                                   004050      004077      004079      004113
                                                   004115      004150      004152      004184
                                                   004186      004220      004222      004240
                                                   004242      004260      004262      004294
                                                   004296      004329      004331      004389
                                                   004391      004424      004442      004476
                                                   004478      004633      004635      004675
                                                   004677      004699      004701      004731
                                                   004733      004757      004759      004872
                                                   004874      004946      004948
          LWCHECK           N(1)                   000378D     002640      002669      002680M
                                                   002935M     003175M
          LWFACTOR1         A(14)                  000380D     002672      002937M     003177M
          LWFACTOR2         A(14)                  000381D     002673      002938M     003178M
          LWIND             A(2)                   000379D     002642      002675      002936M
                                                   003176M
          MAINLINEINDENT    P(5,0)                 000256D     000898M     000899      000902M
                                                   000903      000907      001138      005590
          MAXINDENT         P(5,0)                 000210D     001042      001043      005583M
          MOVEDDEFS(9999)   A(14)                  000211D     005324M     005354      005407
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    204
                                                   005408M     005584M
          MOVEDEF           N(1)                   000212D     005352M     005359M     005376M
                                                   005399      005585M
          NEWOPERATOR       A(10)                  000219D     000989M     000993M     000999M
                            VARYING(2)             001002M     001008      001009      001011
                                                   001026
          NONCONVRSN        A(93)                  000220D     000505M     000660      000661M
                                                   000673      000674M     000685      000697
                                                   000709      000777      000780      001209M
                                                   001645M     002271M     002376M     002761M
                                                   002784M     002963M     003065M     003472M
                                                   003667M     003690M     003959M     003971M
                                                   004071M     004167M     004172M     004570M
                                                   004599M     004624M     004654M
          NONPREFIX         A(95)                  000109D     000434M     001109M     002544M
                                                   002555M     002566M     002577M     002588M
                                                   002599M     002615M     002636M     002641M
                                                   002646M     002655M     002670M     002685M
          NRFCHECK          N(1)                   000365D     002565      002571M     003043M
                                                   003228M     004290M     004468M
          NRFFILE           A(14)                  000367D     003045M     003230M     004292M
                                                   004470M
          NRFIND            A(2)                   000366D     002568      003044M     003229M
                                                   004291M     004469M
          OPCODE            A(10)                  000097D     000324      000328      000332
                                                   000336      000340      000654      000856
                                                   003307M     003307      003309      003310
                                                   003312      003313      003316      003788M
                                                   003788      003790      003793      003794
                                                   003797      004801M     004801      004803
                                                   004806      004807      004810      005054M
                                                   005054      005056      005061      005066
                                                   005071      005072      005073      005078
                                                   005079      005080      005085      005086
                                                   005087      005341M     005341      005343
                                                   005344      005345      005346      005347
                                                   005348      005349      005350      005351
                                                   005375
          OPERATOR          A(10)                  000217D     000654M     000667M     000802M
                                                   000804M     000807M     000808      000810
                                                   000812      000817M     000817      000819
                                                   000822M     000826      000828M     000828
                                                   000832      000836      000840M     000843M
                                                   000854M     000856M     000857      000858
                                                   000867M     000867      000880      000883
                                                   000888      000892      000896      000900
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    205
                                                   000905      000908      000910      000914
                                                   000915M     000918      000922      000926
                                                   000929      000933      000937      000941
                                                   000945      000954      000987      000991
                                                   001000M     001049      001051      001137
                                                   001214      001219      001224      001229
                                                   001234      001239      001244      001249
                                                   001254      001259      001264      001269
                                                   001274      001279      001284      001289
                                                   001294      001299      001304      001305
                                                   001306      001307      001308      001309
                                                   001310      001311      001312      001313
                                                   001314      001315      001316      001317
                                                   001318      001319      001325      001330
                                                   001335      001340      001345      001350
                                                   001355      001360      001365      001370
                                                   001375      001380      001385      001390
                                                   001395      001400      001405      001410
                                                   001415      001421      001426      001431
                                                   001436      001441      001446      001451
                                                   001456      001461      001466      001471
                                                   001476      001481      001486      001491
                                                   001496      001501      001506      001507
                                                   001512      001517      001522      001527
                                                   001532      001537      001542      001547
                                                   001551      001555      001559      001564
                                                   001569      001574      001579      001584
                                                   001589      001594      001599      002707
                                                   002728      002848M     002854      002858
                                                   002874      002892      002959      002968M
                                                   003032      003069      003070M     003072M
                                                   003081      003085      003127      003145
                                                   003201      003222      003249      003279M
                                                   003284      003285      003287      003377
                                                   003393      003427      003429      003470
                                                   003478      003478      003481M     003495
                                                   003495      003498M     003504      003504
                                                   003507M     003512      003514M     003516M
                                                   003520      003524      003539M     003546
                                                   003547      003548      003559      003569
                                                   003585      003625      003714      003733
                                                   003761M     003766      003768      003828
                                                   003845      003848      003868      003881
                                                   003942      003944      003949      003999
                                                   004043      004094      004096      004110
                                                   004143      004145      004177      004179
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    206
                                                   004201      004204      004256      004276
                                                   004310      004324      004458      004505
                                                   004534      004536M     004650      004691
                                                   004692M     004695      004728      004747
                                                   004775M     004780      004782      004841
                                                   004857      004888      004965      004984
                                                   005055      005060      005065      005070
                                                   005077      005084
          OPERATOREND       P(5,0)                 000218D     000808M     000809      000810M
                                                   000811      000812M     000816      000817
                                                   000826M     000827      000828
          OVERFLOW          N(1)                   000033D     000147D     000455      000466M
                                                   005568M
          OVERFLOWLINE      A(92)                  000260D     001120      001122      001123M
                            VARYING(2)             001787      002174
          PADRESULT         N(1)                   000284D     001031      001038M
          PADTARGET         A(14)                  000285D     001035
          PREFIX            A(5)                   000088D     000510
          PREVOFFSET        P(5,0)                 000253D     000733M     001054
          PROCKEYWORDS      A(37)                  000112D     002490      002492      005042
          PROCTYPE          A(1)                   000111D     005042
          QCOMMENTS(3)      A(92)                  000204D     005420      005422      005424
                                                   005443      005445      005447      005922M
          QDECLLO(12)       A(10)                  000203D     000993
          QDECLUP(12)       A(10)                  000202D     000203      000836      000991
                                                   005909M
          QOPCODELO(66)     A(10)                  000201D     000989
          QOPCODEUP(66)     A(10)                  000200D     000201      000832      000987
                                                   003955      005842M
          QPDIRECTIVES      A(1)                   000063D     000553      000747      000764
                            BASED(_QRNL_PRM+)
          QPFROMFILE        A(10)                  000055D     005571
                            BASED(_QRNL_PRM+)
          QPFROMLIB         A(10)                  000056D     005571
                            BASED(_QRNL_PRM+)
          QPFROMMBR         A(10)                  000022      000057D     000469
                            BASED(_QRNL_PRM+)
          QPINDCOMMENT      A(1)                   000061D     000600      000630
                            BASED(_QRNL_PRM+)
          QPRETBLNKCMT      A(1)                   000062D     000613      000634
                            BASED(_QRNL_PRM+)
          QPSHUTDOWN        A(1)                   000054D     005511      005516      005560
                            BASED(_QRNL_PRM+)
          QPTOFILE          A(10)                  000058D     005574
                            BASED(_QRNL_PRM+)
          QPTOLIB           A(10)                  000059D     005574
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    207
                            BASED(_QRNL_PRM+)
          QPTOMBR           A(10)                  000027      000060D     000470
                            BASED(_QRNL_PRM+)
          RESULT            A(14)                  000099D     000211      000285      002736
                                                   002737      002740      002789      002789
                                                   002791      002814      002891      002962
                                                   002972      003001      003005      003010
                                                   003035      003036      003064      003081
                                                   003085      003099      003114      003201
                                                   003256      003263      003345      003346M
                                                   003348      003399      003402      003403
                                                   003628      003629      003694      003946
                                                   003951      003955      003956      004007
                                                   004008      004011      004029      004065
                                                   004067      004171      004208      004209
                                                   004236      004286      004380      004385
                                                   004460      004461      004520      004543
                                                   004544      004547      004568      004604
                                                   004604      004606      004612      004613
                                                   004653      004669      004696      004715
                                                   004750      004751      004860      004861
                                                   004889      004893      004937      004962
                                                   004981      005354      005360      005377
                                                   005408
          SAVEDCOMMENT      A(20)                  000281D     000655M     000668M     000680M
                                                   000692M     000704M     001095      001096
                                                   001097M     002356M
          SAVEDLINETYPE     A(1)                   000247D     005001M     005005      005022
                                                   005164M     005185
          SAVEDNAME         A(80)                  000282D     001631      001650      001652
                                                   001810M     001820      001822      001859M
                                                   001888      001889M     001891      001894
                                                   001900      001904M     001907      001908
                                                   002085      002086M     002165M     002196
                                                   002197M     002275M     002282      002472
                                                   002487      002512M     005144M     005147M
                                                   005172      005174M     005174
          SAVEDSRCDTA       A(100)                 000258D     000748M     000752      000765M
                                                   000769      000778M     000782      001032M
                                                   001037      001090M     001100      001165M
                                                   001169      002347M     002352      003483M
                                                   003488      005000M     005128      005163M
                                                   005211      005222M     005310      005322M
                                                   005460
          SCANBASE          A(14)                  000288D     004359M     004362M     004369
                                                   004375
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    208
          SCANLENGTH        A(10)                  000289D     004348M     004351M     004366
                                                   004374
          SCANNORESULT      N(1)                   000291D     000433      000441M     004381M
                                                   004384M
          SCANSTART         A(10)                  000290D     004358M     004361M     004369
                                                   004375
          SCANSTRING        A(14)                  000287D     004349M     004352M     004368
                                                   004374
          SETOFF            N(1)                   000296D     001094      002598      002612M
                                                   004422M
          SETOFFIND1        A(2)                   000297D     002600      002601      004423M
          SETOFFIND2        A(2)                   000298D     002604      002605      004424M
          SETOFFIND3        A(2)                   000299D     002608      002609      004425M
          SETON             N(1)                   000301D     001094      002614      002628M
                                                   004440M
          SETONIND1         A(2)                   000302D     002616      002617      004441M
          SETONIND2         A(2)                   000303D     002620      002621      004442M
          SETONIND3         A(2)                   000304D     002624      002625      004443M
          SLCOUNT           P(5,0)                 000353D     000894M     000895      000913M
                                                   003505      003506
          SLLEVEL(99)       P(5,0)                 000354D     000895M     003506
 *RNF7031 SOURCEDATA        DS(100)                000086D
          SOURCELINE        A(93)                  000259D     000507M     000714M     000717M
                                                   000735M     000738M     000788M     000801
                                                   000807      000820      000841      000846M
                                                   000846      000853      000983      000996
                                                   001009      001010M     001010      001015M
                                                   001019      001020      001021      001022
                                                   001023      001024M     001024      001026M
                                                   001026      001058      001059      001064
                                                   001066      001069      001071      001092
                                                   001099M     001113      001115      001146
                                                   001193M     001614M     001619M     001808M
                                                   001857M     001895      002195M     002218M
                                                   002235M     002240M     002371M     002386M
                                                   002403M     002408M     002435M     002443M
                                                   002460M     002465M     002511M     002526M
                                                   002707M     002730M     002732M     002736M
                                                   002736      002740M     002740      002745M
                                                   002745      002789M     002791M     002794M
                                                   002794      002814M     002833M     002854M
                                                   002856M     002856      002863M     002864M
                                                   002866M     002866      002913M     002919M
                                                   002921M     003001M     003005M     003010M
                                                   003032M     003036M     003036      003038M
                                                   003038      003081M     003085M     003114M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    209
                                                   003127M     003145M     003147M     003147
                                                   003201M     003203M     003203      003222M
                                                   003224M     003224      003250M     003252M
                                                   003263M     003263      003287M     003289M
                                                   003289      003295M     003297M     003299M
                                                   003299      003310M     003314M     003317M
                                                   003348M     003363M     003363      003367M
                                                   003367      003393M     003396M     003396
                                                   003398M     003398      003400M     003400
                                                   003403M     003403      003407M     003407
                                                   003427M     003429M     003443M     003456M
                                                   003520M     003548M     003550M     003553M
                                                   003553      003558M     003559M     003562M
                                                   003562      003585M     003601M     003605M
                                                   003607M     003607      003625M     003629M
                                                   003629      003631M     003631      003651M
                                                   003694M     003714M     003733M     003746M
                                                   003768M     003770M     003770      003778M
                                                   003780M     003780      003791M     003795M
                                                   003798M     003814M     003814      003818M
                                                   003818      003845M     003848M     003868M
                                                   003881M     003928M     003946M     003951M
                                                   003956M     004001M     004003M     004007M
                                                   004007      004011M     004011      004016M
                                                   004016      004029M     004043M     004065M
                                                   004068M     004094M     004096M     004110M
                                                   004129M     004143M     004145M     004177M
                                                   004179M     004201M     004204M     004209M
                                                   004209      004211M     004211      004236M
                                                   004256M     004276M     004279M     004279
                                                   004283M     004283      004286M     004286
                                                   004310M     004324M     004326M     004326
                                                   004368M     004373M     004382M     004382
                                                   004385M     004385      004409M     004458M
                                                   004461M     004461      004463M     004463
                                                   004492M     004505M     004507M     004507
                                                   004520M     004537M     004539M     004543M
                                                   004543      004547M     004547      004552M
                                                   004552      004604M     004606M     004609M
                                                   004609      004628M     004669M     004695M
                                                   004715M     004728M     004747M     004751M
                                                   004751      004753M     004753      004782M
                                                   004784M     004784      004792M     004794M
                                                   004794      004804M     004808M     004811M
                                                   004827M     004827      004831M     004831
                                                   004857M     004861M     004861      004863M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    210
                                                   004863      004889M     004893M     004937M
                                                   004941M     004941      004943M     004943
                                                   004962M     004966M     004966      004981M
                                                   004985M     004985
          SPLITLINE         PROTOTYPE              001787M     002174M     005723      005726
          SRCDAT            P(6,0)                1000003M    2000003
          SRCDTA            A(100)                 000087D     000088      000089      000090
                                                   000091      000092      000094      000095
                                                   000096      000097      000098      000099
                                                   000100      000101      000102      000103
                                                   000104      000105      000107      000109
                                                   000111      000112      000114      000115
                                                   000116      000117      000118      000119
                                                   000120      000121      000122      000123
                                                   000124      000126      000258     1000004M
                                                   000511      000748      000749M     000752M
                                                   000765      000766M     000769M     000778
                                                   000779M     000782M     001032      001037M
                                                   001090      001100M     001165      001166M
                                                   001169M     002347      002352M     003483
                                                   003488M     005000      005128M     005163
                                                   005211M     005222      005310M     005322
                                                   005419M     005442M     005460M    2000004
                                                   005649      005712M     005782      005831M
          SRCSEQ            P(6,2)                 000072      000242      000243      000266
                                                   000270     1000002M     001162      005159
                                                   005192      005253      005282      005305
                                                   005321      005455     2000002      005608
                                                   005645      005667      005686      005693
          SUBEXITPROGRAM    BEGSR                  000410      005483D     005561
          SUBINITIALISE     BEGSR                  000404      005531D
          SUBSTLEN          A(10)                  000293D     004659M     004672
          SUBSTSTART        A(10)                  000294D     004663M     004666M     004671
          SUBUSERCHECKSPAN  BEGSR                  001625      002248      002410      002467
                                                   002851      003282      003542      003598
                                                   003764      004778      004997D
          SUBUSERCONVERTC_SPEC...
                            BEGSR                  000657      001188D
          SUBUSERCONVERTD_SPEC...
                            BEGSR                  000682      001610D
          SUBUSERCONVERTF_SPEC...
                            BEGSR                  000694      002231D
          SUBUSERCONVERTH_SPEC...
                            BEGSR                  000706      002399D
          SUBUSERCONVERTP_SPEC...
                            BEGSR                  000670      002456D
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    211
          SUBUSERCVT_ACQ    BEGSR                  001215      002705D
          SUBUSERCVT_ADD    BEGSR                  001225      002725D
          SUBUSERCVT_ADDDUR BEGSR                  001220      002756D
          SUBUSERCVT_ALLOC  BEGSR                  001230      002812D
          SUBUSERCVT_BEGSR  BEGSR                  001235      002831D
          SUBUSERCVT_CALLP  BEGSR                  001240      002844D
          SUBUSERCVT_CASXX  BEGSR                  001245      002888D
          SUBUSERCVT_CAT    BEGSR                  001250      002956D
          SUBUSERCVT_CHAIN  BEGSR                  001255      003030D
          SUBUSERCVT_CHECKX BEGSR                  001260      003061D
          SUBUSERCVT_CLEAR  BEGSR                  001265      003112D
          SUBUSERCVT_CLOSE  BEGSR                  001270      003125D
          SUBUSERCVT_COMMIT BEGSR                  001275      003143D
          SUBUSERCVT_COMP   BEGSR                  001280      003164D
          SUBUSERCVT_DEALLOC...
                            BEGSR                  001285      003199D
          SUBUSERCVT_DELETE BEGSR                  001295      003220D
          SUBUSERCVT_DIV    BEGSR                  001300      003246D
          SUBUSERCVT_DO     BEGSR                  001321      003276D
          SUBUSERCVT_DSPLY  BEGSR                  001326      003391D
          SUBUSERCVT_DUMP   BEGSR                  001331      003424D
          SUBUSERCVT_ELSE   BEGSR                  001336      003441D
          SUBUSERCVT_ELSEIF BEGSR                  001341      003454D
          SUBUSERCVT_ENDXX  BEGSR                  001346      003467D
          SUBUSERCVT_EVALX  BEGSR                  001351      003535D
          SUBUSERCVT_EXCEPT BEGSR                  001356      003583D
          SUBUSERCVT_EXEC_SQL...
                            BEGSR                  001199      003596D
          SUBUSERCVT_EXFMT  BEGSR                  001361      003623D
          SUBUSERCVT_EXSR   BEGSR                  001366      003649D
          SUBUSERCVT_EXTRCT BEGSR                  001371      003662D
          SUBUSERCVT_FEOD   BEGSR                  001376      003712D
          SUBUSERCVT_FOR    BEGSR                  001381      003744D
          SUBUSERCVT_FORCE  BEGSR                  001386      003731D
          SUBUSERCVT_IF     BEGSR                  001391      003757D
          SUBUSERCVT_IN     BEGSR                  001396      003842D
          SUBUSERCVT_ITER   BEGSR                  001401      003866D
          SUBUSERCVT_LEAVE  BEGSR                  001406      003879D
          SUBUSERCVT_LOOKUP BEGSR                  001411      003892D
          SUBUSERCVT_MONITOR...
                            BEGSR                  001422      003926D
          SUBUSERCVT_MOVE   BEGSR                  001427      003939D
          SUBUSERCVT_MOVEA  BEGSR                  001416      003985D
          SUBUSERCVT_MULT   BEGSR                  001432      003996D
          SUBUSERCVT_MVR    BEGSR                  001437      004027D
 *RNF7031 SUBUSERCVT_NEXT   BEGSR                  004041D
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    212
          SUBUSERCVT_OCCUR  BEGSR                  001442      004062D
          SUBUSERCVT_ON_ERROR...
                            BEGSR                  001447      004091D
          SUBUSERCVT_OPEN   BEGSR                  001452      004108D
          SUBUSERCVT_OTHER  BEGSR                  001457      004127D
          SUBUSERCVT_OUT    BEGSR                  001462      004140D
          SUBUSERCVT_POST   BEGSR                  001467      004164D
          SUBUSERCVT_READ   BEGSR                  001472      004198D
 *RNF7031 SUBUSERCVT_REALLOC...
                            BEGSR                  004234D
          SUBUSERCVT_REL    BEGSR                  001477      004254D
          SUBUSERCVT_RESET  BEGSR                  001482      004274D
          SUBUSERCVT_RETURN BEGSR                  001487      004308D
          SUBUSERCVT_ROLBK  BEGSR                  001492      004322D
          SUBUSERCVT_SCAN   BEGSR                  001497      004343D
          SUBUSERCVT_SELECT BEGSR                  001502      004407D
          SUBUSERCVT_SETOFF BEGSR                  001513      004420D
          SUBUSERCVT_SETON  BEGSR                  001518      004438D
          SUBUSERCVT_SETXX  BEGSR                  001508      004456D
          SUBUSERCVT_SHTDN  BEGSR                  001523      004490D
          SUBUSERCVT_SORTA  BEGSR                  001528      004503D
 *RNF7031 SUBUSERCVT_SQRT   BEGSR                  004518D
          SUBUSERCVT_SUB    BEGSR                  001543      004531D
          SUBUSERCVT_SUBDUR BEGSR                  001533      004563D
          SUBUSERCVT_SUBST  BEGSR                  001538      004647D
          SUBUSERCVT_TEST   BEGSR                  001560      004689D
          SUBUSERCVT_TIME   BEGSR                  001565      004713D
          SUBUSERCVT_UNLOCK BEGSR                  001575      004726D
          SUBUSERCVT_UPDATE BEGSR                  001570      004745D
          SUBUSERCVT_WHEN   BEGSR                  001580      004771D
          SUBUSERCVT_WRITE  BEGSR                  001585      004855D
 *RNF7031 SUBUSERCVT_XFOOT  BEGSR                  004886D
          SUBUSERCVT_XLATE  BEGSR                  001590      004906D
          SUBUSERCVT_Z_ADD  BEGSR                  001595      004960D
          SUBUSERCVT_Z_SUB  BEGSR                  001600      004978D
          SUBUSEREXITPROGRAM...
                            BEGSR                  005485      005506D
          SUBUSERFUNCTION   BEGSR                  000407      000417D
 *RNF7031 SUBUSERGETDECLARATIONTYPE...
                            BEGSR                  005137D
          SUBUSERGETENDLINE BEGSR                  001878      005220D
          SUBUSERINITIALISE BEGSR                  005541      005550D
          SUBUSERMOVEDEFS   BEGSR                  000967      005319D
          SUBUSERREFORMATLINE...
                            BEGSR                  000428      000437      000439      000447
                                                   000495D     002547      002558      002569
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    213
                                                   002580      002591      002602      002606
                                                   002610      002618      002622      002626
                                                   002638      002643      002648      002659
                                                   002661      002663      002674      002676
                                                   002678      002689      002691      002693
          SUBUSERSETINDICATORS...
                            BEGSR                  000430      002539D
          SUBUSERWRITELINE  BEGSR                  000751      000768      000781      001036
                                                   001117      001124      001168      002351
                                                   003487      005421      005423      005425
                                                   005434      005444      005446      005448
                                                   005469D
          TEMPDECLLINE      P(6,2)                 000270D     005267
          TEMPDECLTYPE      A(2)                   000269D     005265      005268
          TEMPSAVEDNAME     A(80)                  000271D     005266
          TOFILELIB         A(21)                  000215D     000462      005574M
          UNINDENT          N(1)                   000239D     000875M     000911M     000916M
                                                   000919M     000923M     000927M     000930M
                                                   000934M     000938M     000942M     000946M
                                                   000951M     000955M     000972      000975M
          UP                CONST                  000079D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
                                                   001701      001725      001757      001764
                                                   001822      001936      001953      001964
                                                   001988      002046      002050      002052
                                                   002073      002075      002092      002115
                                                   002122      002130      002137      002145
                                                   002242      002243      002244      002245
                                                   002246      002277      002282      002766
                                                   002962      003307      003672      003788
                                                   003955      004581      004613      004653
                                                   004801      005001      005019      005054
                                                   005143      005164      005183      005191
                                                   005231      005236      005332      005334
                                                   005339      005341      005354      005375
                                                   005378      005389      005408      005624
                                                   005650      005666      005676      005685
                                                   005692      005788      005803
          VALIDSPECS        CONST                  000080D     000540
          WHENCOMPARE       A(2)                   000341D     004803M     004807M     004810M
                                                   004814      004815M     004816      004817M
                                                   004818      004819M     004820      004821M
                                                   004822      004823M     004824      004825M
                                                   004828
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    214
          WHENOPERATOR      A(10)                  000340D     004775      004841M     004843M
          WORKDECLATTR      A(1)                   000264D     001622M     001656      001661M
                                                   001664M     001666M     001671      001673
                                                   001686      001688      001699      001710
                                                   001712      001714      001716      001718
                                                   001720      001722      001724      001739
                                                   001740      001741      001742      001743
                                                   001744      001896M     001913      001918M
                                                   001921M     001923M     001928      001930
                                                   001949      001951      001962      001973
                                                   001975      001977      001979      001981
                                                   001983      001985      001987      002002
                                                   002003      002004      002005      002006
                                                   002007      002013      002015
          WORKDECLKEYWORDS  A(92)                  000267D     001623M     001643      001674
                            VARYING(2)             001678M     001678      001680M     001680
                                                   001681      001690      001692      001693
                                                   001695      001697M     001697      001701
                                                   001703      001704      001706      001708M
                                                   001708      001725      001728M     001728
                                                   001757      001759      001761      001762M
                                                   001762      001764      001766      001773
                                                   001776M     001776      001784      001787
                                                   001792      001795      001826      001828
                                                   001831      001936      001940M     001940
                                                   001942M     001942      001943      001953
                                                   001955      001956      001958      001960M
                                                   001960      001964      001966      001967
                                                   001969      001971M     001971      001988
                                                   001991M     001991      002038M     002040M
                                                   002041      002046      002048      002051
                                                   002053      002056M     002058      002059
                                                   002061M     002062      002064      002065
                                                   002073      002075      002084M     002084
                                                   002092      002094M     002095      002097M
                                                   002097      002105      002109      002110M
                                                   002115      002117      002119      002120M
                                                   002120      002122      002124      002130
                                                   002132      002134      002135M     002135
                                                   002137      002139      002145      002147
                                                   002157      002159      002162M     002162
                                                   002171      002174      002179      002182
                                                   002214
          WORKDECLLINE      P(6,2)                 000266D     001631      002472      005159M
                                                   005166M     005192M     005253
          WORKDECLNAME      A(50)                  000265D     001178M     001894M     002052
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    215
          WORKDECLTYPE      A(2)                   000263D     001631      001637      001816
                                                   001865      001867      001869      001879
                                                   001881      001883      001887      001893
                                                   002472      002475      002476      002482
                                                   005143M     005146M     005151      005152
                                                   005153      005154      005155      005156
                                                   005157      005158      005191M
          WORKDIRECTIVE     A(10)                  000261D     000501M     000545      000561
                                                   000567      000571      000575      000579
                                                   000583      000587      000591      000595
                                                   000596      000603      000618      000761
                                                   000871      000874      001198      001203
                                                   003600
          WORKFILEADD       A(1)                   000275D     002244M     002259      002291
                                                   002301
          WORKFILEDESIG     A(1)                   000274D     002243M     002254      002255
                                                   002262      002263      002266
          WORKFILEDEVICE    A(7)                   000277D     002245M     002285      002286
                                                   002292      002293      002294      002307
                                                   002311
          WORKFILEKEYED     A(1)                   000276D     002246M     002322
          WORKFILEUSAGE     A(1)                   000273D     002242M     002253      002256
                                                   002258      002261      002265      002290
                                                   002300      002306      002310
          WORKLENGTH        P(7,0)                 000279D     002011M     002014M     002014
                                                   002016M     002016      002018      002020
          WORKLINETYPE      A(1)                   000262D     000502M     000520      000527
                                                   000530      000532      000534      000536
                                                   000538      000540      000541M     000552M
                                                   000570M     000574M     000578M     000582M
                                                   000586M     000590M     000594M     000600
                                                   000608      000608      000610M     000625M
                                                   000628      000630      000651      000664
                                                   000677      000689      000701      000713
                                                   000716      000719      000845      005231
          X                 P(5,0)                 000205D     000841M     000842      000987M
                                                   000988      000989      000991M     000992
                                                   000993      000996M     000997      001674M
                                                   001675      001677      001678      001680
                                                   001681      001690M     001691      001692M
                                                   001692      001693      001695      001695
                                                   001701M     001702      001703M     001703
                                                   001704      001706      001706      001725M
                                                   001726      001728      001757M     001758
                                                   001759      001761      001761      001762
                                                   001764      001764      001784M     001785
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    216
                                                   001786M     001786      001787      001936M
                                                   001937      001939      001940      001942
                                                   001943      001953M     001954      001955M
                                                   001955      001956      001958      001958
                                                   001964M     001965      001966M     001966
                                                   001967      001969      001969      001988M
                                                   001989      001991      002046M     002047
                                                   002048      002051      002051      002055
                                                   002062      002073M     002074      002075M
                                                   002077      002115M     002116      002117
                                                   002119      002119      002120      002122
                                                   002122      002130M     002131      002132
                                                   002134      002134      002135      002137
                                                   002137      002145M     002146      002147
                                                   002171M     002172      002173M     002173
                                                   002174      002728M     002729      002759M
                                                   002760      002765      002766      002959M
                                                   002960      002978M     002979      002983
                                                   002984      003076M     003079      003086
                                                   003087      003665M     003666      003671
                                                   003672      003942M     003944      003949
                                                   003999M     004000      004346M     004347
                                                   004351      004352      004356M     004357
                                                   004361      004362      004534M     004535
                                                   004566M     004567      004568M     004569
                                                   004580      004581      004612      004613
                                                   004650M     004651      004661M     004662
                                                   004664M     004666      004670      004918M
                                                   004919      004922      004923      004927M
                                                   004928      004932      004933      005002M
                                                   005017M     005124      005165M     005172M
                                                   005173      005174      005175M     005181M
                                                   005207      005228M     005278M     005292
                                                   005407M     005408
          XLATEBASE         A(14)                  000308D     004930M     004933M     004939
          XLATEFROM         A(14)                  000306D     004922M     004938
          XLATESTART        A(10)                  000309D     004929M     004932M     004940
                                                   004941
          XLATETO           A(14)                  000307D     004923M     004938
          Y                 P(5,0)                 000206D     001693M     001695      001697
                                                   001704M     001706      001708      001956M
                                                   001958      001960      001967M     001969
                                                   001971
          ZTFRFL            A(21)                  000461M    4000002
          ZTTOFL            A(21)                  000462M    4000003
          Z1CNVR            P(5,2)                 000478M     000480M    6000010
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    217
          Z1CTCV            P(7,0)                 000474M    6000008
          Z1CTEL            P(7,0)                 000473M    6000007
          Z1CTMV            P(7,0)                 000476M    6000006
          Z1CTNV            P(7,0)                 000475M    6000009
          Z1CTSC            P(7,0)                 000471M    6000004
          Z1CTTG            P(7,0)                 000472M    6000005
          Z1FRMB            A(10)                  000469M    6000002
          Z1QPAG            P(4,0)                 000458M    3000005
          Z1QPGM            A(10)                 3000002
          Z1QTTL            A(40)                  005567M    3000004
          Z1QUSR            A(10)                 3000003
          Z1TOMB            A(10)                  000470M    6000003
       Field References for subprocedure GETDECLARATIONTYPE
          Field             Attributes         References (D=Defined M=Modified)
          QPDECLLINE        P(6,2)                 005608D     005645M     005652M     005667M
                            BASED(_QRNL_PST+)      005686M     005693M
          QPDECLTYPE        A(2)                   005606D     005624M     005627M     005637
                            BASED(_QRNL_PST+)      005638      005639      005640      005641
                                                   005642      005643      005644      005666M
                                                   005685M     005692M
          QPSAVEDNAME       A(80)                  005607D     005625M     005628M     005631
                            BASED(_QRNL_PST+)      005633M     005633      005658      005660M
                                                   005660
          SAVEDLINETYPE     A(1)                   005614D     005650M     005678
          SAVEDSRCDTA       A(100)                 005616D     005649M     005712
          X                 P(3,0)                 005615D     005631M     005632      005633
                                                   005651M     005658M     005659      005660
                                                   005661M     005674M     005708
       Field References for subprocedure SPLITLINE
          Field             Attributes         References (D=Defined M=Modified)
          QPCURRENTLINE     A(92)                  005727D     005740      005747      005749
                            BASED(_QRNL_PST+)      005750M     005750
                            VARYING(2)
          QPMAXLENGTH       P(3,0)                 005729D     005741      005742
                            BASED(_QRNL_PST+)
          QPOVERFLOW        A(92)                  005728D     005739M     005749M
                            BASED(_QRNL_PST+)
                            VARYING(2)
          X                 P(3,0)                 005735D     005740M     005741      005742M
                                                   005746      005746      005747      005749
                                                   005750
       Field References for subprocedure ADJUSTARRAYLENGTH
          Field             Attributes         References (D=Defined M=Modified)
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    218
          ELEMENTS          P(5,0)                 005777D     005792M     005794      005795
          I                 P(3,0)                 005775D     005788M     005790      005791
                                                   005792      005792      005827
          J                 P(3,0)                 005776D     005791M     005792
          QPLENGTH          P(7,0)                 005768D     005794      005795M     005795
                            BASED(_QRNL_PST+)
          SAVEDSRCDTA       A(100)                 005778D     005782M     005831
          X                 P(3,0)                 005774D     005783M     005801M     005827
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                       005494M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    219
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          No references in the source.
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    220
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00     13 The name or indicator is not referenced.
 *RNF7066 00      1 Record-Format name of Externally-Described file is not used.
 *RNF7086 00      1 RPG handles blocking for the file. INFDS is updated only when
                    blocks of data are transferred.
 *RNF7099 00      1 A COMMIT or ROLBK operation is used in the program with no
                    files defined with commitment control.
 *RNF3776 10      1 External program on prototype for main procedure is not the
                    same as program being created.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 15:32:51        Page    221
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :       16
     Warning      (10) . . . . . . . :        1
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :       17
   Source Totals:
     Records . . . . . . . . . . . . :     5855
     Specifications  . . . . . . . . :     3790
     Data records  . . . . . . . . . :       81
     Comments  . . . . . . . . . . . :     1050
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program CVTRPGFRER placed in library CVTRPGFREE. 10 highest severity. Created on 25-06-20 at 15:32:52.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
