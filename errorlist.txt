  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   CVTRPGFRER
     Library  . . . . . . . . . . . :     CVTRPGFREE
   Text 'description' . . . . . . . :   Convert to RPG free
   Source stream file   . . . . . . :   src/cvtRpgFreR.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   01.11.19  16:48:31
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *NOUNREF   *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                     *FREE            000001
      2   Ctl-Opt Debug                                                                                                      000002
      3           DftActGrp( *No ) ActGrp( *Caller )                                                                         000003
      4           Option( *ShowCpy: *SrcStmt: *NoDebugIO );                                                                  000004
 000005                                                                                                                      000005
 000006   //-------------------------------------------------------------------------------------------                      000006
 000007   // Program Name. . . . . : CVTRPGFREE                                                                              000007
 000008   // Program Description . : Convert RPGILE Source Member to Free-form                                               000008
 000009   // Date Created. . . . . : 30/04/2015                                                                              000009
 000010   // Programmer. . . . . . : Ewarwoowar                                                                              000010
 000011   //-------------------------------------------------------------------------------------------                      000011
 000012   // SYNOPSIS :                                                                                                      000012
 000013   // - Reads through an RPGILE source member and reformats the contents.                                             000013
 000014   //-------------------------------------------------------------------------------------------                      000014
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000016   //-------------------------------------------------------------------------------------------                      000016
 000017   // F I L E S                                                                                                       000017
 000018   //-------------------------------------------------------------------------------------------                      000018
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *                 Convert to RPG free                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *SRCSTMT          *
         *                                       *NODEBUGIO *NOUNREF          *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   *NONE                        *
         *  Activation group . . . . . . . . :   *CALLER                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
 000019   Dcl-F QRPGLESRC              EXTMBR(QpFromMbr)                                                                     000019
 000020                                EXTFILE('QTEMP/QRPGLESRC')                                                            000020
 000021                                RENAME(QRPGLESRC:SRCREC)                                                              000021
 000022                                USROPN;                                                                               000022
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC        LIBHTTP/QRPGLESRC                           *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         * Record format(s) . . . . . :  SRCREC           QRPGLESRC                                   *
         *--------------------------------------------------------------------------------------------*
 000023                                                                                                                      000023
 000024   Dcl-F QRPGLESRC2             Usage(*OUTPUT) EXTMBR(QpToMbr)                                                        000024
 000025                                EXTFILE('QTEMP/QRPGLESRC2')                                                           000025
 000026                                RENAME(QRPGLESRC2:OUTREC)                                                             000026
 000027                                USROPN;                                                                               000027
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC2       CVTRPGFREE/QRPGLESRC2                       *
         * Record format(s) . . . . . :  OUTREC           QRPGLESRC2                                  *
         *--------------------------------------------------------------------------------------------*
 000028                                                                                                                      000028
 000029   Dcl-F CVTRPGFREP     PRINTER USROPN                                                                                000029
 000030                                OFLIND(overFlow);                                                                     000030
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  CVTRPGFREP       CVTRPGFREE/CVTRPGFREP                       *
         * Record format(s) . . . . . :  Z1PAGHDG         Z1PAGHDG                                    *
         *                               Z1TOPPAG         Z1TOPPAG                                    *
         *                               ZL01HDG          ZL01HDG                                     *
         *                               Z1DETAIL         Z1DETAIL                                    *
         *                               Z1ENDRPT         Z1ENDRPT                                    *
         *--------------------------------------------------------------------------------------------*
 000031                                                                                                                      000031
 000032   //-------------------------------------------------------------------------------------------                      000032
 000033   // P R O C E D U R E   I N T E R F A C E                                                                           000033
 000034   //-------------------------------------------------------------------------------------------                      000034
 000035                                                                                                                      000035
 000036   Dcl-PR CVTRPGFREE               EXTPGM('CVTRPGFREE');                                                              000036
 000037      QpShutDown               Char(1) CONST;                                                                         000037
 000038      QpFromFile               Char(10) CONST;                                                                        000038
 000039      QpFromLib                Char(10) CONST;                                                                        000039
 000040      QpFromMember             Char(10) CONST;                                                                        000040
 000041      QpToFile                 Char(10) CONST;                                                                        000041
 000042                                                                                                                      000042
 000043      QpToLib                  Char(10) CONST;                                                                        000043
 000044      QpToMbr                  Char(10) CONST;                                                                        000044
 000045      QpIndComment             Char(1) CONST;                                                                         000045
 000046      QpRetBlnkCmt             Char(1) CONST;                                                                         000046
 000047      QpDirectives             Char(1) CONST;                                                                         000047
 000048   End-PR;                                                                                                            000048
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000049                                                                                                                      000049
 000050   Dcl-PI CVTRPGFREE;                                                                                                 000050
 ======>         aaaaaaaaaa
 *RNF3776 10 a      000050  External program on prototype for main procedure is not the
                            same as program being created.
 000051      QpShutDown               Char(1) CONST;                                                                         000051
 000052      QpFromFile               Char(10) CONST;                                                                        000052
 000053      QpFromLib                Char(10) CONST;                                                                        000053
 000054      QpFromMbr                Char(10) CONST;                                                                        000054
 000055      QpToFile                 Char(10) CONST;                                                                        000055
 000056      QpToLib                  Char(10) CONST;                                                                        000056
 000057      QpToMbr                  Char(10) CONST;                                                                        000057
 000058      QpIndComment             Char(1) CONST;                                                                         000058
 000059      QpRetBlnkCmt             Char(1) CONST;                                                                         000059
 000060      QpDirectives             Char(1) CONST;                                                                         000060
 000061   End-PI;                                                                                                            000061
 000062                                                                                                                      000062
 000063   //-------------------------------------------------------------------------------------------                      000063
 000064   // P R O T O T Y P E   I N T E R F A C E S                                                                         000064
 000065   //-------------------------------------------------------------------------------------------                      000065
 000066   Dcl-PR GetDeclarationType;                                                                                         000066
 000067      QpDeclType               Char( 2 );                                                                             000067
 000068      QpSavedName              Char( 80 );                                                                            000068
 000069      QpDeclLine                        Like(SRCSEQ);                                                                 000069
 000070   End-PR;                                                                                                            000070
 000071                                                                                                                      000071
 000072   //-------------------------------------------------------------------------------------------                      000072
 000073   // N A M E D   C O N S T A N T S                                                                                   000073
 000074   //-------------------------------------------------------------------------------------------                      000074
 000075   Dcl-C LO                        'abcdefghijklmnopqrstuvwxyz';                                                      000075
 000076   Dcl-C UP                        'ABCDEFGHIJKLMNOPQRSTUVWXYZ';                                                      000076
 000077   Dcl-C VALIDSPECS                'HFDCP';                                                                           000077
 000078                                                                                                                      000078
 000079   //-------------------------------------------------------------------------------------------                      000079
 000080   // D A T A   S T R U C T U R E S                                                                                   000080
 000081   //-------------------------------------------------------------------------------------------                      000081
 000082                                                                                                                      000082
 000083   Dcl-DS SourceData;                                                                                                 000083
 000084      SRCDTA                   Char(100);                                                                             000084
 000085      prefix                   Char(5) OVERLAY(SRCDTA:1);                                                             000085
 000086      lineType                 Char(1) OVERLAY(SRCDTA:6);                                                             000086
 000087      directive                Char(10) OVERLAY(SRCDTA:7);                                                            000087
 000088      codeLine                 Char(93) OVERLAY(SRCDTA:8);                                                            000088
 000089      fullLine                 Char(94) OVERLAY(SRCDTA:7);                                                            000089
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000090                                                                                                                      000090
 000091      condNot                  Char(1) OVERLAY(SRCDTA:9);                                                             000091
 000092      condInd                  Char(2) OVERLAY(SRCDTA:10);                                                            000092
 000093      factor1                  Char(14) OVERLAY(SRCDTA:12);                                                           000093
 000094      opCode                   Char(10) OVERLAY(SRCDTA:26);                                                           000094
 000095      factor2                  Char(14) OVERLAY(SRCDTA:36);                                                           000095
 000096      result                   Char(14) OVERLAY(SRCDTA:50);                                                           000096
 000097      len                      Char(5) OVERLAY(SRCDTA:64);                                                            000097
 000098      dec                      Char(2) OVERLAY(SRCDTA:69);                                                            000098
 000099      hi                       Char(2) OVERLAY(SRCDTA:71);                                                            000099
 000100      lw                       Char(2) OVERLAY(SRCDTA:73);                                                            000100
 000101      eq                       Char(2) OVERLAY(SRCDTA:75);                                                            000101
 000102      comment                  Char(20) OVERLAY(SRCDTA:81);                                                           000102
 000103                                                                                                                      000103
 000104      extFactor2               Char(45) OVERLAY(SRCDTA:36);                                                           000104
 000105                                                                                                                      000105
 000106      nonPrefix                Char(95) OVERLAY(SRCDTA:6);                                                            000106
 000107                                                                                                                      000107
 000108      procType                 Char(1) OVERLAY(SRCDTA:24);                                                            000108
 000109      procKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000109
 000110                                                                                                                      000110
 000111      declName                 Char(15) OVERLAY(SRCDTA:7);                                                            000111
 000112      declExt                  Char(1) OVERLAY(SRCDTA:22);                                                            000112
 000113      declPrefix               Char(1) OVERLAY(SRCDTA:23);                                                            000113
 000114      declType                 Char(2) OVERLAY(SRCDTA:24);                                                            000114
 000115      declSuffix               Char(1) OVERLAY(SRCDTA:26);                                                            000115
 000116      declFrom                 Char(7) OVERLAY(SRCDTA:26);                                                            000116
 000117      declLen                  Char(7) Overlay(SRCDTA:33);                                                            000117
 000118      declAttr                 Char(1) Overlay(SRCDTA:40);                                                            000118
 000119      declScale                Char(3) Overlay(SRCDTA:41);                                                            000119
 000120      declKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000120
 000121      declOptions              Char(73) Overlay(SRCDTA:7);                                                            000121
 000122                                                                                                                      000122
 000123      FileSpec                 Char(100) Overlay(SRCDTA:1);                                                           000123
 000124      fileName                 Char(10) Overlay(FileSpec:7);                                                          000124
 000125      fileUsage                Char(1) Overlay(FileSpec:17);                                                          000125
 000126      fileDesig                Char(1) Overlay(FileSpec:18);                                                          000126
 000127      fileAdd                  Char(1) Overlay(FileSpec:20);                                                          000127
 000128      fileExternal             Char(1) Overlay(FileSpec:22);                                                          000128
 000129      fileKeyed                Char(1) Overlay(FileSpec:34);                                                          000129
 000130      fileDevice               Char(7) Overlay(FileSpec:36);                                                          000130
 000131      fileKeywords             Char(37) Overlay(FileSpec:44);                                                         000131
 000132   End-DS;                                                                                                            000132
 000133                                                                                                                      000133
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000134   // Display file indicators ------------------------------------------------------------------                      000134
 000135   Dcl-DS IndicatorDS;                                                                                                000135
 000136    // 01-30: Function keys                                                                                           000136
 000137    // 31-59: Conditioning indicators (error)                                                                         000137
 000138    // 60-89: Conditioning indicators (non-error)                                                                     000138
 000139    // 90-99: General indicators                                                                                      000139
 000140   // Report file indicators -------------------------------------------------------------------                      000140
 000141    // 01-79: Conditioning indicators (non-error)                                                                     000141
 000142      cndIndicators             Ind Pos(01) DIM(79);                                                                  000142
 000143    // 80-89: Report control                                                                                          000143
 000144      overFlow                  Ind Pos(80);                                                                          000144
 000145    // 90-99: General indicators                                                                                      000145
 000146      errorInd                  Ind Pos(99) INZ(*OFF);                  // Global error                               000146
 000147   End-DS;                                                                                                            000147
 000148                                                                                                                      000148
 000149   Dcl-DS DCLPR                    QUALIFIED;                                                                         000149
 000150      decl                     Char(7) INZ('Dcl-PR ');                                                                000150
 000151      procName                 Char(16);                                                                              000151
 000152      type                     Char(9);                                                                               000152
 000153      definition               Char(37);                                                                              000153
 000154      comment                  Char(23);                                                                              000154
 000155      fieldName                Char(23) Pos(4);                                                                       000155
 000156   End-DS;                                                                                                            000156
 000157                                                                                                                      000157
 000158   Dcl-DS DCLP                     QUALIFIED;                           // Test comment                               000158
 000159      decl                     Char(9) INZ('Dcl-Proc ');                                                              000159
 000160      definition               Char(61);                                                                              000160
 000161      comment                  Char(23);                                                                              000161
 000162   End-DS;                                                                                                            000162
 000163                                                                                                                      000163
 000164   Dcl-DS DCLS                     QUALIFIED;                                                                         000164
 000165      decl                     Char(6) INZ('Dcl-S ');                                                                 000165
 000166      fieldName                Char(17);                                                                              000166
 000167      type                     Char(9);                                                                               000167
 000168      definition               Char(37);                                                                              000168
 000169      comment                  Char(23);                                                                              000169
 000170   End-DS;                                                                                                            000170
 000171                                                                                                                      000171
 000172   Dcl-DS DCLF                     QUALIFIED;                                                                         000172
 000173      decl                     Char(6) INZ('Dcl-F ');                                                                 000173
 000174      fileName                 Char(15);                                                                              000174
 000175      device                   Char(8);                                                                               000175
 000176      definition               Char(44);                                                                              000176
 000177      comment                  Char(23) Pos(70);                                                                      000177
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000178   End-DS;                                                                                                            000178
 000179                                                                                                                      000179
 000180   Dcl-DS DCLH                     QUALIFIED;                                                                         000180
 000181      decl                     Char(8) INZ('Ctl-Opt ');                                                               000181
 000182      options                  Char(62);                                                                              000182
 000183      comment                  Char(23);                                                                              000183
 000184   End-DS;                                                                                                            000184
 000185                                                                                                                      000185
 000186   //-------------------------------------------------------------------------------------------                      000186
 000187   // S T A N D - A L O N E   V A R I A B L E S                                                                       000187
 000188   //-------------------------------------------------------------------------------------------                      000188
 000189   // Template variables (required - do not alter).                                                                   000189
 000190   Dcl-S cfgCommitControl                                               // Test comment                               000190
 000191                               Char(7) INZ('*SLAVE ');                  // *MASTER/*SLAVE                             000191
 000192   Dcl-S cfgCloseDown          Char(1) INZ('N');                        // Close down program?                        000192
 000193   Dcl-S initialCall           Char(1) INZ(*Blank);                                                                   000193
 000194                                                                                                                      000194
 000195   // End of Template variables (required - do not alter).                                                            000195
 000196   //-------------------------------------------------------------------------------------------                      000196
 000197   Dcl-S QopCodeUP             Char(10) DIM(66) PERRCD(1) CTDATA;                                                     000197
 000198   Dcl-S QopCodeLO             Char(10) DIM(66) ALT(QopCodeUP);                                                       000198
 000199   Dcl-S QdeclUP               Char(10) DIM(12) PERRCD(1) CTDATA;                                                     000199
 000200   Dcl-S QdeclLO               Char(10) DIM(12) ALT(QdeclUP);                                                         000200
 000201   Dcl-S Qcomments             Char(92) DIM(3) CTDATA;                                                                000201
 000202   Dcl-S x                   Packed(3:0);                                                                             000202
 000203   Dcl-S y                   Packed(3:0);                                                                             000203
 000204   Dcl-S i                   Packed(3:0);                                                                             000204
 000205   Dcl-S j                   Packed(3:0);                                                                             000205
 000206   Dcl-S blanks                Char(30) INZ(*Blanks);                                                                 000206
 000207   Dcl-S maxIndent           Packed(3:0) INZ(15);                                                                     000207
 000208   Dcl-S movedDefs                 LIKE(result) DIM(999);                                                             000208
 000209   Dcl-S moveDef                Ind INZ(*Off);                                                                        000209
 000210                                                                                                                      000210
 000211   Dcl-S fromFileLib           Char(21);                                                                              000211
 000212   Dcl-S toFileLib             Char(21);                                                                              000212
 000213                                                                                                                      000213
 000214   Dcl-S operator              Char(10);                                                                              000214
 000215   Dcl-S operatorEnd         Packed(3:0);                                                                             000215
 000216   Dcl-S newOperator        VarChar(10);                                                                              000216
 000217   Dcl-S nonConvRsn                LIKE(codeLine);                                                                    000217
 000218                                                                                                                      000218
 000219   Dcl-S inCode                 Ind INZ(*Off);                                                                        000219
 000220   Dcl-S inArrayData            Ind INZ(*Off);                                                                        000220
 000221   Dcl-S inComment              Ind INZ(*Off);                                                                        000221
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000222   Dcl-S inDeclaration          Ind INZ(*Off);                                                                        000222
 000223   Dcl-S inPrototype            Ind INZ(*Off);                                                                        000223
 000224   Dcl-S inInterface            Ind INZ(*Off);                                                                        000224
 000225   Dcl-S inDatastructure                                                                                              000225
 000226                                Ind INZ(*Off);                                                                        000226
 000227   Dcl-S inExtProc              Ind INZ(*Off);                                                                        000227
 000228   Dcl-S endDS                  Ind INZ(*Off);                                                                        000228
 000229   Dcl-S inDirective            Ind INZ(*Off);                                                                        000229
 000230   Dcl-S inFreeFormat           Ind INZ(*On);                                                                         000230
 000231   Dcl-S inDeclProc             Ind INZ(*Off);                                                                        000231
 000232   Dcl-S indent                 Ind INZ(*Off);                                                                        000232
 000233   Dcl-S inSpan                 Ind INZ(*Off);                                                                        000233
 000234   Dcl-S inCase                 Ind INZ(*Off);                                                                        000234
 000235   Dcl-S convert                Ind INZ(*Off);                                                                        000235
 000236   Dcl-S unindent               Ind INZ(*Off);                                                                        000236
 000237   Dcl-S defsMoved              Ind INZ(*Off);                                                                        000237
 000238   Dcl-S dropLine               Ind INZ(*Off);                                                                        000238
 000239   Dcl-S codeStart                 LIKE(SRCSEQ) INZ(0);                                                               000239
 000240   Dcl-S endLine                   LIKE(SRCSEQ) INZ(0);                 // Close struct here.                         000240
 000241   Dcl-S endFound               Ind;                                                                                  000241
 000242   Dcl-S endDeclType           Char(2);                                                                               000242
 000243                                                                                                                      000243
 000244   Dcl-S savedLineType         Char(1);                                                                               000244
 000245                                                                                                                      000245
 000246   Dcl-S increment           Packed(1:0) INZ(0);                                                                      000246
 000247   Dcl-S indentCount         Packed(3:0) INZ(0);                                                                      000247
 000248   Dcl-S indentSize          Packed(1:0) INZ(3);                                                                      000248
 000249   Dcl-S indentOffset        Packed(3:0) INZ(0);                                                                      000249
 000250   Dcl-S prevOffset          Packed(3:0) INZ(0);                                                                      000250
 000251   Dcl-S currOffset          Packed(3:0) INZ(0);                                                                      000251
 000252   Dcl-S lineEnd             Packed(3:0) INZ(0);                                                                      000252
 000253   Dcl-S mainlineIndent      Packed(3:0) INZ(1);                                                                      000253
 000254                                                                                                                      000254
 000255   Dcl-S savedSRCDTA               LIKE(SRCDTA);                                                                      000255
 000256   Dcl-S sourceLine            Char(93);                                                                              000256
 000257   Dcl-S overflowLine       VarChar(92);                                                                              000257
 000258   Dcl-S workDirective         Char(10);                                                                              000258
 000259   Dcl-S workLineType          Char(1);                                                                               000259
 000260   Dcl-S workDeclType          Char(2);                                                                               000260
 000261   Dcl-S workDeclAttr          Char(1);                                                                               000261
 000262   Dcl-S workDeclName          Char(50);                                                                              000262
 000263   Dcl-S workDeclLine              LIKE(SRCSEQ);                                                                      000263
 000264   Dcl-S workDeclKeywords   VarChar(92);                                                                              000264
 000265                                                                                                                      000265
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000266   Dcl-S tempDeclType          Char(2);                                                                               000266
 000267   Dcl-S tempDeclLine              LIKE(SRCSEQ);                                                                      000267
 000268   Dcl-S tempSavedName         Char(80);                                                                              000268
 000269                                                                                                                      000269
 000270   Dcl-S workFileUsage         Char(1);                                                                               000270
 000271   Dcl-S workFileDesig         Char(1);                                                                               000271
 000272   Dcl-S workFileAdd           Char(1);                                                                               000272
 000273   Dcl-S workFileKeyed         Char(1);                                                                               000273
 000274   Dcl-S workFileDevice        Char(7);                                                                               000274
 000275   Dcl-S checkLength         Packed(3:0);                                                                             000275
 000276   Dcl-S workLength          Packed(7:0);                                                                             000276
 000277                                                                                                                      000277
 000278   Dcl-S savedComment          Char(20);                                                                              000278
 000279   Dcl-S savedName             Char(80);                                                                              000279
 000280                                                                                                                      000280
 000281   Dcl-S padResult              Ind INZ(*Off);                                                                        000281
 000282   Dcl-S padTarget                 LIKE(result);                                                                      000282
 000283                                                                                                                      000283
 000284   Dcl-S scanString                LIKE(factor1);                                                                     000284
 000285   Dcl-S scanBase                  LIKE(factor2);                                                                     000285
 000286   Dcl-S scanLength            Char(10);                                                                              000286
 000287   Dcl-S scanStart             Char(10);                                                                              000287
 000288   Dcl-S scanNoResult           Ind INZ(*Off);                                                                        000288
 000289                                                                                                                      000289
 000290   Dcl-S substLen              Char(10);                                                                              000290
 000291   Dcl-S substStart            Char(10);                                                                              000291
 000292                                                                                                                      000292
 000293   Dcl-S setOff                 Ind INZ(*Off);                                                                        000293
 000294   Dcl-S setOffInd1            Char(2);                                                                               000294
 000295   Dcl-S setOffInd2            Char(2);                                                                               000295
 000296   Dcl-S setOffInd3            Char(2);                                                                               000296
 000297                                                                                                                      000297
 000298   Dcl-S setOn                  Ind INZ(*Off);                                                                        000298
 000299   Dcl-S setOnInd1             Char(2);                                                                               000299
 000300   Dcl-S setOnInd2             Char(2);                                                                               000300
 000301   Dcl-S setOnInd3             Char(2);                                                                               000301
 000302                                                                                                                      000302
 000303   Dcl-S xlateFrom                 LIKE(factor1);                                                                     000303
 000304   Dcl-S xlateTo                   LIKE(factor1);                                                                     000304
 000305   Dcl-S xlateBase                 LIKE(factor2);                                                                     000305
 000306   Dcl-S xlateStart            Char(10);                                                                              000306
 000307                                                                                                                      000307
 000308   Dcl-S caseSubRoutine        Char(10);                                                                              000308
 000309   Dcl-S caseOperator          Char(4);                                                                               000309
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000310                                                                                                                      000310
 000311   Dcl-S catFactor1                LIKE(factor1);                                                                     000311
 000312   Dcl-S catFactor2                LIKE(factor2);                                                                     000312
 000313   Dcl-S catCount            Packed(3:0) INZ(0);                                                                      000313
 000314   Dcl-S catBlanks                 LIKE(factor2);                                                                     000314
 000315                                                                                                                      000315
 000316   Dcl-S durDuration               LIKE(factor2);                                                                     000316
 000317   Dcl-S durCode                   LIKE(factor2);                                                                     000317
 000318   Dcl-S durNewDate             Ind INZ(*Off);                                                                        000318
 000319                                                                                                                      000319
 000320   Dcl-S inEval                 Ind INZ(*Off);                                                                        000320
 000321   Dcl-S evalOperator              Like(opCode);                                                                      000321
 000322   Dcl-S evalOffset          Packed(3:0);                                                                             000322
 000323                                                                                                                      000323
 000324   Dcl-S inCallP                Ind INZ(*Off);                                                                        000324
 000325   Dcl-S callPOperator             Like(opCode);                                                                      000325
 000326   Dcl-S callPOffset         Packed(3:0);                                                                             000326
 000327                                                                                                                      000327
 000328   Dcl-S inDo                   Ind INZ(*Off);                                                                        000328
 000329   Dcl-S doOperator                Like(opCode);                                                                      000329
 000330   Dcl-S doCompare             Char(2);                                                                               000330
 000331                                                                                                                      000331
 000332   Dcl-S inIf                   Ind INZ(*Off);                                                                        000332
 000333   Dcl-S ifOperator                Like(opCode);                                                                      000333
 000334   Dcl-S ifCompare             Char(2);                                                                               000334
 000335                                                                                                                      000335
 000336   Dcl-S inWhen                 Ind INZ(*Off);                                                                        000336
 000337   Dcl-S whenOperator              Like(opCode);                                                                      000337
 000338   Dcl-S whenCompare           Char(2);                                                                               000338
 000339                                                                                                                      000339
 000340   Dcl-S inSQL                  Ind INZ(*Off);                                                                        000340
 000341                                                                                                                      000341
 000342   Dcl-S forCount            Packed(3:0) INZ(0);                                                                      000342
 000343   Dcl-S forLevel            Packed(3:0) DIM(99);                          // Allow for 99                            000343
 000344   Dcl-S forFactor1                LIKE(factor1);                                                                     000344
 000345   Dcl-S forFactor2                LIKE(factor2);                                                                     000345
 000346                                                                                                                      000346
 000347   Dcl-S doCount             Packed(3:0) INZ(0);                                                                      000347
 000348   Dcl-S doLevel             Packed(3:0) DIM(99);                          // Allow for 99                            000348
 000349                                                                                                                      000349
 000350   Dcl-S slCount             Packed(3:0) INZ(0);                                                                      000350
 000351   Dcl-S slLevel             Packed(3:0) DIM(99);                          // Allow for 99                            000351
 000352                                                                                                                      000352
 000353   Dcl-S divFactor1                LIKE(factor1);                                                                     000353
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000354   Dcl-S divFactor2                LIKE(factor2);                                                                     000354
 000355                                                                                                                      000355
 000356   Dcl-S ERRCheck               Ind INZ(*Off);                                                                        000356
 000357   Dcl-S ERRInd                Char(2);                                                                               000357
 000358                                                                                                                      000358
 000359   Dcl-S foundCheck             Ind INZ(*Off);                                                                        000359
 000360   Dcl-S foundInd              Char(2);                                                                               000360
 000361                                                                                                                      000361
 000362   Dcl-S NRFCheck               Ind INZ(*Off);                                                                        000362
 000363   Dcl-S NRFInd                Char(2);                                                                               000363
 000364   Dcl-S NRFFile                   LIKE(factor2);                                                                     000364
 000365                                                                                                                      000365
 000366   Dcl-S EOFCheck               Ind INZ(*Off);                                                                        000366
 000367   Dcl-S EOFInd                Char(2);                                                                               000367
 000368   Dcl-S EOFFile                   LIKE(factor2);                                                                     000368
 000369                                                                                                                      000369
 000370   Dcl-S HICheck                Ind INZ(*Off);                                                                        000370
 000371   Dcl-S HIInd                 Char(2);                                                                               000371
 000372   Dcl-S HiFactor1                 LIKE(factor1);                                                                     000372
 000373   Dcl-S HiFactor2                 LIKE(factor2);                                                                     000373
 000374                                                                                                                      000374
 000375   Dcl-S LWCheck                Ind INZ(*Off);                                                                        000375
 000376   Dcl-S LWInd                 Char(2);                                                                               000376
 000377   Dcl-S LWFactor1                 LIKE(factor1);                                                                     000377
 000378   Dcl-S LWFactor2                 LIKE(factor2);                                                                     000378
 000379                                                                                                                      000379
 000380   Dcl-S EQCheck                Ind INZ(*Off);                                                                        000380
 000381   Dcl-S EQInd                 Char(2);                                                                               000381
 000382   Dcl-S EQFactor1                 LIKE(factor1);                                                                     000382
 000383   Dcl-S EQFactor2                 LIKE(factor2);                                                                     000383
 000384                                                                                                                      000384
 000385   Dcl-S equalCheck             Ind INZ(*Off);                                                                        000385
 000386   Dcl-S equalInd              Char(2);                                                                               000386
 000387                                                                                                                      000387
 000388   Dcl-S countSource         Packed(7:0) INZ(0);                                                                      000388
 000389   Dcl-S countTarget         Packed(7:0) INZ(0);                                                                      000389
 000390   Dcl-S countEligible       Packed(7:0) INZ(0);                                                                      000390
 000391   Dcl-S countConv           Packed(7:0) INZ(0);                                                                      000391
 000392   Dcl-S countNotConv        Packed(7:0) INZ(0);                                                                      000392
 000393   Dcl-S countMoved          Packed(7:0) INZ(0);                                                                      000393
 000394                                                                                                                      000394
 000395   //Dcl-S testb                   BinDec(2:0);                                                                       000395
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000397   //-------------------------------------------------------------------------------------------                      000397
 000398   // Main Procedure                                                                                                  000398
 000399   //-------------------------------------------------------------------------------------------                      000399
 000400      // Initialize                                                                                                   000400
 000001=ISRCREC                                                                                                             1000001
         *--------------------------------------------------------------------------------------------*                     1
         * RPG record format  . . . . :  SRCREC                                                       *                     1
         * External format  . . . . . :  QRPGLESRC : LIBHTTP/QRPGLESRC                                *                     1
         * Format text  . . . . . . . :  ILE RPG IV Source                                            *                     1
         *--------------------------------------------------------------------------------------------*                     1
 000002=I                             S    1    6 2SRCSEQ                                                                   1000002
 000003=I                             S    7   12 0SRCDAT                                                                   1000003
 000004=I                             A   13  112  SRCDTA                                                                   1000004
 000401      Exsr subInitialise;                                                                                             000401
 000402                                                                                                                      000402
 000403      // Perform required function                                                                                    000403
 000404      Exsr subUserFunction;                                                                                           000404
 000405                                                                                                                      000405
 000406      // Terminate the program.                                                                                       000406
 000407      Exsr subExitProgram;                                                                                            000407
 000408   //-------------------------------------------------------------------------------------------                      000408
 000409                                                                                                                      000409
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000411   //-------------------------------------------------------------------------------------------                      000411
 000412   // USER: Perform required function.                                                                                000412
 000413   //-------------------------------------------------------------------------------------------                      000413
 000414   BegSr subUserFunction;                                                                                             000414
 000415                                                                                                                      000415
 000416      // ** Code the necessary processing here.                                                                       000416
 000417      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         000417
 000418                                                                                                                      000418
 000419      // Read through the source member.                                                                              000419
 000420      Read SRCREC;                                                                                                    000420
 000421                                                                                                                      000421
 000422      DoW not %eof(QRPGLESRC);                                                                   B01                  000422
 000423         countSource += 1;                                                                        01                  000423
 000424                                                                                                                      000424
 000425         Exsr subUserReformatLine;                                                                01                  000425
 000426                                                                                                                      000426
 000427         Exsr subUserSetIndicators;                                                               01                  000427
 000428                                                                                                                      000428
 000429         // Old-style SCAN without a result field.                                                                    000429
 000430         If scanNoResult;                                                                        B02                  000430
 000431            Clear nonPrefix;                                                                      02                  000431
 000432                                                                                                                      000432
 000433            codeLine = '// Old-style SCAN without a result!';                                     02                  000433
 000434            Exsr subUserReformatLine;                                                             02                  000434
 000435            codeLine = 'EndIf;';                                                                  02                  000435
 000436            Exsr subUserReformatLine;                                                             02                  000436
 000437                                                                                                                      000437
 000438            scanNoResult = *Off;                                                                  02                  000438
 000439         EndIf;                                                                                  E02                  000439
 000440                                                                                                                      000440
 000441         // If in a CAS statement, record the subroutine to call.                                                     000441
 000442         If inCase and caseSubroutine <> *Blanks;                                                B02                  000442
 000443            codeLine = 'ExSr ' + %trim(caseSubRoutine) + ';';                                     02                  000443
 000444            Exsr subUserReformatLine;                                                             02                  000444
 000445            caseSubRoutine = *Blanks;                                                             02                  000445
 000446         EndIf;                                                                                  E02                  000446
 000447                                                                                                                      000447
 000448         Read SRCREC;                                                                             01                  000448
 000449      EndDo;                                                                                     E01                  000449
 000450                                                                                                                      000450
 000451      // Handle overflow.                                                                                             000451
 000452      If overFlow;                                                                               B01                  000452
 000453                                                                                                                      000453
 000454         // Print page headings.                                                                                      000454
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000455         Z1QPAG += 1;                                                                             01                  000455
 000456         Write Z1PAGHDG;                                                                          01                  000456
 000457                                                                                                                      000457
 000458         ZTFRFL = fromFileLib;                                                                    01                  000458
 000459         ZTTOFL = toFileLib;                                                                      01                  000459
 000460                                                                                                                      000460
 000461         Write Z1TOPPAG;                                                                          01                  000461
 000462                                                                                                                      000462
 000463         overFlow = *Off;                                                                         01                  000463
 000464      EndIf;                                                                                     E01                  000464
 000465                                                                                                                      000465
 000466      Z1FRMB = QpFromMbr;                                                                                             000466
 000467      Z1TOMB = QpToMbr;                                                                                               000467
 000468      Z1CTSC = countSource;                                                                                           000468
 000469      Z1CTTG = countTarget;                                                                                           000469
 000470      Z1CTEL = countEligible;                                                                                         000470
 000471      Z1CTCV = countConv;                                                                                             000471
 000472      Z1CTNV = countNotConv;                                                                                          000472
 000473      Z1CTMV = countMoved;                                                                                            000473
 000474      If countEligible = 0;                                                                      B01                  000474
 000475         Z1CNVR = 0;                                                                              01                  000475
 000476      Else;                                                                                      X01                  000476
 000477         Z1CNVR = countConv * 100 / countEligible;                                                01                  000477
 000478      EndIf;                                                                                     E01                  000478
 000479                                                                                                                      000479
 000480      // Print detail format.                                                                                         000480
 000481      Write Z1DETAIL;                                                                                                 000481
 000482                                                                                                                      000482
 000483      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         000483
 000484                                                                                                                      000484
 000485   EndSr;                                                                                                             000485
 000486   //-------------------------------------------------------------------------------------------                      000486
 000487                                                                                                                      000487
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000489   //-------------------------------------------------------------------------------------------                      000489
 000490   // Perform conversion/reformatting on the current line.                                                            000490
 000491   //-------------------------------------------------------------------------------------------                      000491
 000492   BegSr subUserReformatLine;                                                                                         000492
 000493                                                                                                                      000493
 000494      inDirective = *Off;                                                                                             000494
 000495      inComment = *Off;                                                                                               000495
 000496      increment = 0;                                                                                                  000496
 000497                                                                                                                      000497
 000498      workDirective = %xlate(lo:up:directive);                                                                        000498
 000499      workLineType = %xlate(lo:up:lineType);                                                                          000499
 000500                                                                                                                      000500
 000501      convert = *Off;                                                                                                 000501
 000502      nonConvRsn = *Blanks;                                                                                           000502
 000503                                                                                                                      000503
 000504      sourceLine = codeLine;     // Start with what is already there.                                                 000504
 000505                                                                                                                      000505
 000506      // Array data reached?                                                                                          000506
 000507      If %subst(prefix:1:3) = '** '                                                              B01                  000507
 000508      or %subst(SRCDTA:1:8) = '**CTDATA';                                                        B01                  000508
 000509         inCode = *Off;                                                                           01                  000509
 000510         inDeclaration = *Off;                                                                    01                  000510
 000511         inArrayData = *On;                                                                       01                  000511
 000512      EndIf;                                                                                     E01                  000512
 000513                                                                                                                      000513
 000514      If not inArrayData;                                                                        B01                  000514
 000515         //----------------------------------------------------------------------------------                         000515
 000516         // Determine Line Type                                                                                       000516
 000517         If workLineType = 'C';                  // C-Spec                                       B02                  000517
 000518            inCode = *On;                                                                         02                  000518
 000519            //         ElseIf workLineType = 'P'               // P-Spec                                              000519
 000520            //             or %len(%trim(codeLine)) >= 4                                                              000520
 000521            //            and %xlate(lo:up:%subst(%trim(codeLine):1:4)) = 'DCL-';                                     000521
 000522            //            inCode = *Off;                                                                              000522
 000523            //            defsMoved = *Off;                                                                           000523
 000524         ElseIf workLineType = 'P';              // P-Spec                                       X02                  000524
 000525            inCode = *Off;                                                                        02                  000525
 000526            defsMoved = *Off;                                                                     02                  000526
 000527         ElseIf workLineType = 'D';              // Declaration.                                 X02                  000527
 000528            inCode = *Off;                                                                        02                  000528
 000529         ElseIf workLineType = 'H';              // Header spec.                                 X02                  000529
 000530            inCode = *Off;                                                                        02                  000530
 000531         ElseIf workLineType = 'F';              // File spec.                                   X02                  000531
 000532            inCode = *Off;                                                                        02                  000532
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000533         ElseIf workLineType = 'O';              // O-Spec                                       X02                  000533
 000534            inCode = *Off;                                                                        02                  000534
 000535         ElseIf workLineType = 'I';              // I-Spec                                       X02                  000535
 000536            inCode = *On;                                                                         02                  000536
 000537         ElseIf %check(validSpecs:workLineType) <> 0;    // Invalid spec type.                   X02                  000537
 000538            workLineType = *Blanks;                                                               02                  000538
 000539            lineType = *Blank;                           // Clear it!                             02                  000539
 000540         EndIf;                                                                                  E02                  000540
 000541                                                                                                                      000541
 000542         If %trim(workDirective) = '/FREE';                                                      B02                  000542
 000543            // In a free-format directive, so we must be in code too.                                                 000543
 000544            If not inFreeFormat;                                                                 B03                  000544
 000545               inDirective = *On;                                                                 03                  000545
 000546               inCode = *On;                                                                      03                  000546
 000547               inFreeFormat = *On;                                                                03                  000547
 000548               lineType = ' ';                                                                    03                  000548
 000549               workLineType = ' ';                                                                03                  000549
 000550               If QpDirectives = 'Y';                                                            B04                  000550
 000551                  directive = '/Free';                                                            04                  000551
 000552               Else;                                                                             X04                  000552
 000553                  dropLine = *On;                                                                 04                  000553
 000554               EndIf;                                                                            E04                  000554
 000555            Else;                                                                                X03                  000555
 000556               dropLine = *On;   // Not needed.                                                   03                  000556
 000557            EndIf;                                                                               E03                  000557
 000558         ElseIf %trim(workDirective) = '/END-FREE';                                              X02                  000558
 000559            // At the end of a directive, so we can't be in free format any more.                                     000559
 000560            //inDirective = *On;                                                                                      000560
 000561            //directive = '/End-Free';                                                                                000561
 000562            //inFreeFormat = *Off;                                                                                    000562
 000563            dropLine = *On;                                                                       02                  000563
 000564         ElseIf %trim(workDirective) = '/EJECT';                                                 X02                  000564
 000565            inDirective = *On;                                                                    02                  000565
 000566            lineType = ' ';                                                                       02                  000566
 000567            workLineType = ' ';                                                                   02                  000567
 000568         ElseIf %subst(workDirective:1:5) = '/COPY';                                             X02                  000568
 000569            inDirective = *On;                                                                    02                  000569
 000570            lineType = ' ';                                                                       02                  000570
 000571            workLineType = ' ';                                                                   02                  000571
 000572         ElseIf %subst(workDirective:1:3) = '/IF';                                               X02                  000572
 000573            inDirective = *On;                                                                    02                  000573
 000574            lineType = ' ';                                                                       02                  000574
 000575            workLineType = ' ';                                                                   02                  000575
 000576         ElseIf %subst(workDirective:1:6) = '/ENDIF';                                            X02                  000576
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000577            inDirective = *On;                                                                    02                  000577
 000578            lineType = ' ';                                                                       02                  000578
 000579            workLineType = ' ';                                                                   02                  000579
 000580         ElseIf %subst(workDirective:1:7) = '/DEFINE';                                           X02                  000580
 000581            inDirective = *On;                                                                    02                  000581
 000582            lineType = ' ';                                                                       02                  000582
 000583            workLineType = ' ';                                                                   02                  000583
 000584         ElseIf %subst(workDirective:1:6) = '/SPACE';                                            X02                  000584
 000585            inDirective = *On;                                                                    02                  000585
 000586            lineType = ' ';                                                                       02                  000586
 000587            workLineType = ' ';                                                                   02                  000587
 000588         ElseIf %subst(workDirective:1:6) = '/TITLE';                                            X02                  000588
 000589            inDirective = *On;                                                                    02                  000589
 000590            lineType = ' ';                                                                       02                  000590
 000591            workLineType = ' ';                                                                   02                  000591
 000592         ElseIf (%subst(workDirective:1:1) = '*'                                                 X02                  000592
 000593            or %subst(workDirective:1:2) = '//')                                                 X02                  000593
 000594            and (lineType = *Blank or inCode);                                                   X02                  000594
 000595            //            and inCode;                                                                                 000595
 000596            // This is a comment line.                                                                                000596
 000597            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000597
 000598               inComment = *On;                                                                   03                  000598
 000599            EndIf;                                                                               E03                  000599
 000600            If %subst(workDirective:1:2) = '//';                                                 B03                  000600
 000601               %subst(directive:1:2) = '  ';                                                      03                  000601
 000602            Else;                                                                                X03                  000602
 000603               %subst(directive:1:1) = ' ';                                                       03                  000603
 000604            EndIf;                                                                               E03                  000604
 000605            If workLineType = 'C' or workLineType = 'D';                                         B03                  000605
 000606               lineType = ' ';                                                                    03                  000606
 000607               workLineType = ' ';                                                                03                  000607
 000608            EndIf;                                                                               E03                  000608
 000609            // Retain blank comment markers?                                                                          000609
 000610            If QpRetBlnkCmt = 'N' and %len(%trim(codeLine)) = 0;                                 B03                  000610
 000611               // Leave the line blank, devoid of any marker.                                                         000611
 000612            Else;                                                                                X03                  000612
 000613               codeLine = '//' + codeLine;                                                        03                  000613
 000614            EndIf;                                                                               E03                  000614
 000615         ElseIf %subst(workDirective:1:1) = '*';                                                 X02                  000615
 000616            //            and workLineType = 'O';                                                                     000616
 000617            // Leave the line as it is.                                                                               000617
 000618            inComment = *On;                                                                      02                  000618
 000619         ElseIf %len(%trim(codeLine)) = 0;                                                       X02                  000619
 000620            // Just a 'spacer' line - keep it but drop the line type.                                                 000620
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000621            lineType = ' ';                                                                       02                  000621
 000622            workLineType = ' ';                                                                   02                  000622
 000623         ElseIf %len(%trim(codeLine)) >= 2                                                       X02                  000623
 000624            and %subst(%trim(codeLine):1:2) = '//'                                               X02                  000624
 000625            and (workLineType = *Blank or inCode);                                               X02                  000625
 000626            // This is a comment line.                                                                                000626
 000627            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000627
 000628               inComment = *On;                                                                   03                  000628
 000629            EndIf;                                                                               E03                  000629
 000630            // Retain blank comment markers?                                                                          000630
 000631            If QpRetBlnkCmt = 'N' and %len(%trim(%subst(codeLine:3)))                            B03                  000631
 000632                                              = 0;                                               B03                  000632
 000633               // Leave the line blank, devoid of any marker.                                                         000633
 000634               codeLine = *Blanks;                                                                03                  000634
 000635            EndIf;                                                                               E03                  000635
 000636         ElseIf comment <> *Blanks                                                               X02                  000636
 000637            and %len(%trim(%subst(codeLine:1:73))) = 0;                                          X02                  000637
 000638            // This is a blank line with a comment section.                                                           000638
 000639            %subst(codeLine:71:2) = '//';                                                         02                  000639
 000640            inComment = *On;                                                                      02                  000640
 000641         EndIf;                                                                                  E02                  000641
 000642                                                                                                                      000642
 000643         //----------------------------------------------------------------------------------                         000643
 000644         // Convert fixed-format to free-format?                                                                      000644
 000645         If not inComment                                                                        B02                  000645
 000646         and not inDirective;                                                                    B02                  000646
 000647                                                                                                                      000647
 000648            If workLineType = 'C';                                                               B03                  000648
 000649               countEligible += 1;                                                                03                  000649
 000650               countNotConv += 1;                                                                 03                  000650
 000651               operator = %xlate(lo:up:opCode);                                                   03                  000651
 000652               savedComment = comment;                                                            03                  000652
 000653                                                                                                                      000653
 000654               Exsr subUserConvertC_Spec;                                                         03                  000654
 000655                                                                                                                      000655
 000656               If not inComment and not convert                                                  B04                  000656
 000657               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000657
 000658                  nonConvRsn = 'Conversion not currently supported.';                             04                  000658
 000659               EndIf;                                                                            E04                  000659
 000660                                                                                                                      000660
 000661            ElseIf workLineType = 'P';     // Procedure start/end.                               X03                  000661
 000662               countEligible += 1;                                                                03                  000662
 000663               countNotConv += 1;                                                                 03                  000663
 000664               operator = *Blanks;                                                                03                  000664
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000665               savedComment = comment;                                                            03                  000665
 000666                                                                                                                      000666
 000667               Exsr subUserConvertP_Spec;                                                         03                  000667
 000668                                                                                                                      000668
 000669               If not inComment and not convert                                                  B04                  000669
 000670               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000670
 000671                  nonConvRsn = 'Conversion not currently supported.';                             04                  000671
 000672               EndIf;                                                                            E04                  000672
 000673                                                                                                                      000673
 000674            ElseIf workLineType = 'D';     // Declaration.                                       X03                  000674
 000675               countEligible += 1;                                                                03                  000675
 000676               countNotConv += 1;                                                                 03                  000676
 000677               savedComment = comment;                                                            03                  000677
 000678                                                                                                                      000678
 000679               Exsr subUserConvertD_Spec;                                                         03                  000679
 000680                                                                                                                      000680
 000681               If not inComment and not convert                                                  B04                  000681
 000682               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000682
 000683                  //nonConvRsn = 'Conversion not currently supported.';                                               000683
 000684               EndIf;                                                                            E04                  000684
 000685                                                                                                                      000685
 000686            ElseIf workLineType = 'F';     // File.                                              X03                  000686
 000687               countEligible += 1;                                                                03                  000687
 000688               countNotConv += 1;                                                                 03                  000688
 000689               savedComment = comment;                                                            03                  000689
 000690                                                                                                                      000690
 000691               Exsr subUserConvertF_Spec;                                                         03                  000691
 000692                                                                                                                      000692
 000693               If not inComment and not convert                                                  B04                  000693
 000694               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000694
 000695                  //nonConvRsn = 'Conversion not currently supported.';                                               000695
 000696               EndIf;                                                                            E04                  000696
 000697                                                                                                                      000697
 000698            ElseIf workLineType = 'H';     // Header.                                            X03                  000698
 000699               countEligible += 1;                                                                03                  000699
 000700               countNotConv += 1;                                                                 03                  000700
 000701               savedComment = comment;                                                            03                  000701
 000702                                                                                                                      000702
 000703               Exsr subUserConvertH_Spec;                                                         03                  000703
 000704                                                                                                                      000704
 000705               If not inComment and not convert                                                  B04                  000705
 000706               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000706
 000707                  //nonConvRsn = 'Conversion not currently supported.';                                               000707
 000708               EndIf;                                                                            E04                  000708
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000709                                                                                                                      000709
 000710            ElseIf workLineType = 'O';     // Output spec                                        X03                  000710
 000711               sourceLine = fullLine;                                                             03                  000711
 000712                                                                                                                      000712
 000713            ElseIf workLineType = 'I';     // Input spec                                         X03                  000713
 000714               sourceLine = fullLine;                                                             03                  000714
 000715                                                                                                                      000715
 000716            ElseIf workLineType = ' ' and inCode;                                                X03                  000716
 000717               inFreeFormat = *On;                                                                03                  000717
 000718               // When in an IF we usually want subsequent lines to be pulled back to be                              000718
 000719               // in line with the 'If', but only if those lines start with either 'and'                              000719
 000720               // or 'or'.  Otherwise we retain the existing indentation by turning on                                000720
 000721               // inSpan.                                                                                             000721
 000722               If inIf and %len(%trim(codeLine)) >= 3                                            B04                  000722
 000723               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'AND'                            B04                  000723
 000724               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'OR ';                           B04                  000724
 000725                  inSpan = *On;                                                                   04                  000725
 000726               EndIf;                                                                            E04                  000726
 000727               If inSpan;                                                                        B04                  000727
 000728                  currOffset = %check(' ':codeLine);  // Offset of the continuation line.         04                  000728
 000729               Else;                                                                             X04                  000729
 000730                  prevOffset = %check(' ':codeLine);  // Offset of the parent line.               04                  000730
 000731               EndIf;                                                                            E04                  000731
 000732               sourceLine = %trim(codeLine);         // Free-format already, so trim it.          03                  000732
 000733            Else;                                                                                X03                  000733
 000734               inFreeFormat = *On;                                                                03                  000734
 000735               sourceLine = %trimr(codeLine);        // None of the above, use the raw source     03                  000735
 000736            EndIf;                                                                               E03                  000736
 000737                                                                                                                      000737
 000738            // Converted?                                                                                             000738
 000739            If convert;                                                                          B03                  000739
 000740               countConv += 1;                                                                    03                  000740
 000741               countNotConv -= 1;                                                                 03                  000741
 000742               // Switch to free-format?                                                                              000742
 000743               If not inFreeFormat and not inDeclaration;                                        B04                  000743
 000744                  If QpDirectives = 'Y';                                                         B05                  000744
 000745                     savedSRCDTA = SRCDTA;                                                        05                  000745
 000746                     Clear SRCDTA;                                                                05                  000746
 000747                     directive = '/Free';                                                         05                  000747
 000748                     Exsr subUserWriteLine;                                                       05                  000748
 000749                     SRCDTA = savedSRCDTA;                                                        05                  000749
 000750                  EndIf;                                                                         E05                  000750
 000751                  inFreeFormat = *On;                                                             04                  000751
 000752                  directive = *Blanks;                                                            04                  000752
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000753               EndIf;                                                                            E04                  000753
 000754            EndIf;                                                                               E03                  000754
 000755                                                                                                                      000755
 000756            // Revert to fixed-format?                                                                                000756
 000757            If not convert and (lineType <> *Blanks                                              B03                  000757
 000758            or %subst(workDirective:1:5) = '/COPY');                                             B03                  000758
 000759               //                or  %subst(prefix:1:3) = '** ');        // Array data reached                        000759
 000760               If inFreeFormat and not inDeclaration;                                            B04                  000760
 000761                  If QpDirectives = 'Y';                                                         B05                  000761
 000762                     savedSRCDTA = SRCDTA;                                                        05                  000762
 000763                     Clear SRCDTA;                                                                05                  000763
 000764                     directive = '/End-Free';                                                     05                  000764
 000765                     Exsr subUserWriteLine;                                                       05                  000765
 000766                     SRCDTA = savedSRCDTA;                                                        05                  000766
 000767                  EndIf;                                                                         E05                  000767
 000768                  inFreeFormat = *Off;                                                            04                  000768
 000769                  If not inDirective;                                                            B05                  000769
 000770                     directive = *Blanks;                                                         05                  000770
 000771                  EndIf;                                                                         E05                  000771
 000772               EndIf;                                                                            E04                  000772
 000773               // Record the reason for not converting?                                                               000773
 000774               If nonConvRsn <> *Blanks;                                                         B04                  000774
 000775                  savedSRCDTA = SRCDTA;                                                           04                  000775
 000776                  Clear SRCDTA;                                                                   04                  000776
 000777                  codeLine = '// >>>>> Not converted: ' + nonConvRsn;                             04                  000777
 000778                  Exsr subUserWriteLine;                                                          04                  000778
 000779                  SRCDTA = savedSRCDTA;                                                           04                  000779
 000780               EndIf;                                                                            E04                  000780
 000781               inSpan = *Off;                                                                     03                  000781
 000782            EndIf;                                                                               E03                  000782
 000783         Else;                                                                                   X02                  000783
 000784            // Use source exactly as is.                                                                              000784
 000785            sourceLine = codeLine;                                                                02                  000785
 000786         EndIf;                                                                                  E02                  000786
 000787                                                                                                                      000787
 000788         //----------------------------------------------------------------------------------                         000788
 000789         // If we are in a code section, check if indent is affected at all.                                          000789
 000790         //         If not inDeclaration                                                                              000790
 000791         //         and not inDirective                                                                               000791
 000792         If not inDirective                                                                      B02                  000792
 000793         and not inComment                                                                       B02                  000793
 000794         and not dropLine;                                                                       B02                  000794
 000795            // Isolate the operator to check indentation against.                                                     000795
 000796            //sourceLine = %trimr(codeLine);                                                                          000796
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000797            If inFreeFormat;                                                                     B03                  000797
 000798               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000798
 000799                  operator = *Blanks;                                                             04                  000799
 000800               ElseIf inSQL;                                // Embedded SQL - no operator.       X04                  000800
 000801                  operator = *Blanks;                                                             04                  000801
 000802               Else;                                                                             X04                  000802
 000803                  // Isolate the 'operator' (first word really).                                                      000803
 000804                  operator = %trim(sourceLine);                                                   04                  000804
 000805                  operatorEnd = %scan(' ':%trim(operator)); // Look for end of first 'word'.      04                  000805
 000806                  If operatorEnd = 0;                                                            B05                  000806
 000807                     operatorEnd = %scan(';':operator);  // Only one word - is it an operator     05                  000807
 000808                     If operatorEnd = 0;                                                         B06                  000808
 000809                        operatorEnd = %scan('(':operator);  // Shouldn't match!                   06                  000809
 000810                     EndIf;                                                                      E06                  000810
 000811                  EndIf;                                                                         E05                  000811
 000812                  // If we have an operator, remove any attached extender code.                                       000812
 000813                  If operatorEnd > 0;                                                            B05                  000813
 000814                     operator = %subst(operator:1:operatorEnd - 1);                               05                  000814
 000815                     // Exec SQL?                                                                                     000815
 000816                     If %xlate(lo:up:operator) = 'EXEC';                                         B06                  000816
 000817                        If %scan('SQL':%xlate(lo:up:%trim(sourceLine)):6)                        B07                  000817
 000818                                 > 0;                                                            B07                  000818
 000819                           operator = 'Exec SQL';                                                 07                  000819
 000820                           inSQL = *On;                                                           07                  000820
 000821                        EndIf;                                                                   E07                  000821
 000822                     EndIf;                                                                      E06                  000822
 000823                     operatorEnd = %scan('(':operator);                                           05                  000823
 000824                     If operatorEnd > 1;                                                         B06                  000824
 000825                        operator = %subst(operator:1:operatorEnd - 1);                            06                  000825
 000826                     EndIf;                                                                      E06                  000826
 000827                  EndIf;                                                                         E05                  000827
 000828                                                                                                                      000828
 000829                  If %lookup(%xlate(lo:up:operator):QopCodeUP) > 0                               B05                  000829
 000830                  and not inDeclaration;                                                         B05                  000830
 000831                     inCode = *On;                                                                05                  000831
 000832                  Else;                                                                          X05                  000832
 000833                     If %lookup(%xlate(lo:up:operator):QdeclUP) > 0;                             B06                  000833
 000834                        // Declaration!                                                                               000834
 000835                     Else;                                                                       X06                  000835
 000836                        // Not an operator!                                                                           000836
 000837                        operator = *Blanks;                                                       06                  000837
 000838                        x = %scan('=':sourceLine);                                                06                  000838
 000839                        If x > 0;   // Looks like an assignment.                                 B07                  000839
 000840                           operator = '=';                                                        07                  000840
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000841                           inCode = *On;                                                          07                  000841
 000842                           If workLineType = *Blank;                                             B08                  000842
 000843                              sourceLine = %trim(sourceLine);                                     08                  000843
 000844                           EndIf;                                                                E08                  000844
 000845                        EndIf;                                                                   E07                  000845
 000846                     EndIf;                                                                      E06                  000846
 000847                  EndIf;                                                                         E05                  000847
 000848               EndIf;                                                                            E04                  000848
 000849            Else;                                                                                X03                  000849
 000850               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000850
 000851                  operator = *Blanks;                                                             04                  000851
 000852               Else;                                                                             X04                  000852
 000853                  operator = %xlate(lo:up:opCode);                                                04                  000853
 000854                  If %subst(operator:1:4) <> 'EVAL'                                              B05                  000854
 000855                  and operator <> *Blanks;                                                       B05                  000855
 000856                     // Strip out in-line definitions.                                                                000856
 000857                     len = *Blanks;                                                               05                  000857
 000858                     dec = *Blanks;                                                               05                  000858
 000859                  EndIf;                                                                         E05                  000859
 000860               EndIf;                                                                            E04                  000860
 000861            EndIf;                                                                               E03                  000861
 000862                                                                                                                      000862
 000863            // Convert to upper case for check.                                                                       000863
 000864            operator = %xlate(lo:up:operator);                                                    02                  000864
 000865                                                                                                                      000865
 000866            // Check for indentation level change.                                                                    000866
 000867            Select;                                                                              B03                  000867
 000868               When workDirective = '/EXEC SQL';                                                 X03                  000868
 000869                  increment = 1;                                                                  03                  000869
 000870                  inSQL = *On;                                                                    03                  000870
 000871               When workDirective = '/END-EXEC';                                                 X03                  000871
 000872                  unindent = *On;                                                                 03                  000872
 000873                  increment = -1;                                                                 03                  000873
 000874                  dropLine = *On;                                                                 03                  000874
 000875               When inSQL;                                                                       X03                  000875
 000876                  // Do nothing.                                                                                      000876
 000877               When %subst(operator:1:2) = 'IF';                                                 X03                  000877
 000878                  increment = 1;                                                                  03                  000878
 000879                  inIf = *On;                                                                     03                  000879
 000880               When %subst(operator:1:2) = 'DO';                                                 X03                  000880
 000881                  increment = 1;                                                                  03                  000881
 000882                  inDo = *On;                                                                     03                  000882
 000883                  doCount += 1;                                                                   03                  000883
 000884                  doLevel(doCount) = indentCount;                                                 03                  000884
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000885               When operator = 'FOR';                                                            X03                  000885
 000886                  increment = 1;                                                                  03                  000886
 000887                  forCount += 1;                                                                  03                  000887
 000888                  forLevel(forCount) = indentCount;                                               03                  000888
 000889               When operator = 'SELECT';                                                         X03                  000889
 000890                  increment = 2;                                                                  03                  000890
 000891                  slCount += 1;                                                                   03                  000891
 000892                  slLevel(slCount) = indentCount;                                                 03                  000892
 000893               When operator = 'BEGSR';                                                          X03                  000893
 000894                  increment = 1;                                                                  03                  000894
 000895                  mainlineIndent = 0;                                                             03                  000895
 000896                  indentCount = mainlineIndent;                                                   03                  000896
 000897               When %subst(operator:1:4) = 'DCL-';                                               X03                  000897
 000898                  increment = 0;                                                                  03                  000898
 000899                  mainlineIndent = 1;                                                             03                  000899
 000900                  indentCount = mainlineIndent;                                                   03                  000900
 000901                  defsMoved = *Off;                                                               03                  000901
 000902               When %subst(operator:1:4) = 'END-';                                               X03                  000902
 000903                  increment = 0;                                                                  03                  000903
 000904                  indentCount = mainlineIndent;                                                   03                  000904
 000905               When operator = 'MONITOR';                                                        X03                  000905
 000906                  increment = 1;                                                                  03                  000906
 000907               When operator = 'ENDSL';                                                          X03                  000907
 000908                  unindent = *On;                                                                 03                  000908
 000909                  increment = -2;                                                                 03                  000909
 000910                  slCount -= 1;                                                                   03                  000910
 000911               When operator = 'ENDCS';                                                          X03                  000911
 000912                  Operator = 'ENDIF';                                                             03                  000912
 000913                  unindent = *On;                                                                 03                  000913
 000914                  increment = -1;                                                                 03                  000914
 000915               When operator = 'ENDDO';                                                          X03                  000915
 000916                  unindent = *On;                                                                 03                  000916
 000917                  increment = -1;                                                                 03                  000917
 000918                  doCount -= 1;                                                                   03                  000918
 000919               When operator = 'ENDFOR';                                                         X03                  000919
 000920                  unindent = *On;                                                                 03                  000920
 000921                  increment = -1;                                                                 03                  000921
 000922                  forCount -= 1;                                                                  03                  000922
 000923               When %subst(operator:1:3) = 'END';                                                X03                  000923
 000924                  unindent = *On;                                                                 03                  000924
 000925                  increment = -1;                                                                 03                  000925
 000926               When %subst(operator:1:4) = 'ELSE'; // Unindent ELSE                              X03                  000926
 000927                  unindent = *On;                                                                 03                  000927
 000928                  indent = *On;                                                                   03                  000928
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000929                  increment = -1;                                                                 03                  000929
 000930               When %subst(operator:1:2) = 'OR';   // Unindent OR                                X03                  000930
 000931                  unindent = *On;                                                                 03                  000931
 000932                  indent = *On;                                                                   03                  000932
 000933                  increment = -1;                                                                 03                  000933
 000934               When %subst(operator:1:3) = 'AND';  // Unindent AND                               X03                  000934
 000935                  unindent = *On;                                                                 03                  000935
 000936                  indent = *On;                                                                   03                  000936
 000937                  increment = -1;                                                                 03                  000937
 000938               When operator = 'ON-ERROR';         // Unindent On-Error                          X03                  000938
 000939                  unindent = *On;                                                                 03                  000939
 000940                  indent = *On;                                                                   03                  000940
 000941                  increment = -1;                                                                 03                  000941
 000942               When %subst(operator:1:4) = 'WHEN' or inWhen;                                     X03                  000942
 000943                  unindent = *On;                                                                 03                  000943
 000944                  indent = *On;                                                                   03                  000944
 000945                  increment = -1;                                                                 03                  000945
 000946                  inWhen = *On;                                                                   03                  000946
 000947               When inIF or inDo;                  // Keep conditions in line.                   X03                  000947
 000948                  unindent = *On;                                                                 03                  000948
 000949                  indent = *On;                                                                   03                  000949
 000950                  increment = -1;                                                                 03                  000950
 000951               When operator = 'OTHER';             // Unindent Other                            X03                  000951
 000952                  unindent = *On;                                                                 03                  000952
 000953                  indent = *On;                                                                   03                  000953
 000954                  increment = -1;                                                                 03                  000954
 000955               Other;                                                                            X03                  000955
 000956                  increment = 0;                                                                  03                  000956
 000957            EndSl;                                                                               E03                  000957
 000958         ElseIf inDeclaration;                                                                   X02                  000958
 000959         EndIf;                                                                                  E02                  000959
 000960                                                                                                                      000960
 000961         //----------------------------------------------------------------------------------                         000961
 000962         // Start of code?  If so, pause here and move all field definitions to D-specs.                              000962
 000963         If inCode and not defsMoved;                                                            B02                  000963
 000964            Exsr subUserMoveDefs;                                                                 02                  000964
 000965         EndIf;                                                                                  E02                  000965
 000966                                                                                                                      000966
 000967         //----------------------------------------------------------------------------------                         000967
 000968         // If we need to temporarily unindent, do so to the requested increment.                                     000968
 000969         If unindent;                                                                            B02                  000969
 000970            indentCount += increment;                                                             02                  000970
 000971            increment = 0;                                                                        02                  000971
 000972            unindent = *Off;                                                                      02                  000972
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000973         EndIf;                                                                                  E02                  000973
 000974                                                                                                                      000974
 000975         //----------------------------------------------------------------------------------                         000975
 000976         // If we are in a code section and in free-format, perform reformatting.                                     000976
 000977         //If inCode and inFreeFormat and not inDirective                                                             000977
 000978         If inFreeFormat                                                                         B02                  000978
 000979         and not inDirective                                                                     B02                  000979
 000980         and sourceLine <> *Blanks                                                               B02                  000980
 000981         and not inComment                                                                       B02                  000981
 000982         and not dropLine;       //  and not inSpan                                              B02                  000982
 000983            // Derive reformatted opcode (if any)                                                                     000983
 000984            x = %lookup(operator:QopCodeUP);                                                      02                  000984
 000985            If x > 0;                                                                            B03                  000985
 000986               newOperator = %trim(QopCodeLO(x));                                                 03                  000986
 000987            Else;                                                                                X03                  000987
 000988               x = %lookup(operator:QdeclUP);                                                     03                  000988
 000989               If x > 0;                                                                         B04                  000989
 000990                  newOperator = %trim(QdeclLO(x));                                                04                  000990
 000991               Else;                                                                             X04                  000991
 000992                  // Not a valid operator, check if this is a comment.                                                000992
 000993                  x = %scan('//':%trim(sourceLine));                                              04                  000993
 000994                  If x = 1;                                                                      B05                  000994
 000995                     inComment = *On;                                                             05                  000995
 000996                     newOperator = '';                                                            05                  000996
 000997                     operator = *Blanks;                                                          05                  000997
 000998                  Else;                                                                          X05                  000998
 000999                     newOperator = '';                                                            05                  000999
 001000                  EndIf;                                                                         E05                  001000
 001001               EndIf;                                                                            E04                  001001
 001002            EndIf;                                                                               E03                  001002
 001003                                                                                                                      001003
 001004            // Use new opcode if it exists.                                                                           001004
 001005            If %len(newOperator) > 0;                                                            B03                  001005
 001006               If %len(%trim(sourceLine)) > %len(newOperator);                                   B04                  001006
 001007                  sourceLine = %trim(%subst(%trim(sourceLine)                                     04                  001007
 001008                                   :%len(newOperator) + 1));                                      04                  001008
 001009               Else;                                                                             X04                  001009
 001010                  //                  sourceLine = %trim(%subst(%trim(sourceLine)                                     001010
 001011                  //                                   :%len(newOperator)));                                          001011
 001012                  sourceLine = *Blanks;                                                           04                  001012
 001013               EndIf;                                                                            E04                  001013
 001014               // Insert a spcace after operator if it's not the end of the line                                      001014
 001015               // and there's no operation extender.                                                                  001015
 001016               If %subst(sourceLine:1:1) <> ';'                                                  B04                  001016
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001017               and (%subst(sourceLine:1:1) <> '('                                                B04                  001017
 001018                 or %subst(sourceLine:1:1) = '('                                                 B04                  001018
 001019                and %subst(sourceLine:3:1) <> ')'                                                B04                  001019
 001020                and %subst(sourceLine:4:1) <> ')');                                              B04                  001020
 001021                  sourceLine = ' ' + sourceLine;                                                  04                  001021
 001022               EndIf;                                                                            E04                  001022
 001023               sourceLine = newOperator + sourceLine;                                             03                  001023
 001024            EndIf;                                                                               E03                  001024
 001025                                                                                                                      001025
 001026            If inCode;                                                                           B03                  001026
 001027               // Padding required?                                                                                   001027
 001028               If padResult;                                                                     B04                  001028
 001029                  savedSRCDTA = SRCDTA;                                                           04                  001029
 001030                  Clear codeLine;                                                                 04                  001030
 001031                  %subst(codeLine:indentOffset)                                                   04                  001031
 001032                        = %trim(padTarget) + ' = *Blanks;';                                       04                  001032
 001033                  Exsr subUserWriteLine;                                                          04                  001033
 001034                  SRCDTA = savedSRCDTA;                                                           04                  001034
 001035                  padResult = *Off;                                                               04                  001035
 001036               EndIf;                                                                            E04                  001036
 001037                                                                                                                      001037
 001038               // Determine the indentation to use.                                                                   001038
 001039               If indentCount > maxIndent;                                                       B04                  001039
 001040                  indentOffset = maxIndent * indentSize + 1;                                      04                  001040
 001041               Else;                                                                             X04                  001041
 001042                  indentOffset = indentCount * indentSize + 1;                                    04                  001042
 001043               EndIf;                                                                            E04                  001043
 001044                                                                                                                      001044
 001045               // Adjust for continuation lines.                                                                      001045
 001046               If inCallP and (%subst(operator:1:5) <> 'CALLP');                                 B04                  001046
 001047                  indentOffset += callPOffset;                                                    04                  001047
 001048               ElseIf inEval and (%subst(operator:1:4) <> 'EVAL');                               X04                  001048
 001049                  indentOffset += evalOffset;                                                     04                  001049
 001050               ElseIf inSpan;                                                                    X04                  001050
 001051                  indentOffset = currOffset + (indentOffset - prevOffset);                        04                  001051
 001052               EndIf;                                                                            E04                  001052
 001053                                                                                                                      001053
 001054               // Avoid losing code off of the right hand side (comments mainly).                                     001054
 001055               If %len(%trimr(sourceLine)) + indentOffset > 93;                                  B04                  001055
 001056                  indentOffset = 93 - %len(%trim(sourceLine));                                    04                  001056
 001057               EndIf;                                                                            E04                  001057
 001058                                                                                                                      001058
 001059               // For code lines, check for overflow, and unindent accordingly if it does,                            001059
 001060               If not inComment;                                                                 B04                  001060
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001061                  lineEnd = %scan(';':%trimr(sourceLine));                                        04                  001061
 001062                  If lineEnd = 0;   // Code already spans to next line.                          B05                  001062
 001063                     lineEnd = %scan('//':sourceLine);                                            05                  001063
 001064                     If lineEnd > 0;                                                             B06                  001064
 001065                        lineEnd                                                                   06                  001065
 001066                          = %len(%trimr(%subst(sourceLine:1:lineEnd-1)));                         06                  001066
 001067                     Else;                                                                       X06                  001067
 001068                        lineEnd = %len(%trimr(sourceLine));                                       06                  001068
 001069                     EndIf;                                                                      E06                  001069
 001070                     If not inIf and not inDo and not inWhen;                                    B06                  001070
 001071                        inSpan = *On;                                                             06                  001071
 001072                     EndIf;                                                                      E06                  001072
 001073                  EndIf;                                                                         E05                  001073
 001074               EndIf;                                                                            E04                  001074
 001075                                                                                                                      001075
 001076               // Cater for commented out code that extends into comments.                                            001076
 001077               If indentOffset + lineEnd > 74;                                                   B04                  001077
 001078                  //Exsr subUserWrapLine;                                                                             001078
 001079                  indentOffset -= ((indentOffset + lineEnd) - 74);                                04                  001079
 001080               EndIf;                                                                            E04                  001080
 001081                                                                                                                      001081
 001082               // Ensure that we don't go back too far!                                                               001082
 001083               If indentOffset < 1;                                                              B04                  001083
 001084                  indentOffset = 1;                                                               04                  001084
 001085               EndIf;                                                                            E04                  001085
 001086                                                                                                                      001086
 001087               savedSRCDTA = SRCDTA;                                                              03                  001087
 001088               Clear codeLine;                                                                    03                  001088
 001089               %subst(codeLine:indentOffset) = %trimr(sourceLine);                                03                  001089
 001090               // Append an in-line comment?                                                                          001090
 001091               If (convert or setOn or setOff)                                                   B04                  001091
 001092               and savedComment <> *Blanks;                                                      B04                  001092
 001093                  %subst(codeLine:71) = '// ' + savedComment;                                     04                  001093
 001094                  savedComment = *Blanks;                                                         04                  001094
 001095               EndIf;                                                                            E04                  001095
 001096               sourceLine = codeLine;                                                             03                  001096
 001097               SRCDTA = savedSRCDTA;                                                              03                  001097
 001098               EndIf;   // inCode                                                                E03                  001098
 001099            EndIf;                                                                               E02                  001099
 001100         EndIf;                                                                                  E01                  001100
 001101                                                                                                                      001101
 001102         //----------------------------------------------------------------------------------                         001102
 001103         // Output the formatted line (and any overflows that have occurred.                                          001103
 001104         If not dropLine;                                                                        B01                  001104
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001105            If convert;                                                                          B02                  001105
 001106               Clear nonPrefix;                                                                   02                  001106
 001107            EndIf;                                                                               E02                  001107
 001108            If inCode or inArrayData                                                             B02                  001108
 001109            or lineType = *Blank or %subst(directive:1:1) = '*';                                 B02                  001109
 001110               codeLine = %trimr(sourceLine);                                                     02                  001110
 001111            Else;                                                                                X02                  001111
 001112               fullLine = %trimr(sourceLine);                                                     02                  001112
 001113            EndIf;                                                                               E02                  001113
 001114            Exsr subUserWriteLine;                                                                01                  001114
 001115                                                                                                                      001115
 001116            // Overflow line?                                                                                         001116
 001117            If overFlowLine <> *Blanks;                                                          B02                  001117
 001118               Clear codeLine;                                                                    02                  001118
 001119               %subst(codeLine:indentOffset) = %trimr(overflowLine);                              02                  001119
 001120               overflowLine = *Blanks;                                                            02                  001120
 001121               Exsr subUserWriteLine;                                                             02                  001121
 001122            EndIf;                                                                               E02                  001122
 001123         Else;                                                                                   X01                  001123
 001124            dropLine = *Off;                                                                      01                  001124
 001125         EndIf;                                                                                  E01                  001125
 001126                                                                                                                      001126
 001127         indentCount += increment;                                                                                    001127
 001128                                                                                                                      001128
 001129         // Following a WHEN or ON-ERROR or ELSE, code should be indented again.                                      001129
 001130         If indent;                                                                              B01                  001130
 001131            indentCount += 1;                                                                     01                  001131
 001132            indent = *Off;                                                                        01                  001132
 001133            // Following ENDSR, we should revert to mainline indentation.                                             001133
 001134         ElseIf operator = 'ENDSR';                                                              X01                  001134
 001135            indentCount = mainlineIndent;                                                         01                  001135
 001136            inCode = *Off;                                                                        01                  001136
 001137         EndIf;                                                                                  E01                  001137
 001138                                                                                                                      001138
 001139         // If spanning a line, check if the current line ends the span.                                              001139
 001140         If (inSpan or inIf or inDo or inWhen or inCallP or inEval                               B01                  001140
 001141         or inSQL or inDeclaration)                                                              B01                  001141
 001142         and not inComment;                                                                      B01                  001142
 001143            lineEnd = %scan(';':%trim(sourceLine));                                               01                  001143
 001144            If lineEnd <> 0;                                                                     B02                  001144
 001145               inSpan = *Off;                                                                     02                  001145
 001146               inIf = *Off;                                                                       02                  001146
 001147               inDo = *Off;                                                                       02                  001147
 001148               inWhen = *Off;                                                                     02                  001148
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001149               inCallP = *Off;                                                                    02                  001149
 001150               inEval = *Off;                                                                     02                  001150
 001151               inSQL = *Off;                                                                      02                  001151
 001152               inDeclaration = *Off;                                                              02                  001152
 001153            EndIf;                                                                               E02                  001153
 001154         EndIf;                                                                                  E01                  001154
 001155                                                                                                                      001155
 001156         //----------------------------------------------------------------------------------                         001156
 001157         // Close off Prototype/Interface/Datastructure?                                                              001157
 001158         If (inPrototype or inInterface or inDatastructure)                                      B01                  001158
 001159         and SRCSEQ = endLine;                                                                   B01                  001159
 001160            If not inDatastructure                                                               B02                  001160
 001161            or inDatastructure and endDS;                                                        B02                  001161
 001162               savedSRCDTA = SRCDTA;                                                              02                  001162
 001163               Clear SRCDTA;                                                                      02                  001163
 001164               codeLine = 'End-' + endDeclType + ';';                                             02                  001164
 001165               Exsr subUserWriteLine;                                                             02                  001165
 001166               SRCDTA = savedSRCDTA;                                                              02                  001166
 001167            EndIf;                                                                               E02                  001167
 001168            inPrototype = *Off;                                                                   01                  001168
 001169            inExtProc = *Off;                                                                     01                  001169
 001170            inInterface = *Off;                                                                   01                  001170
 001171            inDatastructure = *Off;                                                               01                  001171
 001172            inSpan = *Off;                                                                        01                  001172
 001173            inDeclaration = *Off;                                                                 01                  001173
 001174            inExtProc = *Off;                                                                     01                  001174
 001175            workDeclName = *Blanks;                                                               01                  001175
 001176         EndIf;                                                                                  E01                  001176
 001177                                                                                                                      001177
 001178      EndSr;                                                                                                          001178
 001179   //-------------------------------------------------------------------------------------------                      001179
 001180                                                                                                                      001180
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     32
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001182   //-------------------------------------------------------------------------------------------                      001182
 001183   // Convert the line to free-format?                                                                                001183
 001184   //-------------------------------------------------------------------------------------------                      001184
 001185   BegSr subUserConvertC_Spec;                                                                                        001185
 001186                                                                                                                      001186
 001187      Select;                                                                                    B01                  001187
 001188            // Keep blank lines.                                                                                      001188
 001189         When codeLine = *Blanks;                                                                X01                  001189
 001190            sourceLine = *Blanks;                                                                 01                  001190
 001191            convert = *On;                                                                        01                  001191
 001192                                                                                                                      001192
 001193           //----------------------------------------------------------------------------------                       001193
 001194            // EXEC SQL                                                                                               001194
 001195         When workDirective = '/EXEC SQL' or inSQL;                                              X01                  001195
 001196            Exsr subUserCvt_EXEC_SQL;                                                             01                  001196
 001197                                                                                                                      001197
 001198           //----------------------------------------------------------------------------------                       001198
 001199            // END-EXEC                                                                                               001199
 001200         When workDirective = '/END-EXEC';                                                       X01                  001200
 001201            convert = *On;                                                                        01                  001201
 001202                                                                                                                      001202
 001203           //----------------------------------------------------------------------------------                       001203
 001204            // Conditioning indicators                                                                                001204
 001205         When condInd <> *Blanks;                                                                X01                  001205
 001206            nonConvRsn = 'Conditioning indicators are not currently '                             01                  001206
 001207                       + 'supported.';                                                            01                  001207
 001208                                                                                                                      001208
 001209           //----------------------------------------------------------------------------------                       001209
 001210            // ACQ.                                                                                                   001210
 001211         When %subst(operator:1:3) = 'ACQ';                                                      X01                  001211
 001212            Exsr subUserCvt_ACQ;                                                                  01                  001212
 001213                                                                                                                      001213
 001214           //----------------------------------------------------------------------------------                       001214
 001215            // ADDDUR.                                                                                                001215
 001216         When %subst(operator:1:6) = 'ADDDUR';                                                   X01                  001216
 001217            Exsr subUserCvt_ADDDUR;                                                               01                  001217
 001218                                                                                                                      001218
 001219           //----------------------------------------------------------------------------------                       001219
 001220            // ADD.                                                                                                   001220
 001221         When %subst(operator:1:3) = 'ADD';                                                      X01                  001221
 001222            Exsr subUserCvt_ADD;                                                                  01                  001222
 001223                                                                                                                      001223
 001224           //----------------------------------------------------------------------------------                       001224
 001225            // ALLOC.                                                                                                 001225
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     33
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001226         When %subst(operator:1:5) = 'ALLOC';                                                    X01                  001226
 001227            Exsr subUserCvt_ALLOC;                                                                01                  001227
 001228                                                                                                                      001228
 001229           //----------------------------------------------------------------------------------                       001229
 001230            // BEGSR                                                                                                  001230
 001231         When operator = 'BEGSR';                                                                X01                  001231
 001232            Exsr subUserCvt_BEGSR;                                                                01                  001232
 001233                                                                                                                      001233
 001234           //----------------------------------------------------------------------------------                       001234
 001235            // CALLP                                                                                                  001235
 001236         When %subst(operator:1:5) = 'CALLP' or inCallP;                                         X01                  001236
 001237            Exsr subUserCvt_CALLP;                                                                01                  001237
 001238                                                                                                                      001238
 001239           //----------------------------------------------------------------------------------                       001239
 001240            // CASxx                                                                                                  001240
 001241         When %subst(operator:1:3) = 'CAS';                                                      X01                  001241
 001242            Exsr subUserCvt_CASxx;                                                                01                  001242
 001243                                                                                                                      001243
 001244           //----------------------------------------------------------------------------------                       001244
 001245            // CAT                                                                                                    001245
 001246         When %subst(operator:1:3) = 'CAT';                                                      X01                  001246
 001247            Exsr subUserCvt_CAT;                                                                  01                  001247
 001248                                                                                                                      001248
 001249           //----------------------------------------------------------------------------------                       001249
 001250            // CHAIN                                                                                                  001250
 001251         When %subst(operator:1:5) = 'CHAIN';                                                    X01                  001251
 001252            Exsr subUserCvt_CHAIN;                                                                01                  001252
 001253                                                                                                                      001253
 001254           //----------------------------------------------------------------------------------                       001254
 001255            // CHECK                                                                                                  001255
 001256         When %subst(operator:1:5) = 'CHECK';                                                    X01                  001256
 001257            Exsr subUserCvt_CHECKx;                                                               01                  001257
 001258                                                                                                                      001258
 001259           //----------------------------------------------------------------------------------                       001259
 001260            // CLEAR                                                                                                  001260
 001261         When %subst(operator:1:5) = 'CLEAR';                                                    X01                  001261
 001262            Exsr subUserCvt_CLEAR;                                                                01                  001262
 001263                                                                                                                      001263
 001264           //----------------------------------------------------------------------------------                       001264
 001265            // CLOSE                                                                                                  001265
 001266         When %subst(operator:1:5) = 'CLOSE';                                                    X01                  001266
 001267            Exsr subUserCvt_CLOSE;                                                                01                  001267
 001268                                                                                                                      001268
 001269           //----------------------------------------------------------------------------------                       001269
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     34
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001270            // COMMIT                                                                                                 001270
 001271         When %subst(operator:1:6) = 'COMMIT';                                                   X01                  001271
 001272            Exsr subUserCvt_COMMIT;                                                               01                  001272
 001273                                                                                                                      001273
 001274           //----------------------------------------------------------------------------------                       001274
 001275            // COMP                                                                                                   001275
 001276         When operator = 'COMP';                                                                 X01                  001276
 001277            Exsr subUserCvt_COMP;                                                                 01                  001277
 001278                                                                                                                      001278
 001279           //----------------------------------------------------------------------------------                       001279
 001280            // DEALLOC.                                                                                               001280
 001281         When %subst(operator:1:7) = 'DEALLOC';                                                  X01                  001281
 001282            Exsr subUserCvt_DEALLOC;                                                              01                  001282
 001283                                                                                                                      001283
 001284           //----------------------------------------------------------------------------------                       001284
 001285            // DEFINE                                                                                                 001285
 001286         When operator = 'DEFINE';                                                               X01                  001286
 001287            dropLine = *On;                                                                       01                  001287
 001288                                                                                                                      001288
 001289           //----------------------------------------------------------------------------------                       001289
 001290            // DELETE                                                                                                 001290
 001291         When %subst(operator:1:6) = 'DELETE';                                                   X01                  001291
 001292            Exsr subUserCvt_DELETE;                                                               01                  001292
 001293                                                                                                                      001293
 001294           //----------------------------------------------------------------------------------                       001294
 001295            // DIV                                                                                                    001295
 001296         When %subst(operator:1:3) = 'DIV';                                                      X01                  001296
 001297            Exsr subUserCvt_DIV;                                                                  01                  001297
 001298                                                                                                                      001298
 001299           //----------------------------------------------------------------------------------                       001299
 001300            // DOxxx                                                                                                  001300
 001301         When %subst(operator:1:2) = 'DO'                                                        X01                  001301
 001302         and (%subst(operator:3:3) = 'WEQ'                                                       X01                  001302
 001303         or %subst(operator:3:2) = 'W '                                                          X01                  001303
 001304         or %subst(operator:3:3) = 'WGT'                                                         X01                  001304
 001305         or %subst(operator:3:3) = 'WLT'                                                         X01                  001305
 001306         or %subst(operator:3:3) = 'WNE'                                                         X01                  001306
 001307         or %subst(operator:3:3) = 'WGE'                                                         X01                  001307
 001308         or %subst(operator:3:3) = 'WLE'                                                         X01                  001308
 001309         or %subst(operator:3:2) = 'U '                                                          X01                  001309
 001310         or %subst(operator:3:3) = 'UEQ'                                                         X01                  001310
 001311         or %subst(operator:3:3) = 'UGT'                                                         X01                  001311
 001312         or %subst(operator:3:3) = 'ULT'                                                         X01                  001312
 001313         or %subst(operator:3:3) = 'UNE'                                                         X01                  001313
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     35
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001314         or %subst(operator:3:3) = 'UGE'                                                         X01                  001314
 001315         or %subst(operator:3:3) = 'ULE'                                                         X01                  001315
 001316         or %subst(operator:3:3) = '   ')                                                        X01                  001316
 001317         or inDo;                                                                                X01                  001317
 001318            Exsr subUserCvt_DO;                                                                   01                  001318
 001319                                                                                                                      001319
 001320           //----------------------------------------------------------------------------------                       001320
 001321            // DSPLY                                                                                                  001321
 001322         When %subst(operator:1:5) = 'DSPLY';                                                    X01                  001322
 001323            Exsr subUserCvt_DSPLY;                                                                01                  001323
 001324                                                                                                                      001324
 001325           //----------------------------------------------------------------------------------                       001325
 001326            // DUMP                                                                                                   001326
 001327         When %subst(operator:1:4) = 'DUMP';                                                     X01                  001327
 001328            Exsr subUserCvt_DUMP;                                                                 01                  001328
 001329                                                                                                                      001329
 001330           //----------------------------------------------------------------------------------                       001330
 001331            // ELSE                                                                                                   001331
 001332         When operator = 'ELSE';                                                                 X01                  001332
 001333            Exsr subUserCvt_ELSE;                                                                 01                  001333
 001334                                                                                                                      001334
 001335           //----------------------------------------------------------------------------------                       001335
 001336            // ELSEIF                                                                                                 001336
 001337         When operator = 'ELSEIF';                                                               X01                  001337
 001338            Exsr subUserCvt_ELSEIF;                                                               01                  001338
 001339                                                                                                                      001339
 001340           //----------------------------------------------------------------------------------                       001340
 001341            // ENDxx                                                                                                  001341
 001342         When %subst(operator:1:3) = 'END';                                                      X01                  001342
 001343            Exsr subUserCvt_ENDxx;                                                                01                  001343
 001344                                                                                                                      001344
 001345           //----------------------------------------------------------------------------------                       001345
 001346            // EVALx                                                                                                  001346
 001347         When %subst(operator:1:4) = 'EVAL' or inEval;                                           X01                  001347
 001348            Exsr subUserCvt_EVALx;                                                                01                  001348
 001349                                                                                                                      001349
 001350           //----------------------------------------------------------------------------------                       001350
 001351            // EXCEPT                                                                                                 001351
 001352         When operator = 'EXCEPT';                                                               X01                  001352
 001353            Exsr subUserCvt_EXCEPT;                                                               01                  001353
 001354                                                                                                                      001354
 001355           //----------------------------------------------------------------------------------                       001355
 001356            // EXFMT                                                                                                  001356
 001357         When %subst(operator:1:5) = 'EXFMT';                                                    X01                  001357
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     36
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001358            Exsr subUserCvt_EXFMT;                                                                01                  001358
 001359                                                                                                                      001359
 001360           //----------------------------------------------------------------------------------                       001360
 001361            // EXSR                                                                                                   001361
 001362         When operator = 'EXSR';                                                                 X01                  001362
 001363            Exsr subUserCvt_EXSR;                                                                 01                  001363
 001364                                                                                                                      001364
 001365           //----------------------------------------------------------------------------------                       001365
 001366            // EXTRCT                                                                                                 001366
 001367         When %subst(operator:1:6) = 'EXTRCT';                                                   X01                  001367
 001368            Exsr subUserCvt_EXTRCT;                                                               01                  001368
 001369                                                                                                                      001369
 001370           //----------------------------------------------------------------------------------                       001370
 001371            // FEOD                                                                                                   001371
 001372         When %subst(operator:1:4) = 'FEOD';                                                     X01                  001372
 001373            Exsr subUserCvt_FEOD;                                                                 01                  001373
 001374                                                                                                                      001374
 001375           //----------------------------------------------------------------------------------                       001375
 001376            // FOR                                                                                                    001376
 001377         When operator = 'FOR';                                                                  X01                  001377
 001378            Exsr subUserCvt_FOR;                                                                  01                  001378
 001379                                                                                                                      001379
 001380           //----------------------------------------------------------------------------------                       001380
 001381            // FORCE                                                                                                  001381
 001382         When operator = 'FORCE';                                                                X01                  001382
 001383            Exsr subUserCvt_FORCE;                                                                01                  001383
 001384                                                                                                                      001384
 001385           //----------------------------------------------------------------------------------                       001385
 001386            // IFxx                                                                                                   001386
 001387         When %subst(operator:1:2) = 'IF' or inIf;                                               X01                  001387
 001388            Exsr subUserCvt_IF;                                                                   01                  001388
 001389                                                                                                                      001389
 001390           //----------------------------------------------------------------------------------                       001390
 001391            // IN                                                                                                     001391
 001392         When %subst(operator:1:2) = 'IN';                                                       X01                  001392
 001393            Exsr subUserCvt_IN;                                                                   01                  001393
 001394                                                                                                                      001394
 001395           //----------------------------------------------------------------------------------                       001395
 001396            // ITER                                                                                                   001396
 001397         When operator = 'ITER';                                                                 X01                  001397
 001398            Exsr subUserCvt_ITER;                                                                 01                  001398
 001399                                                                                                                      001399
 001400           //----------------------------------------------------------------------------------                       001400
 001401            // LEAVExx;                                                                                               001401
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     37
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001402         When %subst(operator:1:5) = 'LEAVE';                                                    X01                  001402
 001403            Exsr subUserCvt_LEAVE;                                                                01                  001403
 001404                                                                                                                      001404
 001405           //----------------------------------------------------------------------------------                       001405
 001406            // LOOKUP                                                                                                 001406
 001407         When operator = 'LOOKUP';                                                               X01                  001407
 001408            Exsr subUserCvt_LOOKUP;                                                               01                  001408
 001409                                                                                                                      001409
 001410           //----------------------------------------------------------------------------------                       001410
 001411            // MOVEA                                                                                                  001411
 001412         When %subst(operator:1:5) = 'MOVEA';                                                    X01                  001412
 001413            Exsr subUserCvt_MOVEA;                                                                01                  001413
 001414            LeaveSr;                                                                              01                  001414
 001415                                                                                                                      001415
 001416           //----------------------------------------------------------------------------------                       001416
 001417            // MOVE/MOVEL                                                                                             001417
 001418         When operator = 'MONITOR';                                                              X01                  001418
 001419            Exsr subUserCvt_MONITOR;                                                              01                  001419
 001420                                                                                                                      001420
 001421           //----------------------------------------------------------------------------------                       001421
 001422            // MOVE/MOVEL                                                                                             001422
 001423         When %subst(operator:1:4) = 'MOVE';                                                     X01                  001423
 001424            Exsr subUserCvt_MOVE;                                                                 01                  001424
 001425                                                                                                                      001425
 001426           //----------------------------------------------------------------------------------                       001426
 001427            // MULT.                                                                                                  001427
 001428         When %subst(operator:1:4) = 'MULT';                                                     X01                  001428
 001429            Exsr subUserCvt_MULT;                                                                 01                  001429
 001430                                                                                                                      001430
 001431           //----------------------------------------------------------------------------------                       001431
 001432            // MVR                                                                                                    001432
 001433         When operator = 'MVR';                                                                  X01                  001433
 001434            Exsr subUserCvt_MVR;                                                                  01                  001434
 001435                                                                                                                      001435
 001436           //----------------------------------------------------------------------------------                       001436
 001437            // OCCUR (but not both set and get).                                                                      001437
 001438         When %subst(operator:1:5) = 'OCCUR';                                                    X01                  001438
 001439            Exsr subUserCvt_OCCUR;                                                                01                  001439
 001440                                                                                                                      001440
 001441           //----------------------------------------------------------------------------------                       001441
 001442            // ON-ERROR                                                                                               001442
 001443         When operator = 'ON-ERROR';                                                             X01                  001443
 001444            Exsr subUserCvt_ON_ERROR;                                                             01                  001444
 001445                                                                                                                      001445
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     38
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001446           //----------------------------------------------------------------------------------                       001446
 001447            // OPEN                                                                                                   001447
 001448         When %subst(operator:1:4) = 'OPEN';                                                     X01                  001448
 001449            Exsr subUserCvt_OPEN;                                                                 01                  001449
 001450                                                                                                                      001450
 001451           //----------------------------------------------------------------------------------                       001451
 001452            // OTHER                                                                                                  001452
 001453         When operator = 'OTHER';                                                                X01                  001453
 001454            Exsr subUserCvt_OTHER;                                                                01                  001454
 001455                                                                                                                      001455
 001456           //----------------------------------------------------------------------------------                       001456
 001457            // OUT                                                                                                    001457
 001458         When %subst(operator:1:3) = 'OUT';                                                      X01                  001458
 001459            Exsr subUserCvt_OUT;                                                                  01                  001459
 001460                                                                                                                      001460
 001461           //----------------------------------------------------------------------------------                       001461
 001462            // POST                                                                                                   001462
 001463         When %subst(operator:1:4) = 'POST';                                                     X01                  001463
 001464            Exsr subUserCvt_POST;                                                                 01                  001464
 001465                                                                                                                      001465
 001466           //----------------------------------------------------------------------------------                       001466
 001467            // READ                                                                                                   001467
 001468         When %subst(operator:1:4) = 'READ';                                                     X01                  001468
 001469            Exsr subUserCvt_READ;                                                                 01                  001469
 001470                                                                                                                      001470
 001471           //----------------------------------------------------------------------------------                       001471
 001472            // REL                                                                                                    001472
 001473         When %subst(operator:1:3) = 'REL';                                                      X01                  001473
 001474            Exsr subUserCvt_REL;                                                                  01                  001474
 001475                                                                                                                      001475
 001476           //----------------------------------------------------------------------------------                       001476
 001477            // RESET                                                                                                  001477
 001478         When %subst(operator:1:5) = 'RESET';                                                    X01                  001478
 001479            Exsr subUserCvt_RESET;                                                                01                  001479
 001480                                                                                                                      001480
 001481           //----------------------------------------------------------------------------------                       001481
 001482            // RETURN                                                                                                 001482
 001483         When %subst(operator:1:6) = 'RETURN';                                                   X01                  001483
 001484            Exsr subUserCvt_RETURN;                                                               01                  001484
 001485                                                                                                                      001485
 001486           //----------------------------------------------------------------------------------                       001486
 001487            // ROLBK                                                                                                  001487
 001488         When %subst(operator:1:5) = 'ROLBK';                                                    X01                  001488
 001489            Exsr subUserCvt_ROLBK;                                                                01                  001489
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     39
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001490                                                                                                                      001490
 001491           //----------------------------------------------------------------------------------                       001491
 001492            // SCAN                                                                                                   001492
 001493         When operator = 'SCAN';                                                                 X01                  001493
 001494            Exsr subUserCvt_SCAN;                                                                 01                  001494
 001495                                                                                                                      001495
 001496           //----------------------------------------------------------------------------------                       001496
 001497            // SELECT                                                                                                 001497
 001498         When operator = 'SELECT';                                                               X01                  001498
 001499            Exsr subUserCvt_SELECT;                                                               01                  001499
 001500                                                                                                                      001500
 001501           //----------------------------------------------------------------------------------                       001501
 001502            // SETLL / SETGT                                                                                          001502
 001503         When %subst(operator:1:5) = 'SETLL'                                                     X01                  001503
 001504         or %subst(operator:1:5) = 'SETGT';                                                      X01                  001504
 001505            Exsr subUserCvt_SETxx;                                                                01                  001505
 001506                                                                                                                      001506
 001507           //----------------------------------------------------------------------------------                       001507
 001508            // SETOFF                                                                                                 001508
 001509         When operator = 'SETOFF';                                                               X01                  001509
 001510            Exsr subUserCvt_SETOFF;                                                               01                  001510
 001511                                                                                                                      001511
 001512           //----------------------------------------------------------------------------------                       001512
 001513            // SETON                                                                                                  001513
 001514         When operator = 'SETON';                                                                X01                  001514
 001515            Exsr subUserCvt_SETON;                                                                01                  001515
 001516                                                                                                                      001516
 001517           //----------------------------------------------------------------------------------                       001517
 001518            // SHTDN                                                                                                  001518
 001519         When operator = 'SHTDN';                                                                X01                  001519
 001520            Exsr subUserCvt_SHTDN;                                                                01                  001520
 001521                                                                                                                      001521
 001522           //----------------------------------------------------------------------------------                       001522
 001523            // SORTA.                                                                                                 001523
 001524         When %subst(operator:1:5) = 'SORTA';                                                    X01                  001524
 001525            Exsr subUserCvt_SORTA;                                                                01                  001525
 001526                                                                                                                      001526
 001527           //----------------------------------------------------------------------------------                       001527
 001528            // SUBDUR.                                                                                                001528
 001529         When %subst(operator:1:6) = 'SUBDUR';                                                   X01                  001529
 001530            Exsr subUserCvt_SUBDUR;                                                               01                  001530
 001531                                                                                                                      001531
 001532           //----------------------------------------------------------------------------------                       001532
 001533            // SUBST.                                                                                                 001533
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     40
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001534         When %subst(operator:1:5) = 'SUBST';                                                    X01                  001534
 001535            Exsr subUserCvt_SUBST;                                                                01                  001535
 001536                                                                                                                      001536
 001537           //----------------------------------------------------------------------------------                       001537
 001538            // SUB                                                                                                    001538
 001539         When %subst(operator:1:3) = 'SUB';                                                      X01                  001539
 001540            Exsr subUserCvt_SUB;                                                                  01                  001540
 001541                                                                                                                      001541
 001542           //----------------------------------------------------------------------------------                       001542
 001543            // TESTB                                                                                                  001543
 001544         When operator = 'TESTB';                                                                X01                  001544
 001545                                                                                                                      001545
 001546           //----------------------------------------------------------------------------------                       001546
 001547            // TESTN                                                                                                  001547
 001548         When operator = 'TESTN';                                                                X01                  001548
 001549                                                                                                                      001549
 001550           //----------------------------------------------------------------------------------                       001550
 001551            // TESTZ                                                                                                  001551
 001552         When operator = 'TESTZ';                                                                X01                  001552
 001553                                                                                                                      001553
 001554           //----------------------------------------------------------------------------------                       001554
 001555            // TEST                                                                                                   001555
 001556         When %subst(operator:1:4) = 'TEST';                                                     X01                  001556
 001557            Exsr subUserCvt_TEST;                                                                 01                  001557
 001558                                                                                                                      001558
 001559           //----------------------------------------------------------------------------------                       001559
 001560            // TIME                                                                                                   001560
 001561         When operator = 'TIME';                                                                 X01                  001561
 001562            Exsr subUserCvt_TIME;                                                                 01                  001562
 001563                                                                                                                      001563
 001564           //----------------------------------------------------------------------------------                       001564
 001565            // UPDATE                                                                                                 001565
 001566         When %subst(operator:1:6) = 'UPDATE';                                                   X01                  001566
 001567            Exsr subUserCvt_UPDATE;                                                               01                  001567
 001568                                                                                                                      001568
 001569           //----------------------------------------------------------------------------------                       001569
 001570            // UNLOCK                                                                                                 001570
 001571         When %subst(operator:1:6) = 'UNLOCK';                                                   X01                  001571
 001572            Exsr subUserCvt_UNLOCK;                                                               01                  001572
 001573                                                                                                                      001573
 001574           //----------------------------------------------------------------------------------                       001574
 001575            // WHENxx                                                                                                 001575
 001576         When %subst(operator:1:4) = 'WHEN' or inWhen;                                           X01                  001576
 001577            Exsr subUserCvt_WHEN;                                                                 01                  001577
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     41
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001578                                                                                                                      001578
 001579           //----------------------------------------------------------------------------------                       001579
 001580            // WRITE                                                                                                  001580
 001581         When %subst(operator:1:5) = 'WRITE';                                                    X01                  001581
 001582            Exsr subUserCvt_WRITE;                                                                01                  001582
 001583                                                                                                                      001583
 001584           //----------------------------------------------------------------------------------                       001584
 001585            // XLATE                                                                                                  001585
 001586         When %subst(operator:1:5) = 'XLATE';                                                    X01                  001586
 001587            Exsr subUserCvt_XLATE;                                                                01                  001587
 001588                                                                                                                      001588
 001589           //----------------------------------------------------------------------------------                       001589
 001590            // Z-ADD (half-adjust not converted).                                                                     001590
 001591         When %subst(operator:1:5) = 'Z-ADD';                                                    X01                  001591
 001592            Exsr subUserCvt_Z_ADD;                                                                01                  001592
 001593                                                                                                                      001593
 001594           //----------------------------------------------------------------------------------                       001594
 001595            // Z-SUB (half-adjust not converted).                                                                     001595
 001596         When %subst(operator:1:5) = 'Z-SUB';                                                    X01                  001596
 001597            Exsr subUserCvt_Z_SUB;                                                                01                  001597
 001598      EndSl;                                                                                     E01                  001598
 001599                                                                                                                      001599
 001600   EndSr;                                                                                                             001600
 001601   //-------------------------------------------------------------------------------------------                      001601
 001602                                                                                                                      001602
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     42
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001604   //-------------------------------------------------------------------------------------------                      001604
 001605   // Convert declaration to free-format.                                                                             001605
 001606   //-------------------------------------------------------------------------------------------                      001606
 001607   BegSr subUserConvertD_Spec;                                                                                        001607
 001608                                                                                                                      001608
 001609      // Keep blank lines.                                                                                            001609
 001610      If codeLine = *Blanks;                                                                     B01                  001610
 001611         sourceLine = *Blanks;                                                                    01                  001611
 001612         convert = *On;                                                                           01                  001612
 001613         LeaveSr;                                                                                 01                  001613
 001614      EndIf;                                                                                     E01                  001614
 001615                                                                                                                      001615
 001616      sourceLine = fullLine;                                                                                          001616
 001617                                                                                                                      001617
 001618      //      declType = %xlate(lo:up:declType);                                                                      001618
 001619      workDeclAttr = %xlate(lo:up:declAttr);                                                                          001619
 001620      workDeclKeywords = declKeywords;       // Use longer work field to cater for expansion.                         001620
 001621                                                                                                                      001621
 001622      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              001622
 001623                                                                                                                      001623
 001624      //If not inDeclaration;                                                                                         001624
 001625      If not inDeclaration or declName = *Blanks;                                                B01                  001625
 001626         If not inDeclaration;                                                                   B02                  001626
 001627            //Exsr subUserGetDeclarationType;                                                                         001627
 001628            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  001628
 001629         EndIf;                                                                                  E02                  001629
 001630                                                                                                                      001630
 001631         //-------------------------------------------------------------------------                                  001631
 001632         // Stand-alone Field Definition.                                                                             001632
 001633         //-------------------------------------------------------------------------                                  001633
 001634         If workDeclType = 'S';      // Stand-alone field.                                       B02                  001634
 001635            inDeclaration = *On;                                                                  02                  001635
 001636                                                                                                                      001636
 001637            Clear DCLS;                                                                           02                  001637
 001638                                                                                                                      001638
 001639            // FROMFILE is not allowed.                                                                               001639
 001640            If %scan('FROMFILE':%xlate(lo:up:workDeclKeywords)) > 0;                             B03                  001640
 001641               inDeclaration = *Off;                                                              03                  001641
 001642               nonConvRsn = 'FROMFILE not allowed in Free-Form';                                  03                  001642
 001643               convert = *Off;                                                                    03                  001643
 001644               LeaveSr;                                                                           03                  001644
 001645            EndIf;                                                                               E03                  001645
 001646                                                                                                                      001646
 001647            If savedName <> *Blanks;                                                             B03                  001647
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     43
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001648               DCLS.decl = 'Dcl-S ';                                                              03                  001648
 001649               %subst(DCLS:7) = savedName;                                                        03                  001649
 001650            EndIf;                                                                               E03                  001650
 001651                                                                                                                      001651
 001652            // Type.                                                                                                  001652
 001653            If workDeclAttr = *Blanks                                                            B03                  001653
 001654            and DCLS.type = *Blanks;                                                             B03                  001654
 001655               If declLen = *Blanks;                                                             B04                  001655
 001656                  // No definition (probably in keywords - e.g. LIKE()).                                              001656
 001657               ElseIf declScale = *Blanks;                                                       X04                  001657
 001658                  workDeclAttr = 'A';                                                             04                  001658
 001659               Else;                                                                             X04                  001659
 001660                  If inDatastructure;                                                            B05                  001660
 001661                     workDeclAttr = 'S';                                                          05                  001661
 001662                  Else;                                                                          X05                  001662
 001663                     workDeclAttr = 'P';                                                          05                  001663
 001664                  EndIf;                                                                         E05                  001664
 001665               EndIf;                                                                            E04                  001665
 001666            EndIf;                                                                               E03                  001666
 001667                                                                                                                      001667
 001668            If workDeclAttr = *Blanks;                                                           B03                  001668
 001669               // No definition (probably in keywords - e.g. LIKE()).                                                 001669
 001670            ElseIf workDeclAttr = 'A';                                                           X03                  001670
 001671               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001671
 001672               If x > 0;                                                                         B04                  001672
 001673                  DCLS.type = '  VarChar';                                                        04                  001673
 001674                  If x = 1;                                                                      B05                  001674
 001675                     workDeclKeywords = %subst(workDeclKeywords:x+7);                             05                  001675
 001676                  Else;                                                                          X05                  001676
 001677                     workDeclKeywords = %subst(workDeclKeywords:1:x-1)                            05                  001677
 001678                                  + %subst(workDeclKeywords:x+7);                                 05                  001678
 001679                  EndIf;                                                                         E05                  001679
 001680               Else;                                                                             X04                  001680
 001681                  DCLS.type = '     Char';                                                        04                  001681
 001682               EndIf;                                                                            E04                  001682
 001683            ElseIf workDeclAttr = 'P';                                                           X03                  001683
 001684               DCLS.type = '   Packed';                                                           03                  001684
 001685            ElseIf workDeclAttr = 'D';                                                           X03                  001685
 001686               DCLS.type = '     Date';                                                           03                  001686
 001687               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001687
 001688               If x > 0;                                                                         B04                  001688
 001689                  x = %scan('(':workDeclKeywords:x);                                              04                  001689
 001690                  y = %scan(')':workDeclKeywords:x);                                              04                  001690
 001691                  DCLS.definition = '('                                                           04                  001691
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     44
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001692                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001692
 001693                            + ')';                                                                04                  001693
 001694                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001694
 001695               EndIf;                                                                            E04                  001695
 001696            ElseIf workDeclAttr = 'T';                                                           X03                  001696
 001697               DCLS.type = '     Time';                                                           03                  001697
 001698               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001698
 001699               If x > 0;                                                                         B04                  001699
 001700                  x = %scan('(':workDeclKeywords:x);                                              04                  001700
 001701                  y = %scan(')':workDeclKeywords:x);                                              04                  001701
 001702                  DCLS.definition = '('                                                           04                  001702
 001703                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001703
 001704                            + ')';                                                                04                  001704
 001705                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001705
 001706               EndIf;                                                                            E04                  001706
 001707            ElseIf workDeclAttr = 'Z';                                                           X03                  001707
 001708               DCLS.type = 'TimeStamp';                                                           03                  001708
 001709            ElseIf workDeclAttr = 'I';                                                           X03                  001709
 001710               DCLS.type = '      Int';                                                           03                  001710
 001711            ElseIf workDeclAttr = 'S';                                                           X03                  001711
 001712               DCLS.type = '    Zoned';                                                           03                  001712
 001713            ElseIf workDeclAttr = 'N';                                                           X03                  001713
 001714               DCLS.type = '      Ind';                                                           03                  001714
 001715            ElseIf workDeclAttr = '*';                                                           X03                  001715
 001716               DCLS.type = '  Pointer';                                                           03                  001716
 001717            ElseIf workDeclAttr = 'B';                                                           X03                  001717
 001718               DCLS.type = '   BinDec';                                                           03                  001718
 001719            ElseIf workDeclAttr = 'G';                                                           X03                  001719
 001720               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001720
 001721               If x > 0;                                                                         B04                  001721
 001722                  DCLS.type = ' VarGraph';                                                        04                  001722
 001723                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001723
 001724               Else;                                                                             X04                  001724
 001725                  DCLS.type = '    Graph';                                                        04                  001725
 001726               EndIf;                                                                            E04                  001726
 001727            Else;                                                                                X03                  001727
 001728               inDeclaration = *Off;                                                              03                  001728
 001729               convert = *Off;                                                                    03                  001729
 001730               LeaveSr;                                                                           03                  001730
 001731            EndIf;                                                                               E03                  001731
 001732                                                                                                                      001732
 001733            // Attributes.                                                                                            001733
 001734            If workDeclAttr <> '*'                                                               B03                  001734
 001735            and workDeclAttr <> 'N'                                                              B03                  001735
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     45
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001736            and workDeclAttr <> 'D'                                                              B03                  001736
 001737            and workDeclAttr <> 'T'                                                              B03                  001737
 001738            and workDeclAttr <> 'Z'                                                              B03                  001738
 001739            and workDeclAttr <> *Blank                                                           B03                  001739
 001740            and DCLS.type <> *Blanks;                                                            B03                  001740
 001741               DCLS.definition = '(' + %trim(declLen);                                            03                  001741
 001742               If declScale <> *Blanks;                                                          B04                  001742
 001743                  DCLS.definition = %trimr(DCLS.definition)                                       04                  001743
 001744                                  + ':' + %trim(declScale);                                       04                  001744
 001745               EndIf;                                                                            E04                  001745
 001746               DCLS.definition = %trimr(DCLS.definition) + ')';                                   03                  001746
 001747            EndIf;                                                                               E03                  001747
 001748                                                                                                                      001748
 001749            // Keywords.                                                                                              001749
 001750                                                                                                                      001750
 001751            // Expand DTAARA?                                                                                         001751
 001752            x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                                  02                  001752
 001753            If x > 0;                                                                            B03                  001753
 001754               i = %scan(')':workDeclKeywords:x+1);                                               03                  001754
 001755               If i > 0;                                                                         B04                  001755
 001756                  If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                         B05                  001756
 001757                     workDeclKeywords = %subst(workDeclKeywords:1:x+6)                            05                  001757
 001758                        + ''''                                                                    05                  001758
 001759                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      05                  001759
 001760                        + ''''                                                                    05                  001760
 001761                        + %subst(workDeclKeywords:i);                                             05                  001761
 001762                  EndIf;                                                                         E05                  001762
 001763               EndIf;                                                                            E04                  001763
 001764            EndIf;                                                                               E03                  001764
 001765                                                                                                                      001765
 001766            // Terminate the line?                                                                                    001766
 001767            If not inSpan;                                                                       B03                  001767
 001768               If workDeclKeyWords = *Blanks;                                                    B04                  001768
 001769                  DCLS.definition = %trimr(DCLS.definition) + ';';                                04                  001769
 001770               Else;                                                                             X04                  001770
 001771                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  001771
 001772               EndIf;                                                                            E04                  001772
 001773               inDeclaration = *Off;                                                              03                  001773
 001774            Else;                                                                                X03                  001774
 001775               inSpan = *Off;                                                                     03                  001775
 001776            EndIf;                                                                               E03                  001776
 001777                                                                                                                      001777
 001778            // Have we encroached on the comments?                                                                    001778
 001779            x = %len(%trimr(DCLS.definition)) + %len(workDeclKeywords);                           02                  001779
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     46
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001780            If x >= 37;                                                                          B03                  001780
 001781               x = x - %len(%trimr(DCLS.definition));                                             03                  001781
 001782               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  001782
 001783               indentOffset = 37;                                                                 03                  001783
 001784            EndIf;                                                                               E03                  001784
 001785                                                                                                                      001785
 001786            If DCLS.definition = *Blanks and DCLS.type = *Blanks;                                B03                  001786
 001787               DCLS.definition = %trim(workDeclKeywords);                                         03                  001787
 001788            Else;                                                                                X03                  001788
 001789               DCLS.definition = %trimr(DCLS.definition) + ' '                                    03                  001789
 001790                               + %trim(workDeclKeywords);                                         03                  001790
 001791            EndIf;                                                                               E03                  001791
 001792                                                                                                                      001792
 001793            // Comment.                                                                                               001793
 001794            If comment <> *Blanks;                                                               B03                  001794
 001795               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001795
 001796                  DCLS.comment = '   ' + comment;                                                 04                  001796
 001797               Else;                                                                             X04                  001797
 001798                  DCLS.comment = '// ' + comment;                                                 04                  001798
 001799               EndIf;                                                                            E04                  001799
 001800            EndIf;                                                                               E03                  001800
 001801                                                                                                                      001801
 001802            // Converted line...                                                                                      001802
 001803            sourceLine = DCLS;                                                                    02                  001803
 001804            If not inSpan;                                                                       B03                  001804
 001805               savedName = *Blanks;                                                               03                  001805
 001806            EndIf;                                                                               E03                  001806
 001807                                                                                                                      001807
 001808            //-------------------------------------------------------------------------                               001808
 001809            // Constant Definition.                                                                                   001809
 001810            //-------------------------------------------------------------------------                               001810
 001811         ElseIf workDeclType = 'C';                                                              X02                  001811
 001812            inDeclaration = *On;                                                                  02                  001812
 001813                                                                                                                      001813
 001814            Clear DCLS;                                                                           02                  001814
 001815            If savedName <> *Blanks;                                                             B03                  001815
 001816               DCLS.decl = 'Dcl-C ';                                                              03                  001816
 001817               %subst(DCLS:7) = %xlate(lo:up:savedName);                                          03                  001817
 001818            EndIf;                                                                               E03                  001818
 001819                                                                                                                      001819
 001820            // Keywords.                                                                                              001820
 001821            If workDeclKeywords <> *Blanks;                                                      B03                  001821
 001822               If DCLS.definition = *Blanks;                                                     B04                  001822
 001823                  DCLS.definition = %trim(workDeclKeywords);                                      04                  001823
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     47
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001824               Else;                                                                             X04                  001824
 001825                  DCLS.definition = %trimr(DCLS.definition) + ' '                                 04                  001825
 001826                                  + %trim(workDeclKeywords);                                      04                  001826
 001827               EndIf;                                                                            E04                  001827
 001828            EndIf;                                                                               E03                  001828
 001829                                                                                                                      001829
 001830            // Comment.                                                                                               001830
 001831            If comment <> *Blanks;                                                               B03                  001831
 001832               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001832
 001833                  DCLS.comment = '   ' + comment;                                                 04                  001833
 001834               Else;                                                                             X04                  001834
 001835                  DCLS.comment = '// ' + comment;                                                 04                  001835
 001836               EndIf;                                                                            E04                  001836
 001837            EndIf;                                                                               E03                  001837
 001838                                                                                                                      001838
 001839            If not inSpan;                                                                       B03                  001839
 001840               DCLS.definition = %trimr(DCLS.definition) + ';';                                   03                  001840
 001841               inDeclaration = *Off;                                                              03                  001841
 001842            Else;                                                                                X03                  001842
 001843               inSpan = *Off;                                                                     03                  001843
 001844            EndIf;                                                                               E03                  001844
 001845                                                                                                                      001845
 001846            // Continuation of constant must start at left margin.                                                    001846
 001847            If DCLS.decl = *Blanks;                                                              B03                  001847
 001848               DCLS = DCLS.definition;                                                            03                  001848
 001849            EndIf;                                                                               E03                  001849
 001850                                                                                                                      001850
 001851            // Converted line...                                                                                      001851
 001852            sourceLine = DCLS;                                                                    02                  001852
 001853            If not inSpan;                                                                       B03                  001853
 001854               savedName = *Blanks;                                                               03                  001854
 001855            EndIf;                                                                               E03                  001855
 001856                                                                                                                      001856
 001857            //-------------------------------------------------------------------------                               001857
 001858            // Prototype/Interface/Datastructure Definition.                                                          001858
 001859            //-------------------------------------------------------------------------                               001859
 001860         ElseIf workDeclType = 'PR'                                                              X02                  001860
 001861             or inPrototype                                                                      X02                  001861
 001862             or workDeclType = 'PI'                                                              X02                  001862
 001863             or inInterface                                                                      X02                  001863
 001864             or workDeclType = 'DS'                                                              X02                  001864
 001865             or inDatastructure;                                                                 X02                  001865
 001866            inDeclaration = *On;                                                                  02                  001866
 001867            Clear DCLPR;                                                                          02                  001867
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     48
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001868                                                                                                                      001868
 001869            // Determine where to end the structure.                                                                  001869
 001870            If not inPrototype                                                                   B03                  001870
 001871            and not inInterface                                                                  B03                  001871
 001872            and not inDatastructure;                                                             B03                  001872
 001873               Exsr subUserGetEndLine;                                                            03                  001873
 001874               If workDeclType = 'PR';                                                           B04                  001874
 001875                  inPrototype = *On;                                                              04                  001875
 001876               ElseIf workDeclType = 'PI';                                                       X04                  001876
 001877                  inInterface = *On;                                                              04                  001877
 001878               ElseIf workDeclType = 'DS';                                                       X04                  001878
 001879                  inDatastructure = *On;                                                          04                  001879
 001880                  endDS = *On;                                                                    04                  001880
 001881               EndIf;                                                                            E04                  001881
 001882               DCLPR.decl = 'Dcl-' + workDeclType;                                                03                  001882
 001883               If savedName = *Blanks;                                                           B04                  001883
 001884                  savedName = '*N';                                                               04                  001884
 001885               EndIf;                                                                            E04                  001885
 001886               %subst(DCLPR:8) = savedName;                                                       03                  001886
 001887               //DCLPR.procName = savedName;                                                                          001887
 001888               endDeclType = workDeclType;                                                        03                  001888
 001889               workDeclName = savedName;                                                          03                  001889
 001890               If %scan('...':sourceLine) > 0;  // Long name!                                    B04                  001890
 001891                  workDeclAttr = *Blanks;                                                         04                  001891
 001892               EndIf;                                                                            E04                  001892
 001893            Else;                                                                                X03                  001893
 001894               If inPrototype                                                                    B04                  001894
 001895               and savedName = *Blanks                                                           B04                  001895
 001896               and declType = *Blanks                                                            B04                  001896
 001897               and not inExtProc                                                                 B04                  001897
 001898               and not inSpan;                                                                   B04                  001898
 001899                  savedName = '*N';                                                               04                  001899
 001900               EndIf;                                                                            E04                  001900
 001901                                                                                                                      001901
 001902               If savedName <> '**';                                                             B04                  001902
 001903                  DCLPR.fieldName = savedName;                                                    04                  001903
 001904               EndIf;                                                                            E04                  001904
 001905            EndIf;                                                                               E03                  001905
 001906                                                                                                                      001906
 001907            // Type.                                                                                                  001907
 001908            If workDeclAttr = *Blanks                                                            B03                  001908
 001909            and DCLPR.type = *Blanks;                                                            B03                  001909
 001910               If declLen = *Blanks;                                                             B04                  001910
 001911                  // No definition (probably in keywords - e.g. LIKE()).                                              001911
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     49
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001912               ElseIf declScale = *Blanks;                                                       X04                  001912
 001913                  workDeclAttr = 'A';                                                             04                  001913
 001914               Else;                                                                             X04                  001914
 001915                  If inDatastructure;                                                            B05                  001915
 001916                     workDeclAttr = 'S';                                                          05                  001916
 001917                  Else;                                                                          X05                  001917
 001918                     workDeclAttr = 'P';                                                          05                  001918
 001919                  EndIf;                                                                         E05                  001919
 001920               EndIf;                                                                            E04                  001920
 001921            EndIf;                                                                               E03                  001921
 001922                                                                                                                      001922
 001923            If workDeclAttr = *Blanks;                                                           B03                  001923
 001924               // No definition (probably in keywords - e.g. LIKE()).                                                 001924
 001925            ElseIf workDeclAttr = 'A';                                                           X03                  001925
 001926               If DCLPR.decl = 'Dcl-DS';                                                         B04                  001926
 001927                  If declLen <> *Blanks;                                                         B05                  001927
 001928                     DCLPR.type = '      Len';                                                    05                  001928
 001929                  EndIf;                                                                         E05                  001929
 001930               Else;                                                                             X04                  001930
 001931                  x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                            04                  001931
 001932                  If x > 0;                                                                      B05                  001932
 001933                     DCLPR.type = '  VarChar';                                                    05                  001933
 001934                     If x = 1;                                                                   B06                  001934
 001935                        workDeclKeywords = %subst(workDeclKeywords:x+7);                          06                  001935
 001936                     Else;                                                                       X06                  001936
 001937                        workDeclKeywords = %subst(workDeclKeywords:1:x-1)                         06                  001937
 001938                                     + %subst(workDeclKeywords:x+7);                              06                  001938
 001939                     EndIf;                                                                      E06                  001939
 001940                  Else;                                                                          X05                  001940
 001941                     DCLPR.type = '     Char';                                                    05                  001941
 001942                  EndIf;                                                                         E05                  001942
 001943               EndIf;                                                                            E04                  001943
 001944            ElseIf workDeclAttr = 'P';                                                           X03                  001944
 001945               DCLPR.type = '   Packed';                                                          03                  001945
 001946            ElseIf workDeclAttr = 'D';                                                           X03                  001946
 001947               DCLPR.type = '     Date';                                                          03                  001947
 001948               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001948
 001949               If x > 0;                                                                         B04                  001949
 001950                  x = %scan('(':workDeclKeywords:x);                                              04                  001950
 001951                  y = %scan(')':workDeclKeywords:x);                                              04                  001951
 001952                  DCLPR.definition = '('                                                          04                  001952
 001953                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001953
 001954                            + ')';                                                                04                  001954
 001955                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001955
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     50
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001956               EndIf;                                                                            E04                  001956
 001957            ElseIf workDeclAttr = 'T';                                                           X03                  001957
 001958               DCLPR.type = '     Time';                                                          03                  001958
 001959               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001959
 001960               If x > 0;                                                                         B04                  001960
 001961                  x = %scan('(':workDeclKeywords:x);                                              04                  001961
 001962                  y = %scan(')':workDeclKeywords:x);                                              04                  001962
 001963                  DCLPR.definition = '('                                                          04                  001963
 001964                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001964
 001965                            + ')';                                                                04                  001965
 001966                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001966
 001967               EndIf;                                                                            E04                  001967
 001968            ElseIf workDeclAttr = 'Z';                                                           X03                  001968
 001969               DCLPR.type = 'TimeStamp';                                                          03                  001969
 001970            ElseIf workDeclAttr = 'I';                                                           X03                  001970
 001971               DCLPR.type = '      Int';                                                          03                  001971
 001972            ElseIf workDeclAttr = 'S';                                                           X03                  001972
 001973               DCLPR.type = '    Zoned';                                                          03                  001973
 001974            ElseIf workDeclAttr = 'N';                                                           X03                  001974
 001975               DCLPR.type = '      Ind';                                                          03                  001975
 001976            ElseIf workDeclAttr = '*';                                                           X03                  001976
 001977               DCLPR.type = '  Pointer';                                                          03                  001977
 001978            ElseIf workDeclAttr = 'B';                                                           X03                  001978
 001979               DCLPR.type = '   BinDec';                                                          03                  001979
 001980            ElseIf workDeclAttr = 'G';                                                           X03                  001980
 001981               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001981
 001982               If x > 0;                                                                         B04                  001982
 001983                  DCLPR.type = ' VarGraph';                                                       04                  001983
 001984                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001984
 001985               Else;                                                                             X04                  001985
 001986                  DCLPR.type = '    Graph';                                                       04                  001986
 001987               EndIf;                                                                            E04                  001987
 001988            Else;                                                                                X03                  001988
 001989               inDeclaration = *Off;                                                              03                  001989
 001990               convert = *Off;                                                                    03                  001990
 001991               LeaveSr;                                                                           03                  001991
 001992            EndIf;                                                                               E03                  001992
 001993                                                                                                                      001993
 001994            // Attributes.                                                                                            001994
 001995            If workDeclAttr <> '*'                                                               B03                  001995
 001996            and workDeclAttr <> 'N'                                                              B03                  001996
 001997            and workDeclAttr <> 'D'                                                              B03                  001997
 001998            and workDeclAttr <> 'T'                                                              B03                  001998
 001999            and workDeclAttr <> 'Z'                                                              B03                  001999
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     51
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002000            and workDeclAttr <> *Blank                                                           B03                  002000
 002001            and DCLPR.type <> *Blanks;                                                           B03                  002001
 002002               DCLPR.definition = '(';                                                            03                  002002
 002003               If inDatastructure and declFrom <> *Blanks;                                       B04                  002003
 002004                  workLength = %dec(%trim(declLen):7:0)                                           04                  002004
 002005                             - %dec(%trim(declFrom):7:0) + 1;                                     04                  002005
 002006                  If workDeclAttr = 'B';                                                         B05                  002006
 002007                     workLength = workLength * 2;                                                 05                  002007
 002008                  ElseIf workDeclAttr = 'P';                                                     X05                  002008
 002009                     workLength = (workLength * 2) - 1;                                           05                  002009
 002010                  EndIf;                                                                         E05                  002010
 002011                  AdjustArrayLength(workLength);                                                  04                  002011
 002012                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002012
 002013                                   + %char(workLength);                                           04                  002013
 002014               Else;                                                                             X04                  002014
 002015                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002015
 002016                                   + %trim(declLen);                                              04                  002016
 002017               EndIf;                                                                            E04                  002017
 002018                                                                                                                      002018
 002019               If declScale <> *Blanks;                                                          B04                  002019
 002020                  DCLPR.definition = %trimr(DCLPR.definition)                                     04                  002020
 002021                                  + ':' + %trim(declScale);                                       04                  002021
 002022               EndIf;                                                                            E04                  002022
 002023               DCLPR.definition = %trimr(DCLPR.definition) + ')';                                 03                  002023
 002024            EndIf;                                                                               E03                  002024
 002025                                                                                                                      002025
 002026            // From specified?                                                                                        002026
 002027            If inDatastructure;                                                                  B03                  002027
 002028               If declFrom <> *Blanks                                                            B04                  002028
 002029               and %scan('...':declOptions) = 0;                                                 B04                  002029
 002030                  If %subst(declFrom:1:1) = '*';                                                 B05                  002030
 002031                     workDeclKeywords = %trim(declFrom) + ' ';                                    05                  002031
 002032                  Else;                                                                          X05                  002032
 002033                  workDeclKeywords = 'Pos(' + %trim(declFrom) + ') '                              05                  002033
 002034                               + workDeclKeywords;                                                05                  002034
 002035                  EndIf;                                                                         E05                  002035
 002036               Else;                                                                             X04                  002036
 002037                  // Overlay specified using the base datastructure name?                                             002037
 002038                  // This is not permitted in free-form, so convert it to 'POS'.                                      002038
 002039                  x = %scan('OVERLAY(':%xlate(lo:up:workDeclKeywords));                           04                  002039
 002040                  If x > 0;                                                                      B05                  002040
 002041                     i = %scan(':':workDeclKeywords:x);                                           05                  002041
 002042                     If i > 0;                                                                   B06                  002042
 002043                        If %trim(%xlate(lo:up                                                    B07                  002043
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     52
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002044                                :%subst(workDeclKeywords:x+8:i-x-8))) =                          B07                  002044
 002045                           %xlate(lo:up:workDeclName);                                           B07                  002045
 002046                           j = %scan(')':workDeclKeywords:i);                                     07                  002046
 002047                           If j > 0;                                                             B08                  002047
 002048                              If x = 1;                                                          B09                  002048
 002049                                 workDeclKeywords                                                 09                  002049
 002050                                  = 'Pos('                                                        09                  002050
 002051                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002051
 002052                                 + %subst(workDeclKeywords:j);                                    09                  002052
 002053                              Else;                                                              X09                  002053
 002054                                 workDeclKeywords                                                 09                  002054
 002055                                   = %trim(%subst(workDeclKeywords:1:x-1))                        09                  002055
 002056                                   + ' Pos('                                                      09                  002056
 002057                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002057
 002058                                 + %subst(workDeclKeywords:j);                                    09                  002058
 002059                              EndIf;                                                             E09                  002059
 002060                           EndIf;                                                                E08                  002060
 002061                        EndIf;                                                                   E07                  002061
 002062                     EndIf;                                                                      E06                  002062
 002063                  EndIf;                                                                         E05                  002063
 002064               EndIf;                                                                            E04                  002064
 002065               // Require End-DS?                                                                                     002065
 002066               x = %scan('LIKEDS(':%xlate(lo:up:workDeclKeywords));                               03                  002066
 002067               If x = 0;                                                                         B04                  002067
 002068                  x = %scan('LIKEREC(':%xlate(lo:up:workDeclKeywords));                           04                  002068
 002069               EndIf;                                                                            E04                  002069
 002070               If x > 0;                                                                         B04                  002070
 002071                  // Nope.                                                                                            002071
 002072                  endDS = *Off;                                                                   04                  002072
 002073               EndIf;                                                                            E04                  002073
 002074                                                                                                                      002074
 002075               // Datastructure type?                                                                                 002075
 002076               If declPrefix = 'S';       // Program Status                                      B04                  002076
 002077                  workDeclKeywords = 'PSDS ' + workDeclKeywords;                                  04                  002077
 002078                  If savedName = DCLPR.procName;                                                 B05                  002078
 002079                     %subst(savedName:16:1) = *Blank;                                             05                  002079
 002080                  EndIf;                                                                         E05                  002080
 002081                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002081
 002082                                                                                                                      002082
 002083               ElseIf declPrefix = 'U';   // Dataarea                                            X04                  002083
 002084                  // If not already defined as a data area, do it now.                                                002084
 002085                  If %scan('DTAARA':%xlate(lo:up:workDeclKeywords)) = 0;                         B05                  002085
 002086                     If declName = *Blanks;                                                      B06                  002086
 002087                        workDeclKeywords = 'DTAARA(*AUTO) '                                       06                  002087
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     53
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002088                                                     + workDeclKeywords;                          06                  002088
 002089                     Else;                                                                       X06                  002089
 002090                        workDeclKeywords = 'DTAARA ' + workDeclKeywords;                          06                  002090
 002091                     EndIf;                                                                      E06                  002091
 002092                  EndIf;                                                                         E05                  002092
 002093                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002093
 002094               EndIf;                                                                            E04                  002094
 002095            EndIf;                                                                               E03                  002095
 002096                                                                                                                      002096
 002097            // Keywords.                                                                                              002097
 002098            If workDeclKeywords <> *Blanks;                                                      B03                  002098
 002099               // ExtProc name has extended to a second line.                                                         002099
 002100               If inExtProc;                                                                     B04                  002100
 002101                  // Continuation of name must start at left margin.                                                  002101
 002102                  DCLPR = workDeclKeywords;                                                       04                  002102
 002103                  workDeclKeywords = *Blanks;                                                     04                  002103
 002104                  inExtProc = *Off;                                                               04                  002104
 002105               EndIf;                                                                            E04                  002105
 002106                                                                                                                      002106
 002107               // Expand EXTNAME?                                                                                     002107
 002108               x = %scan('EXTNAME(':%xlate(lo:up:workDeclKeywords));                              03                  002108
 002109               If x > 0;                                                                         B04                  002109
 002110                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002110
 002111                  If i > 0;                                                                      B05                  002111
 002112                     If %scan('''':%subst(workDeclKeywords:x+8:i-x-8)) = 0;                      B06                  002112
 002113                        workDeclKeywords = %subst(workDeclKeywords:1:x+7)                         06                  002113
 002114                           + ''''                                                                 06                  002114
 002115                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+8:i-x-8)))                      06                  002115
 002116                           + ''''                                                                 06                  002116
 002117                           + %subst(workDeclKeywords:i);                                          06                  002117
 002118                     EndIf;                                                                      E06                  002118
 002119                  EndIf;                                                                         E05                  002119
 002120               EndIf;                                                                            E04                  002120
 002121                                                                                                                      002121
 002122               // Expand DTAARA?                                                                                      002122
 002123               x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                               03                  002123
 002124               If x > 0;                                                                         B04                  002124
 002125                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002125
 002126                  If i > 0;                                                                      B05                  002126
 002127                     If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                      B06                  002127
 002128                        workDeclKeywords = %subst(workDeclKeywords:1:x+6)                         06                  002128
 002129                           + ''''                                                                 06                  002129
 002130                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      06                  002130
 002131                           + ''''                                                                 06                  002131
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     54
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002132                           + %subst(workDeclKeywords:i);                                          06                  002132
 002133                     EndIf;                                                                      E06                  002133
 002134                  EndIf;                                                                         E05                  002134
 002135               EndIf;                                                                            E04                  002135
 002136                                                                                                                      002136
 002137               // EXTPROC?                                                                                            002137
 002138               x = %scan('EXTPROC(':%xlate(lo:up:workDeclKeywords));                              03                  002138
 002139               If x > 0;                                                                         B04                  002139
 002140                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002140
 002141                  If i = 0;                                                                      B05                  002141
 002142                     // Name extends onto next line.                                                                  002142
 002143                     inExtProc = *On;                                                             05                  002143
 002144                  EndIf;                                                                         E05                  002144
 002145               EndIf;                                                                            E04                  002145
 002146            EndIf;                                                                               E03                  002146
 002147                                                                                                                      002147
 002148            // Terminate the line?                                                                                    002148
 002149            If not inSpan;                                                                       B03                  002149
 002150               If workDeclKeywords = *Blanks and DCLPR.type = *Blanks;                           B04                  002150
 002151                  DCLPR.procName = %trimr(DCLPR.procName) + ';';                                  04                  002151
 002152               ElseIf workDeclKeywords = *Blanks;                                                X04                  002152
 002153                  DCLPR.definition = %trimr(DCLPR.definition) + ';';                              04                  002153
 002154               Else;                                                                             X04                  002154
 002155                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  002155
 002156               EndIf;                                                                            E04                  002156
 002157               inDeclaration = *Off;                                                              03                  002157
 002158               savedName = *Blanks;                                                               03                  002158
 002159            Else;                                                                                X03                  002159
 002160               inSpan = *Off;                                                                     03                  002160
 002161            EndIf;                                                                               E03                  002161
 002162                                                                                                                      002162
 002163            // Have we encroached on the comments?                                                                    002163
 002164            x = %len(%trimr(DCLPR.definition)) + %len(workDeclKeywords);                          02                  002164
 002165            If x >= 37;                                                                          B03                  002165
 002166               x = x - %len(%trimr(DCLPR.definition));                                            03                  002166
 002167               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  002167
 002168               indentOffset = 37;                                                                 03                  002168
 002169            EndIf;                                                                               E03                  002169
 002170                                                                                                                      002170
 002171            If DCLPR.definition = *Blanks and DCLPR.type = *Blanks;                              B03                  002171
 002172               DCLPR.definition = %trim(workDeclKeywords);                                        03                  002172
 002173            Else;                                                                                X03                  002173
 002174               DCLPR.definition = %trimr(DCLPR.definition) + ' '                                  03                  002174
 002175                               + %trim(workDeclKeywords);                                         03                  002175
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     55
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002176            EndIf;                                                                               E03                  002176
 002177                                                                                                                      002177
 002178            // Comment.                                                                                               002178
 002179            If comment <> *Blanks;                                                               B03                  002179
 002180               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  002180
 002181                  DCLPR.comment = '   ' + comment;                                                04                  002181
 002182               Else;                                                                             X04                  002182
 002183                  DCLPR.comment = '// ' + comment;                                                04                  002183
 002184               EndIf;                                                                            E04                  002184
 002185            EndIf;                                                                               E03                  002185
 002186                                                                                                                      002186
 002187            // Converted line...                                                                                      002187
 002188            sourceLine = DCLPR;                                                                   02                  002188
 002189            If not inSpan and savedName <> *Blanks;                                              B03                  002189
 002190               savedName = '**';                                                                  03                  002190
 002191            EndIf;                                                                               E03                  002191
 002192                                                                                                                      002192
 002193            //-------------------------------------------------------------------------                               002193
 002194            // Unsupported.                                                                                           002194
 002195            //-------------------------------------------------------------------------                               002195
 002196         Else;                                                                                   X02                  002196
 002197            inDeclaration = *Off;                                                                 02                  002197
 002198            convert = *Off;                                                                       02                  002198
 002199            LeaveSr;                                                                              02                  002199
 002200         EndIf;                                                                                  E02                  002200
 002201                                                                                                                      002201
 002202         //-------------------------------------------------------------------------                                  002202
 002203         // Second+ line of declaration.                                                                              002203
 002204         //-------------------------------------------------------------------------                                  002204
 002205      Else;                                                                                      X01                  002205
 002206         Clear DCLS;                                                                              01                  002206
 002207         DCLS.definition = %trim(workDeclKeywords);                                               01                  002207
 002208         If not inSpan;                                                                          B02                  002208
 002209            DCLS.definition = %trim(DCLS.definition) + ';';                                       02                  002209
 002210         EndIf;                                                                                  E02                  002210
 002211         sourceLine = DCLS;                                                                       01                  002211
 002212         inSpan = *Off;                                                                           01                  002212
 002213      EndIf;                                                                                     E01                  002213
 002214                                                                                                                      002214
 002215      convert = *On;                                                                                                  002215
 002216                                                                                                                      002216
 002217   EndSr;                                                                                                             002217
 002218   //-------------------------------------------------------------------------------------------                      002218
 002219                                                                                                                      002219
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     56
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002221   //-------------------------------------------------------------------------------------------                      002221
 002222   // Convert file spec to free-format.                                                                               002222
 002223   //-------------------------------------------------------------------------------------------                      002223
 002224   BegSr subUserConvertF_Spec;                                                                                        002224
 002225                                                                                                                      002225
 002226      // Keep blank lines.                                                                                            002226
 002227      If codeLine = *Blanks;                                                                     B01                  002227
 002228         sourceLine = *Blanks;                                                                    01                  002228
 002229         convert = *On;                                                                           01                  002229
 002230         LeaveSr;                                                                                 01                  002230
 002231      EndIf;                                                                                     E01                  002231
 002232                                                                                                                      002232
 002233      sourceLine = fullLine;                                                                                          002233
 002234                                                                                                                      002234
 002235      workFileUsage  = %xlate(lo:up:fileUsage);                                                                       002235
 002236      workFileDesig  = %xlate(lo:up:fileDesig);                                                                       002236
 002237      workFileAdd    = %xlate(lo:up:fileAdd);                                                                         002237
 002238      workFileDevice = %xlate(lo:up:fileDevice);                                                                      002238
 002239      workFileKeyed  = %xlate(lo:up:fileKeyed);                                                                       002239
 002240                                                                                                                      002240
 002241      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002241
 002242                                                                                                                      002242
 002243      If not inDeclaration;                                                                      B01                  002243
 002244                                                                                                                      002244
 002245         // Validate whether this can be converted.                                                                   002245
 002246         If workFileUsage = 'I'                                                                  B02                  002246
 002247         and (workFileDesig = 'P'                                                                B02                  002247
 002248         or workFileDesig = 'S'                                                                  B02                  002248
 002249         or workFileUsage = 'T')                                                                 B02                  002249
 002250                                                                                                 B02                  002250
 002251         or workFileUsage = 'O'                                                                  B02                  002251
 002252         and workFileAdd = 'A'                                                                   B02                  002252
 002253                                                                                                 B02                  002253
 002254         or workFileUsage = 'U'                                                                  B02                  002254
 002255         and (workFileDesig = 'P'                                                                B02                  002255
 002256         or workFileDesig = 'S')                                                                 B02                  002256
 002257                                                                                                 B02                  002257
 002258         or workFileUsage = 'C'                                                                  B02                  002258
 002259         and workFileDesig = 'T';                                                                B02                  002259
 002260                                                                                                                      002260
 002261            // Not supported in free-form.                                                                            002261
 002262            inDeclaration = *Off;                                                                 02                  002262
 002263            convert = *Off;                                                                       02                  002263
 002264            nonConvRsn = 'File usage not supported in free-form';                                 02                  002264
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     57
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002265            LeaveSr;                                                                              02                  002265
 002266         EndIf;                                                                                  E02                  002266
 002267                                                                                                                      002267
 002268         savedName = %trim(fileName);                                                             01                  002268
 002269                                                                                                                      002269
 002270         If %xlate(lo:up:fileExternal) = 'E';       // Externally-described file.                B02                  002270
 002271            inDeclaration = *On;                                                                  02                  002271
 002272                                                                                                                      002272
 002273            Clear DCLF;                                                                           02                  002273
 002274            DCLF.decl = 'Dcl-F ';                                                                 02                  002274
 002275            %subst(DCLF:7) = %xlate(lo:up:savedName);                                             02                  002275
 002276                                                                                                                      002276
 002277            // Set device type.                                                                                       002277
 002278            If workFileDevice <> 'DISK';                                                         B03                  002278
 002279               DCLF.device = workFileDevice;                                                      03                  002279
 002280            EndIf;                                                                               E03                  002280
 002281                                                                                                                      002281
 002282            // Set usage.                                                                                             002282
 002283            If workFileUsage = 'I';                                                              B03                  002283
 002284               If workFileAdd = ' ';                                                             B04                  002284
 002285                  If workFileDevice <> 'DISK'                                                    B05                  002285
 002286                  and workFileDevice <> 'SEQ'                                                    B05                  002286
 002287                  and workFileDevice <> 'SPECIAL';                                               B05                  002287
 002288                     DCLF.definition = '*INPUT';                                                  05                  002288
 002289                  EndIf;                                                                         E05                  002289
 002290               Else;                                                                             X04                  002290
 002291                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002291
 002292               EndIf;                                                                            E04                  002292
 002293            ElseIf workFileUsage = 'U';                                                          X03                  002293
 002294               If workFileAdd = ' ';                                                             B04                  002294
 002295                  DCLF.definition = '*UPDATE:*DELETE';                                            04                  002295
 002296               Else;                                                                             X04                  002296
 002297                  DCLF.definition = '*UPDATE:*DELETE:*OUTPUT';                                    04                  002297
 002298               EndIf;                                                                            E04                  002298
 002299            ElseIf workFileUsage = 'O';                                                          X03                  002299
 002300               If workFileDevice <> 'PRINTER';                                                   B04                  002300
 002301                  DCLF.definition = '*OUTPUT';                                                    04                  002301
 002302               EndIf;                                                                            E04                  002302
 002303            ElseIf workFileUsage = 'C';                                                          X03                  002303
 002304               If workFileDevice <> 'WORKSTN';                                                   B04                  002304
 002305                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002305
 002306               EndIf;                                                                            E04                  002306
 002307            EndIf;                                                                               E03                  002307
 002308                                                                                                                      002308
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     58
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002309            // Pad out usage.                                                                                         002309
 002310            If DCLF.definition <> *Blanks;                                                       B03                  002310
 002311               DCLF.definition = 'Usage(' + %trim(DCLF.definition) + ')';                         03                  002311
 002312            EndIf;                                                                               E03                  002312
 002313                                                                                                                      002313
 002314            // Keyed file?                                                                                            002314
 002315            If workFileKeyed = 'K';                                                              B03                  002315
 002316               DCLF.definition = %trim(%trim(DCLF.definition)                                     03                  002316
 002317                                       + ' ' + 'Keyed');                                          03                  002317
 002318            EndIf;                                                                               E03                  002318
 002319                                                                                                                      002319
 002320            If comment <> *Blanks;                                                               B03                  002320
 002321               If %subst(%trim(comment):1:2) = '//';                                             B04                  002321
 002322                  DCLF.comment = '   ' + comment;                                                 04                  002322
 002323               Else;                                                                             X04                  002323
 002324                  DCLF.comment = '// ' + comment;                                                 04                  002324
 002325               EndIf;                                                                            E04                  002325
 002326            EndIf;                                                                               E03                  002326
 002327                                                                                                                      002327
 002328            // Keywords.                                                                                              002328
 002329            If fileKeyWords <> *Blanks;                                                          B03                  002329
 002330               // Do we have room to insert the keywords here?                                                        002330
 002331               checkLength = %len(%trim(%trim(DCLF.definition)                                    03                  002331
 002332                                       + ' ' + %trim(fileKeyWords))) + 1;                         03                  002332
 002333                                                                                                                      002333
 002334               If comment <> *Blanks;                                                            B04                  002334
 002335                  checkLength += 3;                                                               04                  002335
 002336               EndIf;                                                                            E04                  002336
 002337                                                                                                                      002337
 002338               If checkLength > %len(DCLF.definition);                                           B04                  002338
 002339                  // Not enoungh room for the keywords, so output the current line.                                   002339
 002340                  savedSRCDTA = SRCDTA;                                                           04                  002340
 002341                  lineType = *Blank;                                                              04                  002341
 002342                  directive = *Blanks;                                                            04                  002342
 002343                  codeLine = DCLF;                                                                04                  002343
 002344                  Exsr subUserWriteLine;                                                          04                  002344
 002345                  SRCDTA = savedSRCDTA;                                                           04                  002345
 002346                  // ...and move the keywords to their own line.                                                      002346
 002347                  Clear DCLF;                                                                     04                  002347
 002348                  DCLF.definition = fileKeywords;                                                 04                  002348
 002349                  savedComment = *Blanks;                                                         04                  002349
 002350               Else;                                                                             X04                  002350
 002351                  DCLF.definition = %trim(%trim(DCLF.definition)                                  04                  002351
 002352                                          + ' ' + %trim(fileKeyWords));                           04                  002352
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     59
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002353               EndIf;                                                                            E04                  002353
 002354            EndIf;                                                                               E03                  002354
 002355                                                                                                                      002355
 002356            If not inSpan;                                                                       B03                  002356
 002357               DCLF.definition = %trimr(DCLF.definition) + ';';                                   03                  002357
 002358               inDeclaration = *Off;                                                              03                  002358
 002359            Else;                                                                                X03                  002359
 002360               inSpan = *Off;                                                                     03                  002360
 002361            EndIf;                                                                               E03                  002361
 002362                                                                                                                      002362
 002363            // Converted line...                                                                                      002363
 002364            sourceLine = DCLF;                                                                    02                  002364
 002365                                                                                                                      002365
 002366         Else;                                                                                   X02                  002366
 002367            inDeclaration = *Off;                                                                 02                  002367
 002368            convert = *Off;                                                                       02                  002368
 002369            nonConvRsn = 'File not externally-described';                                         02                  002369
 002370            LeaveSr;                                                                              02                  002370
 002371         EndIf;                                                                                  E02                  002371
 002372                                                                                                                      002372
 002373      Else;                   // Second+ line of declaration                                     X01                  002373
 002374         Clear DCLF;                                                                              01                  002374
 002375         DCLF.definition = %trim(fileKeyWords);                                                   01                  002375
 002376         If not inSpan;                                                                          B02                  002376
 002377            DCLF.definition = %trim(DCLF.definition) + ';';                                       02                  002377
 002378         EndIf;                                                                                  E02                  002378
 002379         sourceLine = DCLF;                                                                       01                  002379
 002380         inSpan = *Off;                                                                           01                  002380
 002381      EndIf;                                                                                     E01                  002381
 002382                                                                                                                      002382
 002383      convert = *On;                                                                                                  002383
 002384                                                                                                                      002384
 002385   EndSr;                                                                                                             002385
 002386   //-------------------------------------------------------------------------------------------                      002386
 002387                                                                                                                      002387
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     60
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002389   //-------------------------------------------------------------------------------------------                      002389
 002390   // Convert Header spec to free-format.                                                                             002390
 002391   //-------------------------------------------------------------------------------------------                      002391
 002392   BegSr subUserConvertH_Spec;                                                                                        002392
 002393                                                                                                                      002393
 002394      // Keep blank lines.                                                                                            002394
 002395      If codeLine = *Blanks;                                                                     B01                  002395
 002396         sourceLine = *Blanks;                                                                    01                  002396
 002397         convert = *On;                                                                           01                  002397
 002398         LeaveSr;                                                                                 01                  002398
 002399      EndIf;                                                                                     E01                  002399
 002400                                                                                                                      002400
 002401      sourceLine = codeLine;                                                                                          002401
 002402                                                                                                                      002402
 002403      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002403
 002404                                                                                                                      002404
 002405      If not inDeclaration;                                                                      B01                  002405
 002406         inDeclaration = *On;                                                                     01                  002406
 002407                                                                                                                      002407
 002408         Clear DCLH;                                                                              01                  002408
 002409         DCLH.decl = 'Ctl-Opt ';                                                                  01                  002409
 002410         DCLH.options = %trim(declOptions);                                                       01                  002410
 002411                                                                                                                      002411
 002412         If comment <> *Blanks;                                                                  B02                  002412
 002413            If %subst(%trim(comment):1:2) = '//';                                                B03                  002413
 002414               DCLH.comment = '   ' + comment;                                                    03                  002414
 002415            Else;                                                                                X03                  002415
 002416               DCLH.comment = '// ' + comment;                                                    03                  002416
 002417            EndIf;                                                                               E03                  002417
 002418         EndIf;                                                                                  E02                  002418
 002419                                                                                                                      002419
 002420         If not inSpan;                                                                          B02                  002420
 002421            DCLH.options = %trimr(DCLH.options) + ';';                                            02                  002421
 002422            inDeclaration = *Off;                                                                 02                  002422
 002423         Else;                                                                                   X02                  002423
 002424            inSpan = *Off;                                                                        02                  002424
 002425         EndIf;                                                                                  E02                  002425
 002426                                                                                                                      002426
 002427         // Converted line...                                                                                         002427
 002428         sourceLine = DCLH;                                                                       01                  002428
 002429                                                                                                                      002429
 002430      Else;                   // Second+ line of declaration                                     X01                  002430
 002431         Clear DCLH;                                                                              01                  002431
 002432         DCLH.options = %trim(declOptions);                                                       01                  002432
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     61
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002433         If not inSpan;                                                                          B02                  002433
 002434            DCLH.options = %trim(DCLH.options) + ';';                                             02                  002434
 002435         EndIf;                                                                                  E02                  002435
 002436         sourceLine = DCLH;                                                                       01                  002436
 002437         inSpan = *Off;                                                                           01                  002437
 002438      EndIf;                                                                                     E01                  002438
 002439                                                                                                                      002439
 002440      convert = *On;                                                                                                  002440
 002441                                                                                                                      002441
 002442   EndSr;                                                                                                             002442
 002443   //-------------------------------------------------------------------------------------------                      002443
 002444                                                                                                                      002444
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     62
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002446   //-------------------------------------------------------------------------------------------                      002446
 002447   // Convert procedure declaration to free-format?                                                                   002447
 002448   //-------------------------------------------------------------------------------------------                      002448
 002449   BegSr subUserConvertP_Spec;                                                                                        002449
 002450                                                                                                                      002450
 002451      // Keep blank lines.                                                                                            002451
 002452      If codeLine = *Blanks;                                                                     B01                  002452
 002453         sourceLine = *Blanks;                                                                    01                  002453
 002454         convert = *On;                                                                           01                  002454
 002455         LeaveSr;                                                                                 01                  002455
 002456      EndIf;                                                                                     E01                  002456
 002457                                                                                                                      002457
 002458      sourceLine = fullLine;                                                                                          002458
 002459                                                                                                                      002459
 002460      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002460
 002461                                                                                                                      002461
 002462      If not inDeclaration;   // First line of procedure start/end.                              B01                  002462
 002463         If not inDeclaration;                                                                   B02                  002463
 002464            //Exsr subUserGetDeclarationType;                                                                         002464
 002465            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  002465
 002466         EndIf;                                                                                  E02                  002466
 002467                                                                                                                      002467
 002468         If workDeclType = 'B'       // Begin.                                                   B02                  002468
 002469         or workDeclType = 'E'       // End.                                                     B02                  002469
 002470         or declName <> *Blanks;                                                                 B02                  002470
 002471            inDeclaration = *On;                                                                  02                  002471
 002472                                                                                                                      002472
 002473            Clear DCLP;                                                                           02                  002473
 002474            //            If savedName <> *Blanks;                                                                    002474
 002475            If workDeclType = 'B';                                                               B03                  002475
 002476               DCLP.decl = 'Dcl-Proc ';                                                           03                  002476
 002477            Else;                                                                                X03                  002477
 002478               DCLP.decl = 'End-Proc ';                                                           03                  002478
 002479            EndIf;                                                                               E03                  002479
 002480            DCLP.definition = savedName;                                                          02                  002480
 002481            //            EndIf;                                                                                      002481
 002482                                                                                                                      002482
 002483            If procKeyWords <> *Blanks;                                                          B03                  002483
 002484               DCLP.definition = %trimr(DCLP.definition)                                          03                  002484
 002485                               + ' ' + %trim(procKeyWords);                                       03                  002485
 002486            EndIf;                                                                               E03                  002486
 002487                                                                                                                      002487
 002488            If comment <> *Blanks;                                                               B03                  002488
 002489               If %subst(%trim(comment):1:2) = '//';                                             B04                  002489
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     63
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002490                  DCLP.comment = '   ' + comment;                                                 04                  002490
 002491               Else;                                                                             X04                  002491
 002492                  DCLP.comment = '// ' + comment;                                                 04                  002492
 002493               EndIf;                                                                            E04                  002493
 002494            EndIf;                                                                               E03                  002494
 002495                                                                                                                      002495
 002496            If not inSpan;                                                                       B03                  002496
 002497               DCLP.definition = %trimr(DCLP.definition) + ';';                                   03                  002497
 002498               inDeclaration = *Off;                                                              03                  002498
 002499            Else;                                                                                X03                  002499
 002500               inSpan = *Off;                                                                     03                  002500
 002501            EndIf;                                                                               E03                  002501
 002502                                                                                                                      002502
 002503            // Converted line...                                                                                      002503
 002504            sourceLine = DCLP;                                                                    02                  002504
 002505            savedName = *Blanks;                                                                  02                  002505
 002506                                                                                                                      002506
 002507         Else;                                                                                   X02                  002507
 002508            inDeclaration = *Off;                                                                 02                  002508
 002509            convert = *Off;                                                                       02                  002509
 002510            LeaveSr;                                                                              02                  002510
 002511         EndIf;                                                                                  E02                  002511
 002512                                                                                                                      002512
 002513      Else;                   // Second+ line of procedure start/end.                            X01                  002513
 002514         Clear DCLP;                                                                              01                  002514
 002515         DCLP.definition = %trim(declKeyWords);                                                   01                  002515
 002516         If not inSpan;                                                                          B02                  002516
 002517            DCLP.definition = %trimr(DCLP.definition) + ';';                                      02                  002517
 002518         EndIf;                                                                                  E02                  002518
 002519         sourceLine = DCLP;                                                                       01                  002519
 002520         inSpan = *Off;                                                                           01                  002520
 002521      EndIf;                                                                                     E01                  002521
 002522                                                                                                                      002522
 002523      convert = *On;                                                                                                  002523
 002524                                                                                                                      002524
 002525   EndSr;                                                                                                             002525
 002526   //-------------------------------------------------------------------------------------------                      002526
 002527                                                                                                                      002527
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     64
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002529   //-------------------------------------------------------------------------------------------                      002529
 002530   // Set Resulting Indicators.                                                                                       002530
 002531   //-------------------------------------------------------------------------------------------                      002531
 002532   BegSr subUserSetIndicators;                                                                                        002532
 002533                                                                                                                      002533
 002534      //-----------------------------------------------------------------------                                       002534
 002535      // Scan found.                                                                                                  002535
 002536      If foundCheck;                                                                             B01                  002536
 002537         Clear nonPrefix;                                                                         01                  002537
 002538                                                                                                                      002538
 002539         codeLine = '*IN' + foundInd + ' = %found();';                                            01                  002539
 002540         Exsr subUserReformatLine;                                                                01                  002540
 002541                                                                                                                      002541
 002542         foundCheck = *Off;                                                                       01                  002542
 002543      EndIf;                                                                                     E01                  002543
 002544                                                                                                                      002544
 002545      //-----------------------------------------------------------------------                                       002545
 002546      // Error indicator check.                                                                                       002546
 002547      If ERRCheck;                                                                               B01                  002547
 002548         Clear nonPrefix;                                                                         01                  002548
 002549                                                                                                                      002549
 002550         codeLine = '*IN' + ERRInd + ' = %error();';                                              01                  002550
 002551         Exsr subUserReformatLine;                                                                01                  002551
 002552                                                                                                                      002552
 002553         ERRCheck = *Off;                                                                         01                  002553
 002554      EndIf;                                                                                     E01                  002554
 002555                                                                                                                      002555
 002556      //-----------------------------------------------------------------------                                       002556
 002557      // Record not found check.                                                                                      002557
 002558      If NRFCheck;                                                                               B01                  002558
 002559         Clear nonPrefix;                                                                         01                  002559
 002560                                                                                                                      002560
 002561         codeLine = '*IN' + NRFInd + ' = not %found();';                                          01                  002561
 002562         Exsr subUserReformatLine;                                                                01                  002562
 002563                                                                                                                      002563
 002564         NRFCheck = *Off;                                                                         01                  002564
 002565      EndIf;                                                                                     E01                  002565
 002566                                                                                                                      002566
 002567      //-----------------------------------------------------------------------                                       002567
 002568      // End of File check.                                                                                           002568
 002569      If EOFCheck;                                                                               B01                  002569
 002570         Clear nonPrefix;                                                                         01                  002570
 002571                                                                                                                      002571
 002572         codeLine = '*IN' + EOFInd + ' = %eof();';                                                01                  002572
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     65
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002573         Exsr subUserReformatLine;                                                                01                  002573
 002574                                                                                                                      002574
 002575         EOFCheck = *Off;                                                                         01                  002575
 002576      EndIf;                                                                                     E01                  002576
 002577                                                                                                                      002577
 002578      //-----------------------------------------------------------------------                                       002578
 002579      // Matching Key check.                                                                                          002579
 002580      If equalCheck;                                                                             B01                  002580
 002581         Clear nonPrefix;                                                                         01                  002581
 002582                                                                                                                      002582
 002583         codeLine = '*IN' + equalInd + ' = %equal();';                                            01                  002583
 002584         Exsr subUserReformatLine;                                                                01                  002584
 002585                                                                                                                      002585
 002586         equalCheck = *Off;                                                                       01                  002586
 002587      EndIf;                                                                                     E01                  002587
 002588                                                                                                                      002588
 002589      //-----------------------------------------------------------------------                                       002589
 002590      // Perform SETOFF / SETON Expansion.                                                                            002590
 002591      If setOff;                                                                                 B01                  002591
 002592         Clear nonPrefix;                                                                         01                  002592
 002593         If setOffInd1 <> *Blanks;                                                               B02                  002593
 002594            codeLine = '*IN' + setOffInd1 + ' = *Off;';                                           02                  002594
 002595            Exsr subUserReformatLine;                                                             02                  002595
 002596         EndIf;                                                                                  E02                  002596
 002597         If setOffInd2 <> *Blanks;                                                               B02                  002597
 002598            codeLine = '*IN' + setOffInd2 + ' = *Off;';                                           02                  002598
 002599            Exsr subUserReformatLine;                                                             02                  002599
 002600         EndIf;                                                                                  E02                  002600
 002601         If setOffInd3 <> *Blanks;                                                               B02                  002601
 002602            codeLine = '*IN' + setOffInd3 + ' = *Off;';                                           02                  002602
 002603            Exsr subUserReformatLine;                                                             02                  002603
 002604         EndIf;                                                                                  E02                  002604
 002605         setOff = *Off;                                                                           01                  002605
 002606      EndIf;                                                                                     E01                  002606
 002607      If setOn;                                                                                  B01                  002607
 002608         Clear nonPrefix;                                                                         01                  002608
 002609         If setOnInd1 <> *Blanks;                                                                B02                  002609
 002610            codeLine = '*IN' + setOnInd1 + ' = *On;';                                             02                  002610
 002611            Exsr subUserReformatLine;                                                             02                  002611
 002612         EndIf;                                                                                  E02                  002612
 002613         If setOnInd2 <> *Blanks;                                                                B02                  002613
 002614            codeLine = '*IN' + setOnInd2 + ' = *On;';                                             02                  002614
 002615            Exsr subUserReformatLine;                                                             02                  002615
 002616         EndIf;                                                                                  E02                  002616
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     66
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002617         If setOnInd3 <> *Blanks;                                                                B02                  002617
 002618            codeLine = '*IN' + setOnInd3 + ' = *On;';                                             02                  002618
 002619            Exsr subUserReformatLine;                                                             02                  002619
 002620         EndIf;                                                                                  E02                  002620
 002621         setOn = *Off;                                                                            01                  002621
 002622      EndIf;                                                                                     E01                  002622
 002623                                                                                                                      002623
 002624      //-----------------------------------------------------------------------                                       002624
 002625      // Resulting indicators...                                                                                      002625
 002626                                                                                                                      002626
 002627      // Turn off all specified indicators first.                                                                     002627
 002628      If HICheck;                                                                                B01                  002628
 002629         Clear nonPrefix;                                                                         01                  002629
 002630         codeLine = '*IN' + HIInd + ' = *Off;';                                                   01                  002630
 002631         Exsr subUserReformatLine;                                                                01                  002631
 002632      EndIf;                                                                                     E01                  002632
 002633      If LWCheck;                                                                                B01                  002633
 002634         Clear nonPrefix;                                                                         01                  002634
 002635         codeLine = '*IN' + LWInd + ' = *Off;';                                                   01                  002635
 002636         Exsr subUserReformatLine;                                                                01                  002636
 002637      EndIf;                                                                                     E01                  002637
 002638      If EQCheck;                                                                                B01                  002638
 002639         Clear nonPrefix;                                                                         01                  002639
 002640         codeLine = '*IN' + EQInd + ' = *Off;';                                                   01                  002640
 002641         Exsr subUserReformatLine;                                                                01                  002641
 002642      EndIf;                                                                                     E01                  002642
 002643                                                                                                                      002643
 002644      // And now turn on those specified accordingly.                                                                 002644
 002645                                                                                                                      002645
 002646      // HI check.                                                                                                    002646
 002647      If HICheck;                                                                                B01                  002647
 002648         Clear nonPrefix;                                                                         01                  002648
 002649                                                                                                                      002649
 002650         codeLine = 'If ' + %trim(HIFactor1) + ' > '                                              01                  002650
 002651                  + %trim(HIFactor2) + ';';                                                       01                  002651
 002652         Exsr subUserReformatLine;                                                                01                  002652
 002653         codeLine = '*IN' + HIInd + ' = *On;';                                                    01                  002653
 002654         Exsr subUserReformatLine;                                                                01                  002654
 002655         codeLine = 'EndIf;';                                                                     01                  002655
 002656         Exsr subUserReformatLine;                                                                01                  002656
 002657                                                                                                                      002657
 002658         HICheck = *Off;                                                                          01                  002658
 002659      EndIf;                                                                                     E01                  002659
 002660                                                                                                                      002660
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     67
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002661      // LO check.                                                                                                    002661
 002662      If LWCheck;                                                                                B01                  002662
 002663         Clear nonPrefix;                                                                         01                  002663
 002664                                                                                                                      002664
 002665         codeLine = 'If ' + %trim(LWFactor1) + ' < '                                              01                  002665
 002666                  + %trim(LWFactor2) + ';';                                                       01                  002666
 002667         Exsr subUserReformatLine;                                                                01                  002667
 002668         codeLine = '*IN' + LWInd + ' = *On;';                                                    01                  002668
 002669         Exsr subUserReformatLine;                                                                01                  002669
 002670         codeLine = 'EndIf;';                                                                     01                  002670
 002671         Exsr subUserReformatLine;                                                                01                  002671
 002672                                                                                                                      002672
 002673         LWCheck = *Off;                                                                          01                  002673
 002674      EndIf;                                                                                     E01                  002674
 002675                                                                                                                      002675
 002676      // EQ check.                                                                                                    002676
 002677      If EQCheck;                                                                                B01                  002677
 002678         Clear nonPrefix;                                                                         01                  002678
 002679                                                                                                                      002679
 002680         codeLine = 'If ' + %trim(EQFactor1) + ' = '                                              01                  002680
 002681                  + %trim(EQFactor2) + ';';                                                       01                  002681
 002682         Exsr subUserReformatLine;                                                                01                  002682
 002683         codeLine = '*IN' + EQInd + ' = *On;';                                                    01                  002683
 002684         Exsr subUserReformatLine;                                                                01                  002684
 002685         codeLine = 'EndIf;';                                                                     01                  002685
 002686         Exsr subUserReformatLine;                                                                01                  002686
 002687                                                                                                                      002687
 002688         EQCheck = *Off;                                                                          01                  002688
 002689      EndIf;                                                                                     E01                  002689
 002690                                                                                                                      002690
 002691   EndSr;                                                                                                             002691
 002692   //-------------------------------------------------------------------------------------------                      002692
 002693                                                                                                                      002693
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     68
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002695   //-------------------------------------------------------------------------------------------                      002695
 002696   // Convert ACQ.                                                                                                    002696
 002697   //-------------------------------------------------------------------------------------------                      002697
 002698   BegSr subUserCvt_ACQ;                                                                                              002698
 002699                                                                                                                      002699
 002700      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             002700
 002701                 + ' ' + %trim(factor2) + ';';                                                                        002701
 002702                                                                                                                      002702
 002703      // Set resulting indicators?                                                                                    002703
 002704      If lw <> *Blanks;                                                                          B01                  002704
 002705         ERRCheck = *On;                                                                          01                  002705
 002706         ERRInd = lw;                                                                             01                  002706
 002707      EndIf;                                                                                     E01                  002707
 002708                                                                                                                      002708
 002709      convert = *On;                                                                                                  002709
 002710                                                                                                                      002710
 002711   EndSr;                                                                                                             002711
 002712   //-------------------------------------------------------------------------------------------                      002712
 002713                                                                                                                      002713
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     69
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002715   //-------------------------------------------------------------------------------------------                      002715
 002716   // Convert ADD.                                                                                                    002716
 002717   //-------------------------------------------------------------------------------------------                      002717
 002718   BegSr subUserCvt_ADD;                                                                                              002718
 002719                                                                                                                      002719
 002720      // Half-adjust?                                                                                                 002720
 002721      x = %scan('H':operator:4);                                                                                      002721
 002722      If x > 0;                                                                                  B01                  002722
 002723         sourceLine = 'Eval(H)';                                                                  01                  002723
 002724      Else;                                                                                      X01                  002724
 002725         sourceLine = *Blanks;                                                                    01                  002725
 002726      EndIf;                                                                                     E01                  002726
 002727                                                                                                                      002727
 002728      If factor1 = *Blanks;                                                                      B01                  002728
 002729         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002729
 002730                    + ' = ' + %trim(result)                                                       01                  002730
 002731                    + ' + ' + %trim(factor2) +';';                                                01                  002731
 002732      Else;                                                                                      X01                  002732
 002733         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002733
 002734                    + ' = ' + %trim(factor1)                                                      01                  002734
 002735                    + ' + ' + %trim(factor2) + ';';                                               01                  002735
 002736      EndIf;                                                                                     E01                  002736
 002737                                                                                                                      002737
 002738      sourceLine = %trim(sourceLine);                                                                                 002738
 002739                                                                                                                      002739
 002740      convert = *On;                                                                                                  002740
 002741                                                                                                                      002741
 002742   EndSr;                                                                                                             002742
 002743   //-------------------------------------------------------------------------------------------                      002743
 002744                                                                                                                      002744
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     70
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002746   //-------------------------------------------------------------------------------------------                      002746
 002747   // Convert ADDDUR.                                                                                                 002747
 002748   //-------------------------------------------------------------------------------------------                      002748
 002749   BegSr subUserCvt_ADDDUR;                                                                                           002749
 002750                                                                                                                      002750
 002751      // Split out duration and code.                                                                                 002751
 002752      x = %scan(':':factor2);                                                                                         002752
 002753      If x = 0;                                                                                  B01                  002753
 002754         nonConvRsn =  'No duration code specified.';                                             01                  002754
 002755         LeaveSr;                                                                                 01                  002755
 002756      EndIf;                                                                                     E01                  002756
 002757                                                                                                                      002757
 002758      durDuration = %trim(%subst(factor2:1:x-1));                                                                     002758
 002759      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         002759
 002760                                                                                                                      002760
 002761      Select;                                                                                    B01                  002761
 002762         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  002762
 002763            durCode = '%years';                                                                   01                  002763
 002764         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  002764
 002765            durCode = '%months';                                                                  01                  002765
 002766         When durCode = '*D' or durCode = '*DAYS';                                               X01                  002766
 002767            durCode = '%days';                                                                    01                  002767
 002768         When durCode = '*H' or durCode = '*HOURS';                                              X01                  002768
 002769            durCode = '%hours';                                                                   01                  002769
 002770         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  002770
 002771            durCode = '%minutes';                                                                 01                  002771
 002772         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  002772
 002773            durCode = '%seconds';                                                                 01                  002773
 002774         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  002774
 002775            durCode = '%mseconds';                                                                01                  002775
 002776         Other;                                                                                  X01                  002776
 002777            nonConvRsn = 'Invalid duration code specified.';                                      01                  002777
 002778            LeaveSr;                                                                              01                  002778
 002779      EndSl;                                                                                     E01                  002779
 002780                                                                                                                      002780
 002781      If factor1 = *Blanks;                                                                      B01                  002781
 002782         sourceLine = %trim(result) + ' = ' + %trim(result);                                      01                  002782
 002783      Else;                                                                                      X01                  002783
 002784         sourceLine = %trim(result) + ' = ' + %trim(factor1);                                     01                  002784
 002785      EndIf;                                                                                     E01                  002785
 002786                                                                                                                      002786
 002787      sourceLine = %trimr(sourceLine) + ' + ' + %trim(durCode)                                                        002787
 002788                 + '(' + %trim(durDuration) + ');';                                                                   002788
 002789                                                                                                                      002789
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     71
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002790      // Set resulting indicators?                                                                                    002790
 002791      If lw <> *Blanks;                                                                          B01                  002791
 002792         ERRCheck = *On;                                                                          01                  002792
 002793         ERRInd = lw;                                                                             01                  002793
 002794      EndIf;                                                                                     E01                  002794
 002795                                                                                                                      002795
 002796      convert = *On;                                                                                                  002796
 002797                                                                                                                      002797
 002798   EndSr;                                                                                                             002798
 002799   //-------------------------------------------------------------------------------------------                      002799
 002800                                                                                                                      002800
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     72
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002802   //-------------------------------------------------------------------------------------------                      002802
 002803   // Convert ALLOC.                                                                                                  002803
 002804   //-------------------------------------------------------------------------------------------                      002804
 002805   BegSr subUserCvt_ALLOC;                                                                                            002805
 002806                                                                                                                      002806
 002807      sourceLine = %trim(result) + ' = %alloc(' + %trim(factor2) + ');';                                              002807
 002808                                                                                                                      002808
 002809      // Set resulting indicators?                                                                                    002809
 002810      If lw <> *Blanks;                                                                          B01                  002810
 002811         ERRCheck = *On;                                                                          01                  002811
 002812         ERRInd = lw;                                                                             01                  002812
 002813      EndIf;                                                                                     E01                  002813
 002814                                                                                                                      002814
 002815      convert = *On;                                                                                                  002815
 002816                                                                                                                      002816
 002817   EndSr;                                                                                                             002817
 002818   //-------------------------------------------------------------------------------------------                      002818
 002819                                                                                                                      002819
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     73
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002821   //-------------------------------------------------------------------------------------------                      002821
 002822   // Convert BEGSR.                                                                                                  002822
 002823   //-------------------------------------------------------------------------------------------                      002823
 002824   BegSr subUserCvt_BEGSR;                                                                                            002824
 002825                                                                                                                      002825
 002826      sourceLine = 'BegSr ' + %trim(factor1) + ';';                                                                   002826
 002827                                                                                                                      002827
 002828      convert = *On;                                                                                                  002828
 002829                                                                                                                      002829
 002830   EndSr;                                                                                                             002830
 002831   //-------------------------------------------------------------------------------------------                      002831
 002832                                                                                                                      002832
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     74
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002834   //-------------------------------------------------------------------------------------------                      002834
 002835   // Convert CALLP.                                                                                                  002835
 002836   //-------------------------------------------------------------------------------------------                      002836
 002837   BegSr subUserCvt_CALLP;                                                                                            002837
 002838                                                                                                                      002838
 002839      // Returning for a multi-line CALLP - restore the original opcode.                                              002839
 002840      If inCallP;                                                                                B01                  002840
 002841         operator = callPOperator;                                                                01                  002841
 002842      EndIf;                                                                                     E01                  002842
 002843                                                                                                                      002843
 002844      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002844
 002845                                                                                                                      002845
 002846      If not inCallP;         // First line of CALLP.                                            B01                  002846
 002847         sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                                 01                  002847
 002848         If not inSpan;                                                                          B02                  002848
 002849            sourceLine = %trim(sourceLine) + ';';                                                 02                  002849
 002850         Else;                                                                                   X02                  002850
 002851            callPOffset = %len(%trim(operator)) + 2;                                              02                  002851
 002852            inCallP = *On;                                                                        02                  002852
 002853            inSpan = *Off;                                                                        02                  002853
 002854         EndIf;                                                                                  E02                  002854
 002855      Else;                   // Second+ line of CALLP.                                          X01                  002855
 002856         sourceLine = *Blanks;                                                                    01                  002856
 002857         sourceLine = %trim(extFactor2);                                                          01                  002857
 002858         If not inSpan;                                                                          B02                  002858
 002859            sourceLine = %trimr(sourceLine) + ';';                                                02                  002859
 002860            //            inCallP = *Off;                                                                             002860
 002861         EndIf;                                                                                  E02                  002861
 002862         inSpan = *Off;                                                                           01                  002862
 002863      EndIf;                                                                                     E01                  002863
 002864                                                                                                                      002864
 002865      // Multi-line CALLP?  Save the opcode.                                                                          002865
 002866      If inCallP;                                                                                B01                  002866
 002867         callPOperator = operator;                                                                01                  002867
 002868      Else;                                                                                      X01                  002868
 002869         callPOperator = *Blanks;                                                                 01                  002869
 002870      EndIf;                                                                                     E01                  002870
 002871                                                                                                                      002871
 002872      convert = *On;                                                                                                  002872
 002873                                                                                                                      002873
 002874   EndSr;                                                                                                             002874
 002875   //-------------------------------------------------------------------------------------------                      002875
 002876                                                                                                                      002876
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     75
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002878   //-------------------------------------------------------------------------------------------                      002878
 002879   // Convert CASxx.                                                                                                  002879
 002880   //-------------------------------------------------------------------------------------------                      002880
 002881   BegSr subUserCvt_CASxx;                                                                                            002881
 002882                                                                                                                      002882
 002883      // Extract components.                                                                                          002883
 002884      caseSubRoutine = %trim(result);                                                                                 002884
 002885      caseOperator = %subst(operator:4:2);                                                                            002885
 002886                                                                                                                      002886
 002887      // Determine comparator.                                                                                        002887
 002888      If caseOperator = 'EQ';                                                                    B01                  002888
 002889         caseOperator = '=';                                                                      01                  002889
 002890      ElseIf caseOperator = 'GT';                                                                X01                  002890
 002891         caseOperator = '>';                                                                      01                  002891
 002892      ElseIf caseOperator = 'LT';                                                                X01                  002892
 002893         caseOperator = '<';                                                                      01                  002893
 002894      ElseIf caseOperator = 'GE';                                                                X01                  002894
 002895         caseOperator = '>=';                                                                     01                  002895
 002896      ElseIf caseOperator = 'LE';                                                                X01                  002896
 002897         caseOperator = '<=';                                                                     01                  002897
 002898      ElseIf caseOperator = 'NE';                                                                X01                  002898
 002899         caseOperator = '<>';                                                                     01                  002899
 002900      Else;                                                                                      X01                  002900
 002901         caseOperator = 'Else';                                                                   01                  002901
 002902      EndIf;                                                                                     E01                  002902
 002903                                                                                                                      002903
 002904      // Build 'If' statement.                                                                                        002904
 002905      If not inCase;                                                                             B01                  002905
 002906         sourceLine = 'If ' +  %trim(factor1) + ' '                                               01                  002906
 002907                    + %trim(caseOperator) + ' ' + %trim(factor2)                                  01                  002907
 002908                    + ';';                                                                        01                  002908
 002909         inCase = *On;                                                                            01                  002909
 002910      Else;                                                                                      X01                  002910
 002911         If caseOperator = 'Else';                                                               B02                  002911
 002912            sourceLine = 'Else;';                                                                 02                  002912
 002913         Else;                                                                                   X02                  002913
 002914            sourceLine = 'ElseIf ' +  %trim(factor1) + ' '                                        02                  002914
 002915                       + %trim(caseOperator) + ' ' + %trim(factor2)                               02                  002915
 002916                       + ';';                                                                     02                  002916
 002917         EndIf;                                                                                  E02                  002917
 002918      EndIf;                                                                                     E01                  002918
 002919                                                                                                                      002919
 002920      // Do we need to set Resulting indicators?                                                                      002920
 002921      If hi <> *Blanks;                                                                          B01                  002921
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     76
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002922         HICheck = *On;                                                                           01                  002922
 002923         HIInd = hi;                                                                              01                  002923
 002924         HIFactor1 = %trim(factor1);                                                              01                  002924
 002925         HIFactor2 = %trim(factor2);                                                              01                  002925
 002926      EndIf;                                                                                     E01                  002926
 002927      If lw <> *Blanks;                                                                          B01                  002927
 002928         LWCheck = *On;                                                                           01                  002928
 002929         LWInd = lw;                                                                              01                  002929
 002930         LWFactor1 = %trim(factor1);                                                              01                  002930
 002931         LWFactor2 = %trim(factor2);                                                              01                  002931
 002932      EndIf;                                                                                     E01                  002932
 002933      If eq <> *Blanks;                                                                          B01                  002933
 002934         EQCheck = *On;                                                                           01                  002934
 002935         EQInd = eq;                                                                              01                  002935
 002936         EQFactor1 = %trim(factor1);                                                              01                  002936
 002937         EQFactor2 = %trim(factor2);                                                              01                  002937
 002938      EndIf;                                                                                     E01                  002938
 002939                                                                                                                      002939
 002940      convert = *On;                                                                                                  002940
 002941                                                                                                                      002941
 002942   EndSr;                                                                                                             002942
 002943   //-------------------------------------------------------------------------------------------                      002943
 002944                                                                                                                      002944
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     77
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002946   //-------------------------------------------------------------------------------------------                      002946
 002947   // Convert CAT.                                                                                                    002947
 002948   //-------------------------------------------------------------------------------------------                      002948
 002949   BegSr subUserCvt_CAT;                                                                                              002949
 002950                                                                                                                      002950
 002951      // Pad the result?                                                                                              002951
 002952      x = %scan('P':operator:4);                                                                                      002952
 002953      If x = 0                                              // Not padding.                      B01                  002953
 002954      and factor1 <> *Blanks                                // Factor1 specified.                B01                  002954
 002955      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  002955
 002956         nonConvRsn =  'No padding specified, result unpredictable.';                             01                  002956
 002957         LeaveSr;    // Don't convert - too difficult to get right.                               01                  002957
 002958      EndIf;                                                                                     E01                  002958
 002959                                                                                                                      002959
 002960      // Drop the extender.                                                                                           002960
 002961      operator = 'CAT';                                                                                               002961
 002962                                                                                                                      002962
 002963      // Determine first part of string.                                                                              002963
 002964      If factor1 = *Blanks;                                                                      B01                  002964
 002965         catFactor1 = %trim(result);                                                              01                  002965
 002966      Else;                                                                                      X01                  002966
 002967         catFactor1 = %trim(factor1);                                                             01                  002967
 002968      EndIf;                                                                                     E01                  002968
 002969                                                                                                                      002969
 002970      // Determine number of blanks.                                                                                  002970
 002971      x = %scan(':':factor2);                                                                                         002971
 002972      If x = 0;   // No trimming required;                                                       B01                  002972
 002973         catBlanks = *Blanks;                                                                     01                  002973
 002974         catFactor2 = %trim(factor2);                                                             01                  002974
 002975      Else;                                                                                      X01                  002975
 002976         catBlanks = %subst(factor2:x+1);                                                         01                  002976
 002977         catFactor2 = %subst(factor2:1:x-1);                                                      01                  002977
 002978      EndIf;                                                                                     E01                  002978
 002979                                                                                                                      002979
 002980      // Determine second part of String.                                                                             002980
 002981                                                                                                                      002981
 002982      // Blanks zero?                                                                                                 002982
 002983      If catBlanks <> *blanks;                                                                   B01                  002983
 002984         Monitor;                                                                                B02                  002984
 002985            catCount = %dec(catBlanks:3:0);                                                       02                  002985
 002986         On-Error;                                                                               X02                  002986
 002987            LeaveSr; // Uses a field to vary the number of blanks - don't convert.                02                  002987
 002988         EndMon;                                                                                 E02                  002988
 002989      EndIf;                                                                                     E01                  002989
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     78
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002990                                                                                                                      002990
 002991      // Build the new line.                                                                                          002991
 002992      If catBlanks = *Blanks;                                                                    B01                  002992
 002993         // No trimming.                                                                                              002993
 002994         sourceLine = %trim(result) + ' = ' + %trim(catFactor1)                                   01                  002994
 002995                    + ' + ' + %trim(catFactor2) + ';';                                            01                  002995
 002996      ElseIf catCount = 0;                                                                       X01                  002996
 002997         // No spaces.                                                                                                002997
 002998         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  002998
 002999                    + ') + %trim(' + %trim(catFactor2) + ');';                                    01                  002999
 003000      ElseIf catCount > 25;                                                                      X01                  003000
 003001         LeaveSr; // Arbitrary upper limit - don't convert.                                       01                  003001
 003002      Else;                                                                                      X01                  003002
 003003         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003003
 003004                    + ') + ''' + %str(%addr(blanks):catCount)                                     01                  003004
 003005                    + ''' + %trim(' + %trim(catFactor2) + ');';                                   01                  003005
 003006      EndIf;                                                                                     E01                  003006
 003007                                                                                                                      003007
 003008      // Set resulting indicators?                                                                                    003008
 003009      If lw <> *Blanks;                                                                          B01                  003009
 003010         ERRCheck = *On;                                                                          01                  003010
 003011         ERRInd = lw;                                                                             01                  003011
 003012      EndIf;                                                                                     E01                  003012
 003013                                                                                                                      003013
 003014      convert = *On;                                                                                                  003014
 003015                                                                                                                      003015
 003016   EndSr;                                                                                                             003016
 003017   //-------------------------------------------------------------------------------------------                      003017
 003018                                                                                                                      003018
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     79
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003020   //-------------------------------------------------------------------------------------------                      003020
 003021   // Convert CHAIN.                                                                                                  003021
 003022   //-------------------------------------------------------------------------------------------                      003022
 003023   BegSr subUserCvt_CHAIN;                                                                                            003023
 003024                                                                                                                      003024
 003025      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       003025
 003026                 + %trim(factor2);                                                                                    003026
 003027                                                                                                                      003027
 003028      If result <> *Blanks;                                                                      B01                  003028
 003029         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003029
 003030      Else;                                                                                      X01                  003030
 003031         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003031
 003032      EndIf;                                                                                     E01                  003032
 003033                                                                                                                      003033
 003034      // Set resulting indicators?                                                                                    003034
 003035      If hi <> *Blanks;                                                                          B01                  003035
 003036         NRFCheck = *On;                                                                          01                  003036
 003037         NRFInd = hi;                                                                             01                  003037
 003038         NRFFile = %trim(factor2);                                                                01                  003038
 003039      EndIf;                                                                                     E01                  003039
 003040      If lw <> *Blanks;                                                                          B01                  003040
 003041         ERRCheck = *On;                                                                          01                  003041
 003042         ERRInd = lw;                                                                             01                  003042
 003043      EndIf;                                                                                     E01                  003043
 003044                                                                                                                      003044
 003045      convert = *On;                                                                                                  003045
 003046                                                                                                                      003046
 003047   EndSr;                                                                                                             003047
 003048   //-------------------------------------------------------------------------------------------                      003048
 003049                                                                                                                      003049
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     80
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003051   //-------------------------------------------------------------------------------------------                      003051
 003052   // Convert CHECK.                                                                                                  003052
 003053   //-------------------------------------------------------------------------------------------                      003053
 003054   BegSr subUserCvt_CHECKx;                                                                                           003054
 003055                                                                                                                      003055
 003056      // Don't convert of no result specified.                                                                        003056
 003057      If result = *Blanks;                                                                       B01                  003057
 003058         nonConvRsn = 'No result field specified.';                                               01                  003058
 003059         LeaveSr;                                                                                 01                  003059
 003060      EndIf;                                                                                     E01                  003060
 003061                                                                                                                      003061
 003062      If %subst(operator:1:5) = 'CHECKR';                                                        B01                  003062
 003063         operator = '%checkr(';                                                                   01                  003063
 003064      Else;                                                                                      X01                  003064
 003065         operator = '%check(';                                                                    01                  003065
 003066      EndIf;                                                                                     E01                  003066
 003067                                                                                                                      003067
 003068      // Determine starting point.                                                                                    003068
 003069      x = %scan(':':factor2);                                                                                         003069
 003070                                                                                                                      003070
 003071      // Build the new line.                                                                                          003071
 003072      If x = 0;                                                                                  B01                  003072
 003073         // No start specified.                                                                                       003073
 003074         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003074
 003075                    + %trim(factor1) + ':' + %trim(factor2) + ');';                               01                  003075
 003076      Else;                                                                                      X01                  003076
 003077         // Start from a specified point.                                                                             003077
 003078         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003078
 003079                    + %trim(factor1) + ':' + %subst(factor2:1:x-1)                                01                  003079
 003080                    + ':' + %trim(%subst(factor2:x+1))                                            01                  003080
 003081                    + ');';                                                                       01                  003081
 003082      EndIf;                                                                                     E01                  003082
 003083                                                                                                                      003083
 003084      // Set resulting indicators?                                                                                    003084
 003085      If lw <> *Blanks;                                                                          B01                  003085
 003086         ERRCheck = *On;                                                                          01                  003086
 003087         ERRInd = lw;                                                                             01                  003087
 003088      EndIf;                                                                                     E01                  003088
 003089      If eq <> *Blanks;                                                                          B01                  003089
 003090         HICheck = *On;                                                                           01                  003090
 003091         HIInd = eq;                                                                              01                  003091
 003092         HIFactor1 = result;                                                                      01                  003092
 003093         HIFactor2 = '0';                                                                         01                  003093
 003094      EndIf;                                                                                     E01                  003094
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     81
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003095                                                                                                                      003095
 003096      convert = *On;                                                                                                  003096
 003097                                                                                                                      003097
 003098   EndSr;                                                                                                             003098
 003099   //-------------------------------------------------------------------------------------------                      003099
 003100                                                                                                                      003100
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     82
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003102   //-------------------------------------------------------------------------------------------                      003102
 003103   // Convert CLEAR.                                                                                                  003103
 003104   //-------------------------------------------------------------------------------------------                      003104
 003105   BegSr subUserCvt_CLEAR;                                                                                            003105
 003106                                                                                                                      003106
 003107      sourceLine = 'Clear ' + %trim(result) + ';';                                                                    003107
 003108                                                                                                                      003108
 003109      convert = *On;                                                                                                  003109
 003110                                                                                                                      003110
 003111   EndSr;                                                                                                             003111
 003112   //-------------------------------------------------------------------------------------------                      003112
 003113                                                                                                                      003113
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     83
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003115   //-------------------------------------------------------------------------------------------                      003115
 003116   // Convert CLOSE.                                                                                                  003116
 003117   //-------------------------------------------------------------------------------------------                      003117
 003118   BegSr subUserCvt_CLOSE;                                                                                            003118
 003119                                                                                                                      003119
 003120      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003120
 003121                                                                                                                      003121
 003122      If lw <> *Blanks;                                                                          B01                  003122
 003123         ERRCheck = *On;                                                                          01                  003123
 003124         ERRInd = lw;                                                                             01                  003124
 003125      EndIf;                                                                                     E01                  003125
 003126                                                                                                                      003126
 003127      convert = *On;                                                                                                  003127
 003128                                                                                                                      003128
 003129   EndSr;                                                                                                             003129
 003130   //-------------------------------------------------------------------------------------------                      003130
 003131                                                                                                                      003131
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     84
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003133   //-------------------------------------------------------------------------------------------                      003133
 003134   // Convert COMMIT.                                                                                                 003134
 003135   //-------------------------------------------------------------------------------------------                      003135
 003136   BegSr subUserCvt_COMMIT;                                                                                           003136
 003137                                                                                                                      003137
 003138      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            003138
 003139                                                                                                                      003139
 003140      sourceLine = %trim(sourceLine)  + ';';                                                                          003140
 003141                                                                                                                      003141
 003142      // Check indicators?                                                                                            003142
 003143      If lw <> *Blanks;                                                                          B01                  003143
 003144         ERRCheck = *On;                                                                          01                  003144
 003145         ERRInd = lw;                                                                             01                  003145
 003146      EndIf;                                                                                     E01                  003146
 003147                                                                                                                      003147
 003148      convert = *On;                                                                                                  003148
 003149                                                                                                                      003149
 003150   EndSr;                                                                                                             003150
 003151   //-------------------------------------------------------------------------------------------                      003151
 003152                                                                                                                      003152
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     85
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003154   //-------------------------------------------------------------------------------------------                      003154
 003155   // Convert COMP.                                                                                                   003155
 003156   //-------------------------------------------------------------------------------------------                      003156
 003157   BegSr subUserCvt_COMP;                                                                                             003157
 003158                                                                                                                      003158
 003159      // Set resulting indicators to check.                                                                           003159
 003160      If hi <> *Blanks;                                                                          B01                  003160
 003161         HICheck = *On;                                                                           01                  003161
 003162         HIInd = hi;                                                                              01                  003162
 003163         HIFactor1 = factor1;                                                                     01                  003163
 003164         HIFactor2 = factor2;                                                                     01                  003164
 003165      EndIf;                                                                                     E01                  003165
 003166                                                                                                                      003166
 003167      If lw <> *Blanks;                                                                          B01                  003167
 003168         LWCheck = *On;                                                                           01                  003168
 003169         LWInd = lw;                                                                              01                  003169
 003170         LWFactor1 = factor1;                                                                     01                  003170
 003171         LWFactor2 = factor2;                                                                     01                  003171
 003172      EndIf;                                                                                     E01                  003172
 003173                                                                                                                      003173
 003174      If eq <> *Blanks;                                                                          B01                  003174
 003175         EQCheck = *On;                                                                           01                  003175
 003176         EQInd = eq;                                                                              01                  003176
 003177         EQFactor1 = factor1;                                                                     01                  003177
 003178         EQFactor2 = factor2;                                                                     01                  003178
 003179      EndIf;                                                                                     E01                  003179
 003180                                                                                                                      003180
 003181      // Drop the current line.                                                                                       003181
 003182      dropLine = *On;                                                                                                 003182
 003183      convert = *On;                                                                                                  003183
 003184                                                                                                                      003184
 003185   EndSr;                                                                                                             003185
 003186   //-------------------------------------------------------------------------------------------                      003186
 003187                                                                                                                      003187
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     86
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003189   //-------------------------------------------------------------------------------------------                      003189
 003190   // Convert DEALLOC.                                                                                                003190
 003191   //-------------------------------------------------------------------------------------------                      003191
 003192   BegSr subUserCvt_DEALLOC;                                                                                          003192
 003193                                                                                                                      003193
 003194      sourceLine = %trim(operator) + ' ' + %trim(result);                                                             003194
 003195                                                                                                                      003195
 003196      sourceLine = %trim(sourceLine)  + ';';                                                                          003196
 003197                                                                                                                      003197
 003198      // Set resulting indicators?                                                                                    003198
 003199      If lw <> *Blanks;                                                                          B01                  003199
 003200         ERRCheck = *On;                                                                          01                  003200
 003201         ERRInd = lw;                                                                             01                  003201
 003202      EndIf;                                                                                     E01                  003202
 003203                                                                                                                      003203
 003204      convert = *On;                                                                                                  003204
 003205                                                                                                                      003205
 003206   EndSr;                                                                                                             003206
 003207   //-------------------------------------------------------------------------------------------                      003207
 003208                                                                                                                      003208
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     87
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003210   //-------------------------------------------------------------------------------------------                      003210
 003211   // Convert DELETE.                                                                                                 003211
 003212   //-------------------------------------------------------------------------------------------                      003212
 003213   BegSr subUserCvt_DELETE;                                                                                           003213
 003214                                                                                                                      003214
 003215      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003215
 003216                                                                                                                      003216
 003217      sourceLine = %trim(sourceLine)  + ';';                                                                          003217
 003218                                                                                                                      003218
 003219      // Check indicators?                                                                                            003219
 003220      If hi <> *Blanks;                                                                          B01                  003220
 003221         NRFCheck = *On;                                                                          01                  003221
 003222         NRFInd = eq;                                                                             01                  003222
 003223         NRFFile = %trim(factor2);                                                                01                  003223
 003224      EndIf;                                                                                     E01                  003224
 003225      If lw <> *Blanks;                                                                          B01                  003225
 003226         ERRCheck = *On;                                                                          01                  003226
 003227         ERRInd = lw;                                                                             01                  003227
 003228      EndIf;                                                                                     E01                  003228
 003229                                                                                                                      003229
 003230      convert = *On;                                                                                                  003230
 003231                                                                                                                      003231
 003232   EndSr;                                                                                                             003232
 003233   //-------------------------------------------------------------------------------------------                      003233
 003234                                                                                                                      003234
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     88
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003236   //-------------------------------------------------------------------------------------------                      003236
 003237   // Convert DIV.                                                                                                    003237
 003238   //-------------------------------------------------------------------------------------------                      003238
 003239   BegSr subUserCvt_DIV;                                                                                              003239
 003240                                                                                                                      003240
 003241      // Half-adjust?                                                                                                 003241
 003242      If %scan('H':operator:4) > 0;                                                              B01                  003242
 003243         sourceLine = 'Eval(H) ';                                                                 01                  003243
 003244      Else;                                                                                      X01                  003244
 003245         sourceLine = *Blanks;                                                                    01                  003245
 003246      EndIf;                                                                                     E01                  003246
 003247                                                                                                                      003247
 003248      If factor1 = *Blanks;                                                                      B01                  003248
 003249         divFactor1 = result;                                                                     01                  003249
 003250         divFactor2 = factor2;                                                                    01                  003250
 003251      Else;                                                                                      X01                  003251
 003252         divFactor1 = factor1;                                                                    01                  003252
 003253         divFactor2 = factor2;                                                                    01                  003253
 003254      EndIf;                                                                                     E01                  003254
 003255                                                                                                                      003255
 003256      sourceLine = %trim( %trimr(sourceLine) + ' ' + %trim(result)                                                    003256
 003257                 + ' = ' + %trim(divFactor1) + ' / '                                                                  003257
 003258                 + %trim(divFactor2) + ';');                                                                          003258
 003259                                                                                                                      003259
 003260      convert = *On;                                                                                                  003260
 003261                                                                                                                      003261
 003262   EndSr;                                                                                                             003262
 003263   //-------------------------------------------------------------------------------------------                      003263
 003264                                                                                                                      003264
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     89
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003266   //-------------------------------------------------------------------------------------------                      003266
 003267   // Convert DO.                                                                                                     003267
 003268   //-------------------------------------------------------------------------------------------                      003268
 003269   BegSr subUserCvt_DO;                                                                                               003269
 003270                                                                                                                      003270
 003271      If inDo;                                                                                   B01                  003271
 003272         operator = doOperator;                                                                   01                  003272
 003273      EndIf;                                                                                     E01                  003273
 003274                                                                                                                      003274
 003275      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003275
 003276                                                                                                                      003276
 003277      If operator = 'DOW'     // Use Extended Factor2.                                           B01                  003277
 003278      or operator = 'DOU';    // Use Extended Factor2.                                           B01                  003278
 003279         If not inDo;         // First line of DO.                                               B02                  003279
 003280            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003280
 003281            If not inSpan;                                                                       B03                  003281
 003282               sourceLine = %trim(sourceLine) + ';';                                              03                  003282
 003283            Else;                                                                                X03                  003283
 003284               inDo = *On;                                                                        03                  003284
 003285               inSpan = *Off;                                                                     03                  003285
 003286            EndIf;                                                                               E03                  003286
 003287         Else;                   // Second line of DO.                                           X02                  003287
 003288            sourceLine = *Blanks;                                                                 02                  003288
 003289            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003289
 003290            sourceLine = %trim(extFactor2);                                                       02                  003290
 003291            If not inSpan;                                                                       B03                  003291
 003292               sourceLine = %trimr(sourceLine) + ';';                                             03                  003292
 003293               //               inDo = *Off;                                                                          003293
 003294            EndIf;                                                                               E03                  003294
 003295            inSpan = *Off;                                                                        02                  003295
 003296         EndIf;                                                                                  E02                  003296
 003297         doCompare = '!!';    // Just a regular DO.                                               01                  003297
 003298      Else;                                                                                      X01                  003298
 003299         // Fixed format.                                                                                             003299
 003300         opCode = %xlate(lo:up:opCode);                                                           01                  003300
 003301         If not inDo;         // First line of DO.                                               B02                  003301
 003302            doCompare = %subst(opCode:4:2);                                                       02                  003302
 003303            sourceLine = %subst(opcode:1:3);                                                      02                  003303
 003304         Else;                // Second line of DO.                                              X02                  003304
 003305            If %subst(opCode:1:3) = 'AND';                                                       B03                  003305
 003306               doCompare = %subst(opCode:4:2);                                                    03                  003306
 003307               sourceLine = 'And';                                                                03                  003307
 003308            Else;                                                                                X03                  003308
 003309               doCompare = %subst(opCode:3:2);                                                    03                  003309
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     90
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003310               sourceLine = 'Or';                                                                 03                  003310
 003311            EndIf;                                                                               E03                  003311
 003312         EndIf;                                                                                  E02                  003312
 003313                                                                                                                      003313
 003314         If doCompare = 'EQ';                                                                    B02                  003314
 003315            doCompare = '=';                                                                      02                  003315
 003316         ElseIf doCompare = 'GT';                                                                X02                  003316
 003317            doCompare = '>';                                                                      02                  003317
 003318         ElseIf doCompare = 'GE';                                                                X02                  003318
 003319            doCompare = '>=';                                                                     02                  003319
 003320         ElseIf doCompare = 'LT';                                                                X02                  003320
 003321            doCompare = '<';                                                                      02                  003321
 003322         ElseIf doCompare = 'LE';                                                                X02                  003322
 003323            doCompare = '<=';                                                                     02                  003323
 003324         ElseIf doCompare = 'NE';                                                                X02                  003324
 003325            doCompare = '<>';                                                                     02                  003325
 003326         ElseIf doCompare = '!!';                                                                X02                  003326
 003327            // Do nothing.                                                                                            003327
 003328            Else;    // Just DO - convert to FOR.                                                X02                  003328
 003329            If factor1 = *Blanks;                                                                B03                  003329
 003330               forFactor1 = '1';                                                                  03                  003330
 003331            Else;                                                                                X03                  003331
 003332               forFactor1 = factor1;                                                              03                  003332
 003333            EndIf;                                                                               E03                  003333
 003334            forFactor2 = factor2;                                                                 02                  003334
 003335            factor1 = *Blanks;                                                                    02                  003335
 003336            factor2 = *Blanks;                                                                    02                  003336
 003337            doCompare = *Blanks;                                                                  02                  003337
 003338            If result = *Blanks;                                                                 B03                  003338
 003339               result = '???';                                                                    03                  003339
 003340            EndIf;                                                                               E03                  003340
 003341            sourceLine = 'For ' + %trim(result) + ' = '                                           02                  003341
 003342                       + %trim(forFactor1) + ' To '                                               02                  003342
 003343                       + %trim(forFactor2);                                                       02                  003343
 003344         EndIf;                                                                                  E02                  003344
 003345                                                                                                                      003345
 003346         //         If doCompare = *Blanks;                                                                           003346
 003347     //            // Save current indentation level to match up to the associated ENDDO later.                       003347
 003348         //            forCount += 1;                                                                                 003348
 003349         //            forLevel(forCount) = indentCount;                                                              003349
 003350         //         Else;                                                                                             003350
 003351     //            // Save current indentation level to match up to the associated ENDDO later.                       003351
 003352         //            doCount += 1;                                                                                  003352
 003353         //            doLevel(doCount) = indentCount;                                                                003353
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     91
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003354         //         EndIf;                                                                                            003354
 003355                                                                                                                      003355
 003356         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003356
 003357                            + ' ' + %trim(doCompare) + ' '                                        01                  003357
 003358                            + %trim(factor2);                                                     01                  003358
 003359         If not inSpan;                                                                          B02                  003359
 003360            sourceLine = %trimr(sourceLine) + ';';                                                02                  003360
 003361            inDo = *Off;                                                                          02                  003361
 003362         Else;                                                                                   X02                  003362
 003363            inDo = *On;                                                                           02                  003363
 003364            inSpan = *Off;                                                                        02                  003364
 003365         EndIf;                                                                                  E02                  003365
 003366      EndIf;                                                                                     E01                  003366
 003367                                                                                                                      003367
 003368      // If multi-line, retain the original opcode.                                                                   003368
 003369      If inDo;                                                                                   B01                  003369
 003370         doOperator = operator;                                                                   01                  003370
 003371      Else;                                                                                      X01                  003371
 003372         doOperator = *Blanks;                                                                    01                  003372
 003373      EndIf;                                                                                     E01                  003373
 003374                                                                                                                      003374
 003375      convert = *On;                                                                                                  003375
 003376                                                                                                                      003376
 003377   EndSr;                                                                                                             003377
 003378   //-------------------------------------------------------------------------------------------                      003378
 003379                                                                                                                      003379
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     92
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003381   //-------------------------------------------------------------------------------------------                      003381
 003382   // Convert DSPLY.                                                                                                  003382
 003383   //-------------------------------------------------------------------------------------------                      003383
 003384   BegSr subUserCvt_DSPLY;                                                                                            003384
 003385                                                                                                                      003385
 003386      sourceLine = %trim(operator);                                                                                   003386
 003387                                                                                                                      003387
 003388      If factor1 <> *Blanks;                                                                     B01                  003388
 003389         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  003389
 003390         If factor2 <> *Blanks;                                                                  B02                  003390
 003391            sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                               02                  003391
 003392         ElseIf result <> *Blanks;                                                               X02                  003392
 003393            sourceLine = %trimr(sourceLine) + ' ''''';                                            02                  003393
 003394         EndIf;                                                                                  E02                  003394
 003395         If result <> *Blanks;                                                                   B02                  003395
 003396            sourceLine = %trimr(sourceLine) + ' ' + %trim(result);                                02                  003396
 003397         EndIf;                                                                                  E02                  003397
 003398      EndIf;                                                                                     E01                  003398
 003399                                                                                                                      003399
 003400      sourceLine = %trimr(sourceLine) + ';';                                                                          003400
 003401                                                                                                                      003401
 003402      // Set resulting indicators?                                                                                    003402
 003403      If lw <> *Blanks;                                                                          B01                  003403
 003404         ERRCheck = *On;                                                                          01                  003404
 003405         ERRInd = lw;                                                                             01                  003405
 003406      EndIf;                                                                                     E01                  003406
 003407                                                                                                                      003407
 003408      convert = *On;                                                                                                  003408
 003409                                                                                                                      003409
 003410   EndSr;                                                                                                             003410
 003411   //-------------------------------------------------------------------------------------------                      003411
 003412                                                                                                                      003412
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     93
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003414   //-------------------------------------------------------------------------------------------                      003414
 003415   // Convert DUMP.                                                                                                   003415
 003416   //-------------------------------------------------------------------------------------------                      003416
 003417   BegSr subUserCvt_DUMP;                                                                                             003417
 003418                                                                                                                      003418
 003419      If factor1 <> *Blanks;                                                                     B01                  003419
 003420         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ';';                               01                  003420
 003421      Else;                                                                                      X01                  003421
 003422         sourceLine = %trim(operator) + ';';                                                      01                  003422
 003423      EndIf;                                                                                     E01                  003423
 003424                                                                                                                      003424
 003425      convert = *On;                                                                                                  003425
 003426                                                                                                                      003426
 003427   EndSr;                                                                                                             003427
 003428   //-------------------------------------------------------------------------------------------                      003428
 003429                                                                                                                      003429
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     94
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003431   //-------------------------------------------------------------------------------------------                      003431
 003432   // Convert ELSE.                                                                                                   003432
 003433   //-------------------------------------------------------------------------------------------                      003433
 003434   BegSr subUserCvt_ELSE;                                                                                             003434
 003435                                                                                                                      003435
 003436      sourceLine = 'Else;';                                                                                           003436
 003437                                                                                                                      003437
 003438      convert = *On;                                                                                                  003438
 003439                                                                                                                      003439
 003440   EndSr;                                                                                                             003440
 003441   //-------------------------------------------------------------------------------------------                      003441
 003442                                                                                                                      003442
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     95
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003444   //-------------------------------------------------------------------------------------------                      003444
 003445   // Convert ELSEIF.                                                                                                 003445
 003446   //-------------------------------------------------------------------------------------------                      003446
 003447   BegSr subUserCvt_ELSEIF;                                                                                           003447
 003448                                                                                                                      003448
 003449      sourceLine = 'ElseIf ' + %trim(factor2) + ';';                                                                  003449
 003450                                                                                                                      003450
 003451      convert = *On;                                                                                                  003451
 003452                                                                                                                      003452
 003453   EndSr;                                                                                                             003453
 003454   //-------------------------------------------------------------------------------------------                      003454
 003455                                                                                                                      003455
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     96
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003457   //-------------------------------------------------------------------------------------------                      003457
 003458   // Convert ENDxx.                                                                                                  003458
 003459   //-------------------------------------------------------------------------------------------                      003459
 003460   BegSr subUserCvt_ENDxx;                                                                                            003460
 003461                                                                                                                      003461
 003462      // Catch labels on ENDSR.                                                                                       003462
 003463      If %trim(operator) = 'ENDSR';                                                              B01                  003463
 003464         If %len(%trim(factor1)) > 0;                                                            B02                  003464
 003465            nonConvRsn = 'Label on ENDSR is not supported in free-form';                          02                  003465
 003466            LeaveSr;                                                                              02                  003466
 003467         EndIf;                                                                                  E02                  003467
 003468      EndIf;                                                                                     E01                  003468
 003469                                                                                                                      003469
 003470      // Do we need to convert an ENDDO to ENDFOR?                                                                    003470
 003471      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003471
 003472         If forCount > 0;                                                                        B02                  003472
 003473            If forLevel(forCount) = indentCount - 1;                                             B03                  003473
 003474               operator = 'ENDFOR' + ' ' + %trim(factor2);                                        03                  003474
 003475               If factor2 <> *Blanks;                                                            B04                  003475
 003476                  savedSRCDTA = SRCDTA;                                                           04                  003476
 003477                  codeLine = '* CHECK: This is a converted ENDDO -'                               04                  003477
 003478                           + ' Please add ''BY'' to the corresponding'                            04                  003478
 003479                           + ' FOR';                                                              04                  003479
 003480                  Exsr subUserWriteLine;                                                          04                  003480
 003481                  SRCDTA = savedSRCDTA;                                                           04                  003481
 003482               EndIf;                                                                            E04                  003482
 003483            EndIf;                                                                               E03                  003483
 003484         EndIf;                                                                                  E02                  003484
 003485      EndIf;                                                                                     E01                  003485
 003486                                                                                                                      003486
 003487      // Convert END to ENDDO?                                                                                        003487
 003488      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003488
 003489         If doCount > 0;                                                                         B02                  003489
 003490            If doLevel(doCount) = indentCount - 1;                                               B03                  003490
 003491               operator = 'ENDDO';                                                                03                  003491
 003492            EndIf;                                                                               E03                  003492
 003493         EndIf;                                                                                  E02                  003493
 003494      EndIf;                                                                                     E01                  003494
 003495                                                                                                                      003495
 003496      // Convert END to ENDSL?                                                                                        003496
 003497      If %trim(operator) = 'ENDSL' or %trim(operator) = 'END';                                   B01                  003497
 003498         If slCount > 0;                                                                         B02                  003498
 003499            If slLevel(slCount) = indentCount - 2;                                               B03                  003499
 003500               operator = 'ENDSL';                                                                03                  003500
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     97
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003501            EndIf;                                                                               E03                  003501
 003502         EndIf;                                                                                  E02                  003502
 003503      EndIf;                                                                                     E01                  003503
 003504                                                                                                                      003504
 003505      If %trim(operator) = 'END';                                                                B01                  003505
 003506         If inCase;                                                                              B02                  003506
 003507            operator = 'ENDCS';                                                                   02                  003507
 003508         Else;                                                                                   X02                  003508
 003509            operator = 'ENDIF';                                                                   02                  003509
 003510         EndIf;                                                                                  E02                  003510
 003511      EndIf;                                                                                     E01                  003511
 003512                                                                                                                      003512
 003513      sourceLine = %trim(operator) + ';';                                                                             003513
 003514                                                                                                                      003514
 003515      convert = *On;                                                                                                  003515
 003516                                                                                                                      003516
 003517      If operator = 'ENDCS';                                                                     B01                  003517
 003518         inCase = *Off;                                                                           01                  003518
 003519      EndIf;                                                                                     E01                  003519
 003520                                                                                                                      003520
 003521   EndSr;                                                                                                             003521
 003522   //-------------------------------------------------------------------------------------------                      003522
 003523                                                                                                                      003523
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     98
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003525   //-------------------------------------------------------------------------------------------                      003525
 003526   // Convert EVALx.                                                                                                  003526
 003527   //-------------------------------------------------------------------------------------------                      003527
 003528   BegSr subUserCvt_EVALx;                                                                                            003528
 003529                                                                                                                      003529
 003530      // Returning for a multi-line EVAL - restore the original opcode.                                               003530
 003531      If inEval;                                                                                 B01                  003531
 003532         operator = evalOperator;                                                                 01                  003532
 003533      EndIf;                                                                                     E01                  003533
 003534                                                                                                                      003534
 003535      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003535
 003536                                                                                                                      003536
 003537      If not inEval;          // First line of EVAL.                                             B01                  003537
 003538         inEval = *On;                                                                            01                  003538
 003539         If %scan('H':operator:5) > 0  // Half-adjust.                                           B02                  003539
 003540         or %scan('R':operator:1) > 0; // EVALR.                                                 B02                  003540
 003541            sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                              02                  003541
 003542         Else;                                                                                   X02                  003542
 003543            sourceLine = %trim(extFactor2);                                                       02                  003543
 003544         EndIf;                                                                                  E02                  003544
 003545         If not inSpan;                                                                          B02                  003545
 003546            sourceLine = %trim(sourceLine) + ';';                                                 02                  003546
 003547         Else;                                                                                   X02                  003547
 003548            inSpan = *Off;                                                                        02                  003548
 003549         EndIf;                                                                                  E02                  003549
 003550      Else;                   // Second+ line of EVAL.                                           X01                  003550
 003551         sourceLine = *Blanks;                                                                    01                  003551
 003552         %subst(sourceLine:%len(%trim(operator)) + 2)                                             01                  003552
 003553               = %trim(extFactor2);                                                               01                  003553
 003554         If not inSpan;                                                                          B02                  003554
 003555            sourceLine = %trimr(sourceLine) + ';';                                                02                  003555
 003556         EndIf;                                                                                  E02                  003556
 003557         inSpan = *Off;                                                                           01                  003557
 003558      EndIf;                                                                                     E01                  003558
 003559                                                                                                                      003559
 003560      // Multi-line EVAL?  Save the opcode.                                                                           003560
 003561      If inEval;                                                                                 B01                  003561
 003562         evalOperator = operator;                                                                 01                  003562
 003563      Else;                                                                                      X01                  003563
 003564         evalOperator = *Blanks;                                                                  01                  003564
 003565      EndIf;                                                                                     E01                  003565
 003566                                                                                                                      003566
 003567      convert = *On;                                                                                                  003567
 003568                                                                                                                      003568
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page     99
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003569   EndSr;                                                                                                             003569
 003570   //-------------------------------------------------------------------------------------------                      003570
 003571                                                                                                                      003571
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    100
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003573   //-------------------------------------------------------------------------------------------                      003573
 003574   // Convert EXCEPT.                                                                                                 003574
 003575   //-------------------------------------------------------------------------------------------                      003575
 003576   BegSr subUserCvt_EXCEPT;                                                                                           003576
 003577                                                                                                                      003577
 003578      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003578
 003579                                                                                                                      003579
 003580      convert = *On;                                                                                                  003580
 003581                                                                                                                      003581
 003582   EndSr;                                                                                                             003582
 003583   //-------------------------------------------------------------------------------------------                      003583
 003584                                                                                                                      003584
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    101
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003586   //-------------------------------------------------------------------------------------------                      003586
 003587   // Convert Embedded SQL.                                                                                           003587
 003588   //-------------------------------------------------------------------------------------------                      003588
 003589   BegSr subUserCvt_EXEC_SQL;                                                                                         003589
 003590                                                                                                                      003590
 003591      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003591
 003592                                                                                                                      003592
 003593      If workDirective = '/EXEC SQL';                                                            B01                  003593
 003594         sourceLine = 'Exec SQL';                                                                 01                  003594
 003595         inSQL = *On;                                                                             01                  003595
 003596         inSpan = *Off;                                                                           01                  003596
 003597      Else;                                                                                      X01                  003597
 003598         sourceLine = %trimr(%subst(codeLine:2));                                                 01                  003598
 003599         If not inSpan;                                                                          B02                  003599
 003600            sourceLine = %trim(sourceLine) + ';';                                                 02                  003600
 003601         Else;                                                                                   X02                  003601
 003602            inSQL = *On;                                                                          02                  003602
 003603            inSpan = *Off;                                                                        02                  003603
 003604         EndIf;                                                                                  E02                  003604
 003605      EndIf;                                                                                     E01                  003605
 003606                                                                                                                      003606
 003607      convert = *On;                                                                                                  003607
 003608                                                                                                                      003608
 003609   EndSr;                                                                                                             003609
 003610   //-------------------------------------------------------------------------------------------                      003610
 003611                                                                                                                      003611
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    102
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003613   //-------------------------------------------------------------------------------------------                      003613
 003614   // Convert EXFMT.                                                                                                  003614
 003615   //-------------------------------------------------------------------------------------------                      003615
 003616   BegSr subUserCvt_EXFMT;                                                                                            003616
 003617                                                                                                                      003617
 003618      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003618
 003619                                                                                                                      003619
 003620      // Append datastructure?                                                                                        003620
 003621      If result <> *Blanks;                                                                      B01                  003621
 003622         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003622
 003623      Else;                                                                                      X01                  003623
 003624         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003624
 003625      EndIf;                                                                                     E01                  003625
 003626                                                                                                                      003626
 003627      // Check indicators?                                                                                            003627
 003628      If lw <> *Blanks;                                                                          B01                  003628
 003629         ERRCheck = *On;                                                                          01                  003629
 003630         ERRInd = lw;                                                                             01                  003630
 003631      EndIf;                                                                                     E01                  003631
 003632                                                                                                                      003632
 003633      convert = *On;                                                                                                  003633
 003634                                                                                                                      003634
 003635   EndSr;                                                                                                             003635
 003636   //-------------------------------------------------------------------------------------------                      003636
 003637                                                                                                                      003637
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    103
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003639   //-------------------------------------------------------------------------------------------                      003639
 003640   // Convert EXSR.                                                                                                   003640
 003641   //-------------------------------------------------------------------------------------------                      003641
 003642   BegSr subUserCvt_EXSR;                                                                                             003642
 003643                                                                                                                      003643
 003644      sourceLine = 'ExSr ' + %trim(factor2) + ';';                                                                    003644
 003645                                                                                                                      003645
 003646      convert = *On;                                                                                                  003646
 003647                                                                                                                      003647
 003648   EndSr;                                                                                                             003648
 003649   //-------------------------------------------------------------------------------------------                      003649
 003650                                                                                                                      003650
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    104
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003652   //-------------------------------------------------------------------------------------------                      003652
 003653   // Convert EXTRCT                                                                                                  003653
 003654   //-------------------------------------------------------------------------------------------                      003654
 003655   BegSr subUserCvt_EXTRCT;                                                                                           003655
 003656                                                                                                                      003656
 003657      // Split out duration and code.                                                                                 003657
 003658      x = %scan(':':factor2);                                                                                         003658
 003659      If x = 0;                                                                                  B01                  003659
 003660         nonConvRsn =  'No duration code specified.';                                             01                  003660
 003661         LeaveSr;                                                                                 01                  003661
 003662      EndIf;                                                                                     E01                  003662
 003663                                                                                                                      003663
 003664      durDuration = %trim(%subst(factor2:1:x-1));                                                                     003664
 003665      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         003665
 003666                                                                                                                      003666
 003667      Select;                                                                                    B01                  003667
 003668         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  003668
 003669            durCode = '%years';                                                                   01                  003669
 003670         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  003670
 003671            durCode = '%months';                                                                  01                  003671
 003672         When durCode = '*D' or durCode = '*DAYS';                                               X01                  003672
 003673            durCode = '%days';                                                                    01                  003673
 003674         When durCode = '*H' or durCode = '*HOURS';                                              X01                  003674
 003675            durCode = '%hours';                                                                   01                  003675
 003676         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  003676
 003677            durCode = '%minutes';                                                                 01                  003677
 003678         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  003678
 003679            durCode = '%seconds';                                                                 01                  003679
 003680         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  003680
 003681            durCode = '%mseconds';                                                                01                  003681
 003682         Other;                                                                                  X01                  003682
 003683            nonConvRsn = 'Invalid duration code specified.';                                      01                  003683
 003684            LeaveSr;                                                                              01                  003684
 003685      EndSl;                                                                                     E01                  003685
 003686                                                                                                                      003686
 003687      sourceLine = %trim(result) + ' = %subdt(' + %trim(durDuration)                                                  003687
 003688                 + ':' + %trim(durCode) + ');';                                                                       003688
 003689                                                                                                                      003689
 003690      // Check indicators?                                                                                            003690
 003691      If lw <> *Blanks;                                                                          B01                  003691
 003692         ERRCheck = *On;                                                                          01                  003692
 003693         ERRInd = lw;                                                                             01                  003693
 003694      EndIf;                                                                                     E01                  003694
 003695                                                                                                                      003695
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    105
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003696      convert = *On;                                                                                                  003696
 003697                                                                                                                      003697
 003698   EndSr;                                                                                                             003698
 003699   //-------------------------------------------------------------------------------------------                      003699
 003700                                                                                                                      003700
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    106
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003702   //-------------------------------------------------------------------------------------------                      003702
 003703   // Convert FEOD.                                                                                                   003703
 003704   //-------------------------------------------------------------------------------------------                      003704
 003705   BegSr subUserCvt_FEOD;                                                                                             003705
 003706                                                                                                                      003706
 003707      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003707
 003708                                                                                                                      003708
 003709      // Check indicators?                                                                                            003709
 003710      If lw <> *Blanks;                                                                          B01                  003710
 003711         ERRCheck = *On;                                                                          01                  003711
 003712         ERRInd = lw;                                                                             01                  003712
 003713      EndIf;                                                                                     E01                  003713
 003714                                                                                                                      003714
 003715      convert = *On;                                                                                                  003715
 003716                                                                                                                      003716
 003717   EndSr;                                                                                                             003717
 003718   //-------------------------------------------------------------------------------------------                      003718
 003719                                                                                                                      003719
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    107
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003721   //-------------------------------------------------------------------------------------------                      003721
 003722   // Convert FORCE.                                                                                                  003722
 003723   //-------------------------------------------------------------------------------------------                      003723
 003724   BegSr subUserCvt_FORCE;                                                                                            003724
 003725                                                                                                                      003725
 003726      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003726
 003727                                                                                                                      003727
 003728      convert = *On;                                                                                                  003728
 003729                                                                                                                      003729
 003730   EndSr;                                                                                                             003730
 003731   //-------------------------------------------------------------------------------------------                      003731
 003732                                                                                                                      003732
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    108
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003734   //-------------------------------------------------------------------------------------------                      003734
 003735   // Convert FOR.                                                                                                    003735
 003736   //-------------------------------------------------------------------------------------------                      003736
 003737   BegSr subUserCvt_FOR;                                                                                              003737
 003738                                                                                                                      003738
 003739      sourceLine = 'For ' + %trim(extFactor2) + ';';                                                                  003739
 003740                                                                                                                      003740
 003741      convert = *On;                                                                                                  003741
 003742                                                                                                                      003742
 003743   EndSr;                                                                                                             003743
 003744   //-------------------------------------------------------------------------------------------                      003744
 003745                                                                                                                      003745
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    109
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003747   //-------------------------------------------------------------------------------------------                      003747
 003748   // Convert IF.                                                                                                     003748
 003749   //-------------------------------------------------------------------------------------------                      003749
 003750   BegSr subUserCvt_IF;                                                                                               003750
 003751                                                                                                                      003751
 003752      // Returning for a multi-line IF?  Reinstate original opcode.                                                   003752
 003753      If inIf;                                                                                   B01                  003753
 003754         operator = ifOperator;                                                                   01                  003754
 003755      EndIf;                                                                                     E01                  003755
 003756                                                                                                                      003756
 003757      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003757
 003758                                                                                                                      003758
 003759      If operator = 'IF';     // Use Extended Factor2.                                           B01                  003759
 003760         If not inIf;            // First line of IF.                                            B02                  003760
 003761            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003761
 003762            If not inSpan;                                                                       B03                  003762
 003763               sourceLine = %trim(sourceLine) + ';';                                              03                  003763
 003764            Else;                                                                                X03                  003764
 003765               inIf = *On;                                                                        03                  003765
 003766               inSpan = *Off;                                                                     03                  003766
 003767            EndIf;                                                                               E03                  003767
 003768         Else;                   // Second line of IF.                                           X02                  003768
 003769            //            sourceLine = *Blanks;                                                                       003769
 003770            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003770
 003771            sourceLine = %trim(extFactor2);                                                       02                  003771
 003772            If not inSpan;                                                                       B03                  003772
 003773               sourceLine = %trimr(sourceLine) + ';';                                             03                  003773
 003774               //               inIf = *Off;                                                                          003774
 003775            EndIf;                                                                               E03                  003775
 003776            //            inSpan = *On;                                                                               003776
 003777            inSpan = *Off;                                                                        02                  003777
 003778         EndIf;                                                                                  E02                  003778
 003779      Else;                                                                                      X01                  003779
 003780         // Fixed format.                                                                                             003780
 003781         opCode = %xlate(lo:up:opCode);                                                           01                  003781
 003782         If not inIf;         // First line of IF.                                               B02                  003782
 003783            ifCompare = %subst(opCode:3:2);                                                       02                  003783
 003784            sourceLine = 'If';                                                                    02                  003784
 003785         Else;                // Second line of IF.                                              X02                  003785
 003786            If %subst(opCode:1:3) = 'AND';                                                       B03                  003786
 003787               ifCompare = %subst(opCode:4:2);                                                    03                  003787
 003788               sourceLine = 'And';                                                                03                  003788
 003789            Else;                                                                                X03                  003789
 003790               ifCompare = %subst(opCode:3:2);                                                    03                  003790
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    110
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003791               sourceLine = 'Or';                                                                 03                  003791
 003792            EndIf;                                                                               E03                  003792
 003793         EndIf;                                                                                  E02                  003793
 003794         If ifCompare = 'EQ';                                                                    B02                  003794
 003795            ifCompare = '=';                                                                      02                  003795
 003796         ElseIf ifCompare = 'GT';                                                                X02                  003796
 003797            ifCompare = '>';                                                                      02                  003797
 003798         ElseIf ifCompare = 'GE';                                                                X02                  003798
 003799            ifCompare = '>=';                                                                     02                  003799
 003800         ElseIf ifCompare = 'LT';                                                                X02                  003800
 003801            ifCompare = '<';                                                                      02                  003801
 003802         ElseIf ifCompare = 'LE';                                                                X02                  003802
 003803            ifCompare = '<=';                                                                     02                  003803
 003804         ElseIf ifCompare = 'NE';                                                                X02                  003804
 003805            ifCompare = '<>';                                                                     02                  003805
 003806         EndIf;                                                                                  E02                  003806
 003807         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003807
 003808                            + ' ' + %trim(ifCompare) + ' '                                        01                  003808
 003809                            + %trim(factor2);                                                     01                  003809
 003810         If not inSpan;                                                                          B02                  003810
 003811            sourceLine = %trimr(sourceLine) + ';';                                                02                  003811
 003812            inIf = *Off;                                                                          02                  003812
 003813         Else;                                                                                   X02                  003813
 003814            inIf = *On;                                                                           02                  003814
 003815            inSpan = *Off;                                                                        02                  003815
 003816         EndIf;                                                                                  E02                  003816
 003817      EndIf;                                                                                     E01                  003817
 003818                                                                                                                      003818
 003819      // Multi-line IF?  Retain original opcode.                                                                      003819
 003820      If inIf;                                                                                   B01                  003820
 003821         ifOperator = operator;                                                                   01                  003821
 003822      Else;                                                                                      X01                  003822
 003823         ifOperator = *Blanks;                                                                    01                  003823
 003824      EndIf;                                                                                     E01                  003824
 003825                                                                                                                      003825
 003826      convert = *On;                                                                                                  003826
 003827                                                                                                                      003827
 003828   EndSr;                                                                                                             003828
 003829   //-------------------------------------------------------------------------------------------                      003829
 003830                                                                                                                      003830
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    111
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003832   //-------------------------------------------------------------------------------------------                      003832
 003833   // Convert IN.                                                                                                     003833
 003834   //-------------------------------------------------------------------------------------------                      003834
 003835   BegSr subUserCvt_IN;                                                                                               003835
 003836                                                                                                                      003836
 003837      If factor1 <> *Blanks;                                                                     B01                  003837
 003838         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  003838
 003839                    + %trim(factor2) + ';';                                                       01                  003839
 003840      Else;                                                                                      X01                  003840
 003841         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  003841
 003842      EndIf;                                                                                     E01                  003842
 003843                                                                                                                      003843
 003844      // Set resulting indicators?                                                                                    003844
 003845      If lw <> *Blanks;                                                                          B01                  003845
 003846         ERRCheck = *On;                                                                          01                  003846
 003847         ERRInd = lw;                                                                             01                  003847
 003848      EndIf;                                                                                     E01                  003848
 003849                                                                                                                      003849
 003850      convert = *On;                                                                                                  003850
 003851                                                                                                                      003851
 003852   EndSr;                                                                                                             003852
 003853   //-------------------------------------------------------------------------------------------                      003853
 003854                                                                                                                      003854
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    112
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003856   //-------------------------------------------------------------------------------------------                      003856
 003857   // Convert ITER.                                                                                                   003857
 003858   //-------------------------------------------------------------------------------------------                      003858
 003859   BegSr subUserCvt_ITER;                                                                                             003859
 003860                                                                                                                      003860
 003861      sourceLine = %trim(operator) + ';';                                                                             003861
 003862                                                                                                                      003862
 003863      convert = *On;                                                                                                  003863
 003864                                                                                                                      003864
 003865   EndSr;                                                                                                             003865
 003866   //-------------------------------------------------------------------------------------------                      003866
 003867                                                                                                                      003867
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    113
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003869   //-------------------------------------------------------------------------------------------                      003869
 003870   // Convert LEAVExx.                                                                                                003870
 003871   //-------------------------------------------------------------------------------------------                      003871
 003872   BegSr subUserCvt_LEAVE;                                                                                            003872
 003873                                                                                                                      003873
 003874      sourceLine = %trim(operator) + ';';                                                                             003874
 003875                                                                                                                      003875
 003876      convert = *On;                                                                                                  003876
 003877                                                                                                                      003877
 003878   EndSr;                                                                                                             003878
 003879   //-------------------------------------------------------------------------------------------                      003879
 003880                                                                                                                      003880
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    114
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003882   //-------------------------------------------------------------------------------------------                      003882
 003883   // Convert LOOKUP.                                                                                                 003883
 003884   //-------------------------------------------------------------------------------------------                      003884
 003885   BegSr subUserCvt_LOOKUP;                                                                                           003885
 003886                                                                                                                      003886
 003887      //            If %subst(factor2:1:3) = 'TAB';  // Table lookup.                                                 003887
 003888      //            Else;                            // Array lookup.                                                 003888
 003889      //               // Extract element variable.                                                                   003889
 003890      //               x = %scan('(':factor2);                                                                        003890
 003891      //               If x = 0;   // No variable specified, so use a substitute.                                     003891
 003892      //                  lookupVar = 'lookupIndex';                                                                  003892
 003893      //               Else;                                                                                          003893
 003894      //                  lookupVar = %subst(factor2:x+1:%scan(')':factor2:x)-x-1);                                   003894
 003895      //               EndIf;                                                                                         003895
 003896      //               If eq <> *Blanks and lw <> *Blanks;                                                            003896
 003897      //                  sourceLine = '%lookupLE(';                                                                  003897
 003898      //               ElseIf eq <> *Blanks and hi <> *Blanks;                                                        003898
 003899      //                  sourceLine = '%lookupGE(';                                                                  003899
 003900      //               ElseIf lw <> *Blanks;                                                                          003900
 003901      //                  sourceLine = '%lookupLT(';                                                                  003901
 003902      //               ElseIf hi <> *Blanks;                                                                          003902
 003903      //                  sourceLine = '%lookupGT(';                                                                  003903
 003904      //               Else;                                                                                          003904
 003905      //                  sourceLine = '%lookup(';                                                                    003905
 003906      //               EndIf;                                                                                         003906
 003907      //               sourceLine = %trim(sourceLine) + %trim(factor1) + ':'                                          003907
 003908      //                          + %trim(factor2) + ');';                                                            003908
 003909      //            EndIf;                                                                                            003909
 003910      //            convert = *On;                                                                                    003910
 003911                                                                                                                      003911
 003912   EndSr;                                                                                                             003912
 003913   //-------------------------------------------------------------------------------------------                      003913
 003914                                                                                                                      003914
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    115
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003916   //-------------------------------------------------------------------------------------------                      003916
 003917   // Convert MONITOR.                                                                                                003917
 003918   //-------------------------------------------------------------------------------------------                      003918
 003919   BegSr subUserCvt_MONITOR;                                                                                          003919
 003920                                                                                                                      003920
 003921      sourceLine = 'Monitor;';                                                                                        003921
 003922                                                                                                                      003922
 003923      convert = *On;                                                                                                  003923
 003924                                                                                                                      003924
 003925   EndSr;                                                                                                             003925
 003926   //-------------------------------------------------------------------------------------------                      003926
 003927                                                                                                                      003927
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    116
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003929   //-------------------------------------------------------------------------------------------                      003929
 003930   // Convert MOVE.                                                                                                   003930
 003931   //-------------------------------------------------------------------------------------------                      003931
 003932   BegSr subUserCvt_MOVE;                                                                                             003932
 003933                                                                                                                      003933
 003934      // Pad the result?                                                                                              003934
 003935      x = %scan('P':operator:5);                                                                                      003935
 003936                                                                                                                      003936
 003937      If x > 0 and %subst(operator:5:1) <> 'L';                                                  B01                  003937
 003938         // Move right and pad left.                                                                                  003938
 003939         sourceLine = 'EvalR ' + %trim(result) + ' = ' + %trim(factor2)                           01                  003939
 003940                    + ';';                                                                        01                  003940
 003941                                                                                                                      003941
 003942      ElseIf x > 0 and %subst(operator:5:1) = 'L';                                               X01                  003942
 003943         // Move left and pad right.                                                                                  003943
 003944         sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                               01                  003944
 003945                                                                                                                      003945
 003946      ElseIf factor1 = *Blanks;                                                                  X01                  003946
 003947         // Straight move.                                                                                            003947
 003948         If %lookup(%xlate(lo:up:%trim(result)):QopCodeUp) = 0;                                  B02                  003948
 003949            sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                            02                  003949
 003950         Else;                                                                                   X02                  003950
 003951            // Result is a reserved word - don't convert.                                                             003951
 003952            nonConvRsn = 'Result field name is a reserved word.';                                 02                  003952
 003953            LeaveSr;                                                                              02                  003953
 003954         EndIf;                                                                                  E02                  003954
 003955                                                                                                                      003955
 003956      Else;                                                                                      X01                  003956
 003957         // Conversion from one format to another...                                                                  003957
 003958         //         sourceLine = %xlate(lo:up:factor1);                                                               003958
 003959                                                                                                                      003959
 003960         //         If sourceLine = '*CYMD';   // Date.                                                               003960
 003961         //            sourceLine = %trim(result) + ' = %dec(' + %trim(factor2)                                       003961
 003962         //                       + ':*CYMD);';                                                                       003962
 003963         //         Else;                                                                                             003963
 003964         nonConvRsn = 'Data conversion is needed.';                                               01                  003964
 003965         LeaveSr; // Don't convert.                                                               01                  003965
 003966         //         EndIf;                                                                                            003966
 003967      EndIf;                                                                                     E01                  003967
 003968                                                                                                                      003968
 003969      convert = *On;                                                                                                  003969
 003970                                                                                                                      003970
 003971   EndSr;                                                                                                             003971
 003972   //-------------------------------------------------------------------------------------------                      003972
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    117
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003973                                                                                                                      003973
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    118
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003975   //-------------------------------------------------------------------------------------------                      003975
 003976   // Convert MOVEA.                                                                                                  003976
 003977   //-------------------------------------------------------------------------------------------                      003977
 003978   BegSr subUserCvt_MOVEA;                                                                                            003978
 003979                                                                                                                      003979
 003980      // Not supported.                                                                                               003980
 003981                                                                                                                      003981
 003982   EndSr;                                                                                                             003982
 003983   //-------------------------------------------------------------------------------------------                      003983
 003984                                                                                                                      003984
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    119
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003986   //-------------------------------------------------------------------------------------------                      003986
 003987   // Convert MULT.                                                                                                   003987
 003988   //-------------------------------------------------------------------------------------------                      003988
 003989   BegSr subUserCvt_MULT;                                                                                             003989
 003990                                                                                                                      003990
 003991      // Half-adjust?                                                                                                 003991
 003992      x = %scan('H':operator:4);                                                                                      003992
 003993      If x > 0;                                                                                  B01                  003993
 003994         sourceLine = 'Eval(H)';                                                                  01                  003994
 003995      Else;                                                                                      X01                  003995
 003996         sourceLine = *Blanks;                                                                    01                  003996
 003997      EndIf;                                                                                     E01                  003997
 003998                                                                                                                      003998
 003999      If factor1 = *Blanks;                                                                      B01                  003999
 004000         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004000
 004001                    + ' = ' + %trim(result)                                                       01                  004001
 004002                    + ' * ' + %trim(factor2) +';';                                                01                  004002
 004003      Else;                                                                                      X01                  004003
 004004         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004004
 004005                    + ' = ' + %trim(factor1)                                                      01                  004005
 004006                    + ' * ' + %trim(factor2) + ';';                                               01                  004006
 004007      EndIf;                                                                                     E01                  004007
 004008                                                                                                                      004008
 004009      sourceLine = %trim(sourceLine);                                                                                 004009
 004010                                                                                                                      004010
 004011      convert = *On;                                                                                                  004011
 004012                                                                                                                      004012
 004013   EndSr;                                                                                                             004013
 004014   //-------------------------------------------------------------------------------------------                      004014
 004015                                                                                                                      004015
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    120
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004017   //-------------------------------------------------------------------------------------------                      004017
 004018   // Convert MVR.                                                                                                    004018
 004019   //-------------------------------------------------------------------------------------------                      004019
 004020   BegSr subUserCvt_MVR;                                                                                              004020
 004021                                                                                                                      004021
 004022      sourceLine = %trim(result) + ' = %rem(' + %trim(divFactor1)                                                     004022
 004023                 + ':' + %trim(divFactor2) + ');';                                                                    004023
 004024                                                                                                                      004024
 004025      convert = *On;                                                                                                  004025
 004026                                                                                                                      004026
 004027   EndSr;                                                                                                             004027
 004028   //-------------------------------------------------------------------------------------------                      004028
 004029                                                                                                                      004029
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    121
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004031   //-------------------------------------------------------------------------------------------                      004031
 004032   // Convert NEXT.                                                                                                   004032
 004033   //-------------------------------------------------------------------------------------------                      004033
 004034   BegSr subUserCvt_NEXT;                                                                                             004034
 004035                                                                                                                      004035
 004036      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004036
 004037                 + %trim(factor2) + ';';                                                                              004037
 004038                                                                                                                      004038
 004039                                                                                                                      004039
 004040      // Check indicators?                                                                                            004040
 004041      If lw <> *Blanks;                                                                          B01                  004041
 004042         ERRCheck = *On;                                                                          01                  004042
 004043         ERRInd = lw;                                                                             01                  004043
 004044      EndIf;                                                                                     E01                  004044
 004045                                                                                                                      004045
 004046      convert = *On;                                                                                                  004046
 004047                                                                                                                      004047
 004048   EndSr;                                                                                                             004048
 004049   //-------------------------------------------------------------------------------------------                      004049
 004050                                                                                                                      004050
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    122
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004052   //-------------------------------------------------------------------------------------------                      004052
 004053   // Convert OCCUR.                                                                                                  004053
 004054   //-------------------------------------------------------------------------------------------                      004054
 004055   BegSr subUserCvt_OCCUR;                                                                                            004055
 004056                                                                                                                      004056
 004057      If factor1 = *Blanks;      // Get occurrence.                                              B01                  004057
 004058         sourceLine = %trim(result) + ' = ' + '%occur('                                           01                  004058
 004059                    + %trim(factor2) + ');';                                                      01                  004059
 004060      ElseIf result = *Blanks;   // Set occurrent.                                               X01                  004060
 004061         sourceLine = '%occur(' + %trim(factor2) + ') = '                                         01                  004061
 004062                    + %trim(factor1) + ';';                                                       01                  004062
 004063      Else;                                                                                      X01                  004063
 004064         nonConvRsn = 'Cannot determine of OCCUR is used to set or '                              01                  004064
 004065                    + 'get the occurrence.';                                                      01                  004065
 004066         LeaveSr;                                                                                 01                  004066
 004067      EndIf;                                                                                     E01                  004067
 004068                                                                                                                      004068
 004069      // Check resulting indicators?                                                                                  004069
 004070      If lw <> *Blanks;                                                                          B01                  004070
 004071         ERRCheck = *On;                                                                          01                  004071
 004072         ERRInd = lw;                                                                             01                  004072
 004073      EndIf;                                                                                     E01                  004073
 004074                                                                                                                      004074
 004075      convert = *On;                                                                                                  004075
 004076                                                                                                                      004076
 004077   EndSr;                                                                                                             004077
 004078   //-------------------------------------------------------------------------------------------                      004078
 004079                                                                                                                      004079
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    123
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004081   //-------------------------------------------------------------------------------------------                      004081
 004082   // Convert ON-ERROR.                                                                                               004082
 004083   //-------------------------------------------------------------------------------------------                      004083
 004084   BegSr subUserCvt_ON_ERROR;                                                                                         004084
 004085                                                                                                                      004085
 004086      If extFactor2 = *Blanks;                                                                   B01                  004086
 004087         sourceLine = %trim(operator) + ';';                                                      01                  004087
 004088      Else;                                                                                      X01                  004088
 004089         sourceLine = %trim(operator) + ' ' + %trim(extFactor2) + ';';                            01                  004089
 004090      EndIf;                                                                                     E01                  004090
 004091                                                                                                                      004091
 004092      convert = *On;                                                                                                  004092
 004093                                                                                                                      004093
 004094   EndSr;                                                                                                             004094
 004095   //-------------------------------------------------------------------------------------------                      004095
 004096                                                                                                                      004096
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    124
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004098   //-------------------------------------------------------------------------------------------                      004098
 004099   // Convert OPEN.                                                                                                   004099
 004100   //-------------------------------------------------------------------------------------------                      004100
 004101   BegSr subUserCvt_OPEN;                                                                                             004101
 004102                                                                                                                      004102
 004103      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004103
 004104                                                                                                                      004104
 004105      // Check resulting indicators?                                                                                  004105
 004106      If lw <> *Blanks;                                                                          B01                  004106
 004107         ERRCheck = *On;                                                                          01                  004107
 004108         ERRInd = lw;                                                                             01                  004108
 004109      EndIf;                                                                                     E01                  004109
 004110                                                                                                                      004110
 004111      convert = *On;                                                                                                  004111
 004112                                                                                                                      004112
 004113   EndSr;                                                                                                             004113
 004114   //-------------------------------------------------------------------------------------------                      004114
 004115                                                                                                                      004115
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    125
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004117   //-------------------------------------------------------------------------------------------                      004117
 004118   // Convert OTHER.                                                                                                  004118
 004119   //-------------------------------------------------------------------------------------------                      004119
 004120   BegSr subUserCvt_OTHER;                                                                                            004120
 004121                                                                                                                      004121
 004122      sourceLine = 'Other;';                                                                                          004122
 004123                                                                                                                      004123
 004124      convert = *On;                                                                                                  004124
 004125                                                                                                                      004125
 004126   EndSr;                                                                                                             004126
 004127   //-------------------------------------------------------------------------------------------                      004127
 004128                                                                                                                      004128
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    126
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004130   //-------------------------------------------------------------------------------------------                      004130
 004131   // Convert OUT.                                                                                                    004131
 004132   //-------------------------------------------------------------------------------------------                      004132
 004133   BegSr subUserCvt_OUT;                                                                                              004133
 004134                                                                                                                      004134
 004135      If factor1 = *Blanks;                                                                      B01                  004135
 004136         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004136
 004137      Else;                                                                                      X01                  004137
 004138         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004138
 004139                    + %trim(factor2) + ';';                                                       01                  004139
 004140      EndIf;                                                                                     E01                  004140
 004141                                                                                                                      004141
 004142      // Set resulting indicators?                                                                                    004142
 004143      If lw <> *Blanks;                                                                          B01                  004143
 004144         ERRCheck = *On;                                                                          01                  004144
 004145         ERRInd = lw;                                                                             01                  004145
 004146      EndIf;                                                                                     E01                  004146
 004147                                                                                                                      004147
 004148      convert = *On;                                                                                                  004148
 004149                                                                                                                      004149
 004150   EndSr;                                                                                                             004150
 004151   //-------------------------------------------------------------------------------------------                      004151
 004152                                                                                                                      004152
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    127
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004154   //-------------------------------------------------------------------------------------------                      004154
 004155   // Convert POST.                                                                                                   004155
 004156   //-------------------------------------------------------------------------------------------                      004156
 004157   BegSr subUserCvt_POST;                                                                                             004157
 004158                                                                                                                      004158
 004159      If factor2 = *Blanks;                                                                      B01                  004159
 004160         nonConvRsn =  'No filename specified in Factor2.';                                       01                  004160
 004161         LeaveSr;                                                                                 01                  004161
 004162      EndIf;                                                                                     E01                  004162
 004163                                                                                                                      004163
 004164      If result <> *Blanks;                                                                      B01                  004164
 004165         nonConvRsn =  'INFDS specified in result.';                                              01                  004165
 004166         LeaveSr;                                                                                 01                  004166
 004167      EndIf;                                                                                     E01                  004167
 004168                                                                                                                      004168
 004169      If factor1 = *Blanks;                                                                      B01                  004169
 004170         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004170
 004171      Else;                                                                                      X01                  004171
 004172         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004172
 004173                    + %trim(factor2) + ';';                                                       01                  004173
 004174      EndIf;                                                                                     E01                  004174
 004175                                                                                                                      004175
 004176      // Set resulting indicators?                                                                                    004176
 004177      If lw <> *Blanks;                                                                          B01                  004177
 004178         ERRCheck = *On;                                                                          01                  004178
 004179         ERRInd = lw;                                                                             01                  004179
 004180      EndIf;                                                                                     E01                  004180
 004181                                                                                                                      004181
 004182      convert = *On;                                                                                                  004182
 004183                                                                                                                      004183
 004184   EndSr;                                                                                                             004184
 004185   //-------------------------------------------------------------------------------------------                      004185
 004186                                                                                                                      004186
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    128
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004188   //-------------------------------------------------------------------------------------------                      004188
 004189   // Convert READ.                                                                                                   004189
 004190   //-------------------------------------------------------------------------------------------                      004190
 004191   BegSr subUserCvt_READ;                                                                                             004191
 004192                                                                                                                      004192
 004193      If factor1 <> *Blanks;                                                                     B01                  004193
 004194         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004194
 004195                    + %trim(factor2);                                                             01                  004195
 004196      Else;                                                                                      X01                  004196
 004197         sourceLine = %trim(operator) + ' ' + %trim(factor2);                                     01                  004197
 004198      EndIf;                                                                                     E01                  004198
 004199                                                                                                                      004199
 004200      // Append datastructure?                                                                                        004200
 004201      If result <> *Blanks;                                                                      B01                  004201
 004202         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004202
 004203      Else;                                                                                      X01                  004203
 004204         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004204
 004205      EndIf;                                                                                     E01                  004205
 004206                                                                                                                      004206
 004207      // Check indicators?                                                                                            004207
 004208      If eq <> *Blanks;                                                                          B01                  004208
 004209         EOFCheck = *On;                                                                          01                  004209
 004210         EOFInd = eq;                                                                             01                  004210
 004211         EOFFile = %trim(factor2);                                                                01                  004211
 004212      EndIf;                                                                                     E01                  004212
 004213      If lw <> *Blanks;                                                                          B01                  004213
 004214         ERRCheck = *On;                                                                          01                  004214
 004215         ERRInd = lw;                                                                             01                  004215
 004216      EndIf;                                                                                     E01                  004216
 004217                                                                                                                      004217
 004218      convert = *On;                                                                                                  004218
 004219                                                                                                                      004219
 004220   EndSr;                                                                                                             004220
 004221   //-------------------------------------------------------------------------------------------                      004221
 004222                                                                                                                      004222
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    129
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004224   //-------------------------------------------------------------------------------------------                      004224
 004225   // Convert REALLOC.                                                                                                004225
 004226   //-------------------------------------------------------------------------------------------                      004226
 004227   BegSr subUserCvt_REALLOC;                                                                                          004227
 004228                                                                                                                      004228
 004229      sourceLine = %trim(result) + ' = %realloc(' + %trim(factor2)                                                    004229
 004230                 + ');';                                                                                              004230
 004231                                                                                                                      004231
 004232      // Set resulting indicators?                                                                                    004232
 004233      If lw <> *Blanks;                                                                          B01                  004233
 004234         ERRCheck = *On;                                                                          01                  004234
 004235         ERRInd = lw;                                                                             01                  004235
 004236      EndIf;                                                                                     E01                  004236
 004237                                                                                                                      004237
 004238      convert = *On;                                                                                                  004238
 004239                                                                                                                      004239
 004240   EndSr;                                                                                                             004240
 004241   //-------------------------------------------------------------------------------------------                      004241
 004242                                                                                                                      004242
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    130
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004244   //-------------------------------------------------------------------------------------------                      004244
 004245   // Convert REL.                                                                                                    004245
 004246   //-------------------------------------------------------------------------------------------                      004246
 004247   BegSr subUserCvt_REL;                                                                                              004247
 004248                                                                                                                      004248
 004249      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             004249
 004250                 + ' ' + %trim(factor2) + ';';                                                                        004250
 004251                                                                                                                      004251
 004252      // Check resulting indicators?                                                                                  004252
 004253      If lw <> *Blanks;                                                                          B01                  004253
 004254         ERRCheck = *On;                                                                          01                  004254
 004255         ERRInd = lw;                                                                             01                  004255
 004256      EndIf;                                                                                     E01                  004256
 004257                                                                                                                      004257
 004258      convert = *On;                                                                                                  004258
 004259                                                                                                                      004259
 004260   EndSr;                                                                                                             004260
 004261   //-------------------------------------------------------------------------------------------                      004261
 004262                                                                                                                      004262
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    131
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004264   //-------------------------------------------------------------------------------------------                      004264
 004265   // Convert RESET.                                                                                                  004265
 004266   //-------------------------------------------------------------------------------------------                      004266
 004267   BegSr subUserCvt_RESET;                                                                                            004267
 004268                                                                                                                      004268
 004269      sourceLine = %trim(operator);                                                                                   004269
 004270                                                                                                                      004270
 004271      If factor1 <> *Blanks;                                                                     B01                  004271
 004272         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  004272
 004273      EndIf;                                                                                     E01                  004273
 004274                                                                                                                      004274
 004275      If factor2 <> *Blanks;                                                                     B01                  004275
 004276         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                                  01                  004276
 004277      EndIf;                                                                                     E01                  004277
 004278                                                                                                                      004278
 004279      sourceLine = %trimr(sourceLine) + ' ' + %trim(result) + ';';                                                    004279
 004280                                                                                                                      004280
 004281      // Check indicators?                                                                                            004281
 004282      If hi <> *Blanks;                                                                          B01                  004282
 004283         NRFCheck = *On;                                                                          01                  004283
 004284         NRFInd = eq;                                                                             01                  004284
 004285         NRFFile = %trim(factor2);                                                                01                  004285
 004286      EndIf;                                                                                     E01                  004286
 004287      If lw <> *Blanks;                                                                          B01                  004287
 004288         ERRCheck = *On;                                                                          01                  004288
 004289         ERRInd = lw;                                                                             01                  004289
 004290      EndIf;                                                                                     E01                  004290
 004291                                                                                                                      004291
 004292      convert = *On;                                                                                                  004292
 004293                                                                                                                      004293
 004294   EndSr;                                                                                                             004294
 004295   //-------------------------------------------------------------------------------------------                      004295
 004296                                                                                                                      004296
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    132
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004298   //-------------------------------------------------------------------------------------------                      004298
 004299   // Convert RETURN;                                                                                                 004299
 004300   //-------------------------------------------------------------------------------------------                      004300
 004301   BegSr subUserCvt_RETURN;                                                                                           004301
 004302                                                                                                                      004302
 004303      sourceLine = 'Return ' + %trim(%subst(operator:7))                                                              004303
 004304                 + ' ' + %trim(extFactor2) + ';';                                                                     004304
 004305                                                                                                                      004305
 004306      convert = *On;                                                                                                  004306
 004307                                                                                                                      004307
 004308   EndSr;                                                                                                             004308
 004309   //-------------------------------------------------------------------------------------------                      004309
 004310                                                                                                                      004310
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    133
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004312   //-------------------------------------------------------------------------------------------                      004312
 004313   // Convert ROLBK.                                                                                                  004313
 004314   //-------------------------------------------------------------------------------------------                      004314
 004315   BegSr subUserCvt_ROLBK;                                                                                            004315
 004316                                                                                                                      004316
 004317      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            004317
 004318                                                                                                                      004318
 004319      sourceLine = %trim(sourceLine)  + ';';                                                                          004319
 004320                                                                                                                      004320
 004321      // Check indicators?                                                                                            004321
 004322      If lw <> *Blanks;                                                                          B01                  004322
 004323         ERRCheck = *On;                                                                          01                  004323
 004324         ERRInd = lw;                                                                             01                  004324
 004325      EndIf;                                                                                     E01                  004325
 004326                                                                                                                      004326
 004327      convert = *On;                                                                                                  004327
 004328                                                                                                                      004328
 004329   EndSr;                                                                                                             004329
 004330   //-------------------------------------------------------------------------------------------                      004330
 004331                                                                                                                      004331
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    134
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004333   //-------------------------------------------------------------------------------------------                      004333
 004334   // Convert SCAN.                                                                                                   004334
 004335   //-------------------------------------------------------------------------------------------                      004335
 004336   BegSr subUserCvt_SCAN;                                                                                             004336
 004337                                                                                                                      004337
 004338      // Determine length of comparator.                                                                              004338
 004339      x = %scan(':':factor1);                                                                                         004339
 004340      If x = 0;   // No length specified.                                                        B01                  004340
 004341         scanLength = *Blanks;               // Scan length                                       01                  004341
 004342         scanString = %trim(factor1);        // Scan string                                       01                  004342
 004343      Else;                                                                                      X01                  004343
 004344         scanLength = %subst(factor1:x+1);   // Scan length                                       01                  004344
 004345         scanString = %subst(factor1:1:x-1); // Scan string                                       01                  004345
 004346      EndIf;                                                                                     E01                  004346
 004347                                                                                                                      004347
 004348      // Determine starting point.                                                                                    004348
 004349      x = %scan(':':factor2);                                                                                         004349
 004350      If x = 0;   // No start specified.                                                         B01                  004350
 004351         scanStart = '1';                    // Start position                                    01                  004351
 004352         scanBase = %trim(factor2);          // Base string                                       01                  004352
 004353      Else;                                                                                      X01                  004353
 004354         scanStart = %subst(factor2:x+1);    // Start position                                    01                  004354
 004355         scanBase = %subst(factor2:1:x-1);   // Base string                                       01                  004355
 004356      EndIf;                                                                                     E01                  004356
 004357                                                                                                                      004357
 004358      // Build the new line.                                                                                          004358
 004359      If scanLength = *Blanks;                                                                   B01                  004359
 004360         // No length specified.                                                                                      004360
 004361         sourceLine = '%scan(' + %trim(scanString)                                                01                  004361
 004362                    + ':' + %trim(scanBase) + ':' + %trim(scanStart)                              01                  004362
 004363                    + ')';                                                                        01                  004363
 004364      Else;                                                                                      X01                  004364
 004365         // Use a subset of the scan string.                                                                          004365
 004366         sourceLine = '%scan(%subst('                                                             01                  004366
 004367                    + %trim(scanString) + ':1:' + %trim(scanLength)                               01                  004367
 004368                    + '):' + %trim(scanBase) + ':' + %trim(scanStart)                             01                  004368
 004369                    + ')';                                                                        01                  004369
 004370      EndIf;                                                                                     E01                  004370
 004371                                                                                                                      004371
 004372      // Result specified?                                                                                            004372
 004373      If result = *Blanks;                                                                       B01                  004373
 004374         scanNoResult = *On;                                                                      01                  004374
 004375         sourceLine = 'If ' + %trimr(sourceLine) + ' = 0;';                                       01                  004375
 004376      Else;                                                                                      X01                  004376
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    135
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004377         scanNoResult = *Off;                                                                     01                  004377
 004378         sourceLine = %trim(result) + ' = ' + %trimr(sourceLine) + ';';                           01                  004378
 004379      EndIf;                                                                                     E01                  004379
 004380                                                                                                                      004380
 004381      // Set resulting indicators?                                                                                    004381
 004382      If lw <> *Blanks;                                                                          B01                  004382
 004383         ERRCheck = *On;                                                                          01                  004383
 004384         ERRInd = lw;                                                                             01                  004384
 004385      EndIf;                                                                                     E01                  004385
 004386      If eq <> *Blanks;                                                                          B01                  004386
 004387         foundCheck = *On;                                                                        01                  004387
 004388         foundInd = eq;                                                                           01                  004388
 004389      EndIf;                                                                                     E01                  004389
 004390                                                                                                                      004390
 004391      convert = *On;                                                                                                  004391
 004392                                                                                                                      004392
 004393   EndSr;                                                                                                             004393
 004394   //-------------------------------------------------------------------------------------------                      004394
 004395                                                                                                                      004395
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    136
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004397   //-------------------------------------------------------------------------------------------                      004397
 004398   // Convert SELECT                                                                                                  004398
 004399   //-------------------------------------------------------------------------------------------                      004399
 004400   BegSr subUserCvt_SELECT;                                                                                           004400
 004401                                                                                                                      004401
 004402      sourceLine = 'Select;';                                                                                         004402
 004403                                                                                                                      004403
 004404      convert = *On;                                                                                                  004404
 004405                                                                                                                      004405
 004406   EndSr;                                                                                                             004406
 004407   //-------------------------------------------------------------------------------------------                      004407
 004408                                                                                                                      004408
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    137
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004410   //-------------------------------------------------------------------------------------------                      004410
 004411   // Convert SETOFF                                                                                                  004411
 004412   //-------------------------------------------------------------------------------------------                      004412
 004413   BegSr subUserCvt_SETOFF;                                                                                           004413
 004414                                                                                                                      004414
 004415      setOff = *On;                                                                                                   004415
 004416      setOffInd1 = hi;                                                                                                004416
 004417      setOffInd2 = lw;                                                                                                004417
 004418      setOffInd3 = eq;                                                                                                004418
 004419                                                                                                                      004419
 004420      dropLine = *On;                                                                                                 004420
 004421                                                                                                                      004421
 004422      convert = *On;                                                                                                  004422
 004423                                                                                                                      004423
 004424   EndSr;                                                                                                             004424
 004425   //-------------------------------------------------------------------------------------------                      004425
 004426                                                                                                                      004426
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    138
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004428   //-------------------------------------------------------------------------------------------                      004428
 004429   // Convert SETON                                                                                                   004429
 004430   //-------------------------------------------------------------------------------------------                      004430
 004431   BegSr subUserCvt_SETON;                                                                                            004431
 004432                                                                                                                      004432
 004433      setOn = *On;                                                                                                    004433
 004434      setOnInd1 = hi;                                                                                                 004434
 004435      setOnInd2 = lw;                                                                                                 004435
 004436      setOnInd3 = eq;                                                                                                 004436
 004437                                                                                                                      004437
 004438      dropLine = *On;                                                                                                 004438
 004439                                                                                                                      004439
 004440      convert = *On;                                                                                                  004440
 004441                                                                                                                      004441
 004442   EndSr;                                                                                                             004442
 004443   //-------------------------------------------------------------------------------------------                      004443
 004444                                                                                                                      004444
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    139
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004446   //-------------------------------------------------------------------------------------------                      004446
 004447   // Convert SETxx.                                                                                                  004447
 004448   //-------------------------------------------------------------------------------------------                      004448
 004449   BegSr subUserCvt_SETxx;                                                                                            004449
 004450                                                                                                                      004450
 004451      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004451
 004452                 + %trim(factor2);                                                                                    004452
 004453      If result <> *Blanks;                                                                      B01                  004453
 004454         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004454
 004455      Else;                                                                                      X01                  004455
 004456         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004456
 004457      EndIf;                                                                                     E01                  004457
 004458                                                                                                                      004458
 004459      // Check resulting indicators.                                                                                  004459
 004460      If hi <> *Blanks;                                                                          B01                  004460
 004461         NRFCheck = *On;                                                                          01                  004461
 004462         NRFInd = hi;                                                                             01                  004462
 004463         NRFFile = %trim(factor2);                                                                01                  004463
 004464      EndIf;                                                                                     E01                  004464
 004465      If eq <> *Blanks;                                                                          B01                  004465
 004466         equalCheck = *On;                                                                        01                  004466
 004467         equalInd = eq;                                                                           01                  004467
 004468      EndIf;                                                                                     E01                  004468
 004469      If lw <> *Blanks;                                                                          B01                  004469
 004470         ERRCheck = *On;                                                                          01                  004470
 004471         ERRInd = lw;                                                                             01                  004471
 004472      EndIf;                                                                                     E01                  004472
 004473                                                                                                                      004473
 004474      convert = *On;                                                                                                  004474
 004475                                                                                                                      004475
 004476   EndSr;                                                                                                             004476
 004477   //-------------------------------------------------------------------------------------------                      004477
 004478                                                                                                                      004478
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    140
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004480   //-------------------------------------------------------------------------------------------                      004480
 004481   // Convert SHTDN                                                                                                   004481
 004482   //-------------------------------------------------------------------------------------------                      004482
 004483   BegSr subUserCvt_SHTDN;                                                                                            004483
 004484                                                                                                                      004484
 004485      sourceLine = '*IN' + hi + ' = %shtdn();';                                                                       004485
 004486                                                                                                                      004486
 004487      convert = *On;                                                                                                  004487
 004488                                                                                                                      004488
 004489   EndSr;                                                                                                             004489
 004490   //-------------------------------------------------------------------------------------------                      004490
 004491                                                                                                                      004491
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    141
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004493   //-------------------------------------------------------------------------------------------                      004493
 004494   // Convert SORTA.                                                                                                  004494
 004495   //-------------------------------------------------------------------------------------------                      004495
 004496   BegSr subUserCvt_SORTA;                                                                                            004496
 004497                                                                                                                      004497
 004498      sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                                                         004498
 004499                                                                                                                      004499
 004500      sourceLine = %trim(sourceLine)  + ';';                                                                          004500
 004501                                                                                                                      004501
 004502      convert = *On;                                                                                                  004502
 004503                                                                                                                      004503
 004504   EndSr;                                                                                                             004504
 004505   //-------------------------------------------------------------------------------------------                      004505
 004506                                                                                                                      004506
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    142
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004508   //-------------------------------------------------------------------------------------------                      004508
 004509   // Convert SQRT.                                                                                                   004509
 004510   //-------------------------------------------------------------------------------------------                      004510
 004511   BegSr subUserCvt_SQRT;                                                                                             004511
 004512                                                                                                                      004512
 004513      sourceLine = %trim(result) + ' = %sqrt(' + %trim(factor2) + ');';                                               004513
 004514                                                                                                                      004514
 004515      convert = *On;                                                                                                  004515
 004516                                                                                                                      004516
 004517   EndSr;                                                                                                             004517
 004518   //-------------------------------------------------------------------------------------------                      004518
 004519                                                                                                                      004519
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    143
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004521   //-------------------------------------------------------------------------------------------                      004521
 004522   // Convert SUB.                                                                                                    004522
 004523   //-------------------------------------------------------------------------------------------                      004523
 004524   BegSr subUserCvt_SUB;                                                                                              004524
 004525                                                                                                                      004525
 004526      // Half-adjust?                                                                                                 004526
 004527      x = %scan('H':operator:4);                                                                                      004527
 004528      If x > 0;                                                                                  B01                  004528
 004529         operator = 'SUB';                                                                        01                  004529
 004530         sourceLine = 'Eval(H)';                                                                  01                  004530
 004531      Else;                                                                                      X01                  004531
 004532         sourceLine = *Blanks;                                                                    01                  004532
 004533      EndIf;                                                                                     E01                  004533
 004534                                                                                                                      004534
 004535      If factor1 = *Blanks;                                                                      B01                  004535
 004536         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004536
 004537                    + ' = ' + %trim(result)                                                       01                  004537
 004538                    + ' - ' + %trim(factor2) +';';                                                01                  004538
 004539      Else;                                                                                      X01                  004539
 004540         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004540
 004541                    + ' = ' + %trim(factor1)                                                      01                  004541
 004542                    + ' - ' + %trim(factor2) + ';';                                               01                  004542
 004543      EndIf;                                                                                     E01                  004543
 004544                                                                                                                      004544
 004545      sourceLine = %trim(sourceLine);                                                                                 004545
 004546                                                                                                                      004546
 004547      convert = *On;                                                                                                  004547
 004548                                                                                                                      004548
 004549   EndSr;                                                                                                             004549
 004550   //-------------------------------------------------------------------------------------------                      004550
 004551                                                                                                                      004551
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    144
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004553   //-------------------------------------------------------------------------------------------                      004553
 004554   // Convert SUBDUR.                                                                                                 004554
 004555   //-------------------------------------------------------------------------------------------                      004555
 004556   BegSr subUserCvt_SUBDUR;                                                                                           004556
 004557                                                                                                                      004557
 004558      // Split out duration and code.                                                                                 004558
 004559      x = %scan(':':factor2);                                                                                         004559
 004560      If x = 0;                                                                                  B01                  004560
 004561         x = %scan(':':result);                                                                   01                  004561
 004562         If x = 0;                                                                               B02                  004562
 004563            nonConvRsn =  'No duration code specified.';                                          02                  004563
 004564            LeaveSr;                                                                              02                  004564
 004565         Else;                                                                                   X02                  004565
 004566            durNewDate = *Off;                                                                    02                  004566
 004567         EndIf;                                                                                  E02                  004567
 004568      Else;                                                                                      X01                  004568
 004569         durNewDate = *On;                                                                        01                  004569
 004570      EndIf;                                                                                     E01                  004570
 004571                                                                                                                      004571
 004572      If durNewDate;                                                                             B01                  004572
 004573         durDuration = %trim(%subst(factor2:1:x-1));                                              01                  004573
 004574         durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                  01                  004574
 004575                                                                                                                      004575
 004576         Select;                                                                                 B02                  004576
 004577            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004577
 004578               durCode = '%years';                                                                02                  004578
 004579            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004579
 004580               durCode = '%months';                                                               02                  004580
 004581            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004581
 004582               durCode = '%days';                                                                 02                  004582
 004583            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004583
 004584               durCode = '%hours';                                                                02                  004584
 004585            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004585
 004586               durCode = '%minutes';                                                              02                  004586
 004587            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004587
 004588               durCode = '%seconds';                                                              02                  004588
 004589            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004589
 004590               durCode = '%mseconds';                                                             02                  004590
 004591            Other;                                                                               X02                  004591
 004592               nonConvRsn = 'Invalid duration code specified.';                                   02                  004592
 004593               LeaveSr;                                                                           02                  004593
 004594         EndSl;                                                                                  E02                  004594
 004595                                                                                                                      004595
 004596         If factor1 = *Blanks;                                                                   B02                  004596
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    145
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004597            sourceLine = %trim(result) + ' = ' + %trim(result);                                   02                  004597
 004598         Else;                                                                                   X02                  004598
 004599            sourceLine = %trim(result) + ' = ' + %trim(factor1);                                  02                  004599
 004600         EndIf;                                                                                  E02                  004600
 004601                                                                                                                      004601
 004602         sourceLine = %trimr(sourceLine) + ' - ' + %trim(durCode)                                 01                  004602
 004603                    + '(' + %trim(durDuration) + ');';                                            01                  004603
 004604      Else;                                                                                      X01                  004604
 004605         durDuration = %trim(%subst(result:1:x-1));                                               01                  004605
 004606         durCode     = %xlate(lo:up:%trim(%subst(result:x+1)));                                   01                  004606
 004607                                                                                                                      004607
 004608         Select;                                                                                 B02                  004608
 004609            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004609
 004610            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004610
 004611            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004611
 004612            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004612
 004613            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004613
 004614            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004614
 004615            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004615
 004616            Other;                                                                               X02                  004616
 004617               nonConvRsn = 'Invalid duration code specified.';                                   02                  004617
 004618               LeaveSr;                                                                           02                  004618
 004619         EndSl;                                                                                  E02                  004619
 004620                                                                                                                      004620
 004621         sourceLine = %trim(durDuration) + ' = %diff(' + %trim(factor1)                           01                  004621
 004622                    + ':' + %trim(factor2) + ':' + %trim(durCode) + ');';                         01                  004622
 004623      EndIf;                                                                                     E01                  004623
 004624                                                                                                                      004624
 004625      // Set resulting indicators?                                                                                    004625
 004626      If lw <> *Blanks;                                                                          B01                  004626
 004627         ERRCheck = *On;                                                                          01                  004627
 004628         ERRInd = lw;                                                                             01                  004628
 004629      EndIf;                                                                                     E01                  004629
 004630                                                                                                                      004630
 004631      convert = *On;                                                                                                  004631
 004632                                                                                                                      004632
 004633   EndSr;                                                                                                             004633
 004634   //-------------------------------------------------------------------------------------------                      004634
 004635                                                                                                                      004635
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    146
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004637   //-------------------------------------------------------------------------------------------                      004637
 004638   // Convert SUBST.                                                                                                  004638
 004639   //-------------------------------------------------------------------------------------------                      004639
 004640   BegSr subUserCvt_SUBST;                                                                                            004640
 004641                                                                                                                      004641
 004642      // Pad the result?                                                                                              004642
 004643      x = %scan('P':operator:4);                                                                                      004643
 004644      If x = 0                                              // Not padding.                      B01                  004644
 004645      and factor1 <> *Blanks                                // Factor1 specified.                B01                  004645
 004646      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  004646
 004647         nonConvRsn = 'No padding specified, and factor1 and result '                             01                  004647
 004648                    + 'are not the same.';                                                        01                  004648
 004649         LeaveSr;    // Don't convert - too difficult to get right.                               01                  004649
 004650      EndIf;                                                                                     E01                  004650
 004651                                                                                                                      004651
 004652      substLen = %trim(factor1);                                                                                      004652
 004653                                                                                                                      004653
 004654      x = %scan(':':factor2);                                                                                         004654
 004655      If x = 0;                                                                                  B01                  004655
 004656         substStart = '1';                                                                        01                  004656
 004657         x = %len(%trim(factor2)) + 1;                                                            01                  004657
 004658      Else;                                                                                      X01                  004658
 004659         substStart = %subst(factor2:x+1);                                                        01                  004659
 004660      EndIf;                                                                                     E01                  004660
 004661                                                                                                                      004661
 004662      sourceLine = %trim(result) + ' = %subst('                                                                       004662
 004663                 + %subst(factor2:1:x-1) + ':'                                                                        004663
 004664                 + %trim(substStart)                                                                                  004664
 004665                 + ':' + %trim(substLen) + ');';                                                                      004665
 004666                                                                                                                      004666
 004667      // Set resulting indicators?                                                                                    004667
 004668      If lw <> *Blanks;                                                                          B01                  004668
 004669         ERRCheck = *On;                                                                          01                  004669
 004670         ERRInd = lw;                                                                             01                  004670
 004671      EndIf;                                                                                     E01                  004671
 004672                                                                                                                      004672
 004673      convert = *On;                                                                                                  004673
 004674                                                                                                                      004674
 004675   EndSr;                                                                                                             004675
 004676   //-------------------------------------------------------------------------------------------                      004676
 004677                                                                                                                      004677
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    147
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004679   //-------------------------------------------------------------------------------------------                      004679
 004680   // Convert TEST.                                                                                                   004680
 004681   //-------------------------------------------------------------------------------------------                      004681
 004682   BegSr subUserCvt_TEST;                                                                                             004682
 004683                                                                                                                      004683
 004684      If operator = 'TEST';                                                                      B01                  004684
 004685         operator = 'Test(E)';                                                                    01                  004685
 004686      EndIf;                                                                                     E01                  004686
 004687                                                                                                                      004687
 004688      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004688
 004689                 + %trim(result) + ';';                                                                               004689
 004690                                                                                                                      004690
 004691      // Set resulting indicators?                                                                                    004691
 004692      If lw <> *Blanks;                                                                          B01                  004692
 004693         ERRCheck = *On;                                                                          01                  004693
 004694         ERRInd = lw;                                                                             01                  004694
 004695      EndIf;                                                                                     E01                  004695
 004696                                                                                                                      004696
 004697      convert = *On;                                                                                                  004697
 004698                                                                                                                      004698
 004699   EndSr;                                                                                                             004699
 004700   //-------------------------------------------------------------------------------------------                      004700
 004701                                                                                                                      004701
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    148
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004703   //-------------------------------------------------------------------------------------------                      004703
 004704   // Convert TIME.                                                                                                   004704
 004705   //-------------------------------------------------------------------------------------------                      004705
 004706   BegSr subUserCvt_TIME;                                                                                             004706
 004707                                                                                                                      004707
 004708      sourceLine = %trim(result) + ' = %time();';                                                                     004708
 004709                                                                                                                      004709
 004710      convert = *On;                                                                                                  004710
 004711                                                                                                                      004711
 004712   EndSr;                                                                                                             004712
 004713   //-------------------------------------------------------------------------------------------                      004713
 004714                                                                                                                      004714
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    149
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004716   //-------------------------------------------------------------------------------------------                      004716
 004717   // Convert UNLOCK.                                                                                                 004717
 004718   //-------------------------------------------------------------------------------------------                      004718
 004719   BegSr subUserCvt_UNLOCK;                                                                                           004719
 004720                                                                                                                      004720
 004721      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004721
 004722                                                                                                                      004722
 004723      // Check indicators?                                                                                            004723
 004724      If lw <> *Blanks;                                                                          B01                  004724
 004725         ERRCheck = *On;                                                                          01                  004725
 004726         ERRInd = lw;                                                                             01                  004726
 004727      EndIf;                                                                                     E01                  004727
 004728                                                                                                                      004728
 004729      convert = *On;                                                                                                  004729
 004730                                                                                                                      004730
 004731   EndSr;                                                                                                             004731
 004732   //-------------------------------------------------------------------------------------------                      004732
 004733                                                                                                                      004733
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    150
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004735   //-------------------------------------------------------------------------------------------                      004735
 004736   // Convert UPDATE.                                                                                                 004736
 004737   //-------------------------------------------------------------------------------------------                      004737
 004738   BegSr subUserCvt_UPDATE;                                                                                           004738
 004739                                                                                                                      004739
 004740      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004740
 004741                                                                                                                      004741
 004742      // Append datastructure?                                                                                        004742
 004743      If result <> *Blanks;                                                                      B01                  004743
 004744         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004744
 004745      Else;                                                                                      X01                  004745
 004746         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004746
 004747      EndIf;                                                                                     E01                  004747
 004748                                                                                                                      004748
 004749      // Check indicators?                                                                                            004749
 004750      If lw <> *Blanks;                                                                          B01                  004750
 004751         ERRCheck = *On;                                                                          01                  004751
 004752         ERRInd = lw;                                                                             01                  004752
 004753      EndIf;                                                                                     E01                  004753
 004754                                                                                                                      004754
 004755      convert = *On;                                                                                                  004755
 004756                                                                                                                      004756
 004757   EndSr;                                                                                                             004757
 004758   //-------------------------------------------------------------------------------------------                      004758
 004759                                                                                                                      004759
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    151
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004761   //-------------------------------------------------------------------------------------------                      004761
 004762   // Convert WHEN.                                                                                                   004762
 004763   //-------------------------------------------------------------------------------------------                      004763
 004764   BegSr subUserCvt_WHEN;                                                                                             004764
 004765                                                                                                                      004765
 004766      // Returning for a multi-line IF?  Reinstate original opcode.                                                   004766
 004767      If inWhen;                                                                                 B01                  004767
 004768         operator = whenOperator;                                                                 01                  004768
 004769      EndIf;                                                                                     E01                  004769
 004770                                                                                                                      004770
 004771      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              004771
 004772                                                                                                                      004772
 004773      If operator = 'WHEN';     // Use Extended Factor2.                                         B01                  004773
 004774         If not inWhen;            // First line of IF.                                          B02                  004774
 004775            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  004775
 004776            If not inSpan;                                                                       B03                  004776
 004777               sourceLine = %trim(sourceLine) + ';';                                              03                  004777
 004778            Else;                                                                                X03                  004778
 004779               inWhen = *On;                                                                      03                  004779
 004780               inSpan = *Off;                                                                     03                  004780
 004781            EndIf;                                                                               E03                  004781
 004782         Else;                   // Second line of WHEN.                                         X02                  004782
 004783            //            sourceLine = *Blanks;                                                                       004783
 004784            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  004784
 004785            sourceLine = %trim(extFactor2);                                                       02                  004785
 004786            If not inSpan;                                                                       B03                  004786
 004787               sourceLine = %trimr(sourceLine) + ';';                                             03                  004787
 004788               //               inWhen = *Off;                                                                        004788
 004789            EndIf;                                                                               E03                  004789
 004790            inSpan = *Off;                                                                        02                  004790
 004791         EndIf;                                                                                  E02                  004791
 004792      Else;                                                                                      X01                  004792
 004793         // Fixed format.                                                                                             004793
 004794         opCode = %xlate(lo:up:opCode);                                                           01                  004794
 004795         If not inWhen;         // First line of WHEN.                                           B02                  004795
 004796            whenCompare = %subst(opCode:5:2);                                                     02                  004796
 004797            sourceLine = 'When';                                                                  02                  004797
 004798         Else;                // Second line of WHEN.                                            X02                  004798
 004799            If %subst(opCode:1:3) = 'AND';                                                       B03                  004799
 004800               whenCompare = %subst(opCode:4:2);                                                  03                  004800
 004801               sourceLine = 'And';                                                                03                  004801
 004802            Else;                                                                                X03                  004802
 004803               whenCompare = %subst(opCode:3:2);                                                  03                  004803
 004804               sourceLine = 'Or';                                                                 03                  004804
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    152
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004805            EndIf;                                                                               E03                  004805
 004806         EndIf;                                                                                  E02                  004806
 004807         If whenCompare = 'EQ';                                                                  B02                  004807
 004808            whenCompare = '=';                                                                    02                  004808
 004809         ElseIf whenCompare = 'GT';                                                              X02                  004809
 004810            whenCompare = '>';                                                                    02                  004810
 004811         ElseIf whenCompare = 'GE';                                                              X02                  004811
 004812            whenCompare = '>=';                                                                   02                  004812
 004813         ElseIf whenCompare = 'LT';                                                              X02                  004813
 004814            whenCompare = '<';                                                                    02                  004814
 004815         ElseIf whenCompare = 'LE';                                                              X02                  004815
 004816            whenCompare = '<=';                                                                   02                  004816
 004817         ElseIf whenCompare = 'NE';                                                              X02                  004817
 004818            whenCompare = '<>';                                                                   02                  004818
 004819         EndIf;                                                                                  E02                  004819
 004820         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  004820
 004821                            + ' ' + %trim(whenCompare) + ' '                                      01                  004821
 004822                            + %trim(factor2);                                                     01                  004822
 004823         If not inSpan;                                                                          B02                  004823
 004824            sourceLine = %trimr(sourceLine) + ';';                                                02                  004824
 004825            inWhen = *Off;                                                                        02                  004825
 004826         Else;                                                                                   X02                  004826
 004827            inWhen = *On;                                                                         02                  004827
 004828            inSpan = *Off;                                                                        02                  004828
 004829         EndIf;                                                                                  E02                  004829
 004830      EndIf;                                                                                     E01                  004830
 004831                                                                                                                      004831
 004832      // Multi-line IF?  Retain original opcode.                                                                      004832
 004833      If inWhen;                                                                                 B01                  004833
 004834         whenOperator = operator;                                                                 01                  004834
 004835      Else;                                                                                      X01                  004835
 004836         whenOperator = *Blanks;                                                                  01                  004836
 004837      EndIf;                                                                                     E01                  004837
 004838                                                                                                                      004838
 004839      convert = *On;                                                                                                  004839
 004840                                                                                                                      004840
 004841   EndSr;                                                                                                             004841
 004842   //-------------------------------------------------------------------------------------------                      004842
 004843                                                                                                                      004843
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    153
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004845   //-------------------------------------------------------------------------------------------                      004845
 004846   // Convert WRITE.                                                                                                  004846
 004847   //-------------------------------------------------------------------------------------------                      004847
 004848   BegSr subUserCvt_WRITE;                                                                                            004848
 004849                                                                                                                      004849
 004850      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004850
 004851                                                                                                                      004851
 004852      // Append datastructure?                                                                                        004852
 004853      If result <> *Blanks;                                                                      B01                  004853
 004854         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004854
 004855      Else;                                                                                      X01                  004855
 004856         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004856
 004857      EndIf;                                                                                     E01                  004857
 004858                                                                                                                      004858
 004859      // Check indicators?                                                                                            004859
 004860      If eq <> *Blanks;                                                                          B01                  004860
 004861         EOFCheck = *On;                                                                          01                  004861
 004862         EOFInd = eq;                                                                             01                  004862
 004863         EOFFile = %trim(factor2);                                                                01                  004863
 004864      EndIf;                                                                                     E01                  004864
 004865      If lw <> *Blanks;                                                                          B01                  004865
 004866         ERRCheck = *On;                                                                          01                  004866
 004867         ERRInd = lw;                                                                             01                  004867
 004868      EndIf;                                                                                     E01                  004868
 004869                                                                                                                      004869
 004870      convert = *On;                                                                                                  004870
 004871                                                                                                                      004871
 004872   EndSr;                                                                                                             004872
 004873   //-------------------------------------------------------------------------------------------                      004873
 004874                                                                                                                      004874
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    154
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004876   //-------------------------------------------------------------------------------------------                      004876
 004877   // Convert XFOOT.                                                                                                  004877
 004878   //-------------------------------------------------------------------------------------------                      004878
 004879   BegSr subUserCvt_XFOOT;                                                                                            004879
 004880                                                                                                                      004880
 004881      If %scan('H':operator) = 0;                                                                B01                  004881
 004882         sourceLine = %trim(result) + ' = %xfoot(' + %trim(factor2)                               01                  004882
 004883                    + ');';                                                                       01                  004883
 004884      Else;                                                                                      X01                  004884
 004885         // Half-adjust.                                                                                              004885
 004886         sourceLine = 'Eval(H) ' + %trim(result) + ' = %xfoot('                                   01                  004886
 004887                    + %trim(factor2) + ');';                                                      01                  004887
 004888      EndIf;                                                                                     E01                  004888
 004889                                                                                                                      004889
 004890      convert = *On;                                                                                                  004890
 004891                                                                                                                      004891
 004892   EndSr;                                                                                                             004892
 004893   //-------------------------------------------------------------------------------------------                      004893
 004894                                                                                                                      004894
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    155
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004896   //-------------------------------------------------------------------------------------------                      004896
 004897   // Convert XLATE.                                                                                                  004897
 004898   //-------------------------------------------------------------------------------------------                      004898
 004899   BegSr subUserCvt_XLATE;                                                                                            004899
 004900                                                                                                                      004900
 004901      //      // Pad the result?                                                                                      004901
 004902      //      x = %scan('P':operator:6);                                                                              004902
 004903      //      If x > 0;                                                                                               004903
 004904      //         padResult = *On;                                                                                     004904
 004905      //         padTarget = result;                                                                                  004905
 004906      //         // Drop the extender.                                                                                004906
 004907      //         operator = 'XLATE';                                                                                  004907
 004908      //      EndIf;                                                                                                  004908
 004909                                                                                                                      004909
 004910      // Derive from and to.                                                                                          004910
 004911      x = %scan(':':factor1);                                                                                         004911
 004912      If x = 0;                                                                                  B01                  004912
 004913         LeaveSr;    // Invalid specification - there MUST be a from and to - don't convert.      01                  004913
 004914      Else;                                                                                      X01                  004914
 004915         xlateFrom = %subst(factor1:1:x-1);                                                       01                  004915
 004916         xlateTo = %subst(factor1:x+1);                                                           01                  004916
 004917      EndIf;                                                                                     E01                  004917
 004918                                                                                                                      004918
 004919      // Check for start position.                                                                                    004919
 004920      x = %scan(':':factor2);                                                                                         004920
 004921      If x = 0;                                                                                  B01                  004921
 004922         xlateStart = *Blanks;                                                                    01                  004922
 004923         xlateBase = factor2;                                                                     01                  004923
 004924      Else;                                                                                      X01                  004924
 004925         xlateStart = %subst(factor2:x+1);                                                        01                  004925
 004926         xlateBase = %subst(factor2:1:x-1);                                                       01                  004926
 004927      EndIf;                                                                                     E01                  004927
 004928                                                                                                                      004928
 004929      // Build new line.                                                                                              004929
 004930      sourceLine = %trim(result) + ' = %xlate('                                                                       004930
 004931                 + %trim(xlateFrom) + ':' + %trim(xlateTo) + ':'                                                      004931
 004932                 + %trim(xlateBase);                                                                                  004932
 004933      If xlateStart <> *Blanks;                                                                  B01                  004933
 004934         sourceLine = %trimr(sourceLine) + ':' + %trim(xlateStart);                               01                  004934
 004935      EndIf;                                                                                     E01                  004935
 004936      sourceLine = %trimr(sourceLine) + ');';                                                                         004936
 004937                                                                                                                      004937
 004938      // Set resulting indicators?                                                                                    004938
 004939      If lw <> *Blanks;                                                                          B01                  004939
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    156
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004940         ERRCheck = *On;                                                                          01                  004940
 004941         ERRInd = lw;                                                                             01                  004941
 004942      EndIf;                                                                                     E01                  004942
 004943                                                                                                                      004943
 004944      convert = *On;                                                                                                  004944
 004945                                                                                                                      004945
 004946   EndSr;                                                                                                             004946
 004947   //-------------------------------------------------------------------------------------------                      004947
 004948                                                                                                                      004948
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    157
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004950   //-------------------------------------------------------------------------------------------                      004950
 004951   // Convert Z-ADD.                                                                                                  004951
 004952   //-------------------------------------------------------------------------------------------                      004952
 004953   BegSr subUserCvt_Z_ADD;                                                                                            004953
 004954                                                                                                                      004954
 004955      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                                                      004955
 004956                                                                                                                      004956
 004957      // Half-adjust required?                                                                                        004957
 004958      If %len(%trim(operator)) > 5;                                                              B01                  004958
 004959         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004959
 004960      EndIf;                                                                                     E01                  004960
 004961                                                                                                                      004961
 004962      convert = *On;                                                                                                  004962
 004963                                                                                                                      004963
 004964   EndSr;                                                                                                             004964
 004965   //-------------------------------------------------------------------------------------------                      004965
 004966                                                                                                                      004966
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    158
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004968   //-------------------------------------------------------------------------------------------                      004968
 004969   // Convert Z-SUB.                                                                                                  004969
 004970   //-------------------------------------------------------------------------------------------                      004970
 004971   BegSr subUserCvt_Z_SUB;                                                                                            004971
 004972                                                                                                                      004972
 004973                                                                                                                      004973
 004974      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ' * -1;';                                                 004974
 004975                                                                                                                      004975
 004976      // Half-adjust required?                                                                                        004976
 004977      If %len(%trim(operator)) > 5;                                                              B01                  004977
 004978         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004978
 004979      EndIf;                                                                                     E01                  004979
 004980                                                                                                                      004980
 004981      convert = *On;                                                                                                  004981
 004982                                                                                                                      004982
 004983   EndSr;                                                                                                             004983
 004984   //-------------------------------------------------------------------------------------------                      004984
 004985                                                                                                                      004985
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    159
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004987   //-------------------------------------------------------------------------------------------                      004987
 004988   // Check if the next line is a continuation of the current line.                                                   004988
 004989   //-------------------------------------------------------------------------------------------                      004989
 004990   BegSr subUserCheckSpan;                                                                                            004990
 004991                                                                                                                      004991
 004992      inspan = *Off;                                                                                                  004992
 004993      savedSRCDTA = SRCDTA;                                                                                           004993
 004994      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          004994
 004995      x = 0;                                                                                                          004995
 004996                                                                                                                      004996
 004997      // Is the current line a continuation line?                                                                     004997
 004998      If savedLineType = 'D';                                                                    B01                  004998
 004999         If declName <> *Blanks;                                                                 B02                  004999
 005000            If %scan('...':%trim(declOptions)) > 0;                                              B03                  005000
 005001               // Yes - so we must be in a span.                                                                      005001
 005002               inSpan = *On;                                                                      03                  005002
 005003            EndIf;                                                                               E03                  005003
 005004         EndIf;                                                                                  E02                  005004
 005005      EndIf;                                                                                     E01                  005005
 005006                                                                                                                      005006
 005007      If not inSpan;                                                                             B01                  005007
 005008         Read SRCREC;                                                                             01                  005008
 005009         DoW not %eof();                                                                         B02                  005009
 005010            x += 1;     // Keep a track of how many lines we have read.                           02                  005010
 005011                                                                                                                      005011
 005012            lineType = %xlate(lo:up:lineType);                                                    02                  005012
 005013                                                                                                                      005013
 005014            If lineType <> *Blank                                                                B03                  005014
 005015            and lineType <> savedLineType;                                                       B03                  005015
 005016               // Not a spanned line.                                                                                 005016
 005017               Leave;                                                                             03                  005017
 005018                                                                                                                      005018
 005019            ElseIf lineType = 'D'                                                                X03                  005019
 005020            and %subst(directive:1:1) <> '*';                       // D-spec and no comment     X03                  005020
 005021               If declName = *Blanks                                                             B04                  005021
 005022               and declType = *Blanks                                                            B04                  005022
 005023               and declLen = *Blanks                                                             B04                  005023
 005024               and declKeyWords <> *Blanks;                                                      B04                  005024
 005025                  //               and ((declType <> *Blanks and workDeclType = *Blanks)                              005025
 005026                  //                    or (declType <> *Blanks and declType <> workDeclType)                         005026
 005027                  //                    or (declType = *Blanks and declKeyWords <> *Blanks));                         005027
 005028                  inSpan = *On;                                                                   04                  005028
 005029               EndIf;                                                                            E04                  005029
 005030               Leave;                                                                             03                  005030
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    160
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005031                                                                                                                      005031
 005032            ElseIf lineType = 'P'                                                                X03                  005032
 005033            and %subst(directive:1:1) <> '*';                       // P-spec and no comment     X03                  005033
 005034               If declName = *Blanks                                                             B04                  005034
 005035               and (procType <> *Blanks or procKeyWords <> *Blanks);                             B04                  005035
 005036                  inSpan = *On;                                                                   04                  005036
 005037               EndIf;                                                                            E04                  005037
 005038               Leave;                                                                             03                  005038
 005039                                                                                                                      005039
 005040            ElseIf lineType = 'H'                                                                X03                  005040
 005041            and %subst(directive:1:1) = *Blank;                     // H-spec and no comment     X03                  005041
 005042               inSpan = *On;                                                                      03                  005042
 005043               Leave;                                                                             03                  005043
 005044                                                                                                                      005044
 005045            ElseIf lineType = 'C'                                                                X03                  005045
 005046            and %subst(directive:1:1) = *Blank;                      // C-spec and no comment    X03                  005046
 005047               opCode = %xlate(lo:up:opCode);                                                     03                  005047
 005048               If %subst(operator:1:4) = 'EVAL';                                                 B04                  005048
 005049                  If opCode = *Blanks and extFactor2 <> *Blanks;     // EVAL continues.          B05                  005049
 005050                     inSpan = *On;                                                                05                  005050
 005051                  EndIf;                                                                         E05                  005051
 005052                  Leave;                                                                          04                  005052
 005053               ElseIf %subst(operator:1:6) = 'CALLP';                                            X04                  005053
 005054                  If opCode = *Blanks;                               // CALLP continues.         B05                  005054
 005055                     inSpan = *On;                                                                05                  005055
 005056                  EndIf;                                                                         E05                  005056
 005057                  Leave;                                                                          04                  005057
 005058               ElseIf operator = 'IF';                               // IF Continues.            X04                  005058
 005059                  If opCode = *Blanks;                                                           B05                  005059
 005060                     inSpan = *On;                                                                05                  005060
 005061                  EndIf;                                                                         E05                  005061
 005062                  Leave;                                                                          04                  005062
 005063               ElseIf %subst(operator:1:2) = 'IF';                   // IF Continues.            X04                  005063
 005064                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005064
 005065                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005065
 005066                  or opCode = *Blanks;                                                           B05                  005066
 005067                     inSpan = *On;                                                                05                  005067
 005068                  EndIf;                                                                         E05                  005068
 005069                  Leave;                                                                          04                  005069
 005070               ElseIf %subst(operator:1:2) = 'DO';                   // DO Continues.            X04                  005070
 005071                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005071
 005072                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005072
 005073                  or opCode = *Blanks;                                                           B05                  005073
 005074                     inSpan = *On;                                                                05                  005074
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    161
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005075                  EndIf;                                                                         E05                  005075
 005076                  Leave;                                                                          04                  005076
 005077               ElseIf %subst(operator:1:4) = 'WHEN';                 // WHEN Continues.          X04                  005077
 005078                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005078
 005079                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005079
 005080                  or opCode = *Blanks;                                                           B05                  005080
 005081                     inSpan = *On;                                                                05                  005081
 005082                  EndIf;                                                                         E05                  005082
 005083                  Leave;                                                                          04                  005083
 005084               EndIf;                                                                            E04                  005084
 005085                                                                                                                      005085
 005086            ElseIf lineType = 'C'                                                                X03                  005086
 005087            and %subst(directive:1:1) = '+';                        // Embedded SQL              X03                  005087
 005088               inSpan = *On;                                                                      03                  005088
 005089               Leave;                                                                             03                  005089
 005090                                                                                                                      005090
 005091            ElseIf lineType = 'F'                                                                X03                  005091
 005092            and %subst(directive:1:1) <> '*';                       // F-spec and no comment     X03                  005092
 005093               If fileName = *Blanks and fileKeyWords <> *Blanks;                                B04                  005093
 005094                  inSpan = *On;                                                                   04                  005094
 005095               EndIf;                                                                            E04                  005095
 005096               Leave;                                                                             03                  005096
 005097                                                                                                                      005097
 005098            ElseIf %subst(directive:1:1) = '/';          // Directive, so line must end here.    X03                  005098
 005099               Leave;                                                                             03                  005099
 005100               //            ElseIf lineType = ' '                                                                    005100
 005101               //            and opCode <> *Blanks;                                                                   005101
 005102             //               Leave;                                       // Free-format line.                       005102
 005103            EndIf;                                                                               E03                  005103
 005104                                                                                                                      005104
 005105            Read SRCREC;                                                                          02                  005105
 005106         EndDo;                                                                                  E02                  005106
 005107      EndIf;                                                                                     E01                  005107
 005108                                                                                                                      005108
 005109      // End of file breaks the logic!  We need to reposition to the last record before                               005109
 005110      // continuing.                                                                                                  005110
 005111      If %eof(QRPGLESRC);                                                                        B01                  005111
 005112         SetGT *HIVAL SRCREC;                                                                     01                  005112
 005113         ReadP SRCREC;                                                                            01                  005113
 005114      EndIf;                                                                                     E01                  005114
 005115                                                                                                                      005115
 005116      // Return to the previous point.                                                                                005116
 005117      For i = 1 to x;                                                                            B01                  005117
 005118         ReadP SRCREC;                                                                            01                  005118
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    162
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005119      EndFor;                                                                                    E01                  005119
 005120                                                                                                                      005120
 005121      SRCDTA = savedSRCDTA;                                                                                           005121
 005122                                                                                                                      005122
 005123   EndSr;                                                                                                             005123
 005124   //-------------------------------------------------------------------------------------------                      005124
 005125                                                                                                                      005125
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    163
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005127   //-------------------------------------------------------------------------------------------                      005127
 005128   // Get the type of declaration encountered - it may not be on the current line!                                    005128
 005129   //-------------------------------------------------------------------------------------------                      005129
 005130   BegSr subUserGetDeclarationType;                                                                                   005130
 005131                                                                                                                      005131
 005132      // Start with what we've got.                                                                                   005132
 005133      If declSuffix  = ' '                                                                       B01                  005133
 005134      and (declPrefix = ' '                                                                      B01                  005134
 005135      or declPrefix = 'U' or declPrefix = 'S');                                                  B01                  005135
 005136         workDeclType = %xlate(lo:up:declType);                                                   01                  005136
 005137         savedName = %trim(declName);                                                             01                  005137
 005138      Else;                                                                                      X01                  005138
 005139         workDeclType = *Blank;                                                                   01                  005139
 005140         savedName = %trim(%subst(fullLine:1:74));                                                01                  005140
 005141      EndIf;                                                                                     E01                  005141
 005142                                                                                                                      005142
 005143      // If we already have the declaration type, then stop.                                                          005143
 005144      If workDeclType = 'S'                                                                      B01                  005144
 005145      or workDeclType = 'DS'                                                                     B01                  005145
 005146      or workDeclType = 'C'                                                                      B01                  005146
 005147      or workDeclType = 'B'                                                                      B01                  005147
 005148      or workDeclType = 'E'                                                                      B01                  005148
 005149      or workDeclType = 'PR'                                                                     B01                  005149
 005150      or workDeclType = 'PI'                                                                     B01                  005150
 005151      or workDeclType = *Blanks and inPrototype;                                                 B01                  005151
 005152         workDeclLine = SRCSEQ;                                                                   01                  005152
 005153         LeaveSr;                                                                                 01                  005153
 005154      EndIf;                                                                                     E01                  005154
 005155                                                                                                                      005155
 005156      savedSRCDTA = SRCDTA;                                                                                           005156
 005157      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005157
 005158      x = 0;                                                                                                          005158
 005159      workDeclLine = 0;                                                                                               005159
 005160                                                                                                                      005160
 005161      //      // Name of the variable/routine should be on this line.                                                 005161
 005162      //      savedName = %trim(declOptions);                                                                         005162
 005163                                                                                                                      005163
 005164      // Trim any ellipsis from the name as this is not valid in free-form.                                           005164
 005165      x = %scan('...':savedName);                                                                                     005165
 005166      If x > 0;                                                                                  B01                  005166
 005167         savedName = %subst(savedName:1:x-1);                                                     01                  005167
 005168         x = 0;                                                                                   01                  005168
 005169      EndIf;                                                                                     E01                  005169
 005170                                                                                                                      005170
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    164
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005171      // Read ahead to find the next line with a declaration type.                                                    005171
 005172      Read SRCREC;                                                                                                    005172
 005173      DoW not %eof();                                                                            B01                  005173
 005174         x += 1;     // Keep a track of how many lines we have read.                              01                  005174
 005175                                                                                                                      005175
 005176         lineType = %xlate(lo:up:lineType);                                                       01                  005176
 005177                                                                                                                      005177
 005178         If lineType <> savedLineType;                                                           B02                  005178
 005179            // End of this declaration.                                                                               005179
 005180            Leave;                                                                                02                  005180
 005181         EndIf;                                                                                  E02                  005181
 005182                                                                                                                      005182
 005183         If declType <> *Blanks;                                                                 B02                  005183
 005184            workDeclType = %xlate(lo:up:declType);                                                02                  005184
 005185            workDeclLine = SRCSEQ;                                                                02                  005185
 005186            Leave;                                                                                02                  005186
 005187         EndIf;                                                                                  E02                  005187
 005188                                                                                                                      005188
 005189         Read SRCREC;                                                                             01                  005189
 005190      EndDo;                                                                                     E01                  005190
 005191                                                                                                                      005191
 005192      // End of file breaks the logic!  We need to reposition to the last record before                               005192
 005193      // continuing.                                                                                                  005193
 005194      If %eof(QRPGLESRC);                                                                        B01                  005194
 005195         SetGT *HIVAL SRCREC;                                                                     01                  005195
 005196         ReadP SRCREC;                                                                            01                  005196
 005197      EndIf;                                                                                     E01                  005197
 005198                                                                                                                      005198
 005199      // Return to the previous point.                                                                                005199
 005200      For i = 1 to x;                                                                            B01                  005200
 005201         ReadP SRCREC;                                                                            01                  005201
 005202      EndFor;                                                                                    E01                  005202
 005203                                                                                                                      005203
 005204      SRCDTA = savedSRCDTA;                                                                                           005204
 005205                                                                                                                      005205
 005206   EndSr;                                                                                                             005206
 005207   //-------------------------------------------------------------------------------------------                      005207
 005208                                                                                                                      005208
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    165
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005210   //-------------------------------------------------------------------------------------------                      005210
 005211   // Get the line number at which the current structure ends.                                                        005211
 005212   //-------------------------------------------------------------------------------------------                      005212
 005213   BegSr subUserGetEndLine;                                                                                           005213
 005214                                                                                                                      005214
 005215      savedSRCDTA = SRCDTA;                                                                                           005215
 005216      endLine = 0;                                                                                                    005216
 005217      endFound = *Off;                                                                                                005217
 005218                                                                                                                      005218
 005219      // Read ahead to find the start of the next declaration.                                                        005219
 005220      Read SRCREC;                                                                                                    005220
 005221      x = 1;                                                                                                          005221
 005222      DoW not %eof();                                                                            B01                  005222
 005223         If lineType <> *Blanks                                                                  B02                  005223
 005224         and %xlate(lo:up:lineType) <> workLineType;                                             B02                  005224
 005225            // We've found a different line type.                                                                     005225
 005226            Leave;                                                                                02                  005226
 005227         Else;                                                                                   X02                  005227
 005228            If %len(%trim(codeLine)) >= 4;                                                       B03                  005228
 005229               If %xlate(lo:up:%subst(codeLine:1:4)) = 'DCL-';                                   B04                  005229
 005230                  // We've found a different line type.                                                               005230
 005231                  Leave;                                                                          04                  005231
 005232               EndIf;                                                                            E04                  005232
 005233            EndIf;                                                                               E03                  005233
 005234         EndIf;                                                                                  E02                  005234
 005235                                                                                                                      005235
 005236         If codeLine = *Blanks;                                                                  B02                  005236
 005237            // Ignore empty lines.                                                                                    005237
 005238   //      ElseIf %subst(directive:1:1) = '/';                                                                        005238
 005239   //         // Ignore directives.                                                                                   005239
 005240         ElseIf %subst(directive:2:1) = '*'                                                      X02                  005240
 005241             or %len(%trim(codeLine)) >= 2                                                       X02                  005241
 005242            and %subst(%trim(codeLine):1:2) = '//';                                              X02                  005242
 005243            // Ignore comment.                                                                                        005243
 005244         ElseIf inSpan                                                                           X02                  005244
 005245            and declName = *Blanks                                                               X02                  005245
 005246            and SRCSEQ = workDeclLine;                                                           X02                  005246
 005247            // Ignore the curent declaration.                                                                         005247
 005248         ElseIf declType = *Blanks                                                               X02                  005248
 005249            and (declLen <> *Blanks or declKeywords <> *Blanks);                                 X02                  005249
 005250            // Ignore sub-field definition.                                                                           005250
 005251         ElseIf declType = *Blanks                                                               X02                  005251
 005252            and declName <> *Blanks                                                              X02                  005252
 005253            and %scan('...':declOptions) = 0;                                                    X02                  005253
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    166
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005254            // Ignore sub-field definition.                                                                           005254
 005255         ElseIf %scan('...':declOptions) > 0;                                                    X02                  005255
 005256            // We have a continuation line, but is it a sub-field or a new                                            005256
 005257            // delcaration?                                                                                           005257
 005258            GetDeclarationType(tempDeclType                                                       02                  005258
 005259                              :tempSavedName                                                      02                  005259
 005260                              :tempDeclLine);                                                     02                  005260
 005261            If tempDeclType <> *Blanks;                                                          B03                  005261
 005262               // We've hit the next declaration or code.                                                             005262
 005263               Leave;                                                                             03                  005263
 005264            EndIf;                                                                               E03                  005264
 005265         Else;                                                                                   X02                  005265
 005266            // We've hit the next declaration or code.                                                                005266
 005267            Leave;                                                                                02                  005267
 005268         EndIf;                                                                                  E02                  005268
 005269                                                                                                                      005269
 005270         Read SRCREC;                                                                             01                  005270
 005271         x += 1;     // Keep a track of how many lines we have read.                              01                  005271
 005272      EndDo;                                                                                     E01                  005272
 005273                                                                                                                      005273
 005274      // We are now at the start of the next declaration.                                                             005274
 005275      endLine = SRCSEQ;                                                                                               005275
 005276                                                                                                                      005276
 005277      // End of file breaks the logic!  We need to reposition to the last record before                               005277
 005278      // continuing.                                                                                                  005278
 005279      If %eof(QRPGLESRC);                                                                        B01                  005279
 005280         SetGT *HIVAL SRCREC;                                                                     01                  005280
 005281         //ReadP SRCREC;                                                                                              005281
 005282      EndIf;                                                                                     E01                  005282
 005283                                                                                                                      005283
 005284      // Return to the previous point.                                                                                005284
 005285      For i = 1 to x;                                                                            B01                  005285
 005286         ReadP SRCREC;                                                                            01                  005286
 005287                                                                                                                      005287
 005288         // Move the end point for blank lines or comments.                                                           005288
 005289         If not endFound;                                                                        B02                  005289
 005290            If (lineType = *Blanks                                                               B03                  005290
 005291            or %subst(directive:1:1) = '*'                                                       B03                  005291
 005292            or %subst(directive:1:2) = '//'                                                      B03                  005292
 005293            or (%len(%trim(codeLine)) > 0                                                        B03                  005293
 005294            and %subst(%trim(codeLine):1:2) = '//'));                                            B03                  005294
 005295               //            and %subst(directive:1:1) <> '/';                                                        005295
 005296            Else;                                                                                X03                  005296
 005297               endFound = *On;                                                                    03                  005297
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    167
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005298               endLine = SRCSEQ;                                                                  03                  005298
 005299            EndIf;                                                                               E03                  005299
 005300         EndIf;                                                                                  E02                  005300
 005301      EndFor;                                                                                    E01                  005301
 005302                                                                                                                      005302
 005303      SRCDTA = savedSRCDTA;                                                                                           005303
 005304                                                                                                                      005304
 005305   EndSr;                                                                                                             005305
 005306   //-------------------------------------------------------------------------------------------                      005306
 005307                                                                                                                      005307
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    168
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005309   //-------------------------------------------------------------------------------------------                      005309
 005310   // Move field definitions to D-specs.                                                                              005310
 005311   //-------------------------------------------------------------------------------------------                      005311
 005312   BegSr subUserMoveDefs;                                                                                             005312
 005313                                                                                                                      005313
 005314      codeStart = SRCSEQ;   // Save the start of the source.                                                          005314
 005315      savedSRCDTA = SRCDTA;                                                                                           005315
 005316                                                                                                                      005316
 005317      Clear movedDefs;                                                                                                005317
 005318      Reset DCLS;                                                                                                     005318
 005319                                                                                                                      005319
 005320      // Read through the source and create a D-spec for every field definition found.                                005320
 005321      DoW not %eof(QRPGLESRC);                                                                   B01                  005321
 005322         // Stop if we hit either the start or end of a procedure (to preserve local                                  005322
 005323         // definitions of variables).                                                                                005323
 005324         If lineType = 'P'                                                                       B02                  005324
 005325         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005325
 005326                                                      = 'DCL-PROC'                               B02                  005326
 005327         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005327
 005328                                                      = 'END-PROC';                              B02                  005328
 005329            Leave;                                                                                02                  005329
 005330         EndIf;                                                                                  E02                  005330
 005331                                                                                                                      005331
 005332         If %xlate(lo:up:lineType) = 'C'                                                         B02                  005332
 005333         and %subst(directive:1:1) = ' ';                                                        B02                  005333
 005334            opCode = %xlate(lo:up:opCode);                                                        02                  005334
 005335            // C-Spec with a size definition.                                                                         005335
 005336            If opCode <> *Blanks                                                                 B03                  005336
 005337            and %subst(opCode:1:4) <> 'EVAL'                                                     B03                  005337
 005338            and opCode <> 'IF'                                                                   B03                  005338
 005339            and opCode <> 'WHEN'                                                                 B03                  005339
 005340            and opCode <> 'DOW'                                                                  B03                  005340
 005341            and opCode <> 'DOU'                                                                  B03                  005341
 005342            and opCode <> 'DSPLY'                                                                B03                  005342
 005343            and opCode <> 'CALLP'                                                                B03                  005343
 005344            and (len <> *Blanks or opCode = 'DEFINE');                                           B03                  005344
 005345               moveDef = *Off;                                                                    03                  005345
 005346               // Only do if not already moved.                                                                       005346
 005347               If %lookup(%xlate(lo:up:result):movedDefs) = 0;                                   B04                  005347
 005348                  Reset DCLS;                                                                     04                  005348
 005349                  // In-line definition.                                                                              005349
 005350                  If len <> *Blanks                                                              B05                  005350
 005351                  and %scan('+':len) = 0 and %scan('-':len) = 0;                                 B05                  005351
 005352                     moveDef = *On;                                                               05                  005352
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    169
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005353                     DCLS.fieldName = result;                                                     05                  005353
 005354                     If dec = *Blanks;                                                           B06                  005354
 005355                        DCLS.type = '     Char';                                                  06                  005355
 005356                     Else;                                                                       X06                  005356
 005357                        DCLS.type = '   Packed';                                                  06                  005357
 005358                     EndIf;                                                                      E06                  005358
 005359                     DCLS.definition = '(' + %trim(len);                                          05                  005359
 005360                     If dec <> *Blanks;                                                          B06                  005360
 005361                        DCLS.definition = %trimr(DCLS.definition)                                 06                  005361
 005362                                        + ':' + %trim(dec);                                       06                  005362
 005363                     EndIf;                                                                      E06                  005363
 005364                     DCLS.definition = %trimr(DCLS.definition) + ')';                             05                  005364
 005365                  EndIf;                                                                         E05                  005365
 005366                                                                                                                      005366
 005367                  // *LIKE Definition                                                                                 005367
 005368                  If %xlate(lo:up:opCode) = 'DEFINE';                                            B05                  005368
 005369                     moveDef = *On;                                                               05                  005369
 005370                     DCLS.fieldName = result;                                                     05                  005370
 005371                     If %xlate(lo:up:factor1) = '*LIKE';                                         B06                  005371
 005372                        %subst(DCLS.definition:8)                                                 06                  005372
 005373                                    = 'LIKE(' + %trimr(factor2);                                  06                  005373
 005374                        // Length adjustment?                                                                         005374
 005375                        If %scan('+':len) > 0 or %scan('-':len) > 0;                             B07                  005375
 005376                           len = %scanrpl(' ':'':len);                                            07                  005376
 005377                           DCLS.definition = %trimr(DCLS.definition)                              07                  005377
 005378                                           + ':' + %trim(len);                                    07                  005378
 005379                        EndIf;                                                                   E07                  005379
 005380                        DCLS.definition = %trimr(DCLS.definition) + ')';                          06                  005380
 005381                     Else;                                                                       X06                  005381
 005382                        If %xlate(lo:up:%trim(factor2)) = '*LDA';                                B07                  005382
 005383                           DCLS.definition = %trimr(DCLS.definition)                              07                  005383
 005384                                 + ' DTAARA(' + %trimr(factor2) + ')';                            07                  005384
 005385                        Else;                                                                    X07                  005385
 005386                           DCLS.definition = %trimr(DCLS.definition)                              07                  005386
 005387                             + ' DTAARA(''' + %trimr(factor2) + ''')';                            07                  005387
 005388                        EndIf;                                                                   E07                  005388
 005389                     EndIf;                                                                      E06                  005389
 005390                  EndIf;                                                                         E05                  005390
 005391                                                                                                                      005391
 005392                  If moveDef;                                                                    B05                  005392
 005393                     // Put any additional keywords needed here!                                                      005393
 005394                     DCLS.definition = %trimr(DCLS.definition) + ';';                             05                  005394
 005395                     If comment <> *Blanks;                                                      B06                  005395
 005396                        DCLS.comment = '// ' + comment;                                           06                  005396
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    170
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005397                     EndIf;                                                                      E06                  005397
 005398                                                                                                                      005398
 005399                     // Store the moved definition.                                                                   005399
 005400                     x = %lookup(' ':movedDefs);                                                  05                  005400
 005401                     movedDefs(x) = %xlate(lo:up:result);                                         05                  005401
 005402                  EndIf;                                                                         E05                  005402
 005403               EndIf;                                                                            E04                  005403
 005404            EndIf;                                                                               E03                  005404
 005405         EndIf;                                                                                  E02                  005405
 005406                                                                                                                      005406
 005407         // Anything to output?                                                                                       005407
 005408         If DCLS.fieldName <> *Blanks;                                                           B02                  005408
 005409            DCLS.decl = 'Dcl-S ';                                                                 02                  005409
 005410            If not defsMoved;                                                                    B03                  005410
 005411               // Log start of moved field block;                                                                     005411
 005412               SRCDTA = *Blanks;                                                                  03                  005412
 005413               codeLine = Qcomments(1);                                                           03                  005413
 005414               Exsr subUserWriteLine;                                                             03                  005414
 005415               codeLine = Qcomments(2);                                                           03                  005415
 005416               Exsr subUserWriteLine;                                                             03                  005416
 005417               codeLine = Qcomments(1);                                                           03                  005417
 005418               Exsr subUserWriteLine;                                                             03                  005418
 005419               defsMoved = *On;                                                                   03                  005419
 005420            EndIf;                                                                               E03                  005420
 005421                                                                                                                      005421
 005422            lineType = ' ';                                                                       02                  005422
 005423            codeLine = DCLS;                                                                      02                  005423
 005424            countMoved += 1;                                                                      02                  005424
 005425            Clear DCLS.fieldName;                                                                 02                  005425
 005426                                                                                                                      005426
 005427            Exsr subUserWriteLine;                                                                02                  005427
 005428         EndIf;                                                                                  E02                  005428
 005429                                                                                                                      005429
 005430         Read QRPGLESRC;                                                                          01                  005430
 005431      EndDo;                                                                                     E01                  005431
 005432                                                                                                                      005432
 005433      If defsMoved;                                                                              B01                  005433
 005434         // Log end of moved field block;                                                                             005434
 005435         SRCDTA = *Blanks;                                                                        01                  005435
 005436         codeLine = Qcomments(1);                                                                 01                  005436
 005437         Exsr subUserWriteLine;                                                                   01                  005437
 005438         codeLine = Qcomments(3);                                                                 01                  005438
 005439         Exsr subUserWriteLine;                                                                   01                  005439
 005440         codeLine = Qcomments(1);                                                                 01                  005440
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    171
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005441         Exsr subUserWriteLine;                                                                   01                  005441
 005442      EndIf;                                                                                     E01                  005442
 005443                                                                                                                      005443
 005444      // Reposition source file pointer to the start of the source again.                                             005444
 005445      Close QRPGLESRC;                                                                                                005445
 005446      Open QRPGLESRC;                                                                                                 005446
 005447      Read SRCREC;                                                                                                    005447
 005448      DoW SRCSEQ <> codeStart;                                                                   B01                  005448
 005449         Read SRCREC;                                                                             01                  005449
 005450      EndDo;                                                                                     E01                  005450
 005451                                                                                                                      005451
 005452      defsMoved = *On;                                                                                                005452
 005453      SRCDTA = savedSRCDTA;                                                                                           005453
 005454                                                                                                                      005454
 005455   EndSr;                                                                                                             005455
 005456   //-------------------------------------------------------------------------------------------                      005456
 005457                                                                                                                      005457
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    172
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005459   //-------------------------------------------------------------------------------------------                      005459
 005460   // Output the current line.                                                                                        005460
 005461   //-------------------------------------------------------------------------------------------                      005461
 005462   BegSr subUserWriteLine;                                                                                            005462
 005463                                                                                                                      005463
 005464      countTarget += 1;                                                                                               005464
 005465                                                                                                                      005465
 005466      Write OUTREC;                                                                                                   005466
 005467      //Except OUTREC;                                                                                                005467
 005468                                                                                                                      005468
 005469   EndSr;                                                                                                             005469
 005470   //-------------------------------------------------------------------------------------------                      005470
 005471                                                                                                                      005471
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    173
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005473   //-------------------------------------------------------------------------------------------                      005473
 005474   // Exit the program directly.                                                                                      005474
 005475   //-------------------------------------------------------------------------------------------                      005475
 005476   BegSr subExitProgram;                                                                                              005476
 005477                                                                                                                      005477
 005478      Exsr subUserExitProgram;     // Perform any user-specified exit processing.                                     005478
 005479                                                                                                                      005479
 005480      // If commitment control is active, a commit should have been done if everything                                005480
 005481      // was OK, so issue a rollback here to catch and remove any uncommitted changes.                                005481
 005482      If cfgCommitControl = '*MASTER';                                                           B01                  005482
 005483         RolBk;                                                                                   01                  005483
 005484      EndIf;                                                                                     E01                  005484
 005485                                                                                                                      005485
 005486      If cfgCloseDown = 'Y';                                                                     B01                  005486
 005487         *INLR = *On;                  // Close down the program.                                 01                  005487
 005488      EndIf;                                                                                     E01                  005488
 005489                                                                                                                      005489
 005490      Return;                          // Exit the program.                                                           005490
 005491                                                                                                                      005491
 005492   EndSr;                                                                                                             005492
 005493   //-------------------------------------------------------------------------------------------                      005493
 005494                                                                                                                      005494
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    174
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005496   //-------------------------------------------------------------------------------------------                      005496
 005497   // USER: Exit processing.                                                                                          005497
 005498   //-------------------------------------------------------------------------------------------                      005498
 005499   BegSr subUserExitProgram;                                                                                          005499
 005500                                                                                                                      005500
 005501      // ** Place any program-specific exit code here.                                                                005501
 005502      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005502
 005503                                                                                                                      005503
 005504      If QpShutDown <> 'Y';                                                                      B01                  005504
 005505         Close QRPGLESRC;                                                                         01                  005505
 005506         Close QRPGLESRC2;                                                                        01                  005506
 005507      EndIf;                                                                                     E01                  005507
 005508                                                                                                                      005508
 005509      If QpShutDown = 'Y' and initialCall <> 'Y';                                                B01                  005509
 005510         cfgCloseDown = 'Y';                                                                      01                  005510
 005511         Write Z1ENDRPT;                                                                          01                  005511
 005512         Close CVTRPGFREP;                                                                        01                  005512
 005513      EndIf;                                                                                     E01                  005513
 005514                                                                                                                      005514
 005515      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005515
 005516                                                                                                                      005516
 005517   EndSr;                                                                                                             005517
 005518   //-------------------------------------------------------------------------------------------                      005518
 005519                                                                                                                      005519
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    175
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005521   //-------------------------------------------------------------------------------------------                      005521
 005522   // Initialisation                                                                                                  005522
 005523   //-------------------------------------------------------------------------------------------                      005523
 005524   BegSr subInitialise;                                                                                               005524
 005525                                                                                                                      005525
 005526      // Flag initial call.                                                                                           005526
 005527      If initialCall = *Blank;                                                                   B01                  005527
 005528         initialCall = 'Y';                                                                       01                  005528
 005529      Else;                                                                                      X01                  005529
 005530         initialCall = 'N';                                                                       01                  005530
 005531      EndIf;                                                                                     E01                  005531
 005532                                                                                                                      005532
 005533      // Perform user-specified intialisation processing.                                                             005533
 005534      Exsr subUserInitialise;                                                                                         005534
 005535                                                                                                                      005535
 005536   EndSr;                                                                                                             005536
 005537   //-------------------------------------------------------------------------------------------                      005537
 005538                                                                                                                      005538
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    176
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005540   //-------------------------------------------------------------------------------------------                      005540
 005541   // USER: Initialisation                                                                                            005541
 005542   //-------------------------------------------------------------------------------------------                      005542
 005543   BegSr subUserInitialise;                                                                                           005543
 005544                                                                                                                      005544
 005545      // Set configuration/processing options:                                                                        005545
 005546      cfgCommitControl   = '*NONE  '; // Commitment control setting: *MASTER/*SLAVE                                   005546
 005547      cfgCloseDown       = 'N';       // Close down the program on exit?                                              005547
 005548                                                                                                                      005548
 005549                                                                                                                      005549
 005550      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005550
 005551                                                                                                                      005551
 005552      // Shut down?                                                                                                   005552
 005553      If QpShutDown = 'Y';                                                                       B01                  005553
 005554         Exsr subExitProgram;                                                                     01                  005554
 005555      EndIf;                                                                                     E01                  005555
 005556                                                                                                                      005556
 005557      // Open audit report.                                                                                           005557
 005558      If initialCall = 'Y';                                                                      B01                  005558
 005559         Open CVTRPGFREP;                                                                         01                  005559
 005560         Z1QTTL = 'RPG/ILE to Free-Format Conversion Report';                                     01                  005560
 005561         overflow = *On;                                                                          01                  005561
 005562      EndIf;                                                                                     E01                  005562
 005563                                                                                                                      005563
 005564      fromFileLib = %trim(QpFromLib) + '/' + %trim(QpFromFile);                                                       005564
 005565      Open QRPGLESRC;                                                                                                 005565
 005566                                                                                                                      005566
 005567      toFileLib = %trim(QpToLib) + '/' + %trim(QpToFile);                                                             005567
 005568      Open QRPGLESRC2;                                                                                                005568
 005569                                                                                                                      005569
 005570      Reset countSource;                                                                                              005570
 005571      Reset countTarget;                                                                                              005571
 005572      Reset countEligible;                                                                                            005572
 005573      Reset countConv;                                                                                                005573
 005574      Reset CountNotConv;                                                                                             005574
 005575                                                                                                                      005575
 005576      Reset maxIndent;                                                                                                005576
 005577      Reset movedDefs;                                                                                                005577
 005578      Reset moveDef;                                                                                                  005578
 005579      Reset inCode;                                                                                                   005579
 005580      Reset inArrayData;                                                                                              005580
 005581      Reset indentCount;                                                                                              005581
 005582                                                                                                                      005582
 005583      indentCount = mainlineIndent;                                                                                   005583
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    177
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005584                                                                                                                      005584
 005585      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005585
 005586                                                                                                                      005586
 005587   EndSr;                                                                                                             005587
 005588   //-------------------------------------------------------------------------------------------                      005588
 005589   //===========================================================================================                      005589
 005590                                                                                                                      005590
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    178
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005592   //==========================================================================================                       005592
 005593   // Get the type of declaration encountered - it may not be on the current line!                                    005593
 005594   //==========================================================================================                       005594
 000001=OOUTREC                                                                                                             2000001
         *--------------------------------------------------------------------------------------------*                     2
         * RPG record format  . . . . :  OUTREC                                                       *                     2
         * External format  . . . . . :  QRPGLESRC2 : CVTRPGFREE/QRPGLESRC2                           *                     2
         *--------------------------------------------------------------------------------------------*                     2
 000002=O                       SRCSEQ               6S ZONE      6,2                                                       2000002
 000003=O                       SRCDAT              12S ZONE      6,0                                                       2000003
 000004=O                       SRCDTA             112A CHAR      100                                                       2000004
 000001=OZ1PAGHDG                                                                                                           3000001
         *--------------------------------------------------------------------------------------------*                     3
         * RPG record format  . . . . :  Z1PAGHDG                                                     *                     3
         * External format  . . . . . :  Z1PAGHDG : CVTRPGFREE/CVTRPGFREP                             *                     3
         *--------------------------------------------------------------------------------------------*                     3
 000002=O                       Z1QPGM              10A CHAR       10                                                       3000002
 000003=O                       Z1QUSR              20A CHAR       10                                                       3000003
 000004=O                       Z1QTTL              60A CHAR       40                                                       3000004
 000005=O                       Z1QPAG              64S ZONE      4,0                                                       3000005
 000001=OZ1TOPPAG                                                                                                           4000001
         *--------------------------------------------------------------------------------------------*                     4
         * RPG record format  . . . . :  Z1TOPPAG                                                     *                     4
         * External format  . . . . . :  Z1TOPPAG : CVTRPGFREE/CVTRPGFREP                             *                     4
         *--------------------------------------------------------------------------------------------*                     4
 000002=O                       ZTFRFL              21A CHAR       21                                                       4000002
 000003=O                       ZTTOFL              42A CHAR       21                                                       4000003
 000001=OZL01HDG                                                                                                            5000001
         *--------------------------------------------------------------------------------------------*                     5
         * RPG record format  . . . . :  ZL01HDG                                                      *                     5
         * External format  . . . . . :  ZL01HDG : CVTRPGFREE/CVTRPGFREP                              *                     5
         *--------------------------------------------------------------------------------------------*                     5
 000001=OZ1DETAIL                                                                                                           6000001
         *--------------------------------------------------------------------------------------------*                     6
         * RPG record format  . . . . :  Z1DETAIL                                                     *                     6
         * External format  . . . . . :  Z1DETAIL : CVTRPGFREE/CVTRPGFREP                             *                     6
         *--------------------------------------------------------------------------------------------*                     6
 000002=O                       Z1FRMB              10A CHAR       10                                                       6000002
 000003=O                       Z1TOMB              20A CHAR       10                                                       6000003
 000004=O                       Z1CTSC              27S ZONE      7,0                                                       6000004
 000005=O                       Z1CTTG              34S ZONE      7,0                                                       6000005
 000006=O                       Z1CTMV              41S ZONE      7,0                                                       6000006
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    179
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000007=O                       Z1CTEL              48S ZONE      7,0                                                       6000007
 000008=O                       Z1CTCV              55S ZONE      7,0                                                       6000008
 000009=O                       Z1CTNV              62S ZONE      7,0                                                       6000009
 000010=O                       Z1CNVR              67S ZONE      5,2                                                       6000010
 000001=OZ1ENDRPT                                                                                                           7000001
         *--------------------------------------------------------------------------------------------*                     7
         * RPG record format  . . . . :  Z1ENDRPT                                                     *                     7
         * External format  . . . . . :  Z1ENDRPT : CVTRPGFREE/CVTRPGFREP                             *                     7
         *--------------------------------------------------------------------------------------------*                     7
 005595   Dcl-Proc GetDeclarationType;                                                                                       005595
 005596                                                                                                                      005596
 005597   // -- Procedure Interface ------------------------------------------------------------------                       005597
 005598   Dcl-PI GetDeclarationType;                                                                                         005598
 005599      QpDeclType               Char( 2 );                                                                             005599
 005600      QpSavedName              Char( 80 );                                                                            005600
 005601      QpDeclLine                        Like(SRCSEQ);                                                                 005601
 005602   End-PI;                                                                                                            005602
 005603                                                                                                                      005603
 005604   // -- Data Structures ----------------------------------------------------------------------                       005604
 005605                                                                                                                      005605
 005606   // -- Variables ----------------------------------------------------------------------------                       005606
 005607   Dcl-S savedLineType        Char(  1 );                                                                             005607
 005608   Dcl-S x                  Packed( 3:0 );                                                                            005608
 005609   Dcl-S savedSRCDTA          Char( 100 );                                                                            005609
 005610                                                                                                                      005610
 005611   //-------------------------------------------------------------------------------------------                      005611
 005612                                                                                                                      005612
 005613      // Start with what we've got.                                                                                   005613
 005614      If ((declExt = ' ' and declPrefix  = ' ')                                                  B01                  005614
 005615      or declPrefix = 'S' or declPrefix = 'U')                                                   B01                  005615
 005616      and declSuffix = ' ';                                                                      B01                  005616
 005617         QpDeclType = %xlate(lo:up:declType);                                                     01                  005617
 005618         QpSavedName = %trim(declName);                                                           01                  005618
 005619      Else;                                                                                      X01                  005619
 005620         QpDeclType = *Blank;                                                                     01                  005620
 005621         QpSavedName = %trim(%subst(fullLine:1:74));                                              01                  005621
 005622      EndIf;                                                                                     E01                  005622
 005623                                                                                                                      005623
 005624      x = %scan(' ':QpSavedName);                                                                                     005624
 005625      If x > 1;                                                                                  B01                  005625
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    180
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005626         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005626
 005627      EndIf;                                                                                     E01                  005627
 005628                                                                                                                      005628
 005629      // If we already have the declaration type, then stop.                                                          005629
 005630      If QpDeclType = 'S'                                                                        B01                  005630
 005631      or QpDeclType = 'DS'                                                                       B01                  005631
 005632      or QpDeclType = 'C'                                                                        B01                  005632
 005633      or QpDeclType = 'B'                                                                        B01                  005633
 005634      or QpDeclType = 'E'                                                                        B01                  005634
 005635      or QpDeclType = 'PR'                                                                       B01                  005635
 005636      or QpDeclType = 'PI'                                                                       B01                  005636
 005637      or QpDeclType = *Blanks and inPrototype;                                                   B01                  005637
 005638         QpDeclLine = SRCSEQ;                                                                     01                  005638
 005639         Return;                                                                                  01                  005639
 005640      EndIf;                                                                                     E01                  005640
 005641                                                                                                                      005641
 005642      savedSRCDTA = SRCDTA;                                                                                           005642
 005643      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005643
 005644      x = 0;                                                                                                          005644
 005645      QpDeclLine = 0;                                                                                                 005645
 005646                                                                                                                      005646
 005647      //   // Name of the variable/routine should be on this line.                                                    005647
 005648      //   savedName = %trim(declOptions);                                                                            005648
 005649                                                                                                                      005649
 005650      // Trim any ellipsis from the name as this is not valid in free-form.                                           005650
 005651      x = %scan('...':QpSavedName);                                                                                   005651
 005652      If x > 0;                                                                                  B01                  005652
 005653         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005653
 005654         x = 0;                                                                                   01                  005654
 005655      ElseIf declFrom <> *Blanks                                                                 X01                  005655
 005656          or declLen <> *Blanks                                                                  X01                  005656
 005657          or declOptions <> *BLanks;                                                             X01                  005657
 005658         // It's not a declaration - it's a subfield.                                                                 005658
 005659         QpDeclType = %xlate(lo:up:declType);                                                     01                  005659
 005660         QpDeclLine = SRCSEQ;                                                                     01                  005660
 005661         Return;                                                                                  01                  005661
 005662      EndIf;                                                                                     E01                  005662
 005663                                                                                                                      005663
 005664      // Read ahead to find the next line with a declaration type.                                                    005664
 005665      Read SRCREC;                                                                                                    005665
 005666      DoW not %eof();                                                                            B01                  005666
 005667         x += 1;     // Keep a track of how many lines we have read.                              01                  005667
 005668                                                                                                                      005668
 005669         lineType = %xlate(lo:up:lineType);                                                       01                  005669
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    181
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005670                                                                                                                      005670
 005671         If lineType <> savedLineType;                                                           B02                  005671
 005672            // End of this declaration.                                                                               005672
 005673            Leave;                                                                                02                  005673
 005674         EndIf;                                                                                  E02                  005674
 005675                                                                                                                      005675
 005676         If declType <> *Blanks;                                                                 B02                  005676
 005677            // We have found the declaration.                                                                         005677
 005678            QpDeclType = %xlate(lo:up:declType);                                                  02                  005678
 005679            QpDeclLine = SRCSEQ;                                                                  02                  005679
 005680            Leave;                                                                                02                  005680
 005681         ElseIf declFrom <> *Blanks                                                              X02                  005681
 005682             or declLen <> *Blanks                                                               X02                  005682
 005683             or declOptions <> *BLanks;                                                          X02                  005683
 005684            // It's not a declaration - it's a subfield.                                                              005684
 005685            QpDeclType = %xlate(lo:up:declType);                                                  02                  005685
 005686            QpDeclLine = SRCSEQ;                                                                  02                  005686
 005687            Leave;                                                                                02                  005687
 005688         EndIf;                                                                                  E02                  005688
 005689                                                                                                                      005689
 005690         Read SRCREC;                                                                             01                  005690
 005691      EndDo;                                                                                     E01                  005691
 005692                                                                                                                      005692
 005693      // End of file breaks the logic!  We need to reposition to the last record before                               005693
 005694      // continuing.                                                                                                  005694
 005695      If %eof(QRPGLESRC);                                                                        B01                  005695
 005696         SetGT *HIVAL SRCREC;                                                                     01                  005696
 005697         ReadP SRCREC;                                                                            01                  005697
 005698      EndIf;                                                                                     E01                  005698
 005699                                                                                                                      005699
 005700      // Return to the previous point.                                                                                005700
 005701      For i = 1 to x;                                                                            B01                  005701
 005702         ReadP SRCREC;                                                                            01                  005702
 005703      EndFor;                                                                                    E01                  005703
 005704                                                                                                                      005704
 005705      SRCDTA = savedSRCDTA;                                                                                           005705
 005706                                                                                                                      005706
 005707      Return;                                                                                                         005707
 005708                                                                                                                      005708
 005709   //------------------------------------------------------------------------------------------                       005709
 005710      End-Proc;                                                                                                       005710
 005711                                                                                                                      005711
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    182
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005713   //==========================================================================================                       005713
 005714   // Split a line at a logical break based on a max length.                                                          005714
 005715   //==========================================================================================                       005715
 005716      Dcl-Proc SplitLine;                                                                                             005716
 005717                                                                                                                      005717
 005718   // -- Procedure Interface ------------------------------------------------------------------                       005718
 005719      Dcl-PI SplitLine;                                                                                               005719
 005720         QpCurrentLine        VarChar(92);                                                                            005720
 005721         QpOverflow           VarChar(92);                                                                            005721
 005722         QpMaxLength           Packed( 3:0 ) CONST;                                                                   005722
 005723      End-PI;                                                                                                         005723
 005724                                                                                                                      005724
 005725   // -- Data Structures ----------------------------------------------------------------------                       005725
 005726                                                                                                                      005726
 005727   // -- Variables ----------------------------------------------------------------------------                       005727
 005728      Dcl-S x                  Packed( 3:0 );                                                                         005728
 005729                                                                                                                      005729
 005730   //-------------------------------------------------------------------------------------------                      005730
 005731                                                                                                                      005731
 005732      QpOverflow = *Blanks;                                                                                           005732
 005733      x = %len(%trim(QpCurrentLine));                                                                                 005733
 005734      If x > QpMaxLength;                                                                        B01                  005734
 005735         x = QpMaxLength;                                                                         01                  005735
 005736      EndIf;                                                                                     E01                  005736
 005737                                                                                                                      005737
 005738      // Scan backwards through the line, looking for a place to break it.                                            005738
 005739      For x = x downto 1;                                                                        B01                  005739
 005740         If %scan(%subst(QpCurrentLine:x:1):' ') > 0;                                            B02                  005740
 005741            // Break here, and put the rest into a new line.                                                          005741
 005742            QpOverflow = %subst(QpCurrentLine:x);                                                 02                  005742
 005743            QpCurrentLine = %subst(QpCurrentLine:1:x-1);                                          02                  005743
 005744            Leave;                                                                                02                  005744
 005745         EndIf;                                                                                  E02                  005745
 005746      EndFor;                                                                                    E01                  005746
 005747                                                                                                                      005747
 005748      Return;                                                                                                         005748
 005749                                                                                                                      005749
 005750   //------------------------------------------------------------------------------------------                       005750
 005751      End-Proc;                                                                                                       005751
 005752                                                                                                                      005752
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    183
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005754   //==========================================================================================                       005754
 005755   // Check for an array definition and adjust the length according to the number of elements.                        005755
 005756   //==========================================================================================                       005756
 005757      Dcl-Proc AdjustArrayLength;                                                                                     005757
 005758                                                                                                                      005758
 005759   // -- Procedure Interface ------------------------------------------------------------------                       005759
 005760      Dcl-PI AdjustArrayLength;                                                                                       005760
 005761      QpLength               Packed( 7:0 );                                                                           005761
 005762      End-PI;                                                                                                         005762
 005763                                                                                                                      005763
 005764   // -- Data Structures ----------------------------------------------------------------------                       005764
 005765                                                                                                                      005765
 005766   // -- Variables ----------------------------------------------------------------------------                       005766
 005767      Dcl-S x                  Packed( 3:0 );                                                                         005767
 005768      Dcl-S i                  Packed( 3:0 );                                                                         005768
 005769      Dcl-S j                  Packed( 3:0 );                                                                         005769
 005770      Dcl-S elements           Packed( 5:0 );                                                                         005770
 005771      Dcl-S savedSRCDTA          Char( 100 );                                                                         005771
 005772                                                                                                                      005772
 005773   //-------------------------------------------------------------------------------------------                      005773
 005774                                                                                                                      005774
 005775      savedSRCDTA = SRCDTA;                                                                                           005775
 005776      x = 0;                                                                                                          005776
 005777                                                                                                                      005777
 005778      // Read ahead to find the next line with a declaration type.                                                    005778
 005779      DoW not %eof();                                                                            B01                  005779
 005780         // Array definition on the current line?                                                                     005780
 005781         i = %scan('DIM(':%xlate(lo:up:declKeywords));                                            01                  005781
 005782                                                                                                                      005782
 005783         If i > 0;                                                                               B02                  005783
 005784            j = %scan(')':declKeywords:i+4);                                                      02                  005784
 005785            elements = %dec(%subst(declKeywords:i + 4:j - i - 4):7:0);                            02                  005785
 005786            // Adjust the length of the variable.                                                                     005786
 005787            If %rem(QpLength:elements) = 0;                                                      B03                  005787
 005788               QpLength = %div(QpLength:elements);                                                03                  005788
 005789            EndIf;                                                                               E03                  005789
 005790            Leave;                                                                                02                  005790
 005791         EndIf;                                                                                  E02                  005791
 005792                                                                                                                      005792
 005793         Read SRCREC;                                                                             01                  005793
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    184
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005794         x += 1;     // Keep a track of how many lines we have read.                              01                  005794
 005795                                                                                                                      005795
 005796         lineType = %xlate(lo:up:lineType);                                                       01                  005796
 005797                                                                                                                      005797
 005798         If lineType <> *Blank                                                                   B02                  005798
 005799         and lineType <> 'D';                                                                    B02                  005799
 005800            // Not part of this definition - stop looking for array definition.                                       005800
 005801            Leave;                                                                                02                  005801
 005802                                                                                                                      005802
 005803         ElseIf lineType = 'D'                                                                   X02                  005803
 005804         and %subst(directive:1:1) <> '*';                       // D-spec and no comment        X02                  005804
 005805            If declName <> *Blanks;                                                              B03                  005805
 005806               // A new declaration - stop looking for array definition.                                              005806
 005807               Leave;                                                                             03                  005807
 005808            EndIf;                                                                               E03                  005808
 005809         EndIf;                                                                                  E02                  005809
 005810      EndDo;                                                                                     E01                  005810
 005811                                                                                                                      005811
 005812      // End of file breaks the logic!  We need to reposition to the last record before                               005812
 005813      // continuing.                                                                                                  005813
 005814      If %eof(QRPGLESRC);                                                                        B01                  005814
 005815         SetGT *HIVAL SRCREC;                                                                     01                  005815
 005816         ReadP SRCREC;                                                                            01                  005816
 005817      EndIf;                                                                                     E01                  005817
 005818                                                                                                                      005818
 005819      // Return to the previous point.                                                                                005819
 005820      For i = 1 to x;                                                                            B01                  005820
 005821         ReadP SRCREC;                                                                            01                  005821
 005822      EndFor;                                                                                    E01                  005822
 005823                                                                                                                      005823
 005824      SRCDTA = savedSRCDTA;                                                                                           005824
 005825                                                                                                                      005825
 005826      Return;                                                                                                         005826
 005827                                                                                                                      005827
 005828   //------------------------------------------------------------------------------------------                       005828
 005829      End-Proc;                                                                                                       005829
 005830   //==========================================================================================                       005830
 005831 O*QRPGLESRC2E            OUTREC                                                                                      005831
 005832 O*                       SRCSEQ                                                                                      005832
 005833 O*                       SRCDAT                                                                                      005833
 005834 O*                       SRCDTA                                                                                      005834
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    185
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv   Statement    Message text
 *RNF7066 00        000029  Record-Format ZL01HDG not used for input or output.
 *RNF7099 00        005483  A COMMIT or ROLBK operation is used in the program with no
                            files defined with commitment control.
 *RNF7086 00        000024  RPG handles blocking for file QRPGLESRC2. INFDS is updated
                            only when blocks of data are transferred.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                  O u t p u t   B u f f e r   P o s i t i o n s
 Line   Start End   Field or Constant
 Number Pos   Pos
    2000002     1     6 SRCSEQ
    2000003     7    12 SRCDAT
    2000004    13   112 SRCDTA
    3000002     1    10 Z1QPGM
    3000003    11    20 Z1QUSR
    3000004    21    60 Z1QTTL
    3000005    61    64 Z1QPAG
    4000002     1    21 ZTFRFL
    4000003    22    42 ZTTOFL
    6000002     1    10 Z1FRMB
    6000003    11    20 Z1TOMB
    6000004    21    27 Z1CTSC
    6000005    28    34 Z1CTTG
    6000006    35    41 Z1CTMV
    6000007    42    48 Z1CTEL
    6000008    49    55 Z1CTCV
    6000009    56    62 Z1CTNV
    6000010    63    67 Z1CNVR
  * * * * *   E N D   O F   O U T P U T   B U F F E R   P O S I T I O N   *  * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    186
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                        C o m p i l e   T i m e   D a t a
 005835 **CTDATA QopCodeUP                                                                                                   005835
         *--------------------------------------------------------------------*
         * Array . . . : QOPCODEUP    Alternating Array  . . . . : QOPCODELO  *
         *--------------------------------------------------------------------*
 005836 ACQ       Acq                                                                                                        005836
 005837 BEGSR     BegSr                                                                                                      005837
 005838 CALLP     CallP                                                                                                      005838
 005839 CHAIN     Chain                                                                                                      005839
 005840 CLEAR     Clear                                                                                                      005840
 005841 CLOSE     Close                                                                                                      005841
 005842 COMMIT    Commit                                                                                                     005842
 005843 DEALLOC   DeAlloc                                                                                                    005843
 005844 DELETE    Delete                                                                                                     005844
 005845 DOU       DoU                                                                                                        005845
 005846 DOW       DoW                                                                                                        005846
 005847 DSPLY     Dsply                                                                                                      005847
 005848 DUMP      Dump                                                                                                       005848
 005849 ELSE      Else                                                                                                       005849
 005850 ELSEIF    ElseIf                                                                                                     005850
 005851 ENDDO     EndDo                                                                                                      005851
 005852 ENDFOR    EndFor                                                                                                     005852
 005853 ENDIF     EndIf                                                                                                      005853
 005854 ENDMON    EndMon                                                                                                     005854
 005855 ENDSL     EndSl                                                                                                      005855
 005856 ENDSR     EndSr                                                                                                      005856
 005857 EVAL      Eval                                                                                                       005857
 005858 EVALR     EvalR                                                                                                      005858
 005859 EVAL-CORR Eval-Corr                                                                                                  005859
 005860 EXCEPT    Except                                                                                                     005860
 005861 EXFMT     Exfmt                                                                                                      005861
 005862 EXSR      Exsr                                                                                                       005862
 005863 EXEC SQL  Exec SQL                                                                                                   005863
 005864 FEOD      FEOD                                                                                                       005864
 005865 FOR       For                                                                                                        005865
 005866 FORCE     Force                                                                                                      005866
 005867 IF        If                                                                                                         005867
 005868 IN        In                                                                                                         005868
 005869 ITER      Iter                                                                                                       005869
 005870 LEAVE     Leave                                                                                                      005870
 005871 LEAVESR   LeaveSr                                                                                                    005871
 005872 MONITOR   Monitor                                                                                                    005872
 005873 NEXT      Next                                                                                                       005873
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    187
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005874 ON-ERROR  On-Error                                                                                                   005874
 005875 OPEN      Open                                                                                                       005875
 005876 OTHER     Other                                                                                                      005876
 005877 OUT       Out                                                                                                        005877
 005878 POST      Post                                                                                                       005878
 005879 READ      Read                                                                                                       005879
 005880 READC     ReadC                                                                                                      005880
 005881 READE     ReadE                                                                                                      005881
 005882 READP     ReadP                                                                                                      005882
 005883 READPE    ReadPE                                                                                                     005883
 005884 REL       Rel                                                                                                        005884
 005885 RESET     Reset                                                                                                      005885
 005886 RETURN    Return                                                                                                     005886
 005887 ROLBK     RolBk                                                                                                      005887
 005888 SELECT    Select                                                                                                     005888
 005889 SETGT     SetGT                                                                                                      005889
 005890 SETLL     SetLL                                                                                                      005890
 005891 SORTA     SortA                                                                                                      005891
 005892 TEST      Test                                                                                                       005892
 005893 UNLOCK    Unlock                                                                                                     005893
 005894 UPDATE    Update                                                                                                     005894
 005895 WHEN      When                                                                                                       005895
 005896 WRITE     Write                                                                                                      005896
 005897 XML-INTO  XML-Into                                                                                                   005897
 005898 XMLSAX    XMLSAX                                                                                                     005898
 005899 ENDCS     ----------                                                                                                 005899
 005900 AND       and                                                                                                        005900
 005901 OR        or                                                                                                         005901
 005902 **CTDATA QdeclUP                                                                                                     005902
         *--------------------------------------------------------------------*
         * Array . . . : QDECLUP      Alternating Array  . . . . : QDECLLO    *
         *--------------------------------------------------------------------*
 005903 DCL-F     Dcl-F                                                                                                      005903
 005904 DCL-S     Dcl-S                                                                                                      005904
 005905 DCL-C     Dcl-C                                                                                                      005905
 005906 DCL-PR    Dcl-PR                                                                                                     005906
 005907 DCL-PI    Dcl-PI                                                                                                     005907
 005908 DCL-PROC  Dcl-Proc                                                                                                   005908
 005909 DCL-DS    Dcl-DS                                                                                                     005909
 005910 END-DS    End-DS                                                                                                     005910
 005911 END-PR    End-PR                                                                                                     005911
 005912 END-PI    End-PI                                                                                                     005912
 005913 END-PROC  End-Proc                                                                                                   005913
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    188
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005914 CTL-OPT   Ctl-Opt                                                                                                    005914
 005915 **CTDATA Qcomments                                                                                                   005915
         *--------------------------------------------------------------------*
         * Array . . . : QCOMMENTS                                            *
         *--------------------------------------------------------------------*
 005916 //===========================================================================================                        005916
 005917 // Start of moved field definitions.                                                                                 005917
 005918 // End of moved field definitions.                                                                                   005918
     * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    189
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          CVTRPGFREP        PRINTER                000029D     005512      005559
            Z1PAGHDG                               000029D     000456     3000001
            Z1TOPPAG                               000029D     000461     4000001
            ZL01HDG                                000029D    5000001
            Z1DETAIL                               000029D     000481     6000001
            Z1ENDRPT                               000029D     005511     7000001
          QRPGLESRC         DISK                   000019D     000422      005111      005194
                                                   005279      005321      005430      005445
                                                   005446      005505      005565      005695
                                                   005814
            SRCREC                                 000021     1000001      000420      000448
                                                   005008      005105      005112      005113
                                                   005118      005172      005189      005195
                                                   005196      005201      005220      005270
                                                   005280      005286      005447      005449
                                                   005665      005690      005696      005697
                                                   005702      005793      005815      005816
                                                   005821
          QRPGLESRC2        DISK                   000024D     005506      005568
            OUTREC                                 000026      005466     2000001
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                   005487M
          ADJUSTARRAYLENGTH PROTOTYPE              002011M     005757      005760
          BLANKS            A(30)                  000206D     003004
          CALLPOFFSET       P(3,0)                 000326D     001047      002851M
          CALLPOPERATOR     A(10)                  000325D     002841      002867M     002869M
          CASEOPERATOR      A(4)                   000309D     002885M     002888      002889M
                                                   002890      002891M     002892      002893M
                                                   002894      002895M     002896      002897M
                                                   002898      002899M     002901M     002907
                                                   002911      002915
          CASESUBROUTINE    A(10)                  000308D     000442      000443      000445M
                                                   002884M
          CATBLANKS         A(14)                  000314D     002973M     002976M     002983
                                                   002985      002992
          CATCOUNT          P(3,0)                 000313D     002985M     002996      003000
                                                   003004
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    190
          CATFACTOR1        A(14)                  000311D     002965M     002967M     002994
                                                   002998      003003
          CATFACTOR2        A(14)                  000312D     002974M     002977M     002995
                                                   002999      003005
          CFGCLOSEDOWN      A(1)                   000192D     005486      005510M     005547M
          CFGCOMMITCONTROL  A(7)                   000190D     005482      005546M
          CHECKLENGTH       P(3,0)                 000275D     002331M     002335M     002338
 *RNF7031 CNDINDICATORS(79) N(1)                   000142D
          CODELINE          A(93)                  000088D     000217      000433M     000435M
                                                   000443M     000504      000610      000613M
                                                   000613      000619      000623      000624
                                                   000631      000634M     000637      000639M
                                                   000722      000723      000724      000728
                                                   000730      000732      000735      000777M
                                                   000785      001030M     001031M     001088M
                                                   001089M     001093M     001096      001110M
                                                   001118M     001119M     001164M     001189
                                                   001610      002227      002343M     002395
                                                   002401      002452      002539M     002550M
                                                   002561M     002572M     002583M     002594M
                                                   002598M     002602M     002610M     002614M
                                                   002618M     002630M     002635M     002640M
                                                   002650M     002653M     002655M     002665M
                                                   002668M     002670M     002680M     002683M
                                                   002685M     003477M     003598      005228
                                                   005229      005236      005241      005242
                                                   005293      005294      005325      005327
                                                   005413M     005415M     005417M     005423M
                                                   005436M     005438M     005440M
          CODESTART         P(6,2)                 000239D     005314M     005448
          COMMENT           A(20)                  000102D     000636      000652      000665
                                                   000677      000689      000701      001794
                                                   001795      001796      001798      001831
                                                   001832      001833      001835      002179
                                                   002180      002181      002183      002320
                                                   002321      002322      002324      002334
                                                   002412      002413      002414      002416
                                                   002488      002489      002490      002492
                                                   005395      005396
          CONDIND           A(2)                   000092D     001205
 *RNF7031 CONDNOT           A(1)                   000091D
          CONVERT           N(1)                   000235D     000501M     000656      000669
                                                   000681      000693      000705      000739
                                                   000757      001091      001105      001191M
                                                   001201M     001612M     001643M     001729M
                                                   001990M     002198M     002215M     002229M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    191
                                                   002263M     002368M     002383M     002397M
                                                   002440M     002454M     002509M     002523M
                                                   002709M     002740M     002796M     002815M
                                                   002828M     002872M     002940M     003014M
                                                   003045M     003096M     003109M     003127M
                                                   003148M     003183M     003204M     003230M
                                                   003260M     003375M     003408M     003425M
                                                   003438M     003451M     003515M     003567M
                                                   003580M     003607M     003633M     003646M
                                                   003696M     003715M     003728M     003741M
                                                   003826M     003850M     003863M     003876M
                                                   003923M     003969M     004011M     004025M
                                                   004046M     004075M     004092M     004111M
                                                   004124M     004148M     004182M     004218M
                                                   004238M     004258M     004292M     004306M
                                                   004327M     004391M     004404M     004422M
                                                   004440M     004474M     004487M     004502M
                                                   004515M     004547M     004631M     004673M
                                                   004697M     004710M     004729M     004755M
                                                   004839M     004870M     004890M     004944M
                                                   004962M     004981M
          COUNTCONV         P(7,0)                 000391D     000471      000477      000740M
                                                   005573M
          COUNTELIGIBLE     P(7,0)                 000390D     000470      000474      000477
                                                   000649M     000662M     000675M     000687M
                                                   000699M     005572M
          COUNTMOVED        P(7,0)                 000393D     000473      005424M
          COUNTNOTCONV      P(7,0)                 000392D     000472      000650M     000663M
                                                   000676M     000688M     000700M     000741M
                                                   005574M
          COUNTSOURCE       P(7,0)                 000388D     000423M     000468      005570M
          COUNTTARGET       P(7,0)                 000389D     000469      005464M     005571M
          CURROFFSET        P(3,0)                 000251D     000728M     001051
 *RNF7031 CVTRPGFREE        PROTOTYPE              000036D
          DCLF              DS(92)                 000172D     002273M     002274M     002275M
                                                   002279M     002288M     002291M     002295M
                                                   002297M     002301M     002305M     002310
                                                   002311M     002311      002316M     002316
                                                   002322M     002324M     002331      002338
                                                   002343      002347M     002348M     002351M
                                                   002351      002357M     002357      002364
                                                   002374M     002375M     002377M     002377
                                                   002379
            COMMENT         A(23)                  000177D     002322      002324
            DECL            A(6)                   000173D     002274
            DEFINITION      A(44)                  000176D     002288      002291      002295
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    192
                                                   002297      002301      002305      002310
                                                   002311      002311      002316      002316
                                                   002331      002338      002348      002351
                                                   002351      002357      002357      002375
                                                   002377      002377
            DEVICE          A(8)                   000175D     002279
 *RNF7031   FILENAME        A(15)                  000174D
          DCLH              DS(93)                 000180D     002408M     002409M     002410M
                                                   002414M     002416M     002421M     002421
                                                   002428      002431M     002432M     002434M
                                                   002434      002436
            COMMENT         A(23)                  000183D     002414      002416
            DECL            A(8)                   000181D     002409
            OPTIONS         A(62)                  000182D     002410      002421      002421
                                                   002432      002434      002434
          DCLP              DS(93)                 000158D     002473M     002476M     002478M
                                                   002480M     002484M     002484      002490M
                                                   002492M     002497M     002497      002504
                                                   002514M     002515M     002517M     002517
                                                   002519
            COMMENT         A(23)                  000161D     002490      002492
            DECL            A(9)                   000159D     002476      002478
            DEFINITION      A(61)                  000160D     002480      002484      002484
                                                   002497      002497      002515      002517
                                                   002517
          DCLPR             DS(92)                 000149D     001867M     001882M     001886M
                                                   001903M     001909      001926      001928M
                                                   001933M     001941M     001945M     001947M
                                                   001952M     001958M     001963M     001969M
                                                   001971M     001973M     001975M     001977M
                                                   001979M     001983M     001986M     002001
                                                   002002M     002012M     002012      002015M
                                                   002015      002020M     002020      002023M
                                                   002023      002078      002081M     002093M
                                                   002102M     002150      002151M     002151
                                                   002153M     002153      002164      002166
                                                   002171      002171      002172M     002174M
                                                   002174      002181M     002183M     002188
            COMMENT         A(23)                  000154D     002181      002183
            DECL            A(7)                   000150D     001882      001926
            DEFINITION      A(37)                  000153D     001952      001963      002002
                                                   002012      002012      002015      002015
                                                   002020      002020      002023      002023
                                                   002153      002153      002164      002166
                                                   002171      002172      002174      002174
            FIELDNAME       A(23)                  000155D     001903
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    193
            PROCNAME        A(16)                  000151D     002078      002081      002093
                                                   002151      002151
            TYPE            A(9)                   000152D     001909      001928      001933
                                                   001941      001945      001947      001958
                                                   001969      001971      001973      001975
                                                   001977      001979      001983      001986
                                                   002001      002150      002171
          DCLS              DS(92)                 000164D     001637M     001648M     001649M
                                                   001654      001673M     001681M     001684M
                                                   001686M     001691M     001697M     001702M
                                                   001708M     001710M     001712M     001714M
                                                   001716M     001718M     001722M     001725M
                                                   001740      001741M     001743M     001743
                                                   001746M     001746      001769M     001769
                                                   001779      001781      001786      001786
                                                   001787M     001789M     001789      001796M
                                                   001798M     001803      001814M     001816M
                                                   001817M     001822      001823M     001825M
                                                   001825      001833M     001835M     001840M
                                                   001840      001847      001848M     001848
                                                   001852      002206M     002207M     002209M
                                                   002209      002211      005318M     005348M
                                                   005353M     005355M     005357M     005359M
                                                   005361M     005361      005364M     005364
                                                   005370M     005372M     005377M     005377
                                                   005380M     005380      005383M     005383
                                                   005386M     005386      005394M     005394
                                                   005396M     005408      005409M     005423
                                                   005425M
            COMMENT         A(23)                  000169D     001796      001798      001833
                                                   001835      005396
            DECL            A(6)                   000165D     001648      001816      001847
                                                   005409
            DEFINITION      A(37)                  000168D     001691      001702      001741
                                                   001743      001743      001746      001746
                                                   001769      001769      001779      001781
                                                   001786      001787      001789      001789
                                                   001822      001823      001825      001825
                                                   001840      001840      001848      002207
                                                   002209      002209      005359      005361
                                                   005361      005364      005364      005372
                                                   005377      005377      005380      005380
                                                   005383      005383      005386      005386
                                                   005394      005394
            FIELDNAME       A(17)                  000166D     005353      005370      005408
                                                   005425
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    194
            TYPE            A(9)                   000167D     001654      001673      001681
                                                   001684      001686      001697      001708
                                                   001710      001712      001714      001716
                                                   001718      001722      001725      001740
                                                   001786      005355      005357
          DEC               A(2)                   000098D     000858M     005354      005360
                                                   005362
          DECLATTR          A(1)                   000118D     001619
          DECLEXT           A(1)                   000112D     005614
          DECLFROM          A(7)                   000116D     002003      002005      002028
                                                   002030      002031      002033      005655
                                                   005681
          DECLKEYWORDS      A(37)                  000120D     001620      002515      005024
                                                   005249      005781      005784      005785
          DECLLEN           A(7)                   000117D     001655      001741      001910
                                                   001927      002004      002016      005023
                                                   005249      005656      005682
          DECLNAME          A(15)                  000111D     001625      002086      002470
                                                   004999      005021      005034      005137
                                                   005245      005252      005618      005805
          DECLOPTIONS       A(73)                  000121D     002029      002410      002432
                                                   005000      005253      005255      005657
                                                   005683
          DECLPREFIX        A(1)                   000113D     002076      002083      005134
                                                   005135      005135      005614      005615
                                                   005615
          DECLSCALE         A(3)                   000119D     001657      001742      001744
                                                   001912      002019      002021
          DECLSUFFIX        A(1)                   000115D     005133      005616
          DECLTYPE          A(2)                   000114D     001896      005022      005136
                                                   005183      005184      005248      005251
                                                   005617      005659      005676      005678
                                                   005685
          DEFSMOVED         N(1)                   000237D     000526M     000901M     000963
                                                   005410      005419M     005433      005452M
          DIRECTIVE         A(10)                  000087D     000498      000551M     000601M
                                                   000603M     000747M     000752M     000764M
                                                   000770M     001109      002342M     005020
                                                   005033      005041      005046      005087
                                                   005092      005098      005240      005291
                                                   005292      005333      005804
          DIVFACTOR1        A(14)                  000353D     003249M     003252M     003257
                                                   004022
          DIVFACTOR2        A(14)                  000354D     003250M     003253M     003258
                                                   004023
          DOCOMPARE         A(2)                   000330D     003297M     003302M     003306M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    195
                                                   003309M     003314      003315M     003316
                                                   003317M     003318      003319M     003320
                                                   003321M     003322      003323M     003324
                                                   003325M     003326      003337M     003357
          DOCOUNT           P(3,0)                 000347D     000883M     000884      000918M
                                                   003489      003490
          DOLEVEL(99)       P(3,0)                 000348D     000884M     003490
          DOOPERATOR        A(10)                  000329D     003272      003370M     003372M
          DROPLINE          N(1)                   000238D     000553M     000556M     000563M
                                                   000657      000670      000682      000694
                                                   000706      000794      000874M     000982
                                                   001104      001124M     001287M     003182M
                                                   004420M     004438M
          DURCODE           A(14)                  000317D     002759M     002762      002762
                                                   002763M     002764      002764      002765M
                                                   002766      002766      002767M     002768
                                                   002768      002769M     002770      002770
                                                   002771M     002772      002772      002773M
                                                   002774      002774      002775M     002787
                                                   003665M     003668      003668      003669M
                                                   003670      003670      003671M     003672
                                                   003672      003673M     003674      003674
                                                   003675M     003676      003676      003677M
                                                   003678      003678      003679M     003680
                                                   003680      003681M     003688      004574M
                                                   004577      004577      004578M     004579
                                                   004579      004580M     004581      004581
                                                   004582M     004583      004583      004584M
                                                   004585      004585      004586M     004587
                                                   004587      004588M     004589      004589
                                                   004590M     004602      004606M     004609
                                                   004609      004610      004610      004611
                                                   004611      004612      004612      004613
                                                   004613      004614      004614      004615
                                                   004615      004622
          DURDURATION       A(14)                  000316D     002758M     002788      003664M
                                                   003687      004573M     004603      004605M
                                                   004621
          DURNEWDATE        N(1)                   000318D     004566M     004569M     004572
          ENDDECLTYPE       A(2)                   000242D     001164      001888M
          ENDDS             N(1)                   000228D     001161      001880M     002072M
          ENDFOUND          N(1)                   000241D     005217M     005289      005297M
          ENDLINE           P(6,2)                 000240D     001159      005216M     005275M
                                                   005298M
          EOFCHECK          N(1)                   000366D     002569      002575M     004209M
                                                   004861M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    196
          EOFFILE           A(14)                  000368D     004211M     004863M
          EOFIND            A(2)                   000367D     002572      004210M     004862M
          EQ                A(2)                   000101D     002933      002935      003089
                                                   003091      003174      003176      003222
                                                   004208      004210      004284      004386
                                                   004388      004418      004436      004465
                                                   004467      004860      004862
          EQCHECK           N(1)                   000380D     002638      002677      002688M
                                                   002934M     003175M
          EQFACTOR1         A(14)                  000382D     002680      002936M     003177M
          EQFACTOR2         A(14)                  000383D     002681      002937M     003178M
          EQIND             A(2)                   000381D     002640      002683      002935M
                                                   003176M
          EQUALCHECK        N(1)                   000385D     002580      002586M     004466M
          EQUALIND          A(2)                   000386D     002583      004467M
          ERRCHECK          N(1)                   000356D     002547      002553M     002705M
                                                   002792M     002811M     003010M     003041M
                                                   003086M     003123M     003144M     003200M
                                                   003226M     003404M     003629M     003692M
                                                   003711M     003846M     004042M     004071M
                                                   004107M     004144M     004178M     004214M
                                                   004234M     004254M     004288M     004323M
                                                   004383M     004470M     004627M     004669M
                                                   004693M     004725M     004751M     004866M
                                                   004940M
          ERRIND            A(2)                   000357D     002550      002706M     002793M
                                                   002812M     003011M     003042M     003087M
                                                   003124M     003145M     003201M     003227M
                                                   003405M     003630M     003693M     003712M
                                                   003847M     004043M     004072M     004108M
                                                   004145M     004179M     004215M     004235M
                                                   004255M     004289M     004324M     004384M
                                                   004471M     004628M     004670M     004694M
                                                   004726M     004752M     004867M     004941M
 *RNF7031 ERRORIND          N(1)                   000146D
          EVALOFFSET        P(3,0)                 000322D     001049
          EVALOPERATOR      A(10)                  000321D     003532      003562M     003564M
          EXTFACTOR2        A(45)                  000104D     002847      002857      003280
                                                   003290      003541      003543      003553
                                                   003707      003726      003739      003761
                                                   003771      004086      004089      004304
                                                   004498      004775      004785      005049
          FACTOR1           A(14)                  000093D     000284      000303      000304
                                                   000311      000344      000353      000372
                                                   000377      000382      002700      002728
                                                   002734      002781      002784      002826
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    197
                                                   002906      002914      002924      002930
                                                   002936      002954      002955      002964
                                                   002967      003025      003075      003079
                                                   003138      003163      003170      003177
                                                   003248      003252      003329      003332
                                                   003335M     003356      003388      003389
                                                   003419      003420      003464      003807
                                                   003837      003838      003946      003999
                                                   004005      004036      004057      004062
                                                   004135      004138      004169      004172
                                                   004193      004194      004249      004271
                                                   004272      004317      004339      004342
                                                   004344      004345      004451      004535
                                                   004541      004596      004599      004621
                                                   004645      004646      004652      004688
                                                   004820      004911      004915      004916
                                                   005371
          FACTOR2           A(14)                  000095D     000285      000305      000312
                                                   000314      000316      000317      000345
                                                   000354      000364      000368      000373
                                                   000378      000383      002701      002731
                                                   002735      002752      002758      002759
                                                   002807      002907      002915      002925
                                                   002931      002937      002971      002974
                                                   002976      002977      003026      003038
                                                   003069      003075      003079      003080
                                                   003120      003164      003171      003178
                                                   003215      003223      003250      003253
                                                   003334      003336M     003358      003390
                                                   003391      003449      003474      003475
                                                   003578      003618      003644      003658
                                                   003664      003665      003809      003839
                                                   003841      003939      003944      003949
                                                   004002      004006      004037      004059
                                                   004061      004103      004136      004139
                                                   004159      004170      004173      004195
                                                   004197      004211      004229      004250
                                                   004275      004276      004285      004349
                                                   004352      004354      004355      004452
                                                   004463      004513      004538      004542
                                                   004559      004573      004574      004622
                                                   004654      004657      004659      004663
                                                   004721      004740      004822      004850
                                                   004863      004882      004887      004920
                                                   004923      004925      004926      004955
                                                   004974      005373      005382      005384
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    198
                                                   005387
          FILEADD           A(1)                   000127D     002237
          FILEDESIG         A(1)                   000126D     002236
          FILEDEVICE        A(7)                   000130D     002238
          FILEEXTERNAL      A(1)                   000128D     002270
          FILEKEYED         A(1)                   000129D     002239
          FILEKEYWORDS      A(37)                  000131D     002329      002332      002348
                                                   002352      002375      005093
          FILENAME          A(10)                  000124D     002268      005093
          FILESPEC          A(100)                 000123D     000124      000125      000126
                                                   000127      000128      000129      000130
                                                   000131
          FILEUSAGE         A(1)                   000125D     002235
          FORCOUNT          P(3,0)                 000342D     000887M     000888      000922M
                                                   003472      003473
          FORFACTOR1        A(14)                  000344D     003330M     003332M     003342
          FORFACTOR2        A(14)                  000345D     003334M     003343
          FORLEVEL(99)      P(3,0)                 000343D     000888M     003473
          FOUNDCHECK        N(1)                   000359D     002536      002542M     004387M
          FOUNDIND          A(2)                   000360D     002539      004388M
          FROMFILELIB       A(21)                  000211D     000458      005564M
          FULLLINE          A(94)                  000089D     000711      000714      001112M
                                                   001616      002233      002458      005140
                                                   005621
          GETDECLARATIONTYPE...
                            PROTOTYPE              000066D     001628M     002465M     005258M
                                                   005595      005598
          HI                A(2)                   000099D     002921      002923      002955
                                                   003035      003037      003160      003162
                                                   003220      004282      004416      004434
                                                   004460      004462      004485      004646
          HICHECK           N(1)                   000370D     002628      002647      002658M
                                                   002922M     003090M     003161M
          HIFACTOR1         A(14)                  000372D     002650      002924M     003092M
                                                   003163M
          HIFACTOR2         A(14)                  000373D     002651      002925M     003093M
                                                   003164M
          HIIND             A(2)                   000371D     002630      002653      002923M
                                                   003091M     003162M
          I                 P(3,0)                 000204D     001754M     001755      001756
                                                   001759      001761      002041M     002042
                                                   002044      002046      002051      002051
                                                   002057      002057      002110M     002111
                                                   002112      002115      002117      002125M
                                                   002126      002127      002130      002132
                                                   002140M     002141      005117      005200
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    199
                                                   005285      005701
          IFCOMPARE         A(2)                   000334D     003783M     003787M     003790M
                                                   003794      003795M     003796      003797M
                                                   003798      003799M     003800      003801M
                                                   003802      003803M     003804      003805M
                                                   003808
          IFOPERATOR        A(10)                  000333D     003754      003821M     003823M
          INARRAYDATA       N(1)                   000220D     000511M     000514      001108
                                                   005580M
          INCALLP           N(1)                   000324D     001046      001140      001149M
                                                   001236      002840      002846      002852M
                                                   002866
          INCASE            N(1)                   000234D     000442      002905      002909M
                                                   003506      003518M
          INCODE            N(1)                   000219D     000509M     000518M     000525M
                                                   000528M     000530M     000532M     000534M
                                                   000536M     000546M     000594      000625
                                                   000716      000831M     000841M     000963
                                                   001026      001108      001136M     005579M
          INCOMMENT         N(1)                   000221D     000495M     000598M     000618M
                                                   000628M     000640M     000645      000656
                                                   000669      000681      000693      000705
                                                   000793      000981      000995M     001060
                                                   001142
          INCREMENT         P(1,0)                 000246D     000496M     000869M     000873M
                                                   000878M     000881M     000886M     000890M
                                                   000894M     000898M     000903M     000906M
                                                   000909M     000914M     000917M     000921M
                                                   000925M     000929M     000933M     000937M
                                                   000941M     000945M     000950M     000954M
                                                   000956M     000970      000971M     001127
          INDATASTRUCTURE   N(1)                   000225D     001158      001160      001161
                                                   001171M     001660      001865      001872
                                                   001879M     001915      002003      002027
          INDECLARATION     N(1)                   000222D     000510M     000743      000760
                                                   000830      000958      001141      001152M
                                                   001173M     001625      001626      001635M
                                                   001641M     001728M     001773M     001812M
                                                   001841M     001866M     001989M     002157M
                                                   002197M     002243      002262M     002271M
                                                   002358M     002367M     002405      002406M
                                                   002422M     002462      002463      002471M
                                                   002498M     002508M
 *RNF7031 INDECLPROC        N(1)                   000231D
          INDENT            N(1)                   000232D     000928M     000932M     000936M
                                                   000940M     000944M     000949M     000953M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    200
                                                   001130      001132M
          INDENTCOUNT       P(3,0)                 000247D     000884      000888      000892
                                                   000896M     000900M     000904M     000970M
                                                   001039      001042      001127M     001131M
                                                   001135M     003473      003490      003499
                                                   005581M     005583M
          INDENTOFFSET      P(3,0)                 000249D     001031      001040M     001042M
                                                   001047M     001049M     001051M     001051
                                                   001055      001056M     001077      001079M
                                                   001079      001083      001084M     001089
                                                   001119      001783M     002168M
          INDENTSIZE        P(1,0)                 000248D     001040      001042
 *RNF7031 INDICATORDS       DS(99)                 000135D
          INDIRECTIVE       N(1)                   000229D     000494M     000545M     000565M
                                                   000569M     000573M     000577M     000581M
                                                   000585M     000589M     000646      000769
                                                   000792      000979
          INDO              N(1)                   000328D     000882M     000947      001070
                                                   001140      001147M     001317      003271
                                                   003279      003284M     003301      003361M
                                                   003363M     003369
          INEVAL            N(1)                   000320D     001048      001140      001150M
                                                   001347      003531      003537      003538M
                                                   003561
          INEXTPROC         N(1)                   000227D     001169M     001174M     001897
                                                   002100      002104M     002143M
          INFREEFORMAT      N(1)                   000230D     000544      000547M     000717M
                                                   000734M     000743      000751M     000760
                                                   000768M     000797      000978
          INIF              N(1)                   000332D     000722      000879M     000947
                                                   001070      001140      001146M     001387
                                                   003753      003760      003765M     003782
                                                   003812M     003814M     003820
          ININTERFACE       N(1)                   000224D     001158      001170M     001863
                                                   001871      001877M
          INITIALCALL       A(1)                   000193D     005509      005527      005528M
                                                   005530M     005558
          INPROTOTYPE       N(1)                   000223D     001158      001168M     001861
                                                   001870      001875M     001894      005151
                                                   005637
          INSPAN            N(1)                   000233D     000725M     000727      000781M
                                                   001050      001071M     001140      001145M
                                                   001172M     001767      001775M     001804
                                                   001839      001843M     001853      001898
                                                   002149      002160M     002189      002208
                                                   002212M     002356      002360M     002376
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    201
                                                   002380M     002420      002424M     002433
                                                   002437M     002496      002500M     002516
                                                   002520M     002848      002853M     002858
                                                   002862M     003281      003285M     003291
                                                   003295M     003359      003364M     003545
                                                   003548M     003554      003557M     003596M
                                                   003599      003603M     003762      003766M
                                                   003772      003777M     003810      003815M
                                                   004776      004780M     004786      004790M
                                                   004823      004828M     004992M     005002M
                                                   005007      005028M     005036M     005042M
                                                   005050M     005055M     005060M     005067M
                                                   005074M     005081M     005088M     005094M
                                                   005244
          INSQL             N(1)                   000340D     000800      000820M     000870M
                                                   000875      001141      001151M     001195
                                                   003595M     003602M
          INWHEN            N(1)                   000336D     000942      000946M     001070
                                                   001140      001148M     001576      004767
                                                   004774      004779M     004795      004825M
                                                   004827M     004833
          J                 P(3,0)                 000205D     002046M     002047      002051
                                                   002052      002057      002058
          LEN               A(5)                   000097D     000857M     005344      005350
                                                   005351      005351      005359      005375
                                                   005375      005376M     005376      005378
          LINEEND           P(3,0)                 000252D     001061M     001062      001063M
                                                   001064      001065M     001066      001068M
                                                   001077      001079      001143M     001144
          LINETYPE          A(1)                   000086D     000499      000539M     000548M
                                                   000566M     000570M     000574M     000578M
                                                   000582M     000586M     000590M     000594
                                                   000606M     000621M     000757      001109
                                                   002341M     004994      005012M     005012
                                                   005014      005015      005019      005032
                                                   005040      005045      005086      005091
                                                   005157      005176M     005176      005178
                                                   005223      005224      005290      005324
                                                   005332      005422M     005643      005669M
                                                   005669      005671      005796M     005796
                                                   005798      005799      005803
          LO                CONST                  000075D     000498      000499      000651
                                                   000723      000724      000816      000817
                                                   000829      000833      000853      000864
                                                   001619      001640      001671      001687
                                                   001698      001720      001752      001759
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    202
                                                   001817      001931      001948      001959
                                                   001981      002039      002043      002045
                                                   002066      002068      002085      002108
                                                   002115      002123      002130      002138
                                                   002235      002236      002237      002238
                                                   002239      002270      002275      002759
                                                   002955      002955      003300      003665
                                                   003781      003948      004574      004606
                                                   004646      004646      004794      004994
                                                   005012      005047      005136      005157
                                                   005176      005184      005224      005229
                                                   005325      005327      005332      005334
                                                   005347      005368      005371      005382
                                                   005401      005617      005643      005659
                                                   005669      005678      005685      005781
                                                   005796
          LW                A(2)                   000100D     002704      002706      002791
                                                   002793      002810      002812      002927
                                                   002929      003009      003011      003040
                                                   003042      003085      003087      003122
                                                   003124      003143      003145      003167
                                                   003169      003199      003201      003225
                                                   003227      003403      003405      003628
                                                   003630      003691      003693      003710
                                                   003712      003845      003847      004041
                                                   004043      004070      004072      004106
                                                   004108      004143      004145      004177
                                                   004179      004213      004215      004233
                                                   004235      004253      004255      004287
                                                   004289      004322      004324      004382
                                                   004384      004417      004435      004469
                                                   004471      004626      004628      004668
                                                   004670      004692      004694      004724
                                                   004726      004750      004752      004865
                                                   004867      004939      004941
          LWCHECK           N(1)                   000375D     002633      002662      002673M
                                                   002928M     003168M
          LWFACTOR1         A(14)                  000377D     002665      002930M     003170M
          LWFACTOR2         A(14)                  000378D     002666      002931M     003171M
          LWIND             A(2)                   000376D     002635      002668      002929M
                                                   003169M
          MAINLINEINDENT    P(3,0)                 000253D     000895M     000896      000899M
                                                   000900      000904      001135      005583
          MAXINDENT         P(3,0)                 000207D     001039      001040      005576M
          MOVEDDEFS(999)    A(14)                  000208D     005317M     005347      005400
                                                   005401M     005577M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    203
          MOVEDEF           N(1)                   000209D     005345M     005352M     005369M
                                                   005392      005578M
          NEWOPERATOR       A(10)                  000216D     000986M     000990M     000996M
                            VARYING(2)             000999M     001005      001006      001008
                                                   001023
          NONCONVRSN        A(93)                  000217D     000502M     000657      000658M
                                                   000670      000671M     000682      000694
                                                   000706      000774      000777      001206M
                                                   001642M     002264M     002369M     002754M
                                                   002777M     002956M     003058M     003465M
                                                   003660M     003683M     003952M     003964M
                                                   004064M     004160M     004165M     004563M
                                                   004592M     004617M     004647M
          NONPREFIX         A(95)                  000106D     000431M     001106M     002537M
                                                   002548M     002559M     002570M     002581M
                                                   002592M     002608M     002629M     002634M
                                                   002639M     002648M     002663M     002678M
          NRFCHECK          N(1)                   000362D     002558      002564M     003036M
                                                   003221M     004283M     004461M
          NRFFILE           A(14)                  000364D     003038M     003223M     004285M
                                                   004463M
          NRFIND            A(2)                   000363D     002561      003037M     003222M
                                                   004284M     004462M
          OPCODE            A(10)                  000094D     000321      000325      000329
                                                   000333      000337      000651      000853
                                                   003300M     003300      003302      003303
                                                   003305      003306      003309      003781M
                                                   003781      003783      003786      003787
                                                   003790      004794M     004794      004796
                                                   004799      004800      004803      005047M
                                                   005047      005049      005054      005059
                                                   005064      005065      005066      005071
                                                   005072      005073      005078      005079
                                                   005080      005334M     005334      005336
                                                   005337      005338      005339      005340
                                                   005341      005342      005343      005344
                                                   005368
          OPERATOR          A(10)                  000214D     000651M     000664M     000799M
                                                   000801M     000804M     000805      000807
                                                   000809      000814M     000814      000816
                                                   000819M     000823      000825M     000825
                                                   000829      000833      000837M     000840M
                                                   000851M     000853M     000854      000855
                                                   000864M     000864      000877      000880
                                                   000885      000889      000893      000897
                                                   000902      000905      000907      000911
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    204
                                                   000912M     000915      000919      000923
                                                   000926      000930      000934      000938
                                                   000942      000951      000984      000988
                                                   000997M     001046      001048      001134
                                                   001211      001216      001221      001226
                                                   001231      001236      001241      001246
                                                   001251      001256      001261      001266
                                                   001271      001276      001281      001286
                                                   001291      001296      001301      001302
                                                   001303      001304      001305      001306
                                                   001307      001308      001309      001310
                                                   001311      001312      001313      001314
                                                   001315      001316      001322      001327
                                                   001332      001337      001342      001347
                                                   001352      001357      001362      001367
                                                   001372      001377      001382      001387
                                                   001392      001397      001402      001407
                                                   001412      001418      001423      001428
                                                   001433      001438      001443      001448
                                                   001453      001458      001463      001468
                                                   001473      001478      001483      001488
                                                   001493      001498      001503      001504
                                                   001509      001514      001519      001524
                                                   001529      001534      001539      001544
                                                   001548      001552      001556      001561
                                                   001566      001571      001576      001581
                                                   001586      001591      001596      002700
                                                   002721      002841M     002847      002851
                                                   002867      002885      002952      002961M
                                                   003025      003062      003063M     003065M
                                                   003074      003078      003120      003138
                                                   003194      003215      003242      003272M
                                                   003277      003278      003280      003370
                                                   003386      003420      003422      003463
                                                   003471      003471      003474M     003488
                                                   003488      003491M     003497      003497
                                                   003500M     003505      003507M     003509M
                                                   003513      003517      003532M     003539
                                                   003540      003541      003552      003562
                                                   003578      003618      003707      003726
                                                   003754M     003759      003761      003821
                                                   003838      003841      003861      003874
                                                   003935      003937      003942      003992
                                                   004036      004087      004089      004103
                                                   004136      004138      004170      004172
                                                   004194      004197      004249      004269
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    205
                                                   004303      004317      004451      004498
                                                   004527      004529M     004643      004684
                                                   004685M     004688      004721      004740
                                                   004768M     004773      004775      004834
                                                   004850      004881      004958      004977
                                                   005048      005053      005058      005063
                                                   005070      005077
          OPERATOREND       P(3,0)                 000215D     000805M     000806      000807M
                                                   000808      000809M     000813      000814
                                                   000823M     000824      000825
          OVERFLOW          N(1)                   000030D     000144D     000452      000463M
                                                   005561M
          OVERFLOWLINE      A(92)                  000257D     001117      001119      001120M
                            VARYING(2)             001782      002167
          PADRESULT         N(1)                   000281D     001028      001035M
          PADTARGET         A(14)                  000282D     001032
          PREFIX            A(5)                   000085D     000507
          PREVOFFSET        P(3,0)                 000250D     000730M     001051
          PROCKEYWORDS      A(37)                  000109D     002483      002485      005035
          PROCTYPE          A(1)                   000108D     005035
          QCOMMENTS(3)      A(92)                  000201D     005413      005415      005417
                                                   005436      005438      005440      005915M
          QDECLLO(12)       A(10)                  000200D     000990
          QDECLUP(12)       A(10)                  000199D     000200      000833      000988
                                                   005902M
          QOPCODELO(66)     A(10)                  000198D     000986
          QOPCODEUP(66)     A(10)                  000197D     000198      000829      000984
                                                   003948      005835M
          QPDIRECTIVES      A(1)                   000060D     000550      000744      000761
                            BASED(_QRNL_PRM+)
          QPFROMFILE        A(10)                  000052D     005564
                            BASED(_QRNL_PRM+)
          QPFROMLIB         A(10)                  000053D     005564
                            BASED(_QRNL_PRM+)
          QPFROMMBR         A(10)                  000019      000054D     000466
                            BASED(_QRNL_PRM+)
          QPINDCOMMENT      A(1)                   000058D     000597      000627
                            BASED(_QRNL_PRM+)
          QPRETBLNKCMT      A(1)                   000059D     000610      000631
                            BASED(_QRNL_PRM+)
          QPSHUTDOWN        A(1)                   000051D     005504      005509      005553
                            BASED(_QRNL_PRM+)
          QPTOFILE          A(10)                  000055D     005567
                            BASED(_QRNL_PRM+)
          QPTOLIB           A(10)                  000056D     005567
                            BASED(_QRNL_PRM+)
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    206
          QPTOMBR           A(10)                  000024      000057D     000467
                            BASED(_QRNL_PRM+)
          RESULT            A(14)                  000096D     000208      000282      002729
                                                   002730      002733      002782      002782
                                                   002784      002807      002884      002955
                                                   002965      002994      002998      003003
                                                   003028      003029      003057      003074
                                                   003078      003092      003107      003194
                                                   003249      003256      003338      003339M
                                                   003341      003392      003395      003396
                                                   003621      003622      003687      003939
                                                   003944      003948      003949      004000
                                                   004001      004004      004022      004058
                                                   004060      004164      004201      004202
                                                   004229      004279      004373      004378
                                                   004453      004454      004513      004536
                                                   004537      004540      004561      004597
                                                   004597      004599      004605      004606
                                                   004646      004662      004689      004708
                                                   004743      004744      004853      004854
                                                   004882      004886      004930      004955
                                                   004974      005347      005353      005370
                                                   005401
          SAVEDCOMMENT      A(20)                  000278D     000652M     000665M     000677M
                                                   000689M     000701M     001092      001093
                                                   001094M     002349M
          SAVEDLINETYPE     A(1)                   000244D     004994M     004998      005015
                                                   005157M     005178
          SAVEDNAME         A(80)                  000279D     001628      001647      001649
                                                   001805M     001815      001817      001854M
                                                   001883      001884M     001886      001889
                                                   001895      001899M     001902      001903
                                                   002078      002079M     002158M     002189
                                                   002190M     002268M     002275      002465
                                                   002480      002505M     005137M     005140M
                                                   005165      005167M     005167
          SAVEDSRCDTA       A(100)                 000255D     000745M     000749      000762M
                                                   000766      000775M     000779      001029M
                                                   001034      001087M     001097      001162M
                                                   001166      002340M     002345      003476M
                                                   003481      004993M     005121      005156M
                                                   005204      005215M     005303      005315M
                                                   005453
          SCANBASE          A(14)                  000285D     004352M     004355M     004362
                                                   004368
          SCANLENGTH        A(10)                  000286D     004341M     004344M     004359
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    207
                                                   004367
          SCANNORESULT      N(1)                   000288D     000430      000438M     004374M
                                                   004377M
          SCANSTART         A(10)                  000287D     004351M     004354M     004362
                                                   004368
          SCANSTRING        A(14)                  000284D     004342M     004345M     004361
                                                   004367
          SETOFF            N(1)                   000293D     001091      002591      002605M
                                                   004415M
          SETOFFIND1        A(2)                   000294D     002593      002594      004416M
          SETOFFIND2        A(2)                   000295D     002597      002598      004417M
          SETOFFIND3        A(2)                   000296D     002601      002602      004418M
          SETON             N(1)                   000298D     001091      002607      002621M
                                                   004433M
          SETONIND1         A(2)                   000299D     002609      002610      004434M
          SETONIND2         A(2)                   000300D     002613      002614      004435M
          SETONIND3         A(2)                   000301D     002617      002618      004436M
          SLCOUNT           P(3,0)                 000350D     000891M     000892      000910M
                                                   003498      003499
          SLLEVEL(99)       P(3,0)                 000351D     000892M     003499
 *RNF7031 SOURCEDATA        DS(100)                000083D
          SOURCELINE        A(93)                  000256D     000504M     000711M     000714M
                                                   000732M     000735M     000785M     000798
                                                   000804      000817      000838      000843M
                                                   000843      000850      000980      000993
                                                   001006      001007M     001007      001012M
                                                   001016      001017      001018      001019
                                                   001020      001021M     001021      001023M
                                                   001023      001055      001056      001061
                                                   001063      001066      001068      001089
                                                   001096M     001110      001112      001143
                                                   001190M     001611M     001616M     001803M
                                                   001852M     001890      002188M     002211M
                                                   002228M     002233M     002364M     002379M
                                                   002396M     002401M     002428M     002436M
                                                   002453M     002458M     002504M     002519M
                                                   002700M     002723M     002725M     002729M
                                                   002729      002733M     002733      002738M
                                                   002738      002782M     002784M     002787M
                                                   002787      002807M     002826M     002847M
                                                   002849M     002849      002856M     002857M
                                                   002859M     002859      002906M     002912M
                                                   002914M     002994M     002998M     003003M
                                                   003025M     003029M     003029      003031M
                                                   003031      003074M     003078M     003107M
                                                   003120M     003138M     003140M     003140
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    208
                                                   003194M     003196M     003196      003215M
                                                   003217M     003217      003243M     003245M
                                                   003256M     003256      003280M     003282M
                                                   003282      003288M     003290M     003292M
                                                   003292      003303M     003307M     003310M
                                                   003341M     003356M     003356      003360M
                                                   003360      003386M     003389M     003389
                                                   003391M     003391      003393M     003393
                                                   003396M     003396      003400M     003400
                                                   003420M     003422M     003436M     003449M
                                                   003513M     003541M     003543M     003546M
                                                   003546      003551M     003552M     003555M
                                                   003555      003578M     003594M     003598M
                                                   003600M     003600      003618M     003622M
                                                   003622      003624M     003624      003644M
                                                   003687M     003707M     003726M     003739M
                                                   003761M     003763M     003763      003771M
                                                   003773M     003773      003784M     003788M
                                                   003791M     003807M     003807      003811M
                                                   003811      003838M     003841M     003861M
                                                   003874M     003921M     003939M     003944M
                                                   003949M     003994M     003996M     004000M
                                                   004000      004004M     004004      004009M
                                                   004009      004022M     004036M     004058M
                                                   004061M     004087M     004089M     004103M
                                                   004122M     004136M     004138M     004170M
                                                   004172M     004194M     004197M     004202M
                                                   004202      004204M     004204      004229M
                                                   004249M     004269M     004272M     004272
                                                   004276M     004276      004279M     004279
                                                   004303M     004317M     004319M     004319
                                                   004361M     004366M     004375M     004375
                                                   004378M     004378      004402M     004451M
                                                   004454M     004454      004456M     004456
                                                   004485M     004498M     004500M     004500
                                                   004513M     004530M     004532M     004536M
                                                   004536      004540M     004540      004545M
                                                   004545      004597M     004599M     004602M
                                                   004602      004621M     004662M     004688M
                                                   004708M     004721M     004740M     004744M
                                                   004744      004746M     004746      004775M
                                                   004777M     004777      004785M     004787M
                                                   004787      004797M     004801M     004804M
                                                   004820M     004820      004824M     004824
                                                   004850M     004854M     004854      004856M
                                                   004856      004882M     004886M     004930M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    209
                                                   004934M     004934      004936M     004936
                                                   004955M     004959M     004959      004974M
                                                   004978M     004978
          SPLITLINE         PROTOTYPE              001782M     002167M     005716      005719
          SRCDAT            P(6,0)                1000003M    2000003
          SRCDTA            A(100)                 000084D     000085      000086      000087
                                                   000088      000089      000091      000092
                                                   000093      000094      000095      000096
                                                   000097      000098      000099      000100
                                                   000101      000102      000104      000106
                                                   000108      000109      000111      000112
                                                   000113      000114      000115      000116
                                                   000117      000118      000119      000120
                                                   000121      000123      000255     1000004M
                                                   000508      000745      000746M     000749M
                                                   000762      000763M     000766M     000775
                                                   000776M     000779M     001029      001034M
                                                   001087      001097M     001162      001163M
                                                   001166M     002340      002345M     003476
                                                   003481M     004993      005121M     005156
                                                   005204M     005215      005303M     005315
                                                   005412M     005435M     005453M    2000004
                                                   005642      005705M     005775      005824M
          SRCSEQ            P(6,2)                 000069      000239      000240      000263
                                                   000267     1000002M     001159      005152
                                                   005185      005246      005275      005298
                                                   005314      005448     2000002      005601
                                                   005638      005660      005679      005686
          SUBEXITPROGRAM    BEGSR                  000407      005476D     005554
          SUBINITIALISE     BEGSR                  000401      005524D
          SUBSTLEN          A(10)                  000290D     004652M     004665
          SUBSTSTART        A(10)                  000291D     004656M     004659M     004664
          SUBUSERCHECKSPAN  BEGSR                  001622      002241      002403      002460
                                                   002844      003275      003535      003591
                                                   003757      004771      004990D
          SUBUSERCONVERTC_SPEC...
                            BEGSR                  000654      001185D
          SUBUSERCONVERTD_SPEC...
                            BEGSR                  000679      001607D
          SUBUSERCONVERTF_SPEC...
                            BEGSR                  000691      002224D
          SUBUSERCONVERTH_SPEC...
                            BEGSR                  000703      002392D
          SUBUSERCONVERTP_SPEC...
                            BEGSR                  000667      002449D
          SUBUSERCVT_ACQ    BEGSR                  001212      002698D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    210
          SUBUSERCVT_ADD    BEGSR                  001222      002718D
          SUBUSERCVT_ADDDUR BEGSR                  001217      002749D
          SUBUSERCVT_ALLOC  BEGSR                  001227      002805D
          SUBUSERCVT_BEGSR  BEGSR                  001232      002824D
          SUBUSERCVT_CALLP  BEGSR                  001237      002837D
          SUBUSERCVT_CASXX  BEGSR                  001242      002881D
          SUBUSERCVT_CAT    BEGSR                  001247      002949D
          SUBUSERCVT_CHAIN  BEGSR                  001252      003023D
          SUBUSERCVT_CHECKX BEGSR                  001257      003054D
          SUBUSERCVT_CLEAR  BEGSR                  001262      003105D
          SUBUSERCVT_CLOSE  BEGSR                  001267      003118D
          SUBUSERCVT_COMMIT BEGSR                  001272      003136D
          SUBUSERCVT_COMP   BEGSR                  001277      003157D
          SUBUSERCVT_DEALLOC...
                            BEGSR                  001282      003192D
          SUBUSERCVT_DELETE BEGSR                  001292      003213D
          SUBUSERCVT_DIV    BEGSR                  001297      003239D
          SUBUSERCVT_DO     BEGSR                  001318      003269D
          SUBUSERCVT_DSPLY  BEGSR                  001323      003384D
          SUBUSERCVT_DUMP   BEGSR                  001328      003417D
          SUBUSERCVT_ELSE   BEGSR                  001333      003434D
          SUBUSERCVT_ELSEIF BEGSR                  001338      003447D
          SUBUSERCVT_ENDXX  BEGSR                  001343      003460D
          SUBUSERCVT_EVALX  BEGSR                  001348      003528D
          SUBUSERCVT_EXCEPT BEGSR                  001353      003576D
          SUBUSERCVT_EXEC_SQL...
                            BEGSR                  001196      003589D
          SUBUSERCVT_EXFMT  BEGSR                  001358      003616D
          SUBUSERCVT_EXSR   BEGSR                  001363      003642D
          SUBUSERCVT_EXTRCT BEGSR                  001368      003655D
          SUBUSERCVT_FEOD   BEGSR                  001373      003705D
          SUBUSERCVT_FOR    BEGSR                  001378      003737D
          SUBUSERCVT_FORCE  BEGSR                  001383      003724D
          SUBUSERCVT_IF     BEGSR                  001388      003750D
          SUBUSERCVT_IN     BEGSR                  001393      003835D
          SUBUSERCVT_ITER   BEGSR                  001398      003859D
          SUBUSERCVT_LEAVE  BEGSR                  001403      003872D
          SUBUSERCVT_LOOKUP BEGSR                  001408      003885D
          SUBUSERCVT_MONITOR...
                            BEGSR                  001419      003919D
          SUBUSERCVT_MOVE   BEGSR                  001424      003932D
          SUBUSERCVT_MOVEA  BEGSR                  001413      003978D
          SUBUSERCVT_MULT   BEGSR                  001429      003989D
          SUBUSERCVT_MVR    BEGSR                  001434      004020D
 *RNF7031 SUBUSERCVT_NEXT   BEGSR                  004034D
          SUBUSERCVT_OCCUR  BEGSR                  001439      004055D
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    211
          SUBUSERCVT_ON_ERROR...
                            BEGSR                  001444      004084D
          SUBUSERCVT_OPEN   BEGSR                  001449      004101D
          SUBUSERCVT_OTHER  BEGSR                  001454      004120D
          SUBUSERCVT_OUT    BEGSR                  001459      004133D
          SUBUSERCVT_POST   BEGSR                  001464      004157D
          SUBUSERCVT_READ   BEGSR                  001469      004191D
 *RNF7031 SUBUSERCVT_REALLOC...
                            BEGSR                  004227D
          SUBUSERCVT_REL    BEGSR                  001474      004247D
          SUBUSERCVT_RESET  BEGSR                  001479      004267D
          SUBUSERCVT_RETURN BEGSR                  001484      004301D
          SUBUSERCVT_ROLBK  BEGSR                  001489      004315D
          SUBUSERCVT_SCAN   BEGSR                  001494      004336D
          SUBUSERCVT_SELECT BEGSR                  001499      004400D
          SUBUSERCVT_SETOFF BEGSR                  001510      004413D
          SUBUSERCVT_SETON  BEGSR                  001515      004431D
          SUBUSERCVT_SETXX  BEGSR                  001505      004449D
          SUBUSERCVT_SHTDN  BEGSR                  001520      004483D
          SUBUSERCVT_SORTA  BEGSR                  001525      004496D
 *RNF7031 SUBUSERCVT_SQRT   BEGSR                  004511D
          SUBUSERCVT_SUB    BEGSR                  001540      004524D
          SUBUSERCVT_SUBDUR BEGSR                  001530      004556D
          SUBUSERCVT_SUBST  BEGSR                  001535      004640D
          SUBUSERCVT_TEST   BEGSR                  001557      004682D
          SUBUSERCVT_TIME   BEGSR                  001562      004706D
          SUBUSERCVT_UNLOCK BEGSR                  001572      004719D
          SUBUSERCVT_UPDATE BEGSR                  001567      004738D
          SUBUSERCVT_WHEN   BEGSR                  001577      004764D
          SUBUSERCVT_WRITE  BEGSR                  001582      004848D
 *RNF7031 SUBUSERCVT_XFOOT  BEGSR                  004879D
          SUBUSERCVT_XLATE  BEGSR                  001587      004899D
          SUBUSERCVT_Z_ADD  BEGSR                  001592      004953D
          SUBUSERCVT_Z_SUB  BEGSR                  001597      004971D
          SUBUSEREXITPROGRAM...
                            BEGSR                  005478      005499D
          SUBUSERFUNCTION   BEGSR                  000404      000414D
 *RNF7031 SUBUSERGETDECLARATIONTYPE...
                            BEGSR                  005130D
          SUBUSERGETENDLINE BEGSR                  001873      005213D
          SUBUSERINITIALISE BEGSR                  005534      005543D
          SUBUSERMOVEDEFS   BEGSR                  000964      005312D
          SUBUSERREFORMATLINE...
                            BEGSR                  000425      000434      000436      000444
                                                   000492D     002540      002551      002562
                                                   002573      002584      002595      002599
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    212
                                                   002603      002611      002615      002619
                                                   002631      002636      002641      002652
                                                   002654      002656      002667      002669
                                                   002671      002682      002684      002686
          SUBUSERSETINDICATORS...
                            BEGSR                  000427      002532D
          SUBUSERWRITELINE  BEGSR                  000748      000765      000778      001033
                                                   001114      001121      001165      002344
                                                   003480      005414      005416      005418
                                                   005427      005437      005439      005441
                                                   005462D
          TEMPDECLLINE      P(6,2)                 000267D     005260
          TEMPDECLTYPE      A(2)                   000266D     005258      005261
          TEMPSAVEDNAME     A(80)                  000268D     005259
          TOFILELIB         A(21)                  000212D     000459      005567M
          UNINDENT          N(1)                   000236D     000872M     000908M     000913M
                                                   000916M     000920M     000924M     000927M
                                                   000931M     000935M     000939M     000943M
                                                   000948M     000952M     000969      000972M
          UP                CONST                  000076D     000498      000499      000651
                                                   000723      000724      000816      000817
                                                   000829      000833      000853      000864
                                                   001619      001640      001671      001687
                                                   001698      001720      001752      001759
                                                   001817      001931      001948      001959
                                                   001981      002039      002043      002045
                                                   002066      002068      002085      002108
                                                   002115      002123      002130      002138
                                                   002235      002236      002237      002238
                                                   002239      002270      002275      002759
                                                   002955      003300      003665      003781
                                                   003948      004574      004606      004646
                                                   004794      004994      005012      005047
                                                   005136      005157      005176      005184
                                                   005224      005229      005325      005327
                                                   005332      005334      005347      005368
                                                   005371      005382      005401      005617
                                                   005643      005659      005669      005678
                                                   005685      005781      005796
          VALIDSPECS        CONST                  000077D     000537
          WHENCOMPARE       A(2)                   000338D     004796M     004800M     004803M
                                                   004807      004808M     004809      004810M
                                                   004811      004812M     004813      004814M
                                                   004815      004816M     004817      004818M
                                                   004821
          WHENOPERATOR      A(10)                  000337D     004768      004834M     004836M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    213
          WORKDECLATTR      A(1)                   000261D     001619M     001653      001658M
                                                   001661M     001663M     001668      001670
                                                   001683      001685      001696      001707
                                                   001709      001711      001713      001715
                                                   001717      001719      001734      001735
                                                   001736      001737      001738      001739
                                                   001891M     001908      001913M     001916M
                                                   001918M     001923      001925      001944
                                                   001946      001957      001968      001970
                                                   001972      001974      001976      001978
                                                   001980      001995      001996      001997
                                                   001998      001999      002000      002006
                                                   002008
          WORKDECLKEYWORDS  A(92)                  000264D     001620M     001640      001671
                            VARYING(2)             001675M     001675      001677M     001677
                                                   001678      001687      001689      001690
                                                   001692      001694M     001694      001698
                                                   001700      001701      001703      001705M
                                                   001705      001720      001723M     001723
                                                   001752      001754      001756      001757M
                                                   001757      001759      001761      001768
                                                   001771M     001771      001779      001782
                                                   001787      001790      001821      001823
                                                   001826      001931      001935M     001935
                                                   001937M     001937      001938      001948
                                                   001950      001951      001953      001955M
                                                   001955      001959      001961      001962
                                                   001964      001966M     001966      001981
                                                   001984M     001984      002031M     002033M
                                                   002034      002039      002041      002044
                                                   002046      002049M     002051      002052
                                                   002054M     002055      002057      002058
                                                   002066      002068      002077M     002077
                                                   002085      002087M     002088      002090M
                                                   002090      002098      002102      002103M
                                                   002108      002110      002112      002113M
                                                   002113      002115      002117      002123
                                                   002125      002127      002128M     002128
                                                   002130      002132      002138      002140
                                                   002150      002152      002155M     002155
                                                   002164      002167      002172      002175
                                                   002207
          WORKDECLLINE      P(6,2)                 000263D     001628      002465      005152M
                                                   005159M     005185M     005246
          WORKDECLNAME      A(50)                  000262D     001175M     001889M     002045
          WORKDECLTYPE      A(2)                   000260D     001628      001634      001811
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    214
                                                   001860      001862      001864      001874
                                                   001876      001878      001882      001888
                                                   002465      002468      002469      002475
                                                   005136M     005139M     005144      005145
                                                   005146      005147      005148      005149
                                                   005150      005151      005184M
          WORKDIRECTIVE     A(10)                  000258D     000498M     000542      000558
                                                   000564      000568      000572      000576
                                                   000580      000584      000588      000592
                                                   000593      000600      000615      000758
                                                   000868      000871      001195      001200
                                                   003593
          WORKFILEADD       A(1)                   000272D     002237M     002252      002284
                                                   002294
          WORKFILEDESIG     A(1)                   000271D     002236M     002247      002248
                                                   002255      002256      002259
          WORKFILEDEVICE    A(7)                   000274D     002238M     002278      002279
                                                   002285      002286      002287      002300
                                                   002304
          WORKFILEKEYED     A(1)                   000273D     002239M     002315
          WORKFILEUSAGE     A(1)                   000270D     002235M     002246      002249
                                                   002251      002254      002258      002283
                                                   002293      002299      002303
          WORKLENGTH        P(7,0)                 000276D     002004M     002007M     002007
                                                   002009M     002009      002011      002013
          WORKLINETYPE      A(1)                   000259D     000499M     000517      000524
                                                   000527      000529      000531      000533
                                                   000535      000537      000538M     000549M
                                                   000567M     000571M     000575M     000579M
                                                   000583M     000587M     000591M     000597
                                                   000605      000605      000607M     000622M
                                                   000625      000627      000648      000661
                                                   000674      000686      000698      000710
                                                   000713      000716      000842      005224
          X                 P(3,0)                 000202D     000838M     000839      000984M
                                                   000985      000986      000988M     000989
                                                   000990      000993M     000994      001671M
                                                   001672      001674      001675      001677
                                                   001678      001687M     001688      001689M
                                                   001689      001690      001692      001692
                                                   001698M     001699      001700M     001700
                                                   001701      001703      001703      001720M
                                                   001721      001723      001752M     001753
                                                   001754      001756      001756      001757
                                                   001759      001759      001779M     001780
                                                   001781M     001781      001782      001931M
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    215
                                                   001932      001934      001935      001937
                                                   001938      001948M     001949      001950M
                                                   001950      001951      001953      001953
                                                   001959M     001960      001961M     001961
                                                   001962      001964      001964      001981M
                                                   001982      001984      002039M     002040
                                                   002041      002044      002044      002048
                                                   002055      002066M     002067      002068M
                                                   002070      002108M     002109      002110
                                                   002112      002112      002113      002115
                                                   002115      002123M     002124      002125
                                                   002127      002127      002128      002130
                                                   002130      002138M     002139      002140
                                                   002164M     002165      002166M     002166
                                                   002167      002721M     002722      002752M
                                                   002753      002758      002759      002952M
                                                   002953      002971M     002972      002976
                                                   002977      003069M     003072      003079
                                                   003080      003658M     003659      003664
                                                   003665      003935M     003937      003942
                                                   003992M     003993      004339M     004340
                                                   004344      004345      004349M     004350
                                                   004354      004355      004527M     004528
                                                   004559M     004560      004561M     004562
                                                   004573      004574      004605      004606
                                                   004643M     004644      004654M     004655
                                                   004657M     004659      004663      004911M
                                                   004912      004915      004916      004920M
                                                   004921      004925      004926      004995M
                                                   005010M     005117      005158M     005165M
                                                   005166      005167      005168M     005174M
                                                   005200      005221M     005271M     005285
                                                   005400M     005401
          XLATEBASE         A(14)                  000305D     004923M     004926M     004932
          XLATEFROM         A(14)                  000303D     004915M     004931
          XLATESTART        A(10)                  000306D     004922M     004925M     004933
                                                   004934
          XLATETO           A(14)                  000304D     004916M     004931
          Y                 P(3,0)                 000203D     001690M     001692      001694
                                                   001701M     001703      001705      001951M
                                                   001953      001955      001962M     001964
                                                   001966
          ZTFRFL            A(21)                  000458M    4000002
          ZTTOFL            A(21)                  000459M    4000003
          Z1CNVR            P(5,2)                 000475M     000477M    6000010
          Z1CTCV            P(7,0)                 000471M    6000008
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    216
          Z1CTEL            P(7,0)                 000470M    6000007
          Z1CTMV            P(7,0)                 000473M    6000006
          Z1CTNV            P(7,0)                 000472M    6000009
          Z1CTSC            P(7,0)                 000468M    6000004
          Z1CTTG            P(7,0)                 000469M    6000005
          Z1FRMB            A(10)                  000466M    6000002
          Z1QPAG            P(4,0)                 000455M    3000005
          Z1QPGM            A(10)                 3000002
          Z1QTTL            A(40)                  005560M    3000004
          Z1QUSR            A(10)                 3000003
          Z1TOMB            A(10)                  000467M    6000003
       Field References for subprocedure GETDECLARATIONTYPE
          Field             Attributes         References (D=Defined M=Modified)
          QPDECLLINE        P(6,2)                 005601D     005638M     005645M     005660M
                            BASED(_QRNL_PST+)      005679M     005686M
          QPDECLTYPE        A(2)                   005599D     005617M     005620M     005630
                            BASED(_QRNL_PST+)      005631      005632      005633      005634
                                                   005635      005636      005637      005659M
                                                   005678M     005685M
          QPSAVEDNAME       A(80)                  005600D     005618M     005621M     005624
                            BASED(_QRNL_PST+)      005626M     005626      005651      005653M
                                                   005653
          SAVEDLINETYPE     A(1)                   005607D     005643M     005671
          SAVEDSRCDTA       A(100)                 005609D     005642M     005705
          X                 P(3,0)                 005608D     005624M     005625      005626
                                                   005644M     005651M     005652      005653
                                                   005654M     005667M     005701
       Field References for subprocedure SPLITLINE
          Field             Attributes         References (D=Defined M=Modified)
          QPCURRENTLINE     A(92)                  005720D     005733      005740      005742
                            BASED(_QRNL_PST+)      005743M     005743
                            VARYING(2)
          QPMAXLENGTH       P(3,0)                 005722D     005734      005735
                            BASED(_QRNL_PST+)
          QPOVERFLOW        A(92)                  005721D     005732M     005742M
                            BASED(_QRNL_PST+)
                            VARYING(2)
          X                 P(3,0)                 005728D     005733M     005734      005735M
                                                   005739      005739      005740      005742
                                                   005743
       Field References for subprocedure ADJUSTARRAYLENGTH
          Field             Attributes         References (D=Defined M=Modified)
          ELEMENTS          P(5,0)                 005770D     005785M     005787      005788
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    217
          I                 P(3,0)                 005768D     005781M     005783      005784
                                                   005785      005785      005820
          J                 P(3,0)                 005769D     005784M     005785
          QPLENGTH          P(7,0)                 005761D     005787      005788M     005788
                            BASED(_QRNL_PST+)
          SAVEDSRCDTA       A(100)                 005771D     005775M     005824
          X                 P(3,0)                 005767D     005776M     005794M     005820
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                       005487M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    218
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          No references in the source.
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    219
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00     13 The name or indicator is not referenced.
 *RNF7066 00      1 Record-Format name of Externally-Described file is not used.
 *RNF7086 00      1 RPG handles blocking for the file. INFDS is updated only when
                    blocks of data are transferred.
 *RNF7099 00      1 A COMMIT or ROLBK operation is used in the program with no
                    files defined with commitment control.
 *RNF3776 10      1 External program on prototype for main procedure is not the
                    same as program being created.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R3M0  160422 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    MENSA      01.11.19 17:02:42        Page    220
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :       16
     Warning      (10) . . . . . . . :        1
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :       17
   Source Totals:
     Records . . . . . . . . . . . . :     5848
     Specifications  . . . . . . . . :     3786
     Data records  . . . . . . . . . :       81
     Comments  . . . . . . . . . . . :     1047
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program CVTRPGFRER placed in library CVTRPGFREE. 10 highest severity. Created on 01.11.19 at 17:02:42.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
