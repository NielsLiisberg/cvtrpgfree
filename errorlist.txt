  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      1
   Command  . . . . . . . . . . . . :   CRTBNDRPG
     Issued by  . . . . . . . . . . :     NLI
   Program  . . . . . . . . . . . . :   CVTRPGFRER
     Library  . . . . . . . . . . . :     CVTRPGFREE
   Text 'description' . . . . . . . :   Convert to RPG free
   Source stream file   . . . . . . :   src/cvtrpgfreR.rpgle
     CCSID  . . . . . . . . . . . . :     500
   Text 'description' . . . . . . . :
   Last Change  . . . . . . . . . . :   25-06-20  14:37:44
   Generation severity level  . . . :   10
   Default activation group . . . . :   *YES
   Compiler options . . . . . . . . :   *XREF      *GEN       *NOSECLVL  *SHOWCPY
                                        *EXPDDS    *EXT       *NOSHOWSKP *NOSRCSTMT
                                        *DEBUGIO   *NOUNREF   *NOEVENTF
   Debugging views  . . . . . . . . :   *LIST
   Debug encryption key . . . . . . :   *NONE
   Output . . . . . . . . . . . . . :   *PRINT
   Optimization level . . . . . . . :   *NONE
   Source listing indentation . . . :   *NONE
   Type conversion options  . . . . :   *NONE
   Sort sequence  . . . . . . . . . :   *HEX
   Language identifier  . . . . . . :   *JOBRUN
   Replace program  . . . . . . . . :   *YES
   User profile . . . . . . . . . . :   *USER
   Authority  . . . . . . . . . . . :   *LIBCRTAUT
   Truncate numeric . . . . . . . . :   *YES
   Fix numeric  . . . . . . . . . . :   *NONE
   Target release . . . . . . . . . :   *CURRENT
   Allow null values  . . . . . . . :   *NO
   Define condition names . . . . . :   *NONE
   Enable performance collection  . :   *PEP
   Profiling data . . . . . . . . . :   *NOCOL
   Licensed Internal Code options . :
   Generate program interface . . . :   *NO
   Include directory  . . . . . . . :   ./..
   Preprocessor options . . . . . . :   *NONE
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      2
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
                           S o u r c e   L i s t i n g
      1                                                                                                     *FREE            000001
      2   Ctl-Opt Debug                                                                                                      000002
      3           DftActGrp( *No ) ActGrp( *Caller )                                                                         000003
      4           Option( *ShowCpy: *SrcStmt: *NoDebugIO );                                                                  000004
 000005                                                                                                                      000005
 000006   //-------------------------------------------------------------------------------------------                      000006
 000007   // Program Name. . . . . : CVTRPGFREE                                                                              000007
 000008   // Program Description . : Convert RPGILE Source Member to Free-form                                               000008
 000009   // Date Created. . . . . : 30/04/2015                                                                              000009
 000010   // Programmer. . . . . . : Ewarwoowar                                                                              000010
 000011   //                                                                                                                 000011
 000012   // By             Date        Fix                                                                                  000012
 000013   // Niels Liisberg 10.02.2020  Support for source more that 999 lines of code                                       000013
 000014   //-------------------------------------------------------------------------------------------                      000014
 000015   // SYNOPSIS :                                                                                                      000015
 000016   // - Reads through an RPGILE source member and reformats the contents.                                             000016
 000017   //-------------------------------------------------------------------------------------------                      000017
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      3
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000019   //-------------------------------------------------------------------------------------------                      000019
 000020   // F I L E S                                                                                                       000020
 000021   //-------------------------------------------------------------------------------------------                      000021
         *--------------------------------------------------------------------*
         * Compiler Options in Effect:                                        *
         *--------------------------------------------------------------------*
         *  Text 'description' . . . . . . . :                                *
         *                 Convert to RPG free                                *
         *  Generation severity level  . . . :   10                           *
         *  Default activation group . . . . :   *NO                          *
         *  Compiler options . . . . . . . . :   *XREF      *GEN              *
         *                                       *NOSECLVL  *SHOWCPY          *
         *                                       *EXPDDS    *EXT              *
         *                                       *NOSHOWSKP *SRCSTMT          *
         *                                       *NODEBUGIO *NOUNREF          *
         *                                       *NOEVENTF                    *
         *  Optimization level . . . . . . . :   *NONE                        *
         *  Source listing indentation . . . :   *NONE                        *
         *  Type conversion options  . . . . :   *NONE                        *
         *  Sort sequence  . . . . . . . . . :   *HEX                         *
         *  Language identifier  . . . . . . :   *JOBRUN                      *
         *  User profile . . . . . . . . . . :   *USER                        *
         *  Authority  . . . . . . . . . . . :   *LIBCRTAUT                   *
         *  Truncate numeric . . . . . . . . :   *YES                         *
         *  Fix numeric  . . . . . . . . . . :   *NONE                        *
         *  Allow null values  . . . . . . . :   *NO                          *
         *  Storage model . . .  . . . . . . :   *SNGLVL                      *
         *  Binding directory from Command . :   *NONE                        *
         *  Binding directory from Source  . :   *NONE                        *
         *  Activation group . . . . . . . . :   *CALLER                      *
         *  Enable performance collection  . :   *PEP                         *
         *  Profiling data . . . . . . . . . :   *NOCOL                       *
         *  Generate program interface . . . :   *NO                          *
         *--------------------------------------------------------------------*
 000022   Dcl-F QRPGLESRC              EXTMBR(QpFromMbr)                                                                     000022
 000023                                EXTFILE('QTEMP/QRPGLESRC')                                                            000023
 000024                                RENAME(QRPGLESRC:SRCREC)                                                              000024
 000025                                USROPN;                                                                               000025
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC        CVTRPGFREE/QRPGLESRC                        *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      4
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
         * Record format(s) . . . . . :  SRCREC           QRPGLESRC                                   *
         *--------------------------------------------------------------------------------------------*
 000026                                                                                                                      000026
 000027   Dcl-F QRPGLESRC2             Usage(*OUTPUT) EXTMBR(QpToMbr)                                                        000027
 000028                                EXTFILE('QTEMP/QRPGLESRC2')                                                           000028
 000029                                RENAME(QRPGLESRC2:OUTREC)                                                             000029
 000030                                USROPN;                                                                               000030
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  QRPGLESRC2       CVTRPGFREE/QRPGLESRC2                       *
         * Record format(s) . . . . . :  OUTREC           QRPGLESRC2                                  *
         *--------------------------------------------------------------------------------------------*
 000031                                                                                                                      000031
 000032   Dcl-F CVTRPGFREP     PRINTER USROPN                                                                                000032
 000033                                OFLIND(overFlow);                                                                     000033
         *--------------------------------------------------------------------------------------------*
         *                               RPG name         External name                               *
         * File name. . . . . . . . . :  CVTRPGFREP       CVTRPGFREE/CVTRPGFREP                       *
         * Record format(s) . . . . . :  Z1PAGHDG         Z1PAGHDG                                    *
         *                               Z1TOPPAG         Z1TOPPAG                                    *
         *                               ZL01HDG          ZL01HDG                                     *
         *                               Z1DETAIL         Z1DETAIL                                    *
         *                               Z1ENDRPT         Z1ENDRPT                                    *
         *--------------------------------------------------------------------------------------------*
 000034                                                                                                                      000034
 000035   //-------------------------------------------------------------------------------------------                      000035
 000036   // P R O C E D U R E   I N T E R F A C E                                                                           000036
 000037   //-------------------------------------------------------------------------------------------                      000037
 000038                                                                                                                      000038
 000039   Dcl-PR CVTRPGFREE               EXTPGM('CVTRPGFREE');                                                              000039
 000040      QpShutDown               Char(1) CONST;                                                                         000040
 000041      QpFromFile               Char(10) CONST;                                                                        000041
 000042      QpFromLib                Char(10) CONST;                                                                        000042
 000043      QpFromMember             Char(10) CONST;                                                                        000043
 000044      QpToFile                 Char(10) CONST;                                                                        000044
 000045                                                                                                                      000045
 000046      QpToLib                  Char(10) CONST;                                                                        000046
 000047      QpToMbr                  Char(10) CONST;                                                                        000047
 000048      QpIndComment             Char(1) CONST;                                                                         000048
 000049      QpRetBlnkCmt             Char(1) CONST;                                                                         000049
 000050      QpDirectives             Char(1) CONST;                                                                         000050
 000051   End-PR;                                                                                                            000051
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      5
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000052                                                                                                                      000052
 000053   Dcl-PI CVTRPGFREE;                                                                                                 000053
 ======>         aaaaaaaaaa
 *RNF3776 10 a      000053  External program on prototype for main procedure is not the
                            same as program being created.
 000054      QpShutDown               Char(1) CONST;                                                                         000054
 000055      QpFromFile               Char(10) CONST;                                                                        000055
 000056      QpFromLib                Char(10) CONST;                                                                        000056
 000057      QpFromMbr                Char(10) CONST;                                                                        000057
 000058      QpToFile                 Char(10) CONST;                                                                        000058
 000059      QpToLib                  Char(10) CONST;                                                                        000059
 000060      QpToMbr                  Char(10) CONST;                                                                        000060
 000061      QpIndComment             Char(1) CONST;                                                                         000061
 000062      QpRetBlnkCmt             Char(1) CONST;                                                                         000062
 000063      QpDirectives             Char(1) CONST;                                                                         000063
 000064   End-PI;                                                                                                            000064
 000065                                                                                                                      000065
 000066   //-------------------------------------------------------------------------------------------                      000066
 000067   // P R O T O T Y P E   I N T E R F A C E S                                                                         000067
 000068   //-------------------------------------------------------------------------------------------                      000068
 000069   Dcl-PR GetDeclarationType;                                                                                         000069
 000070      QpDeclType               Char( 2 );                                                                             000070
 000071      QpSavedName              Char( 80 );                                                                            000071
 000072      QpDeclLine                        Like(SRCSEQ);                                                                 000072
 000073   End-PR;                                                                                                            000073
 000074                                                                                                                      000074
 000075   //-------------------------------------------------------------------------------------------                      000075
 000076   // N A M E D   C O N S T A N T S                                                                                   000076
 000077   //-------------------------------------------------------------------------------------------                      000077
 000078   Dcl-C LO                        'abcdefghijklmnopqrstuvwxyz';                                                      000078
 000079   Dcl-C UP                        'ABCDEFGHIJKLMNOPQRSTUVWXYZ';                                                      000079
 000080   Dcl-C VALIDSPECS                'HFDCP';                                                                           000080
 000081                                                                                                                      000081
 000082   //-------------------------------------------------------------------------------------------                      000082
 000083   // D A T A   S T R U C T U R E S                                                                                   000083
 000084   //-------------------------------------------------------------------------------------------                      000084
 000085                                                                                                                      000085
 000086   Dcl-DS SourceData;                                                                                                 000086
 000087      SRCDTA                   Char(100);                                                                             000087
 000088      prefix                   Char(5) OVERLAY(SRCDTA:1);                                                             000088
 000089      lineType                 Char(1) OVERLAY(SRCDTA:6);                                                             000089
 000090      directive                Char(10) OVERLAY(SRCDTA:7);                                                            000090
 000091      codeLine                 Char(93) OVERLAY(SRCDTA:8);                                                            000091
 000092      fullLine                 Char(94) OVERLAY(SRCDTA:7);                                                            000092
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      6
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000093                                                                                                                      000093
 000094      condNot                  Char(1) OVERLAY(SRCDTA:9);                                                             000094
 000095      condInd                  Char(2) OVERLAY(SRCDTA:10);                                                            000095
 000096      factor1                  Char(14) OVERLAY(SRCDTA:12);                                                           000096
 000097      opCode                   Char(10) OVERLAY(SRCDTA:26);                                                           000097
 000098      factor2                  Char(14) OVERLAY(SRCDTA:36);                                                           000098
 000099      result                   Char(14) OVERLAY(SRCDTA:50);                                                           000099
 000100      len                      Char(5) OVERLAY(SRCDTA:64);                                                            000100
 000101      dec                      Char(2) OVERLAY(SRCDTA:69);                                                            000101
 000102      hi                       Char(2) OVERLAY(SRCDTA:71);                                                            000102
 000103      lw                       Char(2) OVERLAY(SRCDTA:73);                                                            000103
 000104      eq                       Char(2) OVERLAY(SRCDTA:75);                                                            000104
 000105      comment                  Char(20) OVERLAY(SRCDTA:81);                                                           000105
 000106                                                                                                                      000106
 000107      extFactor2               Char(45) OVERLAY(SRCDTA:36);                                                           000107
 000108                                                                                                                      000108
 000109      nonPrefix                Char(95) OVERLAY(SRCDTA:6);                                                            000109
 000110                                                                                                                      000110
 000111      procType                 Char(1) OVERLAY(SRCDTA:24);                                                            000111
 000112      procKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000112
 000113                                                                                                                      000113
 000114      declName                 Char(15) OVERLAY(SRCDTA:7);                                                            000114
 000115      declExt                  Char(1) OVERLAY(SRCDTA:22);                                                            000115
 000116      declPrefix               Char(1) OVERLAY(SRCDTA:23);                                                            000116
 000117      declType                 Char(2) OVERLAY(SRCDTA:24);                                                            000117
 000118      declSuffix               Char(1) OVERLAY(SRCDTA:26);                                                            000118
 000119      declFrom                 Char(7) OVERLAY(SRCDTA:26);                                                            000119
 000120      declLen                  Char(7) Overlay(SRCDTA:33);                                                            000120
 000121      declAttr                 Char(1) Overlay(SRCDTA:40);                                                            000121
 000122      declScale                Char(3) Overlay(SRCDTA:41);                                                            000122
 000123      declKeyWords             Char(37) OVERLAY(SRCDTA:44);                                                           000123
 000124      declOptions              Char(73) Overlay(SRCDTA:7);                                                            000124
 000125                                                                                                                      000125
 000126      FileSpec                 Char(100) Overlay(SRCDTA:1);                                                           000126
 000127      fileName                 Char(10) Overlay(FileSpec:7);                                                          000127
 000128      fileUsage                Char(1) Overlay(FileSpec:17);                                                          000128
 000129      fileDesig                Char(1) Overlay(FileSpec:18);                                                          000129
 000130      fileAdd                  Char(1) Overlay(FileSpec:20);                                                          000130
 000131      fileExternal             Char(1) Overlay(FileSpec:22);                                                          000131
 000132      fileKeyed                Char(1) Overlay(FileSpec:34);                                                          000132
 000133      fileDevice               Char(7) Overlay(FileSpec:36);                                                          000133
 000134      fileKeywords             Char(37) Overlay(FileSpec:44);                                                         000134
 000135   End-DS;                                                                                                            000135
 000136                                                                                                                      000136
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      7
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000137   // Display file indicators ------------------------------------------------------------------                      000137
 000138   Dcl-DS IndicatorDS;                                                                                                000138
 000139    // 01-30: Function keys                                                                                           000139
 000140    // 31-59: Conditioning indicators (error)                                                                         000140
 000141    // 60-89: Conditioning indicators (non-error)                                                                     000141
 000142    // 90-99: General indicators                                                                                      000142
 000143   // Report file indicators -------------------------------------------------------------------                      000143
 000144    // 01-79: Conditioning indicators (non-error)                                                                     000144
 000145      cndIndicators             Ind Pos(01) DIM(79);                                                                  000145
 000146    // 80-89: Report control                                                                                          000146
 000147      overFlow                  Ind Pos(80);                                                                          000147
 000148    // 90-99: General indicators                                                                                      000148
 000149      errorInd                  Ind Pos(99) INZ(*OFF);                  // Global error                               000149
 000150   End-DS;                                                                                                            000150
 000151                                                                                                                      000151
 000152   Dcl-DS DCLPR                    QUALIFIED;                                                                         000152
 000153      decl                     Char(7) INZ('Dcl-PR ');                                                                000153
 000154      procName                 Char(16);                                                                              000154
 000155      type                     Char(9);                                                                               000155
 000156      definition               Char(37);                                                                              000156
 000157      comment                  Char(23);                                                                              000157
 000158      fieldName                Char(23) Pos(4);                                                                       000158
 000159   End-DS;                                                                                                            000159
 000160                                                                                                                      000160
 000161   Dcl-DS DCLP                     QUALIFIED;                           // Test comment                               000161
 000162      decl                     Char(9) INZ('Dcl-Proc ');                                                              000162
 000163      definition               Char(61);                                                                              000163
 000164      comment                  Char(23);                                                                              000164
 000165   End-DS;                                                                                                            000165
 000166                                                                                                                      000166
 000167   Dcl-DS DCLS                     QUALIFIED;                                                                         000167
 000168      decl                     Char(6) INZ('Dcl-S ');                                                                 000168
 000169      fieldName                Char(17);                                                                              000169
 000170      type                     Char(9);                                                                               000170
 000171      definition               Char(37);                                                                              000171
 000172      comment                  Char(23);                                                                              000172
 000173   End-DS;                                                                                                            000173
 000174                                                                                                                      000174
 000175   Dcl-DS DCLF                     QUALIFIED;                                                                         000175
 000176      decl                     Char(6) INZ('Dcl-F ');                                                                 000176
 000177      fileName                 Char(15);                                                                              000177
 000178      device                   Char(8);                                                                               000178
 000179      definition               Char(44);                                                                              000179
 000180      comment                  Char(23) Pos(70);                                                                      000180
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      8
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000181   End-DS;                                                                                                            000181
 000182                                                                                                                      000182
 000183   Dcl-DS DCLH                     QUALIFIED;                                                                         000183
 000184      decl                     Char(8) INZ('Ctl-Opt ');                                                               000184
 000185      options                  Char(62);                                                                              000185
 000186      comment                  Char(23);                                                                              000186
 000187   End-DS;                                                                                                            000187
 000188                                                                                                                      000188
 000189   //-------------------------------------------------------------------------------------------                      000189
 000190   // S T A N D - A L O N E   V A R I A B L E S                                                                       000190
 000191   //-------------------------------------------------------------------------------------------                      000191
 000192   // Template variables (required - do not alter).                                                                   000192
 000193   Dcl-S cfgCommitControl                                               // Test comment                               000193
 000194                               Char(7) INZ('*SLAVE ');                  // *MASTER/*SLAVE                             000194
 000195   Dcl-S cfgCloseDown          Char(1) INZ('N');                        // Close down program?                        000195
 000196   Dcl-S initialCall           Char(1) INZ(*Blank);                                                                   000196
 000197                                                                                                                      000197
 000198   // End of Template variables (required - do not alter).                                                            000198
 000199   //-------------------------------------------------------------------------------------------                      000199
 000200   Dcl-S QopCodeUP             Char(10) DIM(66) PERRCD(1) CTDATA;                                                     000200
 000201   Dcl-S QopCodeLO             Char(10) DIM(66) ALT(QopCodeUP);                                                       000201
 000202   Dcl-S QdeclUP               Char(10) DIM(12) PERRCD(1) CTDATA;                                                     000202
 000203   Dcl-S QdeclLO               Char(10) DIM(12) ALT(QdeclUP);                                                         000203
 000204   Dcl-S Qcomments             Char(92) DIM(3) CTDATA;                                                                000204
 000205   Dcl-S x                   Packed(5:0);                                                                             000205
 000206   Dcl-S y                   Packed(5:0);                                                                             000206
 000207   Dcl-S i                   Packed(5:0);                                                                             000207
 000208   Dcl-S j                   Packed(5:0);                                                                             000208
 000209   Dcl-S blanks                Char(30) INZ(*Blanks);                                                                 000209
 000210   Dcl-S maxIndent           Packed(5:0) INZ(15);                                                                     000210
 000211   Dcl-S movedDefs                 LIKE(result) DIM(9999);                                                            000211
 000212   Dcl-S moveDef                Ind INZ(*Off);                                                                        000212
 000213                                                                                                                      000213
 000214   Dcl-S fromFileLib           Char(21);                                                                              000214
 000215   Dcl-S toFileLib             Char(21);                                                                              000215
 000216                                                                                                                      000216
 000217   Dcl-S operator              Char(10);                                                                              000217
 000218   Dcl-S operatorEnd         Packed(5:0);                                                                             000218
 000219   Dcl-S newOperator        VarChar(10);                                                                              000219
 000220   Dcl-S nonConvRsn                LIKE(codeLine);                                                                    000220
 000221                                                                                                                      000221
 000222   Dcl-S inCode                 Ind INZ(*Off);                                                                        000222
 000223   Dcl-S inArrayData            Ind INZ(*Off);                                                                        000223
 000224   Dcl-S inComment              Ind INZ(*Off);                                                                        000224
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page      9
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000225   Dcl-S inDeclaration          Ind INZ(*Off);                                                                        000225
 000226   Dcl-S inPrototype            Ind INZ(*Off);                                                                        000226
 000227   Dcl-S inInterface            Ind INZ(*Off);                                                                        000227
 000228   Dcl-S inDatastructure                                                                                              000228
 000229                                Ind INZ(*Off);                                                                        000229
 000230   Dcl-S inExtProc              Ind INZ(*Off);                                                                        000230
 000231   Dcl-S endDS                  Ind INZ(*Off);                                                                        000231
 000232   Dcl-S inDirective            Ind INZ(*Off);                                                                        000232
 000233   Dcl-S inFreeFormat           Ind INZ(*On);                                                                         000233
 000234   Dcl-S inDeclProc             Ind INZ(*Off);                                                                        000234
 000235   Dcl-S indent                 Ind INZ(*Off);                                                                        000235
 000236   Dcl-S inSpan                 Ind INZ(*Off);                                                                        000236
 000237   Dcl-S inCase                 Ind INZ(*Off);                                                                        000237
 000238   Dcl-S convert                Ind INZ(*Off);                                                                        000238
 000239   Dcl-S unindent               Ind INZ(*Off);                                                                        000239
 000240   Dcl-S defsMoved              Ind INZ(*Off);                                                                        000240
 000241   Dcl-S dropLine               Ind INZ(*Off);                                                                        000241
 000242   Dcl-S codeStart                 LIKE(SRCSEQ) INZ(0);                                                               000242
 000243   Dcl-S endLine                   LIKE(SRCSEQ) INZ(0);                 // Close struct here.                         000243
 000244   Dcl-S endFound               Ind;                                                                                  000244
 000245   Dcl-S endDeclType           Char(2);                                                                               000245
 000246                                                                                                                      000246
 000247   Dcl-S savedLineType         Char(1);                                                                               000247
 000248                                                                                                                      000248
 000249   Dcl-S increment           Packed(1:0) INZ(0);                                                                      000249
 000250   Dcl-S indentCount         Packed(5:0) INZ(0);                                                                      000250
 000251   Dcl-S indentSize          Packed(1:0) INZ(3);                                                                      000251
 000252   Dcl-S indentOffset        Packed(5:0) INZ(0);                                                                      000252
 000253   Dcl-S prevOffset          Packed(5:0) INZ(0);                                                                      000253
 000254   Dcl-S currOffset          Packed(5:0) INZ(0);                                                                      000254
 000255   Dcl-S lineEnd             Packed(5:0) INZ(0);                                                                      000255
 000256   Dcl-S mainlineIndent      Packed(5:0) INZ(1);                                                                      000256
 000257                                                                                                                      000257
 000258   Dcl-S savedSRCDTA               LIKE(SRCDTA);                                                                      000258
 000259   Dcl-S sourceLine            Char(93);                                                                              000259
 000260   Dcl-S overflowLine       VarChar(92);                                                                              000260
 000261   Dcl-S workDirective         Char(10);                                                                              000261
 000262   Dcl-S workLineType          Char(1);                                                                               000262
 000263   Dcl-S workDeclType          Char(2);                                                                               000263
 000264   Dcl-S workDeclAttr          Char(1);                                                                               000264
 000265   Dcl-S workDeclName          Char(50);                                                                              000265
 000266   Dcl-S workDeclLine              LIKE(SRCSEQ);                                                                      000266
 000267   Dcl-S workDeclKeywords   VarChar(92);                                                                              000267
 000268                                                                                                                      000268
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     10
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000269   Dcl-S tempDeclType          Char(2);                                                                               000269
 000270   Dcl-S tempDeclLine              LIKE(SRCSEQ);                                                                      000270
 000271   Dcl-S tempSavedName         Char(80);                                                                              000271
 000272                                                                                                                      000272
 000273   Dcl-S workFileUsage         Char(1);                                                                               000273
 000274   Dcl-S workFileDesig         Char(1);                                                                               000274
 000275   Dcl-S workFileAdd           Char(1);                                                                               000275
 000276   Dcl-S workFileKeyed         Char(1);                                                                               000276
 000277   Dcl-S workFileDevice        Char(7);                                                                               000277
 000278   Dcl-S checkLength         Packed(5:0);                                                                             000278
 000279   Dcl-S workLength          Packed(7:0);                                                                             000279
 000280                                                                                                                      000280
 000281   Dcl-S savedComment          Char(20);                                                                              000281
 000282   Dcl-S savedName             Char(80);                                                                              000282
 000283                                                                                                                      000283
 000284   Dcl-S padResult              Ind INZ(*Off);                                                                        000284
 000285   Dcl-S padTarget                 LIKE(result);                                                                      000285
 000286                                                                                                                      000286
 000287   Dcl-S scanString                LIKE(factor1);                                                                     000287
 000288   Dcl-S scanBase                  LIKE(factor2);                                                                     000288
 000289   Dcl-S scanLength            Char(10);                                                                              000289
 000290   Dcl-S scanStart             Char(10);                                                                              000290
 000291   Dcl-S scanNoResult           Ind INZ(*Off);                                                                        000291
 000292                                                                                                                      000292
 000293   Dcl-S substLen              Char(10);                                                                              000293
 000294   Dcl-S substStart            Char(10);                                                                              000294
 000295                                                                                                                      000295
 000296   Dcl-S setOff                 Ind INZ(*Off);                                                                        000296
 000297   Dcl-S setOffInd1            Char(2);                                                                               000297
 000298   Dcl-S setOffInd2            Char(2);                                                                               000298
 000299   Dcl-S setOffInd3            Char(2);                                                                               000299
 000300                                                                                                                      000300
 000301   Dcl-S setOn                  Ind INZ(*Off);                                                                        000301
 000302   Dcl-S setOnInd1             Char(2);                                                                               000302
 000303   Dcl-S setOnInd2             Char(2);                                                                               000303
 000304   Dcl-S setOnInd3             Char(2);                                                                               000304
 000305                                                                                                                      000305
 000306   Dcl-S xlateFrom                 LIKE(factor1);                                                                     000306
 000307   Dcl-S xlateTo                   LIKE(factor1);                                                                     000307
 000308   Dcl-S xlateBase                 LIKE(factor2);                                                                     000308
 000309   Dcl-S xlateStart            Char(10);                                                                              000309
 000310                                                                                                                      000310
 000311   Dcl-S caseSubRoutine        Char(10);                                                                              000311
 000312   Dcl-S caseOperator          Char(4);                                                                               000312
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     11
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000313                                                                                                                      000313
 000314   Dcl-S catFactor1                LIKE(factor1);                                                                     000314
 000315   Dcl-S catFactor2                LIKE(factor2);                                                                     000315
 000316   Dcl-S catCount            Packed(5:0) INZ(0);                                                                      000316
 000317   Dcl-S catBlanks                 LIKE(factor2);                                                                     000317
 000318                                                                                                                      000318
 000319   Dcl-S durDuration               LIKE(factor2);                                                                     000319
 000320   Dcl-S durCode                   LIKE(factor2);                                                                     000320
 000321   Dcl-S durNewDate             Ind INZ(*Off);                                                                        000321
 000322                                                                                                                      000322
 000323   Dcl-S inEval                 Ind INZ(*Off);                                                                        000323
 000324   Dcl-S evalOperator              Like(opCode);                                                                      000324
 000325   Dcl-S evalOffset          Packed(5:0);                                                                             000325
 000326                                                                                                                      000326
 000327   Dcl-S inCallP                Ind INZ(*Off);                                                                        000327
 000328   Dcl-S callPOperator             Like(opCode);                                                                      000328
 000329   Dcl-S callPOffset         Packed(5:0);                                                                             000329
 000330                                                                                                                      000330
 000331   Dcl-S inDo                   Ind INZ(*Off);                                                                        000331
 000332   Dcl-S doOperator                Like(opCode);                                                                      000332
 000333   Dcl-S doCompare             Char(2);                                                                               000333
 000334                                                                                                                      000334
 000335   Dcl-S inIf                   Ind INZ(*Off);                                                                        000335
 000336   Dcl-S ifOperator                Like(opCode);                                                                      000336
 000337   Dcl-S ifCompare             Char(2);                                                                               000337
 000338                                                                                                                      000338
 000339   Dcl-S inWhen                 Ind INZ(*Off);                                                                        000339
 000340   Dcl-S whenOperator              Like(opCode);                                                                      000340
 000341   Dcl-S whenCompare           Char(2);                                                                               000341
 000342                                                                                                                      000342
 000343   Dcl-S inSQL                  Ind INZ(*Off);                                                                        000343
 000344                                                                                                                      000344
 000345   Dcl-S forCount            Packed(5:0) INZ(0);                                                                      000345
 000346   Dcl-S forLevel            Packed(5:0) DIM(99);                          // Allow for 99                            000346
 000347   Dcl-S forFactor1                LIKE(factor1);                                                                     000347
 000348   Dcl-S forFactor2                LIKE(factor2);                                                                     000348
 000349                                                                                                                      000349
 000350   Dcl-S doCount             Packed(5:0) INZ(0);                                                                      000350
 000351   Dcl-S doLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000351
 000352                                                                                                                      000352
 000353   Dcl-S slCount             Packed(5:0) INZ(0);                                                                      000353
 000354   Dcl-S slLevel             Packed(5:0) DIM(99);                          // Allow for 99                            000354
 000355                                                                                                                      000355
 000356   Dcl-S divFactor1                LIKE(factor1);                                                                     000356
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     12
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000357   Dcl-S divFactor2                LIKE(factor2);                                                                     000357
 000358                                                                                                                      000358
 000359   Dcl-S ERRCheck               Ind INZ(*Off);                                                                        000359
 000360   Dcl-S ERRInd                Char(2);                                                                               000360
 000361                                                                                                                      000361
 000362   Dcl-S foundCheck             Ind INZ(*Off);                                                                        000362
 000363   Dcl-S foundInd              Char(2);                                                                               000363
 000364                                                                                                                      000364
 000365   Dcl-S NRFCheck               Ind INZ(*Off);                                                                        000365
 000366   Dcl-S NRFInd                Char(2);                                                                               000366
 000367   Dcl-S NRFFile                   LIKE(factor2);                                                                     000367
 000368                                                                                                                      000368
 000369   Dcl-S EOFCheck               Ind INZ(*Off);                                                                        000369
 000370   Dcl-S EOFInd                Char(2);                                                                               000370
 000371   Dcl-S EOFFile                   LIKE(factor2);                                                                     000371
 000372                                                                                                                      000372
 000373   Dcl-S HICheck                Ind INZ(*Off);                                                                        000373
 000374   Dcl-S HIInd                 Char(2);                                                                               000374
 000375   Dcl-S HiFactor1                 LIKE(factor1);                                                                     000375
 000376   Dcl-S HiFactor2                 LIKE(factor2);                                                                     000376
 000377                                                                                                                      000377
 000378   Dcl-S LWCheck                Ind INZ(*Off);                                                                        000378
 000379   Dcl-S LWInd                 Char(2);                                                                               000379
 000380   Dcl-S LWFactor1                 LIKE(factor1);                                                                     000380
 000381   Dcl-S LWFactor2                 LIKE(factor2);                                                                     000381
 000382                                                                                                                      000382
 000383   Dcl-S EQCheck                Ind INZ(*Off);                                                                        000383
 000384   Dcl-S EQInd                 Char(2);                                                                               000384
 000385   Dcl-S EQFactor1                 LIKE(factor1);                                                                     000385
 000386   Dcl-S EQFactor2                 LIKE(factor2);                                                                     000386
 000387                                                                                                                      000387
 000388   Dcl-S equalCheck             Ind INZ(*Off);                                                                        000388
 000389   Dcl-S equalInd              Char(2);                                                                               000389
 000390                                                                                                                      000390
 000391   Dcl-S countSource         Packed(7:0) INZ(0);                                                                      000391
 000392   Dcl-S countTarget         Packed(7:0) INZ(0);                                                                      000392
 000393   Dcl-S countEligible       Packed(7:0) INZ(0);                                                                      000393
 000394   Dcl-S countConv           Packed(7:0) INZ(0);                                                                      000394
 000395   Dcl-S countNotConv        Packed(7:0) INZ(0);                                                                      000395
 000396   Dcl-S countMoved          Packed(7:0) INZ(0);                                                                      000396
 000397                                                                                                                      000397
 000398   //Dcl-S testb                   BinDec(2:0);                                                                       000398
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     13
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000400   //-------------------------------------------------------------------------------------------                      000400
 000401   // Main Procedure                                                                                                  000401
 000402   //-------------------------------------------------------------------------------------------                      000402
 000403      // Initialize                                                                                                   000403
 000001=ISRCREC                                                                                                             1000001
         *--------------------------------------------------------------------------------------------*                     1
         * RPG record format  . . . . :  SRCREC                                                       *                     1
         * External format  . . . . . :  QRPGLESRC : CVTRPGFREE/QRPGLESRC                             *                     1
         *--------------------------------------------------------------------------------------------*                     1
 000002=I                             S    1    6 2SRCSEQ                                                                   1000002
 000003=I                             S    7   12 0SRCDAT                                                                   1000003
 000004=I                             A   13  112  SRCDTA                                                                   1000004
 000404      Exsr subInitialise;                                                                                             000404
 000405                                                                                                                      000405
 000406      // Perform required function                                                                                    000406
 000407      Exsr subUserFunction;                                                                                           000407
 000408                                                                                                                      000408
 000409      // Terminate the program.                                                                                       000409
 000410      Exsr subExitProgram;                                                                                            000410
 000411   //-------------------------------------------------------------------------------------------                      000411
 000412                                                                                                                      000412
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     14
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000414   //-------------------------------------------------------------------------------------------                      000414
 000415   // USER: Perform required function.                                                                                000415
 000416   //-------------------------------------------------------------------------------------------                      000416
 000417   BegSr subUserFunction;                                                                                             000417
 000418                                                                                                                      000418
 000419      // ** Code the necessary processing here.                                                                       000419
 000420      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         000420
 000421                                                                                                                      000421
 000422      // Read through the source member.                                                                              000422
 000423      Read SRCREC;                                                                                                    000423
 000424                                                                                                                      000424
 000425      DoW not %eof(QRPGLESRC);                                                                   B01                  000425
 000426         countSource += 1;                                                                        01                  000426
 000427                                                                                                                      000427
 000428         Exsr subUserReformatLine;                                                                01                  000428
 000429                                                                                                                      000429
 000430         Exsr subUserSetIndicators;                                                               01                  000430
 000431                                                                                                                      000431
 000432         // Old-style SCAN without a result field.                                                                    000432
 000433         If scanNoResult;                                                                        B02                  000433
 000434            Clear nonPrefix;                                                                      02                  000434
 000435                                                                                                                      000435
 000436            codeLine = '// Old-style SCAN without a result!';                                     02                  000436
 000437            Exsr subUserReformatLine;                                                             02                  000437
 000438            codeLine = 'EndIf;';                                                                  02                  000438
 000439            Exsr subUserReformatLine;                                                             02                  000439
 000440                                                                                                                      000440
 000441            scanNoResult = *Off;                                                                  02                  000441
 000442         EndIf;                                                                                  E02                  000442
 000443                                                                                                                      000443
 000444         // If in a CAS statement, record the subroutine to call.                                                     000444
 000445         If inCase and caseSubroutine <> *Blanks;                                                B02                  000445
 000446            codeLine = 'ExSr ' + %trim(caseSubRoutine) + ';';                                     02                  000446
 000447            Exsr subUserReformatLine;                                                             02                  000447
 000448            caseSubRoutine = *Blanks;                                                             02                  000448
 000449         EndIf;                                                                                  E02                  000449
 000450                                                                                                                      000450
 000451         Read SRCREC;                                                                             01                  000451
 000452      EndDo;                                                                                     E01                  000452
 000453                                                                                                                      000453
 000454      // Handle overflow.                                                                                             000454
 000455      If overFlow;                                                                               B01                  000455
 000456                                                                                                                      000456
 000457         // Print page headings.                                                                                      000457
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     15
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000458         Z1QPAG += 1;                                                                             01                  000458
 000459         Write Z1PAGHDG;                                                                          01                  000459
 000460                                                                                                                      000460
 000461         ZTFRFL = fromFileLib;                                                                    01                  000461
 000462         ZTTOFL = toFileLib;                                                                      01                  000462
 000463                                                                                                                      000463
 000464         Write Z1TOPPAG;                                                                          01                  000464
 000465                                                                                                                      000465
 000466         overFlow = *Off;                                                                         01                  000466
 000467      EndIf;                                                                                     E01                  000467
 000468                                                                                                                      000468
 000469      Z1FRMB = QpFromMbr;                                                                                             000469
 000470      Z1TOMB = QpToMbr;                                                                                               000470
 000471      Z1CTSC = countSource;                                                                                           000471
 000472      Z1CTTG = countTarget;                                                                                           000472
 000473      Z1CTEL = countEligible;                                                                                         000473
 000474      Z1CTCV = countConv;                                                                                             000474
 000475      Z1CTNV = countNotConv;                                                                                          000475
 000476      Z1CTMV = countMoved;                                                                                            000476
 000477      If countEligible = 0;                                                                      B01                  000477
 000478         Z1CNVR = 0;                                                                              01                  000478
 000479      Else;                                                                                      X01                  000479
 000480         Z1CNVR = countConv * 100 / countEligible;                                                01                  000480
 000481      EndIf;                                                                                     E01                  000481
 000482                                                                                                                      000482
 000483      // Print detail format.                                                                                         000483
 000484      Write Z1DETAIL;                                                                                                 000484
 000485                                                                                                                      000485
 000486      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         000486
 000487                                                                                                                      000487
 000488   EndSr;                                                                                                             000488
 000489   //-------------------------------------------------------------------------------------------                      000489
 000490                                                                                                                      000490
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     16
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000492   //-------------------------------------------------------------------------------------------                      000492
 000493   // Perform conversion/reformatting on the current line.                                                            000493
 000494   //-------------------------------------------------------------------------------------------                      000494
 000495   BegSr subUserReformatLine;                                                                                         000495
 000496                                                                                                                      000496
 000497      inDirective = *Off;                                                                                             000497
 000498      inComment = *Off;                                                                                               000498
 000499      increment = 0;                                                                                                  000499
 000500                                                                                                                      000500
 000501      workDirective = %xlate(lo:up:directive);                                                                        000501
 000502      workLineType = %xlate(lo:up:lineType);                                                                          000502
 000503                                                                                                                      000503
 000504      convert = *Off;                                                                                                 000504
 000505      nonConvRsn = *Blanks;                                                                                           000505
 000506                                                                                                                      000506
 000507      sourceLine = codeLine;     // Start with what is already there.                                                 000507
 000508                                                                                                                      000508
 000509      // Array data reached?                                                                                          000509
 000510      If %subst(prefix:1:3) = '** '                                                              B01                  000510
 000511      or %subst(SRCDTA:1:8) = '**CTDATA';                                                        B01                  000511
 000512         inCode = *Off;                                                                           01                  000512
 000513         inDeclaration = *Off;                                                                    01                  000513
 000514         inArrayData = *On;                                                                       01                  000514
 000515      EndIf;                                                                                     E01                  000515
 000516                                                                                                                      000516
 000517      If not inArrayData;                                                                        B01                  000517
 000518         //----------------------------------------------------------------------------------                         000518
 000519         // Determine Line Type                                                                                       000519
 000520         If workLineType = 'C';                  // C-Spec                                       B02                  000520
 000521            inCode = *On;                                                                         02                  000521
 000522            //         ElseIf workLineType = 'P'               // P-Spec                                              000522
 000523            //             or %len(%trim(codeLine)) >= 4                                                              000523
 000524            //            and %xlate(lo:up:%subst(%trim(codeLine):1:4)) = 'DCL-';                                     000524
 000525            //            inCode = *Off;                                                                              000525
 000526            //            defsMoved = *Off;                                                                           000526
 000527         ElseIf workLineType = 'P';              // P-Spec                                       X02                  000527
 000528            inCode = *Off;                                                                        02                  000528
 000529            defsMoved = *Off;                                                                     02                  000529
 000530         ElseIf workLineType = 'D';              // Declaration.                                 X02                  000530
 000531            inCode = *Off;                                                                        02                  000531
 000532         ElseIf workLineType = 'H';              // Header spec.                                 X02                  000532
 000533            inCode = *Off;                                                                        02                  000533
 000534         ElseIf workLineType = 'F';              // File spec.                                   X02                  000534
 000535            inCode = *Off;                                                                        02                  000535
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     17
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000536         ElseIf workLineType = 'O';              // O-Spec                                       X02                  000536
 000537            inCode = *Off;                                                                        02                  000537
 000538         ElseIf workLineType = 'I';              // I-Spec                                       X02                  000538
 000539            inCode = *On;                                                                         02                  000539
 000540         ElseIf %check(validSpecs:workLineType) <> 0;    // Invalid spec type.                   X02                  000540
 000541            workLineType = *Blanks;                                                               02                  000541
 000542            lineType = *Blank;                           // Clear it!                             02                  000542
 000543         EndIf;                                                                                  E02                  000543
 000544                                                                                                                      000544
 000545         If %trim(workDirective) = '/FREE';                                                      B02                  000545
 000546            // In a free-format directive, so we must be in code too.                                                 000546
 000547            If not inFreeFormat;                                                                 B03                  000547
 000548               inDirective = *On;                                                                 03                  000548
 000549               inCode = *On;                                                                      03                  000549
 000550               inFreeFormat = *On;                                                                03                  000550
 000551               lineType = ' ';                                                                    03                  000551
 000552               workLineType = ' ';                                                                03                  000552
 000553               If QpDirectives = 'Y';                                                            B04                  000553
 000554                  directive = '/Free';                                                            04                  000554
 000555               Else;                                                                             X04                  000555
 000556                  dropLine = *On;                                                                 04                  000556
 000557               EndIf;                                                                            E04                  000557
 000558            Else;                                                                                X03                  000558
 000559               dropLine = *On;   // Not needed.                                                   03                  000559
 000560            EndIf;                                                                               E03                  000560
 000561         ElseIf %trim(workDirective) = '/END-FREE';                                              X02                  000561
 000562            // At the end of a directive, so we can't be in free format any more.                                     000562
 000563            //inDirective = *On;                                                                                      000563
 000564            //directive = '/End-Free';                                                                                000564
 000565            //inFreeFormat = *Off;                                                                                    000565
 000566            dropLine = *On;                                                                       02                  000566
 000567         ElseIf %trim(workDirective) = '/EJECT';                                                 X02                  000567
 000568            inDirective = *On;                                                                    02                  000568
 000569            lineType = ' ';                                                                       02                  000569
 000570            workLineType = ' ';                                                                   02                  000570
 000571         ElseIf %subst(workDirective:1:5) = '/COPY';                                             X02                  000571
 000572            inDirective = *On;                                                                    02                  000572
 000573            lineType = ' ';                                                                       02                  000573
 000574            workLineType = ' ';                                                                   02                  000574
 000575         ElseIf %subst(workDirective:1:3) = '/IF';                                               X02                  000575
 000576            inDirective = *On;                                                                    02                  000576
 000577            lineType = ' ';                                                                       02                  000577
 000578            workLineType = ' ';                                                                   02                  000578
 000579         ElseIf %subst(workDirective:1:6) = '/ENDIF';                                            X02                  000579
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     18
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000580            inDirective = *On;                                                                    02                  000580
 000581            lineType = ' ';                                                                       02                  000581
 000582            workLineType = ' ';                                                                   02                  000582
 000583         ElseIf %subst(workDirective:1:7) = '/DEFINE';                                           X02                  000583
 000584            inDirective = *On;                                                                    02                  000584
 000585            lineType = ' ';                                                                       02                  000585
 000586            workLineType = ' ';                                                                   02                  000586
 000587         ElseIf %subst(workDirective:1:6) = '/SPACE';                                            X02                  000587
 000588            inDirective = *On;                                                                    02                  000588
 000589            lineType = ' ';                                                                       02                  000589
 000590            workLineType = ' ';                                                                   02                  000590
 000591         ElseIf %subst(workDirective:1:6) = '/TITLE';                                            X02                  000591
 000592            inDirective = *On;                                                                    02                  000592
 000593            lineType = ' ';                                                                       02                  000593
 000594            workLineType = ' ';                                                                   02                  000594
 000595         ElseIf (%subst(workDirective:1:1) = '*'                                                 X02                  000595
 000596            or %subst(workDirective:1:2) = '//')                                                 X02                  000596
 000597            and (lineType = *Blank or inCode);                                                   X02                  000597
 000598            //            and inCode;                                                                                 000598
 000599            // This is a comment line.                                                                                000599
 000600            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000600
 000601               inComment = *On;                                                                   03                  000601
 000602            EndIf;                                                                               E03                  000602
 000603            If %subst(workDirective:1:2) = '//';                                                 B03                  000603
 000604               %subst(directive:1:2) = '  ';                                                      03                  000604
 000605            Else;                                                                                X03                  000605
 000606               %subst(directive:1:1) = ' ';                                                       03                  000606
 000607            EndIf;                                                                               E03                  000607
 000608            If workLineType = 'C' or workLineType = 'D';                                         B03                  000608
 000609               lineType = ' ';                                                                    03                  000609
 000610               workLineType = ' ';                                                                03                  000610
 000611            EndIf;                                                                               E03                  000611
 000612            // Retain blank comment markers?                                                                          000612
 000613            If QpRetBlnkCmt = 'N' and %len(%trim(codeLine)) = 0;                                 B03                  000613
 000614               // Leave the line blank, devoid of any marker.                                                         000614
 000615            Else;                                                                                X03                  000615
 000616               codeLine = '//' + codeLine;                                                        03                  000616
 000617            EndIf;                                                                               E03                  000617
 000618         ElseIf %subst(workDirective:1:1) = '*';                                                 X02                  000618
 000619            //            and workLineType = 'O';                                                                     000619
 000620            // Leave the line as it is.                                                                               000620
 000621            inComment = *On;                                                                      02                  000621
 000622         ElseIf %len(%trim(codeLine)) = 0;                                                       X02                  000622
 000623            // Just a 'spacer' line - keep it but drop the line type.                                                 000623
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     19
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000624            lineType = ' ';                                                                       02                  000624
 000625            workLineType = ' ';                                                                   02                  000625
 000626         ElseIf %len(%trim(codeLine)) >= 2                                                       X02                  000626
 000627            and %subst(%trim(codeLine):1:2) = '//'                                               X02                  000627
 000628            and (workLineType = *Blank or inCode);                                               X02                  000628
 000629            // This is a comment line.                                                                                000629
 000630            If QpIndComment <> 'Y' or workLineType = 'C';                                        B03                  000630
 000631               inComment = *On;                                                                   03                  000631
 000632            EndIf;                                                                               E03                  000632
 000633            // Retain blank comment markers?                                                                          000633
 000634            If QpRetBlnkCmt = 'N' and %len(%trim(%subst(codeLine:3)))                            B03                  000634
 000635                                              = 0;                                               B03                  000635
 000636               // Leave the line blank, devoid of any marker.                                                         000636
 000637               codeLine = *Blanks;                                                                03                  000637
 000638            EndIf;                                                                               E03                  000638
 000639         ElseIf comment <> *Blanks                                                               X02                  000639
 000640            and %len(%trim(%subst(codeLine:1:73))) = 0;                                          X02                  000640
 000641            // This is a blank line with a comment section.                                                           000641
 000642            %subst(codeLine:71:2) = '//';                                                         02                  000642
 000643            inComment = *On;                                                                      02                  000643
 000644         EndIf;                                                                                  E02                  000644
 000645                                                                                                                      000645
 000646         //----------------------------------------------------------------------------------                         000646
 000647         // Convert fixed-format to free-format?                                                                      000647
 000648         If not inComment                                                                        B02                  000648
 000649         and not inDirective;                                                                    B02                  000649
 000650                                                                                                                      000650
 000651            If workLineType = 'C';                                                               B03                  000651
 000652               countEligible += 1;                                                                03                  000652
 000653               countNotConv += 1;                                                                 03                  000653
 000654               operator = %xlate(lo:up:opCode);                                                   03                  000654
 000655               savedComment = comment;                                                            03                  000655
 000656                                                                                                                      000656
 000657               Exsr subUserConvertC_Spec;                                                         03                  000657
 000658                                                                                                                      000658
 000659               If not inComment and not convert                                                  B04                  000659
 000660               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000660
 000661                  nonConvRsn = 'Conversion not currently supported.';                             04                  000661
 000662               EndIf;                                                                            E04                  000662
 000663                                                                                                                      000663
 000664            ElseIf workLineType = 'P';     // Procedure start/end.                               X03                  000664
 000665               countEligible += 1;                                                                03                  000665
 000666               countNotConv += 1;                                                                 03                  000666
 000667               operator = *Blanks;                                                                03                  000667
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     20
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000668               savedComment = comment;                                                            03                  000668
 000669                                                                                                                      000669
 000670               Exsr subUserConvertP_Spec;                                                         03                  000670
 000671                                                                                                                      000671
 000672               If not inComment and not convert                                                  B04                  000672
 000673               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000673
 000674                  nonConvRsn = 'Conversion not currently supported.';                             04                  000674
 000675               EndIf;                                                                            E04                  000675
 000676                                                                                                                      000676
 000677            ElseIf workLineType = 'D';     // Declaration.                                       X03                  000677
 000678               countEligible += 1;                                                                03                  000678
 000679               countNotConv += 1;                                                                 03                  000679
 000680               savedComment = comment;                                                            03                  000680
 000681                                                                                                                      000681
 000682               Exsr subUserConvertD_Spec;                                                         03                  000682
 000683                                                                                                                      000683
 000684               If not inComment and not convert                                                  B04                  000684
 000685               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000685
 000686                  //nonConvRsn = 'Conversion not currently supported.';                                               000686
 000687               EndIf;                                                                            E04                  000687
 000688                                                                                                                      000688
 000689            ElseIf workLineType = 'F';     // File.                                              X03                  000689
 000690               countEligible += 1;                                                                03                  000690
 000691               countNotConv += 1;                                                                 03                  000691
 000692               savedComment = comment;                                                            03                  000692
 000693                                                                                                                      000693
 000694               Exsr subUserConvertF_Spec;                                                         03                  000694
 000695                                                                                                                      000695
 000696               If not inComment and not convert                                                  B04                  000696
 000697               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000697
 000698                  //nonConvRsn = 'Conversion not currently supported.';                                               000698
 000699               EndIf;                                                                            E04                  000699
 000700                                                                                                                      000700
 000701            ElseIf workLineType = 'H';     // Header.                                            X03                  000701
 000702               countEligible += 1;                                                                03                  000702
 000703               countNotConv += 1;                                                                 03                  000703
 000704               savedComment = comment;                                                            03                  000704
 000705                                                                                                                      000705
 000706               Exsr subUserConvertH_Spec;                                                         03                  000706
 000707                                                                                                                      000707
 000708               If not inComment and not convert                                                  B04                  000708
 000709               and not dropLine and nonConvRsn = *Blanks;                                        B04                  000709
 000710                  //nonConvRsn = 'Conversion not currently supported.';                                               000710
 000711               EndIf;                                                                            E04                  000711
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     21
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000712                                                                                                                      000712
 000713            ElseIf workLineType = 'O';     // Output spec                                        X03                  000713
 000714               sourceLine = fullLine;                                                             03                  000714
 000715                                                                                                                      000715
 000716            ElseIf workLineType = 'I';     // Input spec                                         X03                  000716
 000717               sourceLine = fullLine;                                                             03                  000717
 000718                                                                                                                      000718
 000719            ElseIf workLineType = ' ' and inCode;                                                X03                  000719
 000720               inFreeFormat = *On;                                                                03                  000720
 000721               // When in an IF we usually want subsequent lines to be pulled back to be                              000721
 000722               // in line with the 'If', but only if those lines start with either 'and'                              000722
 000723               // or 'or'.  Otherwise we retain the existing indentation by turning on                                000723
 000724               // inSpan.                                                                                             000724
 000725               If inIf and %len(%trim(codeLine)) >= 3                                            B04                  000725
 000726               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'AND'                            B04                  000726
 000727               and %xlate(lo:up:%subst(%trim(codeLine):1:3)) <> 'OR ';                           B04                  000727
 000728                  inSpan = *On;                                                                   04                  000728
 000729               EndIf;                                                                            E04                  000729
 000730               If inSpan;                                                                        B04                  000730
 000731                  currOffset = %check(' ':codeLine);  // Offset of the continuation line.         04                  000731
 000732               Else;                                                                             X04                  000732
 000733                  prevOffset = %check(' ':codeLine);  // Offset of the parent line.               04                  000733
 000734               EndIf;                                                                            E04                  000734
 000735               sourceLine = %trim(codeLine);         // Free-format already, so trim it.          03                  000735
 000736            Else;                                                                                X03                  000736
 000737               inFreeFormat = *On;                                                                03                  000737
 000738               sourceLine = %trimr(codeLine);        // None of the above, use the raw source     03                  000738
 000739            EndIf;                                                                               E03                  000739
 000740                                                                                                                      000740
 000741            // Converted?                                                                                             000741
 000742            If convert;                                                                          B03                  000742
 000743               countConv += 1;                                                                    03                  000743
 000744               countNotConv -= 1;                                                                 03                  000744
 000745               // Switch to free-format?                                                                              000745
 000746               If not inFreeFormat and not inDeclaration;                                        B04                  000746
 000747                  If QpDirectives = 'Y';                                                         B05                  000747
 000748                     savedSRCDTA = SRCDTA;                                                        05                  000748
 000749                     Clear SRCDTA;                                                                05                  000749
 000750                     directive = '/Free';                                                         05                  000750
 000751                     Exsr subUserWriteLine;                                                       05                  000751
 000752                     SRCDTA = savedSRCDTA;                                                        05                  000752
 000753                  EndIf;                                                                         E05                  000753
 000754                  inFreeFormat = *On;                                                             04                  000754
 000755                  directive = *Blanks;                                                            04                  000755
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     22
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000756               EndIf;                                                                            E04                  000756
 000757            EndIf;                                                                               E03                  000757
 000758                                                                                                                      000758
 000759            // Revert to fixed-format?                                                                                000759
 000760            If not convert and (lineType <> *Blanks                                              B03                  000760
 000761            or %subst(workDirective:1:5) = '/COPY');                                             B03                  000761
 000762               //                or  %subst(prefix:1:3) = '** ');        // Array data reached                        000762
 000763               If inFreeFormat and not inDeclaration;                                            B04                  000763
 000764                  If QpDirectives = 'Y';                                                         B05                  000764
 000765                     savedSRCDTA = SRCDTA;                                                        05                  000765
 000766                     Clear SRCDTA;                                                                05                  000766
 000767                     directive = '/End-Free';                                                     05                  000767
 000768                     Exsr subUserWriteLine;                                                       05                  000768
 000769                     SRCDTA = savedSRCDTA;                                                        05                  000769
 000770                  EndIf;                                                                         E05                  000770
 000771                  inFreeFormat = *Off;                                                            04                  000771
 000772                  If not inDirective;                                                            B05                  000772
 000773                     directive = *Blanks;                                                         05                  000773
 000774                  EndIf;                                                                         E05                  000774
 000775               EndIf;                                                                            E04                  000775
 000776               // Record the reason for not converting?                                                               000776
 000777               If nonConvRsn <> *Blanks;                                                         B04                  000777
 000778                  savedSRCDTA = SRCDTA;                                                           04                  000778
 000779                  Clear SRCDTA;                                                                   04                  000779
 000780                  codeLine = '// >>>>> Not converted: ' + nonConvRsn;                             04                  000780
 000781                  Exsr subUserWriteLine;                                                          04                  000781
 000782                  SRCDTA = savedSRCDTA;                                                           04                  000782
 000783               EndIf;                                                                            E04                  000783
 000784               inSpan = *Off;                                                                     03                  000784
 000785            EndIf;                                                                               E03                  000785
 000786         Else;                                                                                   X02                  000786
 000787            // Use source exactly as is.                                                                              000787
 000788            sourceLine = codeLine;                                                                02                  000788
 000789         EndIf;                                                                                  E02                  000789
 000790                                                                                                                      000790
 000791         //----------------------------------------------------------------------------------                         000791
 000792         // If we are in a code section, check if indent is affected at all.                                          000792
 000793         //         If not inDeclaration                                                                              000793
 000794         //         and not inDirective                                                                               000794
 000795         If not inDirective                                                                      B02                  000795
 000796         and not inComment                                                                       B02                  000796
 000797         and not dropLine;                                                                       B02                  000797
 000798            // Isolate the operator to check indentation against.                                                     000798
 000799            //sourceLine = %trimr(codeLine);                                                                          000799
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     23
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000800            If inFreeFormat;                                                                     B03                  000800
 000801               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000801
 000802                  operator = *Blanks;                                                             04                  000802
 000803               ElseIf inSQL;                                // Embedded SQL - no operator.       X04                  000803
 000804                  operator = *Blanks;                                                             04                  000804
 000805               Else;                                                                             X04                  000805
 000806                  // Isolate the 'operator' (first word really).                                                      000806
 000807                  operator = %trim(sourceLine);                                                   04                  000807
 000808                  operatorEnd = %scan(' ':%trim(operator)); // Look for end of first 'word'.      04                  000808
 000809                  If operatorEnd = 0;                                                            B05                  000809
 000810                     operatorEnd = %scan(';':operator);  // Only one word - is it an operator     05                  000810
 000811                     If operatorEnd = 0;                                                         B06                  000811
 000812                        operatorEnd = %scan('(':operator);  // Shouldn't match!                   06                  000812
 000813                     EndIf;                                                                      E06                  000813
 000814                  EndIf;                                                                         E05                  000814
 000815                  // If we have an operator, remove any attached extender code.                                       000815
 000816                  If operatorEnd > 0;                                                            B05                  000816
 000817                     operator = %subst(operator:1:operatorEnd - 1);                               05                  000817
 000818                     // Exec SQL?                                                                                     000818
 000819                     If %xlate(lo:up:operator) = 'EXEC';                                         B06                  000819
 000820                        If %scan('SQL':%xlate(lo:up:%trim(sourceLine)):6)                        B07                  000820
 000821                                 > 0;                                                            B07                  000821
 000822                           operator = 'Exec SQL';                                                 07                  000822
 000823                           inSQL = *On;                                                           07                  000823
 000824                        EndIf;                                                                   E07                  000824
 000825                     EndIf;                                                                      E06                  000825
 000826                     operatorEnd = %scan('(':operator);                                           05                  000826
 000827                     If operatorEnd > 1;                                                         B06                  000827
 000828                        operator = %subst(operator:1:operatorEnd - 1);                            06                  000828
 000829                     EndIf;                                                                      E06                  000829
 000830                  EndIf;                                                                         E05                  000830
 000831                                                                                                                      000831
 000832                  If %lookup(%xlate(lo:up:operator):QopCodeUP) > 0                               B05                  000832
 000833                  and not inDeclaration;                                                         B05                  000833
 000834                     inCode = *On;                                                                05                  000834
 000835                  Else;                                                                          X05                  000835
 000836                     If %lookup(%xlate(lo:up:operator):QdeclUP) > 0;                             B06                  000836
 000837                        // Declaration!                                                                               000837
 000838                     Else;                                                                       X06                  000838
 000839                        // Not an operator!                                                                           000839
 000840                        operator = *Blanks;                                                       06                  000840
 000841                        x = %scan('=':sourceLine);                                                06                  000841
 000842                        If x > 0;   // Looks like an assignment.                                 B07                  000842
 000843                           operator = '=';                                                        07                  000843
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     24
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000844                           inCode = *On;                                                          07                  000844
 000845                           If workLineType = *Blank;                                             B08                  000845
 000846                              sourceLine = %trim(sourceLine);                                     08                  000846
 000847                           EndIf;                                                                E08                  000847
 000848                        EndIf;                                                                   E07                  000848
 000849                     EndIf;                                                                      E06                  000849
 000850                  EndIf;                                                                         E05                  000850
 000851               EndIf;                                                                            E04                  000851
 000852            Else;                                                                                X03                  000852
 000853               If %subst(sourceLine:1:2) = '//';            // Comment - no operator.            B04                  000853
 000854                  operator = *Blanks;                                                             04                  000854
 000855               Else;                                                                             X04                  000855
 000856                  operator = %xlate(lo:up:opCode);                                                04                  000856
 000857                  If %subst(operator:1:4) <> 'EVAL'                                              B05                  000857
 000858                  and operator <> *Blanks;                                                       B05                  000858
 000859                     // Strip out in-line definitions.                                                                000859
 000860                     len = *Blanks;                                                               05                  000860
 000861                     dec = *Blanks;                                                               05                  000861
 000862                  EndIf;                                                                         E05                  000862
 000863               EndIf;                                                                            E04                  000863
 000864            EndIf;                                                                               E03                  000864
 000865                                                                                                                      000865
 000866            // Convert to upper case for check.                                                                       000866
 000867            operator = %xlate(lo:up:operator);                                                    02                  000867
 000868                                                                                                                      000868
 000869            // Check for indentation level change.                                                                    000869
 000870            Select;                                                                              B03                  000870
 000871               When workDirective = '/EXEC SQL';                                                 X03                  000871
 000872                  increment = 1;                                                                  03                  000872
 000873                  inSQL = *On;                                                                    03                  000873
 000874               When workDirective = '/END-EXEC';                                                 X03                  000874
 000875                  unindent = *On;                                                                 03                  000875
 000876                  increment = -1;                                                                 03                  000876
 000877                  dropLine = *On;                                                                 03                  000877
 000878               When inSQL;                                                                       X03                  000878
 000879                  // Do nothing.                                                                                      000879
 000880               When %subst(operator:1:2) = 'IF';                                                 X03                  000880
 000881                  increment = 1;                                                                  03                  000881
 000882                  inIf = *On;                                                                     03                  000882
 000883               When %subst(operator:1:2) = 'DO';                                                 X03                  000883
 000884                  increment = 1;                                                                  03                  000884
 000885                  inDo = *On;                                                                     03                  000885
 000886                  doCount += 1;                                                                   03                  000886
 000887                  doLevel(doCount) = indentCount;                                                 03                  000887
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     25
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000888               When operator = 'FOR';                                                            X03                  000888
 000889                  increment = 1;                                                                  03                  000889
 000890                  forCount += 1;                                                                  03                  000890
 000891                  forLevel(forCount) = indentCount;                                               03                  000891
 000892               When operator = 'SELECT';                                                         X03                  000892
 000893                  increment = 2;                                                                  03                  000893
 000894                  slCount += 1;                                                                   03                  000894
 000895                  slLevel(slCount) = indentCount;                                                 03                  000895
 000896               When operator = 'BEGSR';                                                          X03                  000896
 000897                  increment = 1;                                                                  03                  000897
 000898                  mainlineIndent = 0;                                                             03                  000898
 000899                  indentCount = mainlineIndent;                                                   03                  000899
 000900               When %subst(operator:1:4) = 'DCL-';                                               X03                  000900
 000901                  increment = 0;                                                                  03                  000901
 000902                  mainlineIndent = 1;                                                             03                  000902
 000903                  indentCount = mainlineIndent;                                                   03                  000903
 000904                  defsMoved = *Off;                                                               03                  000904
 000905               When %subst(operator:1:4) = 'END-';                                               X03                  000905
 000906                  increment = 0;                                                                  03                  000906
 000907                  indentCount = mainlineIndent;                                                   03                  000907
 000908               When operator = 'MONITOR';                                                        X03                  000908
 000909                  increment = 1;                                                                  03                  000909
 000910               When operator = 'ENDSL';                                                          X03                  000910
 000911                  unindent = *On;                                                                 03                  000911
 000912                  increment = -2;                                                                 03                  000912
 000913                  slCount -= 1;                                                                   03                  000913
 000914               When operator = 'ENDCS';                                                          X03                  000914
 000915                  Operator = 'ENDIF';                                                             03                  000915
 000916                  unindent = *On;                                                                 03                  000916
 000917                  increment = -1;                                                                 03                  000917
 000918               When operator = 'ENDDO';                                                          X03                  000918
 000919                  unindent = *On;                                                                 03                  000919
 000920                  increment = -1;                                                                 03                  000920
 000921                  doCount -= 1;                                                                   03                  000921
 000922               When operator = 'ENDFOR';                                                         X03                  000922
 000923                  unindent = *On;                                                                 03                  000923
 000924                  increment = -1;                                                                 03                  000924
 000925                  forCount -= 1;                                                                  03                  000925
 000926               When %subst(operator:1:3) = 'END';                                                X03                  000926
 000927                  unindent = *On;                                                                 03                  000927
 000928                  increment = -1;                                                                 03                  000928
 000929               When %subst(operator:1:4) = 'ELSE'; // Unindent ELSE                              X03                  000929
 000930                  unindent = *On;                                                                 03                  000930
 000931                  indent = *On;                                                                   03                  000931
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     26
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000932                  increment = -1;                                                                 03                  000932
 000933               When %subst(operator:1:2) = 'OR';   // Unindent OR                                X03                  000933
 000934                  unindent = *On;                                                                 03                  000934
 000935                  indent = *On;                                                                   03                  000935
 000936                  increment = -1;                                                                 03                  000936
 000937               When %subst(operator:1:3) = 'AND';  // Unindent AND                               X03                  000937
 000938                  unindent = *On;                                                                 03                  000938
 000939                  indent = *On;                                                                   03                  000939
 000940                  increment = -1;                                                                 03                  000940
 000941               When operator = 'ON-ERROR';         // Unindent On-Error                          X03                  000941
 000942                  unindent = *On;                                                                 03                  000942
 000943                  indent = *On;                                                                   03                  000943
 000944                  increment = -1;                                                                 03                  000944
 000945               When %subst(operator:1:4) = 'WHEN' or inWhen;                                     X03                  000945
 000946                  unindent = *On;                                                                 03                  000946
 000947                  indent = *On;                                                                   03                  000947
 000948                  increment = -1;                                                                 03                  000948
 000949                  inWhen = *On;                                                                   03                  000949
 000950               When inIF or inDo;                  // Keep conditions in line.                   X03                  000950
 000951                  unindent = *On;                                                                 03                  000951
 000952                  indent = *On;                                                                   03                  000952
 000953                  increment = -1;                                                                 03                  000953
 000954               When operator = 'OTHER';             // Unindent Other                            X03                  000954
 000955                  unindent = *On;                                                                 03                  000955
 000956                  indent = *On;                                                                   03                  000956
 000957                  increment = -1;                                                                 03                  000957
 000958               Other;                                                                            X03                  000958
 000959                  increment = 0;                                                                  03                  000959
 000960            EndSl;                                                                               E03                  000960
 000961         ElseIf inDeclaration;                                                                   X02                  000961
 000962         EndIf;                                                                                  E02                  000962
 000963                                                                                                                      000963
 000964         //----------------------------------------------------------------------------------                         000964
 000965         // Start of code?  If so, pause here and move all field definitions to D-specs.                              000965
 000966         If inCode and not defsMoved;                                                            B02                  000966
 000967            Exsr subUserMoveDefs;                                                                 02                  000967
 000968         EndIf;                                                                                  E02                  000968
 000969                                                                                                                      000969
 000970         //----------------------------------------------------------------------------------                         000970
 000971         // If we need to temporarily unindent, do so to the requested increment.                                     000971
 000972         If unindent;                                                                            B02                  000972
 000973            indentCount += increment;                                                             02                  000973
 000974            increment = 0;                                                                        02                  000974
 000975            unindent = *Off;                                                                      02                  000975
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     27
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000976         EndIf;                                                                                  E02                  000976
 000977                                                                                                                      000977
 000978         //----------------------------------------------------------------------------------                         000978
 000979         // If we are in a code section and in free-format, perform reformatting.                                     000979
 000980         //If inCode and inFreeFormat and not inDirective                                                             000980
 000981         If inFreeFormat                                                                         B02                  000981
 000982         and not inDirective                                                                     B02                  000982
 000983         and sourceLine <> *Blanks                                                               B02                  000983
 000984         and not inComment                                                                       B02                  000984
 000985         and not dropLine;       //  and not inSpan                                              B02                  000985
 000986            // Derive reformatted opcode (if any)                                                                     000986
 000987            x = %lookup(operator:QopCodeUP);                                                      02                  000987
 000988            If x > 0;                                                                            B03                  000988
 000989               newOperator = %trim(QopCodeLO(x));                                                 03                  000989
 000990            Else;                                                                                X03                  000990
 000991               x = %lookup(operator:QdeclUP);                                                     03                  000991
 000992               If x > 0;                                                                         B04                  000992
 000993                  newOperator = %trim(QdeclLO(x));                                                04                  000993
 000994               Else;                                                                             X04                  000994
 000995                  // Not a valid operator, check if this is a comment.                                                000995
 000996                  x = %scan('//':%trim(sourceLine));                                              04                  000996
 000997                  If x = 1;                                                                      B05                  000997
 000998                     inComment = *On;                                                             05                  000998
 000999                     newOperator = '';                                                            05                  000999
 001000                     operator = *Blanks;                                                          05                  001000
 001001                  Else;                                                                          X05                  001001
 001002                     newOperator = '';                                                            05                  001002
 001003                  EndIf;                                                                         E05                  001003
 001004               EndIf;                                                                            E04                  001004
 001005            EndIf;                                                                               E03                  001005
 001006                                                                                                                      001006
 001007            // Use new opcode if it exists.                                                                           001007
 001008            If %len(newOperator) > 0;                                                            B03                  001008
 001009               If %len(%trim(sourceLine)) > %len(newOperator);                                   B04                  001009
 001010                  sourceLine = %trim(%subst(%trim(sourceLine)                                     04                  001010
 001011                                   :%len(newOperator) + 1));                                      04                  001011
 001012               Else;                                                                             X04                  001012
 001013                  //                  sourceLine = %trim(%subst(%trim(sourceLine)                                     001013
 001014                  //                                   :%len(newOperator)));                                          001014
 001015                  sourceLine = *Blanks;                                                           04                  001015
 001016               EndIf;                                                                            E04                  001016
 001017               // Insert a spcace after operator if it's not the end of the line                                      001017
 001018               // and there's no operation extender.                                                                  001018
 001019               If %subst(sourceLine:1:1) <> ';'                                                  B04                  001019
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     28
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001020               and (%subst(sourceLine:1:1) <> '('                                                B04                  001020
 001021                 or %subst(sourceLine:1:1) = '('                                                 B04                  001021
 001022                and %subst(sourceLine:3:1) <> ')'                                                B04                  001022
 001023                and %subst(sourceLine:4:1) <> ')');                                              B04                  001023
 001024                  sourceLine = ' ' + sourceLine;                                                  04                  001024
 001025               EndIf;                                                                            E04                  001025
 001026               sourceLine = newOperator + sourceLine;                                             03                  001026
 001027            EndIf;                                                                               E03                  001027
 001028                                                                                                                      001028
 001029            If inCode;                                                                           B03                  001029
 001030               // Padding required?                                                                                   001030
 001031               If padResult;                                                                     B04                  001031
 001032                  savedSRCDTA = SRCDTA;                                                           04                  001032
 001033                  Clear codeLine;                                                                 04                  001033
 001034                  %subst(codeLine:indentOffset)                                                   04                  001034
 001035                        = %trim(padTarget) + ' = *Blanks;';                                       04                  001035
 001036                  Exsr subUserWriteLine;                                                          04                  001036
 001037                  SRCDTA = savedSRCDTA;                                                           04                  001037
 001038                  padResult = *Off;                                                               04                  001038
 001039               EndIf;                                                                            E04                  001039
 001040                                                                                                                      001040
 001041               // Determine the indentation to use.                                                                   001041
 001042               If indentCount > maxIndent;                                                       B04                  001042
 001043                  indentOffset = maxIndent * indentSize + 1;                                      04                  001043
 001044               Else;                                                                             X04                  001044
 001045                  indentOffset = indentCount * indentSize + 1;                                    04                  001045
 001046               EndIf;                                                                            E04                  001046
 001047                                                                                                                      001047
 001048               // Adjust for continuation lines.                                                                      001048
 001049               If inCallP and (%subst(operator:1:5) <> 'CALLP');                                 B04                  001049
 001050                  indentOffset += callPOffset;                                                    04                  001050
 001051               ElseIf inEval and (%subst(operator:1:4) <> 'EVAL');                               X04                  001051
 001052                  indentOffset += evalOffset;                                                     04                  001052
 001053               ElseIf inSpan;                                                                    X04                  001053
 001054                  indentOffset = currOffset + (indentOffset - prevOffset);                        04                  001054
 001055               EndIf;                                                                            E04                  001055
 001056                                                                                                                      001056
 001057               // Avoid losing code off of the right hand side (comments mainly).                                     001057
 001058               If %len(%trimr(sourceLine)) + indentOffset > 93;                                  B04                  001058
 001059                  indentOffset = 93 - %len(%trim(sourceLine));                                    04                  001059
 001060               EndIf;                                                                            E04                  001060
 001061                                                                                                                      001061
 001062               // For code lines, check for overflow, and unindent accordingly if it does,                            001062
 001063               If not inComment;                                                                 B04                  001063
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     29
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001064                  lineEnd = %scan(';':%trimr(sourceLine));                                        04                  001064
 001065                  If lineEnd = 0;   // Code already spans to next line.                          B05                  001065
 001066                     lineEnd = %scan('//':sourceLine);                                            05                  001066
 001067                     If lineEnd > 0;                                                             B06                  001067
 001068                        lineEnd                                                                   06                  001068
 001069                          = %len(%trimr(%subst(sourceLine:1:lineEnd-1)));                         06                  001069
 001070                     Else;                                                                       X06                  001070
 001071                        lineEnd = %len(%trimr(sourceLine));                                       06                  001071
 001072                     EndIf;                                                                      E06                  001072
 001073                     If not inIf and not inDo and not inWhen;                                    B06                  001073
 001074                        inSpan = *On;                                                             06                  001074
 001075                     EndIf;                                                                      E06                  001075
 001076                  EndIf;                                                                         E05                  001076
 001077               EndIf;                                                                            E04                  001077
 001078                                                                                                                      001078
 001079               // Cater for commented out code that extends into comments.                                            001079
 001080               If indentOffset + lineEnd > 74;                                                   B04                  001080
 001081                  //Exsr subUserWrapLine;                                                                             001081
 001082                  indentOffset -= ((indentOffset + lineEnd) - 74);                                04                  001082
 001083               EndIf;                                                                            E04                  001083
 001084                                                                                                                      001084
 001085               // Ensure that we don't go back too far!                                                               001085
 001086               If indentOffset < 1;                                                              B04                  001086
 001087                  indentOffset = 1;                                                               04                  001087
 001088               EndIf;                                                                            E04                  001088
 001089                                                                                                                      001089
 001090               savedSRCDTA = SRCDTA;                                                              03                  001090
 001091               Clear codeLine;                                                                    03                  001091
 001092               %subst(codeLine:indentOffset) = %trimr(sourceLine);                                03                  001092
 001093               // Append an in-line comment?                                                                          001093
 001094               If (convert or setOn or setOff)                                                   B04                  001094
 001095               and savedComment <> *Blanks;                                                      B04                  001095
 001096                  %subst(codeLine:71) = '// ' + savedComment;                                     04                  001096
 001097                  savedComment = *Blanks;                                                         04                  001097
 001098               EndIf;                                                                            E04                  001098
 001099               sourceLine = codeLine;                                                             03                  001099
 001100               SRCDTA = savedSRCDTA;                                                              03                  001100
 001101               EndIf;   // inCode                                                                E03                  001101
 001102            EndIf;                                                                               E02                  001102
 001103         EndIf;                                                                                  E01                  001103
 001104                                                                                                                      001104
 001105         //----------------------------------------------------------------------------------                         001105
 001106         // Output the formatted line (and any overflows that have occurred.                                          001106
 001107         If not dropLine;                                                                        B01                  001107
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     30
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001108            If convert;                                                                          B02                  001108
 001109               Clear nonPrefix;                                                                   02                  001109
 001110            EndIf;                                                                               E02                  001110
 001111            If inCode or inArrayData                                                             B02                  001111
 001112            or lineType = *Blank or %subst(directive:1:1) = '*';                                 B02                  001112
 001113               codeLine = %trimr(sourceLine);                                                     02                  001113
 001114            Else;                                                                                X02                  001114
 001115               fullLine = %trimr(sourceLine);                                                     02                  001115
 001116            EndIf;                                                                               E02                  001116
 001117            Exsr subUserWriteLine;                                                                01                  001117
 001118                                                                                                                      001118
 001119            // Overflow line?                                                                                         001119
 001120            If overFlowLine <> *Blanks;                                                          B02                  001120
 001121               Clear codeLine;                                                                    02                  001121
 001122               %subst(codeLine:indentOffset) = %trimr(overflowLine);                              02                  001122
 001123               overflowLine = *Blanks;                                                            02                  001123
 001124               Exsr subUserWriteLine;                                                             02                  001124
 001125            EndIf;                                                                               E02                  001125
 001126         Else;                                                                                   X01                  001126
 001127            dropLine = *Off;                                                                      01                  001127
 001128         EndIf;                                                                                  E01                  001128
 001129                                                                                                                      001129
 001130         indentCount += increment;                                                                                    001130
 001131                                                                                                                      001131
 001132         // Following a WHEN or ON-ERROR or ELSE, code should be indented again.                                      001132
 001133         If indent;                                                                              B01                  001133
 001134            indentCount += 1;                                                                     01                  001134
 001135            indent = *Off;                                                                        01                  001135
 001136            // Following ENDSR, we should revert to mainline indentation.                                             001136
 001137         ElseIf operator = 'ENDSR';                                                              X01                  001137
 001138            indentCount = mainlineIndent;                                                         01                  001138
 001139            inCode = *Off;                                                                        01                  001139
 001140         EndIf;                                                                                  E01                  001140
 001141                                                                                                                      001141
 001142         // If spanning a line, check if the current line ends the span.                                              001142
 001143         If (inSpan or inIf or inDo or inWhen or inCallP or inEval                               B01                  001143
 001144         or inSQL or inDeclaration)                                                              B01                  001144
 001145         and not inComment;                                                                      B01                  001145
 001146            lineEnd = %scan(';':%trim(sourceLine));                                               01                  001146
 001147            If lineEnd <> 0;                                                                     B02                  001147
 001148               inSpan = *Off;                                                                     02                  001148
 001149               inIf = *Off;                                                                       02                  001149
 001150               inDo = *Off;                                                                       02                  001150
 001151               inWhen = *Off;                                                                     02                  001151
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     31
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001152               inCallP = *Off;                                                                    02                  001152
 001153               inEval = *Off;                                                                     02                  001153
 001154               inSQL = *Off;                                                                      02                  001154
 001155               inDeclaration = *Off;                                                              02                  001155
 001156            EndIf;                                                                               E02                  001156
 001157         EndIf;                                                                                  E01                  001157
 001158                                                                                                                      001158
 001159         //----------------------------------------------------------------------------------                         001159
 001160         // Close off Prototype/Interface/Datastructure?                                                              001160
 001161         If (inPrototype or inInterface or inDatastructure)                                      B01                  001161
 001162         and SRCSEQ = endLine;                                                                   B01                  001162
 001163            If not inDatastructure                                                               B02                  001163
 001164            or inDatastructure and endDS;                                                        B02                  001164
 001165               savedSRCDTA = SRCDTA;                                                              02                  001165
 001166               Clear SRCDTA;                                                                      02                  001166
 001167               codeLine = 'End-' + endDeclType + ';';                                             02                  001167
 001168               Exsr subUserWriteLine;                                                             02                  001168
 001169               SRCDTA = savedSRCDTA;                                                              02                  001169
 001170            EndIf;                                                                               E02                  001170
 001171            inPrototype = *Off;                                                                   01                  001171
 001172            inExtProc = *Off;                                                                     01                  001172
 001173            inInterface = *Off;                                                                   01                  001173
 001174            inDatastructure = *Off;                                                               01                  001174
 001175            inSpan = *Off;                                                                        01                  001175
 001176            inDeclaration = *Off;                                                                 01                  001176
 001177            inExtProc = *Off;                                                                     01                  001177
 001178            workDeclName = *Blanks;                                                               01                  001178
 001179         EndIf;                                                                                  E01                  001179
 001180                                                                                                                      001180
 001181      EndSr;                                                                                                          001181
 001182   //-------------------------------------------------------------------------------------------                      001182
 001183                                                                                                                      001183
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     32
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001185   //-------------------------------------------------------------------------------------------                      001185
 001186   // Convert the line to free-format?                                                                                001186
 001187   //-------------------------------------------------------------------------------------------                      001187
 001188   BegSr subUserConvertC_Spec;                                                                                        001188
 001189                                                                                                                      001189
 001190      Select;                                                                                    B01                  001190
 001191            // Keep blank lines.                                                                                      001191
 001192         When codeLine = *Blanks;                                                                X01                  001192
 001193            sourceLine = *Blanks;                                                                 01                  001193
 001194            convert = *On;                                                                        01                  001194
 001195                                                                                                                      001195
 001196           //----------------------------------------------------------------------------------                       001196
 001197            // EXEC SQL                                                                                               001197
 001198         When workDirective = '/EXEC SQL' or inSQL;                                              X01                  001198
 001199            Exsr subUserCvt_EXEC_SQL;                                                             01                  001199
 001200                                                                                                                      001200
 001201           //----------------------------------------------------------------------------------                       001201
 001202            // END-EXEC                                                                                               001202
 001203         When workDirective = '/END-EXEC';                                                       X01                  001203
 001204            convert = *On;                                                                        01                  001204
 001205                                                                                                                      001205
 001206           //----------------------------------------------------------------------------------                       001206
 001207            // Conditioning indicators                                                                                001207
 001208         When condInd <> *Blanks;                                                                X01                  001208
 001209            nonConvRsn = 'Conditioning indicators are not currently '                             01                  001209
 001210                       + 'supported.';                                                            01                  001210
 001211                                                                                                                      001211
 001212           //----------------------------------------------------------------------------------                       001212
 001213            // ACQ.                                                                                                   001213
 001214         When %subst(operator:1:3) = 'ACQ';                                                      X01                  001214
 001215            Exsr subUserCvt_ACQ;                                                                  01                  001215
 001216                                                                                                                      001216
 001217           //----------------------------------------------------------------------------------                       001217
 001218            // ADDDUR.                                                                                                001218
 001219         When %subst(operator:1:6) = 'ADDDUR';                                                   X01                  001219
 001220            Exsr subUserCvt_ADDDUR;                                                               01                  001220
 001221                                                                                                                      001221
 001222           //----------------------------------------------------------------------------------                       001222
 001223            // ADD.                                                                                                   001223
 001224         When %subst(operator:1:3) = 'ADD';                                                      X01                  001224
 001225            Exsr subUserCvt_ADD;                                                                  01                  001225
 001226                                                                                                                      001226
 001227           //----------------------------------------------------------------------------------                       001227
 001228            // ALLOC.                                                                                                 001228
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     33
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001229         When %subst(operator:1:5) = 'ALLOC';                                                    X01                  001229
 001230            Exsr subUserCvt_ALLOC;                                                                01                  001230
 001231                                                                                                                      001231
 001232           //----------------------------------------------------------------------------------                       001232
 001233            // BEGSR                                                                                                  001233
 001234         When operator = 'BEGSR';                                                                X01                  001234
 001235            Exsr subUserCvt_BEGSR;                                                                01                  001235
 001236                                                                                                                      001236
 001237           //----------------------------------------------------------------------------------                       001237
 001238            // CALLP                                                                                                  001238
 001239         When %subst(operator:1:5) = 'CALLP' or inCallP;                                         X01                  001239
 001240            Exsr subUserCvt_CALLP;                                                                01                  001240
 001241                                                                                                                      001241
 001242           //----------------------------------------------------------------------------------                       001242
 001243            // CASxx                                                                                                  001243
 001244         When %subst(operator:1:3) = 'CAS';                                                      X01                  001244
 001245            Exsr subUserCvt_CASxx;                                                                01                  001245
 001246                                                                                                                      001246
 001247           //----------------------------------------------------------------------------------                       001247
 001248            // CAT                                                                                                    001248
 001249         When %subst(operator:1:3) = 'CAT';                                                      X01                  001249
 001250            Exsr subUserCvt_CAT;                                                                  01                  001250
 001251                                                                                                                      001251
 001252           //----------------------------------------------------------------------------------                       001252
 001253            // CHAIN                                                                                                  001253
 001254         When %subst(operator:1:5) = 'CHAIN';                                                    X01                  001254
 001255            Exsr subUserCvt_CHAIN;                                                                01                  001255
 001256                                                                                                                      001256
 001257           //----------------------------------------------------------------------------------                       001257
 001258            // CHECK                                                                                                  001258
 001259         When %subst(operator:1:5) = 'CHECK';                                                    X01                  001259
 001260            Exsr subUserCvt_CHECKx;                                                               01                  001260
 001261                                                                                                                      001261
 001262           //----------------------------------------------------------------------------------                       001262
 001263            // CLEAR                                                                                                  001263
 001264         When %subst(operator:1:5) = 'CLEAR';                                                    X01                  001264
 001265            Exsr subUserCvt_CLEAR;                                                                01                  001265
 001266                                                                                                                      001266
 001267           //----------------------------------------------------------------------------------                       001267
 001268            // CLOSE                                                                                                  001268
 001269         When %subst(operator:1:5) = 'CLOSE';                                                    X01                  001269
 001270            Exsr subUserCvt_CLOSE;                                                                01                  001270
 001271                                                                                                                      001271
 001272           //----------------------------------------------------------------------------------                       001272
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     34
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001273            // COMMIT                                                                                                 001273
 001274         When %subst(operator:1:6) = 'COMMIT';                                                   X01                  001274
 001275            Exsr subUserCvt_COMMIT;                                                               01                  001275
 001276                                                                                                                      001276
 001277           //----------------------------------------------------------------------------------                       001277
 001278            // COMP                                                                                                   001278
 001279         When operator = 'COMP';                                                                 X01                  001279
 001280            Exsr subUserCvt_COMP;                                                                 01                  001280
 001281                                                                                                                      001281
 001282           //----------------------------------------------------------------------------------                       001282
 001283            // DEALLOC.                                                                                               001283
 001284         When %subst(operator:1:7) = 'DEALLOC';                                                  X01                  001284
 001285            Exsr subUserCvt_DEALLOC;                                                              01                  001285
 001286                                                                                                                      001286
 001287           //----------------------------------------------------------------------------------                       001287
 001288            // DEFINE                                                                                                 001288
 001289         When operator = 'DEFINE';                                                               X01                  001289
 001290            dropLine = *On;                                                                       01                  001290
 001291                                                                                                                      001291
 001292           //----------------------------------------------------------------------------------                       001292
 001293            // DELETE                                                                                                 001293
 001294         When %subst(operator:1:6) = 'DELETE';                                                   X01                  001294
 001295            Exsr subUserCvt_DELETE;                                                               01                  001295
 001296                                                                                                                      001296
 001297           //----------------------------------------------------------------------------------                       001297
 001298            // DIV                                                                                                    001298
 001299         When %subst(operator:1:3) = 'DIV';                                                      X01                  001299
 001300            Exsr subUserCvt_DIV;                                                                  01                  001300
 001301                                                                                                                      001301
 001302           //----------------------------------------------------------------------------------                       001302
 001303            // DOxxx                                                                                                  001303
 001304         When %subst(operator:1:2) = 'DO'                                                        X01                  001304
 001305         and (%subst(operator:3:3) = 'WEQ'                                                       X01                  001305
 001306         or %subst(operator:3:2) = 'W '                                                          X01                  001306
 001307         or %subst(operator:3:3) = 'WGT'                                                         X01                  001307
 001308         or %subst(operator:3:3) = 'WLT'                                                         X01                  001308
 001309         or %subst(operator:3:3) = 'WNE'                                                         X01                  001309
 001310         or %subst(operator:3:3) = 'WGE'                                                         X01                  001310
 001311         or %subst(operator:3:3) = 'WLE'                                                         X01                  001311
 001312         or %subst(operator:3:2) = 'U '                                                          X01                  001312
 001313         or %subst(operator:3:3) = 'UEQ'                                                         X01                  001313
 001314         or %subst(operator:3:3) = 'UGT'                                                         X01                  001314
 001315         or %subst(operator:3:3) = 'ULT'                                                         X01                  001315
 001316         or %subst(operator:3:3) = 'UNE'                                                         X01                  001316
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     35
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001317         or %subst(operator:3:3) = 'UGE'                                                         X01                  001317
 001318         or %subst(operator:3:3) = 'ULE'                                                         X01                  001318
 001319         or %subst(operator:3:3) = '   ')                                                        X01                  001319
 001320         or inDo;                                                                                X01                  001320
 001321            Exsr subUserCvt_DO;                                                                   01                  001321
 001322                                                                                                                      001322
 001323           //----------------------------------------------------------------------------------                       001323
 001324            // DSPLY                                                                                                  001324
 001325         When %subst(operator:1:5) = 'DSPLY';                                                    X01                  001325
 001326            Exsr subUserCvt_DSPLY;                                                                01                  001326
 001327                                                                                                                      001327
 001328           //----------------------------------------------------------------------------------                       001328
 001329            // DUMP                                                                                                   001329
 001330         When %subst(operator:1:4) = 'DUMP';                                                     X01                  001330
 001331            Exsr subUserCvt_DUMP;                                                                 01                  001331
 001332                                                                                                                      001332
 001333           //----------------------------------------------------------------------------------                       001333
 001334            // ELSE                                                                                                   001334
 001335         When operator = 'ELSE';                                                                 X01                  001335
 001336            Exsr subUserCvt_ELSE;                                                                 01                  001336
 001337                                                                                                                      001337
 001338           //----------------------------------------------------------------------------------                       001338
 001339            // ELSEIF                                                                                                 001339
 001340         When operator = 'ELSEIF';                                                               X01                  001340
 001341            Exsr subUserCvt_ELSEIF;                                                               01                  001341
 001342                                                                                                                      001342
 001343           //----------------------------------------------------------------------------------                       001343
 001344            // ENDxx                                                                                                  001344
 001345         When %subst(operator:1:3) = 'END';                                                      X01                  001345
 001346            Exsr subUserCvt_ENDxx;                                                                01                  001346
 001347                                                                                                                      001347
 001348           //----------------------------------------------------------------------------------                       001348
 001349            // EVALx                                                                                                  001349
 001350         When %subst(operator:1:4) = 'EVAL' or inEval;                                           X01                  001350
 001351            Exsr subUserCvt_EVALx;                                                                01                  001351
 001352                                                                                                                      001352
 001353           //----------------------------------------------------------------------------------                       001353
 001354            // EXCEPT                                                                                                 001354
 001355         When operator = 'EXCEPT';                                                               X01                  001355
 001356            Exsr subUserCvt_EXCEPT;                                                               01                  001356
 001357                                                                                                                      001357
 001358           //----------------------------------------------------------------------------------                       001358
 001359            // EXFMT                                                                                                  001359
 001360         When %subst(operator:1:5) = 'EXFMT';                                                    X01                  001360
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     36
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001361            Exsr subUserCvt_EXFMT;                                                                01                  001361
 001362                                                                                                                      001362
 001363           //----------------------------------------------------------------------------------                       001363
 001364            // EXSR                                                                                                   001364
 001365         When operator = 'EXSR';                                                                 X01                  001365
 001366            Exsr subUserCvt_EXSR;                                                                 01                  001366
 001367                                                                                                                      001367
 001368           //----------------------------------------------------------------------------------                       001368
 001369            // EXTRCT                                                                                                 001369
 001370         When %subst(operator:1:6) = 'EXTRCT';                                                   X01                  001370
 001371            Exsr subUserCvt_EXTRCT;                                                               01                  001371
 001372                                                                                                                      001372
 001373           //----------------------------------------------------------------------------------                       001373
 001374            // FEOD                                                                                                   001374
 001375         When %subst(operator:1:4) = 'FEOD';                                                     X01                  001375
 001376            Exsr subUserCvt_FEOD;                                                                 01                  001376
 001377                                                                                                                      001377
 001378           //----------------------------------------------------------------------------------                       001378
 001379            // FOR                                                                                                    001379
 001380         When operator = 'FOR';                                                                  X01                  001380
 001381            Exsr subUserCvt_FOR;                                                                  01                  001381
 001382                                                                                                                      001382
 001383           //----------------------------------------------------------------------------------                       001383
 001384            // FORCE                                                                                                  001384
 001385         When operator = 'FORCE';                                                                X01                  001385
 001386            Exsr subUserCvt_FORCE;                                                                01                  001386
 001387                                                                                                                      001387
 001388           //----------------------------------------------------------------------------------                       001388
 001389            // IFxx                                                                                                   001389
 001390         When %subst(operator:1:2) = 'IF' or inIf;                                               X01                  001390
 001391            Exsr subUserCvt_IF;                                                                   01                  001391
 001392                                                                                                                      001392
 001393           //----------------------------------------------------------------------------------                       001393
 001394            // IN                                                                                                     001394
 001395         When %subst(operator:1:2) = 'IN';                                                       X01                  001395
 001396            Exsr subUserCvt_IN;                                                                   01                  001396
 001397                                                                                                                      001397
 001398           //----------------------------------------------------------------------------------                       001398
 001399            // ITER                                                                                                   001399
 001400         When operator = 'ITER';                                                                 X01                  001400
 001401            Exsr subUserCvt_ITER;                                                                 01                  001401
 001402                                                                                                                      001402
 001403           //----------------------------------------------------------------------------------                       001403
 001404            // LEAVExx;                                                                                               001404
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     37
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001405         When %subst(operator:1:5) = 'LEAVE';                                                    X01                  001405
 001406            Exsr subUserCvt_LEAVE;                                                                01                  001406
 001407                                                                                                                      001407
 001408           //----------------------------------------------------------------------------------                       001408
 001409            // LOOKUP                                                                                                 001409
 001410         When operator = 'LOOKUP';                                                               X01                  001410
 001411            Exsr subUserCvt_LOOKUP;                                                               01                  001411
 001412                                                                                                                      001412
 001413           //----------------------------------------------------------------------------------                       001413
 001414            // MOVEA                                                                                                  001414
 001415         When %subst(operator:1:5) = 'MOVEA';                                                    X01                  001415
 001416            Exsr subUserCvt_MOVEA;                                                                01                  001416
 001417            LeaveSr;                                                                              01                  001417
 001418                                                                                                                      001418
 001419           //----------------------------------------------------------------------------------                       001419
 001420            // MOVE/MOVEL                                                                                             001420
 001421         When operator = 'MONITOR';                                                              X01                  001421
 001422            Exsr subUserCvt_MONITOR;                                                              01                  001422
 001423                                                                                                                      001423
 001424           //----------------------------------------------------------------------------------                       001424
 001425            // MOVE/MOVEL                                                                                             001425
 001426         When %subst(operator:1:4) = 'MOVE';                                                     X01                  001426
 001427            Exsr subUserCvt_MOVE;                                                                 01                  001427
 001428                                                                                                                      001428
 001429           //----------------------------------------------------------------------------------                       001429
 001430            // MULT.                                                                                                  001430
 001431         When %subst(operator:1:4) = 'MULT';                                                     X01                  001431
 001432            Exsr subUserCvt_MULT;                                                                 01                  001432
 001433                                                                                                                      001433
 001434           //----------------------------------------------------------------------------------                       001434
 001435            // MVR                                                                                                    001435
 001436         When operator = 'MVR';                                                                  X01                  001436
 001437            Exsr subUserCvt_MVR;                                                                  01                  001437
 001438                                                                                                                      001438
 001439           //----------------------------------------------------------------------------------                       001439
 001440            // OCCUR (but not both set and get).                                                                      001440
 001441         When %subst(operator:1:5) = 'OCCUR';                                                    X01                  001441
 001442            Exsr subUserCvt_OCCUR;                                                                01                  001442
 001443                                                                                                                      001443
 001444           //----------------------------------------------------------------------------------                       001444
 001445            // ON-ERROR                                                                                               001445
 001446         When operator = 'ON-ERROR';                                                             X01                  001446
 001447            Exsr subUserCvt_ON_ERROR;                                                             01                  001447
 001448                                                                                                                      001448
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     38
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001449           //----------------------------------------------------------------------------------                       001449
 001450            // OPEN                                                                                                   001450
 001451         When %subst(operator:1:4) = 'OPEN';                                                     X01                  001451
 001452            Exsr subUserCvt_OPEN;                                                                 01                  001452
 001453                                                                                                                      001453
 001454           //----------------------------------------------------------------------------------                       001454
 001455            // OTHER                                                                                                  001455
 001456         When operator = 'OTHER';                                                                X01                  001456
 001457            Exsr subUserCvt_OTHER;                                                                01                  001457
 001458                                                                                                                      001458
 001459           //----------------------------------------------------------------------------------                       001459
 001460            // OUT                                                                                                    001460
 001461         When %subst(operator:1:3) = 'OUT';                                                      X01                  001461
 001462            Exsr subUserCvt_OUT;                                                                  01                  001462
 001463                                                                                                                      001463
 001464           //----------------------------------------------------------------------------------                       001464
 001465            // POST                                                                                                   001465
 001466         When %subst(operator:1:4) = 'POST';                                                     X01                  001466
 001467            Exsr subUserCvt_POST;                                                                 01                  001467
 001468                                                                                                                      001468
 001469           //----------------------------------------------------------------------------------                       001469
 001470            // READ                                                                                                   001470
 001471         When %subst(operator:1:4) = 'READ';                                                     X01                  001471
 001472            Exsr subUserCvt_READ;                                                                 01                  001472
 001473                                                                                                                      001473
 001474           //----------------------------------------------------------------------------------                       001474
 001475            // REL                                                                                                    001475
 001476         When %subst(operator:1:3) = 'REL';                                                      X01                  001476
 001477            Exsr subUserCvt_REL;                                                                  01                  001477
 001478                                                                                                                      001478
 001479           //----------------------------------------------------------------------------------                       001479
 001480            // RESET                                                                                                  001480
 001481         When %subst(operator:1:5) = 'RESET';                                                    X01                  001481
 001482            Exsr subUserCvt_RESET;                                                                01                  001482
 001483                                                                                                                      001483
 001484           //----------------------------------------------------------------------------------                       001484
 001485            // RETURN                                                                                                 001485
 001486         When %subst(operator:1:6) = 'RETURN';                                                   X01                  001486
 001487            Exsr subUserCvt_RETURN;                                                               01                  001487
 001488                                                                                                                      001488
 001489           //----------------------------------------------------------------------------------                       001489
 001490            // ROLBK                                                                                                  001490
 001491         When %subst(operator:1:5) = 'ROLBK';                                                    X01                  001491
 001492            Exsr subUserCvt_ROLBK;                                                                01                  001492
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     39
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001493                                                                                                                      001493
 001494           //----------------------------------------------------------------------------------                       001494
 001495            // SCAN                                                                                                   001495
 001496         When operator = 'SCAN';                                                                 X01                  001496
 001497            Exsr subUserCvt_SCAN;                                                                 01                  001497
 001498                                                                                                                      001498
 001499           //----------------------------------------------------------------------------------                       001499
 001500            // SELECT                                                                                                 001500
 001501         When operator = 'SELECT';                                                               X01                  001501
 001502            Exsr subUserCvt_SELECT;                                                               01                  001502
 001503                                                                                                                      001503
 001504           //----------------------------------------------------------------------------------                       001504
 001505            // SETLL / SETGT                                                                                          001505
 001506         When %subst(operator:1:5) = 'SETLL'                                                     X01                  001506
 001507         or %subst(operator:1:5) = 'SETGT';                                                      X01                  001507
 001508            Exsr subUserCvt_SETxx;                                                                01                  001508
 001509                                                                                                                      001509
 001510           //----------------------------------------------------------------------------------                       001510
 001511            // SETOFF                                                                                                 001511
 001512         When operator = 'SETOFF';                                                               X01                  001512
 001513            Exsr subUserCvt_SETOFF;                                                               01                  001513
 001514                                                                                                                      001514
 001515           //----------------------------------------------------------------------------------                       001515
 001516            // SETON                                                                                                  001516
 001517         When operator = 'SETON';                                                                X01                  001517
 001518            Exsr subUserCvt_SETON;                                                                01                  001518
 001519                                                                                                                      001519
 001520           //----------------------------------------------------------------------------------                       001520
 001521            // SHTDN                                                                                                  001521
 001522         When operator = 'SHTDN';                                                                X01                  001522
 001523            Exsr subUserCvt_SHTDN;                                                                01                  001523
 001524                                                                                                                      001524
 001525           //----------------------------------------------------------------------------------                       001525
 001526            // SORTA.                                                                                                 001526
 001527         When %subst(operator:1:5) = 'SORTA';                                                    X01                  001527
 001528            Exsr subUserCvt_SORTA;                                                                01                  001528
 001529                                                                                                                      001529
 001530           //----------------------------------------------------------------------------------                       001530
 001531            // SUBDUR.                                                                                                001531
 001532         When %subst(operator:1:6) = 'SUBDUR';                                                   X01                  001532
 001533            Exsr subUserCvt_SUBDUR;                                                               01                  001533
 001534                                                                                                                      001534
 001535           //----------------------------------------------------------------------------------                       001535
 001536            // SUBST.                                                                                                 001536
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     40
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001537         When %subst(operator:1:5) = 'SUBST';                                                    X01                  001537
 001538            Exsr subUserCvt_SUBST;                                                                01                  001538
 001539                                                                                                                      001539
 001540           //----------------------------------------------------------------------------------                       001540
 001541            // SUB                                                                                                    001541
 001542         When %subst(operator:1:3) = 'SUB';                                                      X01                  001542
 001543            Exsr subUserCvt_SUB;                                                                  01                  001543
 001544                                                                                                                      001544
 001545           //----------------------------------------------------------------------------------                       001545
 001546            // TESTB                                                                                                  001546
 001547         When operator = 'TESTB';                                                                X01                  001547
 001548                                                                                                                      001548
 001549           //----------------------------------------------------------------------------------                       001549
 001550            // TESTN                                                                                                  001550
 001551         When operator = 'TESTN';                                                                X01                  001551
 001552                                                                                                                      001552
 001553           //----------------------------------------------------------------------------------                       001553
 001554            // TESTZ                                                                                                  001554
 001555         When operator = 'TESTZ';                                                                X01                  001555
 001556                                                                                                                      001556
 001557           //----------------------------------------------------------------------------------                       001557
 001558            // TEST                                                                                                   001558
 001559         When %subst(operator:1:4) = 'TEST';                                                     X01                  001559
 001560            Exsr subUserCvt_TEST;                                                                 01                  001560
 001561                                                                                                                      001561
 001562           //----------------------------------------------------------------------------------                       001562
 001563            // TIME                                                                                                   001563
 001564         When operator = 'TIME';                                                                 X01                  001564
 001565            Exsr subUserCvt_TIME;                                                                 01                  001565
 001566                                                                                                                      001566
 001567           //----------------------------------------------------------------------------------                       001567
 001568            // UPDATE                                                                                                 001568
 001569         When %subst(operator:1:6) = 'UPDATE';                                                   X01                  001569
 001570            Exsr subUserCvt_UPDATE;                                                               01                  001570
 001571                                                                                                                      001571
 001572           //----------------------------------------------------------------------------------                       001572
 001573            // UNLOCK                                                                                                 001573
 001574         When %subst(operator:1:6) = 'UNLOCK';                                                   X01                  001574
 001575            Exsr subUserCvt_UNLOCK;                                                               01                  001575
 001576                                                                                                                      001576
 001577           //----------------------------------------------------------------------------------                       001577
 001578            // WHENxx                                                                                                 001578
 001579         When %subst(operator:1:4) = 'WHEN' or inWhen;                                           X01                  001579
 001580            Exsr subUserCvt_WHEN;                                                                 01                  001580
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     41
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001581                                                                                                                      001581
 001582           //----------------------------------------------------------------------------------                       001582
 001583            // WRITE                                                                                                  001583
 001584         When %subst(operator:1:5) = 'WRITE';                                                    X01                  001584
 001585            Exsr subUserCvt_WRITE;                                                                01                  001585
 001586                                                                                                                      001586
 001587           //----------------------------------------------------------------------------------                       001587
 001588            // XLATE                                                                                                  001588
 001589         When %subst(operator:1:5) = 'XLATE';                                                    X01                  001589
 001590            Exsr subUserCvt_XLATE;                                                                01                  001590
 001591                                                                                                                      001591
 001592           //----------------------------------------------------------------------------------                       001592
 001593            // Z-ADD (half-adjust not converted).                                                                     001593
 001594         When %subst(operator:1:5) = 'Z-ADD';                                                    X01                  001594
 001595            Exsr subUserCvt_Z_ADD;                                                                01                  001595
 001596                                                                                                                      001596
 001597           //----------------------------------------------------------------------------------                       001597
 001598            // Z-SUB (half-adjust not converted).                                                                     001598
 001599         When %subst(operator:1:5) = 'Z-SUB';                                                    X01                  001599
 001600            Exsr subUserCvt_Z_SUB;                                                                01                  001600
 001601      EndSl;                                                                                     E01                  001601
 001602                                                                                                                      001602
 001603   EndSr;                                                                                                             001603
 001604   //-------------------------------------------------------------------------------------------                      001604
 001605                                                                                                                      001605
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     42
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001607   //-------------------------------------------------------------------------------------------                      001607
 001608   // Convert declaration to free-format.                                                                             001608
 001609   //-------------------------------------------------------------------------------------------                      001609
 001610   BegSr subUserConvertD_Spec;                                                                                        001610
 001611                                                                                                                      001611
 001612      // Keep blank lines.                                                                                            001612
 001613      If codeLine = *Blanks;                                                                     B01                  001613
 001614         sourceLine = *Blanks;                                                                    01                  001614
 001615         convert = *On;                                                                           01                  001615
 001616         LeaveSr;                                                                                 01                  001616
 001617      EndIf;                                                                                     E01                  001617
 001618                                                                                                                      001618
 001619      sourceLine = fullLine;                                                                                          001619
 001620                                                                                                                      001620
 001621      //      declType = %xlate(lo:up:declType);                                                                      001621
 001622      workDeclAttr = %xlate(lo:up:declAttr);                                                                          001622
 001623      workDeclKeywords = declKeywords;       // Use longer work field to cater for expansion.                         001623
 001624                                                                                                                      001624
 001625      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              001625
 001626                                                                                                                      001626
 001627      //If not inDeclaration;                                                                                         001627
 001628      If not inDeclaration or declName = *Blanks;                                                B01                  001628
 001629         If not inDeclaration;                                                                   B02                  001629
 001630            //Exsr subUserGetDeclarationType;                                                                         001630
 001631            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  001631
 001632         EndIf;                                                                                  E02                  001632
 001633                                                                                                                      001633
 001634         //-------------------------------------------------------------------------                                  001634
 001635         // Stand-alone Field Definition.                                                                             001635
 001636         //-------------------------------------------------------------------------                                  001636
 001637         If workDeclType = 'S';      // Stand-alone field.                                       B02                  001637
 001638            inDeclaration = *On;                                                                  02                  001638
 001639                                                                                                                      001639
 001640            Clear DCLS;                                                                           02                  001640
 001641                                                                                                                      001641
 001642            // FROMFILE is not allowed.                                                                               001642
 001643            If %scan('FROMFILE':%xlate(lo:up:workDeclKeywords)) > 0;                             B03                  001643
 001644               inDeclaration = *Off;                                                              03                  001644
 001645               nonConvRsn = 'FROMFILE not allowed in Free-Form';                                  03                  001645
 001646               convert = *Off;                                                                    03                  001646
 001647               LeaveSr;                                                                           03                  001647
 001648            EndIf;                                                                               E03                  001648
 001649                                                                                                                      001649
 001650            If savedName <> *Blanks;                                                             B03                  001650
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     43
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001651               DCLS.decl = 'Dcl-S ';                                                              03                  001651
 001652               %subst(DCLS:7) = savedName;                                                        03                  001652
 001653            EndIf;                                                                               E03                  001653
 001654                                                                                                                      001654
 001655            // Type.                                                                                                  001655
 001656            If workDeclAttr = *Blanks                                                            B03                  001656
 001657            and DCLS.type = *Blanks;                                                             B03                  001657
 001658               If declLen = *Blanks;                                                             B04                  001658
 001659                  // No definition (probably in keywords - e.g. LIKE()).                                              001659
 001660               ElseIf declScale = *Blanks;                                                       X04                  001660
 001661                  workDeclAttr = 'A';                                                             04                  001661
 001662               Else;                                                                             X04                  001662
 001663                  If inDatastructure;                                                            B05                  001663
 001664                     workDeclAttr = 'S';                                                          05                  001664
 001665                  Else;                                                                          X05                  001665
 001666                     workDeclAttr = 'P';                                                          05                  001666
 001667                  EndIf;                                                                         E05                  001667
 001668               EndIf;                                                                            E04                  001668
 001669            EndIf;                                                                               E03                  001669
 001670                                                                                                                      001670
 001671            If workDeclAttr = *Blanks;                                                           B03                  001671
 001672               // No definition (probably in keywords - e.g. LIKE()).                                                 001672
 001673            ElseIf workDeclAttr = 'A';                                                           X03                  001673
 001674               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001674
 001675               If x > 0;                                                                         B04                  001675
 001676                  DCLS.type = '  VarChar';                                                        04                  001676
 001677                  If x = 1;                                                                      B05                  001677
 001678                     workDeclKeywords = %subst(workDeclKeywords:x+7);                             05                  001678
 001679                  Else;                                                                          X05                  001679
 001680                     workDeclKeywords = %subst(workDeclKeywords:1:x-1)                            05                  001680
 001681                                  + %subst(workDeclKeywords:x+7);                                 05                  001681
 001682                  EndIf;                                                                         E05                  001682
 001683               Else;                                                                             X04                  001683
 001684                  DCLS.type = '     Char';                                                        04                  001684
 001685               EndIf;                                                                            E04                  001685
 001686            ElseIf workDeclAttr = 'P';                                                           X03                  001686
 001687               DCLS.type = '   Packed';                                                           03                  001687
 001688            ElseIf workDeclAttr = 'D';                                                           X03                  001688
 001689               DCLS.type = '     Date';                                                           03                  001689
 001690               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001690
 001691               If x > 0;                                                                         B04                  001691
 001692                  x = %scan('(':workDeclKeywords:x);                                              04                  001692
 001693                  y = %scan(')':workDeclKeywords:x);                                              04                  001693
 001694                  DCLS.definition = '('                                                           04                  001694
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     44
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001695                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001695
 001696                            + ')';                                                                04                  001696
 001697                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001697
 001698               EndIf;                                                                            E04                  001698
 001699            ElseIf workDeclAttr = 'T';                                                           X03                  001699
 001700               DCLS.type = '     Time';                                                           03                  001700
 001701               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001701
 001702               If x > 0;                                                                         B04                  001702
 001703                  x = %scan('(':workDeclKeywords:x);                                              04                  001703
 001704                  y = %scan(')':workDeclKeywords:x);                                              04                  001704
 001705                  DCLS.definition = '('                                                           04                  001705
 001706                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001706
 001707                            + ')';                                                                04                  001707
 001708                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001708
 001709               EndIf;                                                                            E04                  001709
 001710            ElseIf workDeclAttr = 'Z';                                                           X03                  001710
 001711               DCLS.type = 'TimeStamp';                                                           03                  001711
 001712            ElseIf workDeclAttr = 'I';                                                           X03                  001712
 001713               DCLS.type = '      Int';                                                           03                  001713
 001714            ElseIf workDeclAttr = 'U';                                                           X03                  001714
 001715               DCLS.type = '      Uns';                                                           03                  001715
 001716            ElseIf workDeclAttr = 'S';                                                           X03                  001716
 001717               DCLS.type = '    Zoned';                                                           03                  001717
 001718            ElseIf workDeclAttr = 'N';                                                           X03                  001718
 001719               DCLS.type = '      Ind';                                                           03                  001719
 001720            ElseIf workDeclAttr = '*';                                                           X03                  001720
 001721               DCLS.type = '  Pointer';                                                           03                  001721
 001722            ElseIf workDeclAttr = 'B';                                                           X03                  001722
 001723               DCLS.type = '   BinDec';                                                           03                  001723
 001724            ElseIf workDeclAttr = 'G';                                                           X03                  001724
 001725               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001725
 001726               If x > 0;                                                                         B04                  001726
 001727                  DCLS.type = ' VarGraph';                                                        04                  001727
 001728                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001728
 001729               Else;                                                                             X04                  001729
 001730                  DCLS.type = '    Graph';                                                        04                  001730
 001731               EndIf;                                                                            E04                  001731
 001732            Else;                                                                                X03                  001732
 001733               inDeclaration = *Off;                                                              03                  001733
 001734               convert = *Off;                                                                    03                  001734
 001735               LeaveSr;                                                                           03                  001735
 001736            EndIf;                                                                               E03                  001736
 001737                                                                                                                      001737
 001738            // Attributes.                                                                                            001738
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     45
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001739            If workDeclAttr <> '*'                                                               B03                  001739
 001740            and workDeclAttr <> 'N'                                                              B03                  001740
 001741            and workDeclAttr <> 'D'                                                              B03                  001741
 001742            and workDeclAttr <> 'T'                                                              B03                  001742
 001743            and workDeclAttr <> 'Z'                                                              B03                  001743
 001744            and workDeclAttr <> *Blank                                                           B03                  001744
 001745            and DCLS.type <> *Blanks;                                                            B03                  001745
 001746               DCLS.definition = '(' + %trim(declLen);                                            03                  001746
 001747               If declScale <> *Blanks;                                                          B04                  001747
 001748                  DCLS.definition = %trimr(DCLS.definition)                                       04                  001748
 001749                                  + ':' + %trim(declScale);                                       04                  001749
 001750               EndIf;                                                                            E04                  001750
 001751               DCLS.definition = %trimr(DCLS.definition) + ')';                                   03                  001751
 001752            EndIf;                                                                               E03                  001752
 001753                                                                                                                      001753
 001754            // Keywords.                                                                                              001754
 001755                                                                                                                      001755
 001756            // Expand DTAARA?                                                                                         001756
 001757            x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                                  02                  001757
 001758            If x > 0;                                                                            B03                  001758
 001759               i = %scan(')':workDeclKeywords:x+1);                                               03                  001759
 001760               If i > 0;                                                                         B04                  001760
 001761                  If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                         B05                  001761
 001762                     workDeclKeywords = %subst(workDeclKeywords:1:x+6)                            05                  001762
 001763                        + ''''                                                                    05                  001763
 001764                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      05                  001764
 001765                        + ''''                                                                    05                  001765
 001766                        + %subst(workDeclKeywords:i);                                             05                  001766
 001767                  EndIf;                                                                         E05                  001767
 001768               EndIf;                                                                            E04                  001768
 001769            EndIf;                                                                               E03                  001769
 001770                                                                                                                      001770
 001771            // Terminate the line?                                                                                    001771
 001772            If not inSpan;                                                                       B03                  001772
 001773               If workDeclKeyWords = *Blanks;                                                    B04                  001773
 001774                  DCLS.definition = %trimr(DCLS.definition) + ';';                                04                  001774
 001775               Else;                                                                             X04                  001775
 001776                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  001776
 001777               EndIf;                                                                            E04                  001777
 001778               inDeclaration = *Off;                                                              03                  001778
 001779            Else;                                                                                X03                  001779
 001780               inSpan = *Off;                                                                     03                  001780
 001781            EndIf;                                                                               E03                  001781
 001782                                                                                                                      001782
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     46
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001783            // Have we encroached on the comments?                                                                    001783
 001784            x = %len(%trimr(DCLS.definition)) + %len(workDeclKeywords);                           02                  001784
 001785            If x >= 37;                                                                          B03                  001785
 001786               x = x - %len(%trimr(DCLS.definition));                                             03                  001786
 001787               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  001787
 001788               indentOffset = 37;                                                                 03                  001788
 001789            EndIf;                                                                               E03                  001789
 001790                                                                                                                      001790
 001791            If DCLS.definition = *Blanks and DCLS.type = *Blanks;                                B03                  001791
 001792               DCLS.definition = %trim(workDeclKeywords);                                         03                  001792
 001793            Else;                                                                                X03                  001793
 001794               DCLS.definition = %trimr(DCLS.definition) + ' '                                    03                  001794
 001795                               + %trim(workDeclKeywords);                                         03                  001795
 001796            EndIf;                                                                               E03                  001796
 001797                                                                                                                      001797
 001798            // Comment.                                                                                               001798
 001799            If comment <> *Blanks;                                                               B03                  001799
 001800               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001800
 001801                  DCLS.comment = '   ' + comment;                                                 04                  001801
 001802               Else;                                                                             X04                  001802
 001803                  DCLS.comment = '// ' + comment;                                                 04                  001803
 001804               EndIf;                                                                            E04                  001804
 001805            EndIf;                                                                               E03                  001805
 001806                                                                                                                      001806
 001807            // Converted line...                                                                                      001807
 001808            sourceLine = DCLS;                                                                    02                  001808
 001809            If not inSpan;                                                                       B03                  001809
 001810               savedName = *Blanks;                                                               03                  001810
 001811            EndIf;                                                                               E03                  001811
 001812                                                                                                                      001812
 001813            //-------------------------------------------------------------------------                               001813
 001814            // Constant Definition.                                                                                   001814
 001815            //-------------------------------------------------------------------------                               001815
 001816         ElseIf workDeclType = 'C';                                                              X02                  001816
 001817            inDeclaration = *On;                                                                  02                  001817
 001818                                                                                                                      001818
 001819            Clear DCLS;                                                                           02                  001819
 001820            If savedName <> *Blanks;                                                             B03                  001820
 001821               DCLS.decl = 'Dcl-C ';                                                              03                  001821
 001822               %subst(DCLS:7) = %xlate(lo:up:savedName);                                          03                  001822
 001823            EndIf;                                                                               E03                  001823
 001824                                                                                                                      001824
 001825            // Keywords.                                                                                              001825
 001826            If workDeclKeywords <> *Blanks;                                                      B03                  001826
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     47
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001827               If DCLS.definition = *Blanks;                                                     B04                  001827
 001828                  DCLS.definition = %trim(workDeclKeywords);                                      04                  001828
 001829               Else;                                                                             X04                  001829
 001830                  DCLS.definition = %trimr(DCLS.definition) + ' '                                 04                  001830
 001831                                  + %trim(workDeclKeywords);                                      04                  001831
 001832               EndIf;                                                                            E04                  001832
 001833            EndIf;                                                                               E03                  001833
 001834                                                                                                                      001834
 001835            // Comment.                                                                                               001835
 001836            If comment <> *Blanks;                                                               B03                  001836
 001837               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  001837
 001838                  DCLS.comment = '   ' + comment;                                                 04                  001838
 001839               Else;                                                                             X04                  001839
 001840                  DCLS.comment = '// ' + comment;                                                 04                  001840
 001841               EndIf;                                                                            E04                  001841
 001842            EndIf;                                                                               E03                  001842
 001843                                                                                                                      001843
 001844            If not inSpan;                                                                       B03                  001844
 001845               DCLS.definition = %trimr(DCLS.definition) + ';';                                   03                  001845
 001846               inDeclaration = *Off;                                                              03                  001846
 001847            Else;                                                                                X03                  001847
 001848               inSpan = *Off;                                                                     03                  001848
 001849            EndIf;                                                                               E03                  001849
 001850                                                                                                                      001850
 001851            // Continuation of constant must start at left margin.                                                    001851
 001852            If DCLS.decl = *Blanks;                                                              B03                  001852
 001853               DCLS = DCLS.definition;                                                            03                  001853
 001854            EndIf;                                                                               E03                  001854
 001855                                                                                                                      001855
 001856            // Converted line...                                                                                      001856
 001857            sourceLine = DCLS;                                                                    02                  001857
 001858            If not inSpan;                                                                       B03                  001858
 001859               savedName = *Blanks;                                                               03                  001859
 001860            EndIf;                                                                               E03                  001860
 001861                                                                                                                      001861
 001862            //-------------------------------------------------------------------------                               001862
 001863            // Prototype/Interface/Datastructure Definition.                                                          001863
 001864            //-------------------------------------------------------------------------                               001864
 001865         ElseIf workDeclType = 'PR'                                                              X02                  001865
 001866             or inPrototype                                                                      X02                  001866
 001867             or workDeclType = 'PI'                                                              X02                  001867
 001868             or inInterface                                                                      X02                  001868
 001869             or workDeclType = 'DS'                                                              X02                  001869
 001870             or inDatastructure;                                                                 X02                  001870
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     48
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001871            inDeclaration = *On;                                                                  02                  001871
 001872            Clear DCLPR;                                                                          02                  001872
 001873                                                                                                                      001873
 001874            // Determine where to end the structure.                                                                  001874
 001875            If not inPrototype                                                                   B03                  001875
 001876            and not inInterface                                                                  B03                  001876
 001877            and not inDatastructure;                                                             B03                  001877
 001878               Exsr subUserGetEndLine;                                                            03                  001878
 001879               If workDeclType = 'PR';                                                           B04                  001879
 001880                  inPrototype = *On;                                                              04                  001880
 001881               ElseIf workDeclType = 'PI';                                                       X04                  001881
 001882                  inInterface = *On;                                                              04                  001882
 001883               ElseIf workDeclType = 'DS';                                                       X04                  001883
 001884                  inDatastructure = *On;                                                          04                  001884
 001885                  endDS = *On;                                                                    04                  001885
 001886               EndIf;                                                                            E04                  001886
 001887               DCLPR.decl = 'Dcl-' + workDeclType;                                                03                  001887
 001888               If savedName = *Blanks;                                                           B04                  001888
 001889                  savedName = '*N';                                                               04                  001889
 001890               EndIf;                                                                            E04                  001890
 001891               %subst(DCLPR:8) = savedName;                                                       03                  001891
 001892               //DCLPR.procName = savedName;                                                                          001892
 001893               endDeclType = workDeclType;                                                        03                  001893
 001894               workDeclName = savedName;                                                          03                  001894
 001895               If %scan('...':sourceLine) > 0;  // Long name!                                    B04                  001895
 001896                  workDeclAttr = *Blanks;                                                         04                  001896
 001897               EndIf;                                                                            E04                  001897
 001898            Else;                                                                                X03                  001898
 001899               If inPrototype                                                                    B04                  001899
 001900               and savedName = *Blanks                                                           B04                  001900
 001901               and declType = *Blanks                                                            B04                  001901
 001902               and not inExtProc                                                                 B04                  001902
 001903               and not inSpan;                                                                   B04                  001903
 001904                  savedName = '*N';                                                               04                  001904
 001905               EndIf;                                                                            E04                  001905
 001906                                                                                                                      001906
 001907               If savedName <> '**';                                                             B04                  001907
 001908                  DCLPR.fieldName = savedName;                                                    04                  001908
 001909               EndIf;                                                                            E04                  001909
 001910            EndIf;                                                                               E03                  001910
 001911                                                                                                                      001911
 001912            // Type.                                                                                                  001912
 001913            If workDeclAttr = *Blanks                                                            B03                  001913
 001914            and DCLPR.type = *Blanks;                                                            B03                  001914
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     49
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001915               If declLen = *Blanks;                                                             B04                  001915
 001916                  // No definition (probably in keywords - e.g. LIKE()).                                              001916
 001917               ElseIf declScale = *Blanks;                                                       X04                  001917
 001918                  workDeclAttr = 'A';                                                             04                  001918
 001919               Else;                                                                             X04                  001919
 001920                  If inDatastructure;                                                            B05                  001920
 001921                     workDeclAttr = 'S';                                                          05                  001921
 001922                  Else;                                                                          X05                  001922
 001923                     workDeclAttr = 'P';                                                          05                  001923
 001924                  EndIf;                                                                         E05                  001924
 001925               EndIf;                                                                            E04                  001925
 001926            EndIf;                                                                               E03                  001926
 001927                                                                                                                      001927
 001928            If workDeclAttr = *Blanks;                                                           B03                  001928
 001929               // No definition (probably in keywords - e.g. LIKE()).                                                 001929
 001930            ElseIf workDeclAttr = 'A';                                                           X03                  001930
 001931               If DCLPR.decl = 'Dcl-DS';                                                         B04                  001931
 001932                  If declLen <> *Blanks;                                                         B05                  001932
 001933                     DCLPR.type = '      Len';                                                    05                  001933
 001934                  EndIf;                                                                         E05                  001934
 001935               Else;                                                                             X04                  001935
 001936                  x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                            04                  001936
 001937                  If x > 0;                                                                      B05                  001937
 001938                     DCLPR.type = '  VarChar';                                                    05                  001938
 001939                     If x = 1;                                                                   B06                  001939
 001940                        workDeclKeywords = %subst(workDeclKeywords:x+7);                          06                  001940
 001941                     Else;                                                                       X06                  001941
 001942                        workDeclKeywords = %subst(workDeclKeywords:1:x-1)                         06                  001942
 001943                                     + %subst(workDeclKeywords:x+7);                              06                  001943
 001944                     EndIf;                                                                      E06                  001944
 001945                  Else;                                                                          X05                  001945
 001946                     DCLPR.type = '     Char';                                                    05                  001946
 001947                  EndIf;                                                                         E05                  001947
 001948               EndIf;                                                                            E04                  001948
 001949            ElseIf workDeclAttr = 'P';                                                           X03                  001949
 001950               DCLPR.type = '   Packed';                                                          03                  001950
 001951            ElseIf workDeclAttr = 'D';                                                           X03                  001951
 001952               DCLPR.type = '     Date';                                                          03                  001952
 001953               x = %scan('DATFMT':%xlate(lo:up:workDeclKeywords));                                03                  001953
 001954               If x > 0;                                                                         B04                  001954
 001955                  x = %scan('(':workDeclKeywords:x);                                              04                  001955
 001956                  y = %scan(')':workDeclKeywords:x);                                              04                  001956
 001957                  DCLPR.definition = '('                                                          04                  001957
 001958                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001958
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     50
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 001959                            + ')';                                                                04                  001959
 001960                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001960
 001961               EndIf;                                                                            E04                  001961
 001962            ElseIf workDeclAttr = 'T';                                                           X03                  001962
 001963               DCLPR.type = '     Time';                                                          03                  001963
 001964               x = %scan('TIMFMT':%xlate(lo:up:workDeclKeywords));                                03                  001964
 001965               If x > 0;                                                                         B04                  001965
 001966                  x = %scan('(':workDeclKeywords:x);                                              04                  001966
 001967                  y = %scan(')':workDeclKeywords:x);                                              04                  001967
 001968                  DCLPR.definition = '('                                                          04                  001968
 001969                            + %subst(workDeclKeywords:x+1:y-x-1)                                  04                  001969
 001970                            + ')';                                                                04                  001970
 001971                  workDeclKeywords = %subst(workDeclKeywords:y+1);                                04                  001971
 001972               EndIf;                                                                            E04                  001972
 001973            ElseIf workDeclAttr = 'Z';                                                           X03                  001973
 001974               DCLPR.type = 'TimeStamp';                                                          03                  001974
 001975            ElseIf workDeclAttr = 'I';                                                           X03                  001975
 001976               DCLPR.type = '      Int';                                                          03                  001976
 001977            ElseIf workDeclAttr = 'S';                                                           X03                  001977
 001978               DCLPR.type = '    Zoned';                                                          03                  001978
 001979            ElseIf workDeclAttr = 'N';                                                           X03                  001979
 001980               DCLPR.type = '      Ind';                                                          03                  001980
 001981            ElseIf workDeclAttr = '*';                                                           X03                  001981
 001982               DCLPR.type = '  Pointer';                                                          03                  001982
 001983            ElseIf workDeclAttr = 'B';                                                           X03                  001983
 001984               DCLPR.type = '   BinDec';                                                          03                  001984
 001985            ElseIf workDeclAttr = 'G';                                                           X03                  001985
 001986               x = %scan('VARYING':%xlate(lo:up:workDeclKeywords));                               03                  001986
 001987               If x > 0;                                                                         B04                  001987
 001988                  DCLPR.type = ' VarGraph';                                                       04                  001988
 001989                  workDeclKeywords = %subst(workDeclKeywords:x+7);                                04                  001989
 001990               Else;                                                                             X04                  001990
 001991                  DCLPR.type = '    Graph';                                                       04                  001991
 001992               EndIf;                                                                            E04                  001992
 001993            Else;                                                                                X03                  001993
 001994               inDeclaration = *Off;                                                              03                  001994
 001995               convert = *Off;                                                                    03                  001995
 001996               LeaveSr;                                                                           03                  001996
 001997            EndIf;                                                                               E03                  001997
 001998                                                                                                                      001998
 001999            // Attributes.                                                                                            001999
 002000            If workDeclAttr <> '*'                                                               B03                  002000
 002001            and workDeclAttr <> 'N'                                                              B03                  002001
 002002            and workDeclAttr <> 'D'                                                              B03                  002002
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     51
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002003            and workDeclAttr <> 'T'                                                              B03                  002003
 002004            and workDeclAttr <> 'Z'                                                              B03                  002004
 002005            and workDeclAttr <> *Blank                                                           B03                  002005
 002006            and DCLPR.type <> *Blanks;                                                           B03                  002006
 002007               DCLPR.definition = '(';                                                            03                  002007
 002008               If inDatastructure and declFrom <> *Blanks;                                       B04                  002008
 002009                  workLength = %dec(%trim(declLen):7:0)                                           04                  002009
 002010                             - %dec(%trim(declFrom):7:0) + 1;                                     04                  002010
 002011                  If workDeclAttr = 'B';                                                         B05                  002011
 002012                     workLength = workLength * 2;                                                 05                  002012
 002013                  ElseIf workDeclAttr = 'P';                                                     X05                  002013
 002014                     workLength = (workLength * 2) - 1;                                           05                  002014
 002015                  EndIf;                                                                         E05                  002015
 002016                  AdjustArrayLength(workLength);                                                  04                  002016
 002017                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002017
 002018                                   + %char(workLength);                                           04                  002018
 002019               Else;                                                                             X04                  002019
 002020                  DCLPR.definition = %trim(DCLPR.definition)                                      04                  002020
 002021                                   + %trim(declLen);                                              04                  002021
 002022               EndIf;                                                                            E04                  002022
 002023                                                                                                                      002023
 002024               If declScale <> *Blanks;                                                          B04                  002024
 002025                  DCLPR.definition = %trimr(DCLPR.definition)                                     04                  002025
 002026                                  + ':' + %trim(declScale);                                       04                  002026
 002027               EndIf;                                                                            E04                  002027
 002028               DCLPR.definition = %trimr(DCLPR.definition) + ')';                                 03                  002028
 002029            EndIf;                                                                               E03                  002029
 002030                                                                                                                      002030
 002031            // From specified?                                                                                        002031
 002032            If inDatastructure;                                                                  B03                  002032
 002033               If declFrom <> *Blanks                                                            B04                  002033
 002034               and %scan('...':declOptions) = 0;                                                 B04                  002034
 002035                  If %subst(declFrom:1:1) = '*';                                                 B05                  002035
 002036                     workDeclKeywords = %trim(declFrom) + ' ';                                    05                  002036
 002037                  Else;                                                                          X05                  002037
 002038                  workDeclKeywords = 'Pos(' + %trim(declFrom) + ') '                              05                  002038
 002039                               + workDeclKeywords;                                                05                  002039
 002040                  EndIf;                                                                         E05                  002040
 002041               Else;                                                                             X04                  002041
 002042                  // Overlay specified using the base datastructure name?                                             002042
 002043                  // This is not permitted in free-form, so convert it to 'POS'.                                      002043
 002044                  x = %scan('OVERLAY(':%xlate(lo:up:workDeclKeywords));                           04                  002044
 002045                  If x > 0;                                                                      B05                  002045
 002046                     i = %scan(':':workDeclKeywords:x);                                           05                  002046
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     52
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002047                     If i > 0;                                                                   B06                  002047
 002048                        If %trim(%xlate(lo:up                                                    B07                  002048
 002049                                :%subst(workDeclKeywords:x+8:i-x-8))) =                          B07                  002049
 002050                           %xlate(lo:up:workDeclName);                                           B07                  002050
 002051                           j = %scan(')':workDeclKeywords:i);                                     07                  002051
 002052                           If j > 0;                                                             B08                  002052
 002053                              If x = 1;                                                          B09                  002053
 002054                                 workDeclKeywords                                                 09                  002054
 002055                                  = 'Pos('                                                        09                  002055
 002056                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002056
 002057                                 + %subst(workDeclKeywords:j);                                    09                  002057
 002058                              Else;                                                              X09                  002058
 002059                                 workDeclKeywords                                                 09                  002059
 002060                                   = %trim(%subst(workDeclKeywords:1:x-1))                        09                  002060
 002061                                   + ' Pos('                                                      09                  002061
 002062                                 + %trim(%subst(workDeclKeywords:i+1:j-i-1))                      09                  002062
 002063                                 + %subst(workDeclKeywords:j);                                    09                  002063
 002064                              EndIf;                                                             E09                  002064
 002065                           EndIf;                                                                E08                  002065
 002066                        EndIf;                                                                   E07                  002066
 002067                     EndIf;                                                                      E06                  002067
 002068                  EndIf;                                                                         E05                  002068
 002069               EndIf;                                                                            E04                  002069
 002070               // Require End-DS?                                                                                     002070
 002071               x = %scan('LIKEDS(':%xlate(lo:up:workDeclKeywords));                               03                  002071
 002072               If x = 0;                                                                         B04                  002072
 002073                  x = %scan('LIKEREC(':%xlate(lo:up:workDeclKeywords));                           04                  002073
 002074               EndIf;                                                                            E04                  002074
 002075               If x > 0;                                                                         B04                  002075
 002076                  // Nope.                                                                                            002076
 002077                  endDS = *Off;                                                                   04                  002077
 002078               EndIf;                                                                            E04                  002078
 002079                                                                                                                      002079
 002080               // Datastructure type?                                                                                 002080
 002081               If declPrefix = 'S';       // Program Status                                      B04                  002081
 002082                  workDeclKeywords = 'PSDS ' + workDeclKeywords;                                  04                  002082
 002083                  If savedName = DCLPR.procName;                                                 B05                  002083
 002084                     %subst(savedName:16:1) = *Blank;                                             05                  002084
 002085                  EndIf;                                                                         E05                  002085
 002086                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002086
 002087                                                                                                                      002087
 002088               ElseIf declPrefix = 'U';   // Dataarea                                            X04                  002088
 002089                  // If not already defined as a data area, do it now.                                                002089
 002090                  If %scan('DTAARA':%xlate(lo:up:workDeclKeywords)) = 0;                         B05                  002090
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     53
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002091                     If declName = *Blanks;                                                      B06                  002091
 002092                        workDeclKeywords = 'DTAARA(*AUTO) '                                       06                  002092
 002093                                                     + workDeclKeywords;                          06                  002093
 002094                     Else;                                                                       X06                  002094
 002095                        workDeclKeywords = 'DTAARA ' + workDeclKeywords;                          06                  002095
 002096                     EndIf;                                                                      E06                  002096
 002097                  EndIf;                                                                         E05                  002097
 002098                  %subst(DCLPR.procName:16:1) = *Blank;                                           04                  002098
 002099               EndIf;                                                                            E04                  002099
 002100            EndIf;                                                                               E03                  002100
 002101                                                                                                                      002101
 002102            // Keywords.                                                                                              002102
 002103            If workDeclKeywords <> *Blanks;                                                      B03                  002103
 002104               // ExtProc name has extended to a second line.                                                         002104
 002105               If inExtProc;                                                                     B04                  002105
 002106                  // Continuation of name must start at left margin.                                                  002106
 002107                  DCLPR = workDeclKeywords;                                                       04                  002107
 002108                  workDeclKeywords = *Blanks;                                                     04                  002108
 002109                  inExtProc = *Off;                                                               04                  002109
 002110               EndIf;                                                                            E04                  002110
 002111                                                                                                                      002111
 002112               // Expand EXTNAME?                                                                                     002112
 002113               x = %scan('EXTNAME(':%xlate(lo:up:workDeclKeywords));                              03                  002113
 002114               If x > 0;                                                                         B04                  002114
 002115                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002115
 002116                  If i > 0;                                                                      B05                  002116
 002117                     If %scan('''':%subst(workDeclKeywords:x+8:i-x-8)) = 0;                      B06                  002117
 002118                        workDeclKeywords = %subst(workDeclKeywords:1:x+7)                         06                  002118
 002119                           + ''''                                                                 06                  002119
 002120                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+8:i-x-8)))                      06                  002120
 002121                           + ''''                                                                 06                  002121
 002122                           + %subst(workDeclKeywords:i);                                          06                  002122
 002123                     EndIf;                                                                      E06                  002123
 002124                  EndIf;                                                                         E05                  002124
 002125               EndIf;                                                                            E04                  002125
 002126                                                                                                                      002126
 002127               // Expand DTAARA?                                                                                      002127
 002128               x = %scan('DTAARA(':%xlate(lo:up:workDeclKeywords));                               03                  002128
 002129               If x > 0;                                                                         B04                  002129
 002130                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002130
 002131                  If i > 0;                                                                      B05                  002131
 002132                     If %scan('''':%subst(workDeclKeywords:x+7:i-x-7)) = 0;                      B06                  002132
 002133                        workDeclKeywords = %subst(workDeclKeywords:1:x+6)                         06                  002133
 002134                           + ''''                                                                 06                  002134
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     54
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002135                   + %xlate(lo:up:%trim(%subst(workDeclKeywords:x+7:i-x-7)))                      06                  002135
 002136                           + ''''                                                                 06                  002136
 002137                           + %subst(workDeclKeywords:i);                                          06                  002137
 002138                     EndIf;                                                                      E06                  002138
 002139                  EndIf;                                                                         E05                  002139
 002140               EndIf;                                                                            E04                  002140
 002141                                                                                                                      002141
 002142               // EXTPROC?                                                                                            002142
 002143               x = %scan('EXTPROC(':%xlate(lo:up:workDeclKeywords));                              03                  002143
 002144               If x > 0;                                                                         B04                  002144
 002145                  i = %scan(')':workDeclKeywords:x+1);                                            04                  002145
 002146                  If i = 0;                                                                      B05                  002146
 002147                     // Name extends onto next line.                                                                  002147
 002148                     inExtProc = *On;                                                             05                  002148
 002149                  EndIf;                                                                         E05                  002149
 002150               EndIf;                                                                            E04                  002150
 002151            EndIf;                                                                               E03                  002151
 002152                                                                                                                      002152
 002153            // Terminate the line?                                                                                    002153
 002154            If not inSpan;                                                                       B03                  002154
 002155               If workDeclKeywords = *Blanks and DCLPR.type = *Blanks;                           B04                  002155
 002156                  DCLPR.procName = %trimr(DCLPR.procName) + ';';                                  04                  002156
 002157               ElseIf workDeclKeywords = *Blanks;                                                X04                  002157
 002158                  DCLPR.definition = %trimr(DCLPR.definition) + ';';                              04                  002158
 002159               Else;                                                                             X04                  002159
 002160                  workDeclKeywords = %trimr(workDeclKeywords) + ';';                              04                  002160
 002161               EndIf;                                                                            E04                  002161
 002162               inDeclaration = *Off;                                                              03                  002162
 002163               savedName = *Blanks;                                                               03                  002163
 002164            Else;                                                                                X03                  002164
 002165               inSpan = *Off;                                                                     03                  002165
 002166            EndIf;                                                                               E03                  002166
 002167                                                                                                                      002167
 002168            // Have we encroached on the comments?                                                                    002168
 002169            x = %len(%trimr(DCLPR.definition)) + %len(workDeclKeywords);                          02                  002169
 002170            If x >= 37;                                                                          B03                  002170
 002171               x = x - %len(%trimr(DCLPR.definition));                                            03                  002171
 002172               SplitLine(workDeclKeywords:overflowLine:x);                                        03                  002172
 002173               indentOffset = 37;                                                                 03                  002173
 002174            EndIf;                                                                               E03                  002174
 002175                                                                                                                      002175
 002176            If DCLPR.definition = *Blanks and DCLPR.type = *Blanks;                              B03                  002176
 002177               DCLPR.definition = %trim(workDeclKeywords);                                        03                  002177
 002178            Else;                                                                                X03                  002178
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     55
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002179               DCLPR.definition = %trimr(DCLPR.definition) + ' '                                  03                  002179
 002180                               + %trim(workDeclKeywords);                                         03                  002180
 002181            EndIf;                                                                               E03                  002181
 002182                                                                                                                      002182
 002183            // Comment.                                                                                               002183
 002184            If comment <> *Blanks;                                                               B03                  002184
 002185               If %subst(%trim(comment) + ' ':1:2) = '//';                                       B04                  002185
 002186                  DCLPR.comment = '   ' + comment;                                                04                  002186
 002187               Else;                                                                             X04                  002187
 002188                  DCLPR.comment = '// ' + comment;                                                04                  002188
 002189               EndIf;                                                                            E04                  002189
 002190            EndIf;                                                                               E03                  002190
 002191                                                                                                                      002191
 002192            // Converted line...                                                                                      002192
 002193            sourceLine = DCLPR;                                                                   02                  002193
 002194            If not inSpan and savedName <> *Blanks;                                              B03                  002194
 002195               savedName = '**';                                                                  03                  002195
 002196            EndIf;                                                                               E03                  002196
 002197                                                                                                                      002197
 002198            //-------------------------------------------------------------------------                               002198
 002199            // Unsupported.                                                                                           002199
 002200            //-------------------------------------------------------------------------                               002200
 002201         Else;                                                                                   X02                  002201
 002202            inDeclaration = *Off;                                                                 02                  002202
 002203            convert = *Off;                                                                       02                  002203
 002204            LeaveSr;                                                                              02                  002204
 002205         EndIf;                                                                                  E02                  002205
 002206                                                                                                                      002206
 002207         //-------------------------------------------------------------------------                                  002207
 002208         // Second+ line of declaration.                                                                              002208
 002209         //-------------------------------------------------------------------------                                  002209
 002210      Else;                                                                                      X01                  002210
 002211         Clear DCLS;                                                                              01                  002211
 002212         DCLS.definition = %trim(workDeclKeywords);                                               01                  002212
 002213         If not inSpan;                                                                          B02                  002213
 002214            DCLS.definition = %trim(DCLS.definition) + ';';                                       02                  002214
 002215         EndIf;                                                                                  E02                  002215
 002216         sourceLine = DCLS;                                                                       01                  002216
 002217         inSpan = *Off;                                                                           01                  002217
 002218      EndIf;                                                                                     E01                  002218
 002219                                                                                                                      002219
 002220      convert = *On;                                                                                                  002220
 002221                                                                                                                      002221
 002222   EndSr;                                                                                                             002222
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     56
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002223   //-------------------------------------------------------------------------------------------                      002223
 002224                                                                                                                      002224
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     57
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002226   //-------------------------------------------------------------------------------------------                      002226
 002227   // Convert file spec to free-format.                                                                               002227
 002228   //-------------------------------------------------------------------------------------------                      002228
 002229   BegSr subUserConvertF_Spec;                                                                                        002229
 002230                                                                                                                      002230
 002231      // Keep blank lines.                                                                                            002231
 002232      If codeLine = *Blanks;                                                                     B01                  002232
 002233         sourceLine = *Blanks;                                                                    01                  002233
 002234         convert = *On;                                                                           01                  002234
 002235         LeaveSr;                                                                                 01                  002235
 002236      EndIf;                                                                                     E01                  002236
 002237                                                                                                                      002237
 002238      sourceLine = fullLine;                                                                                          002238
 002239                                                                                                                      002239
 002240      workFileUsage  = %xlate(lo:up:fileUsage);                                                                       002240
 002241      workFileDesig  = %xlate(lo:up:fileDesig);                                                                       002241
 002242      workFileAdd    = %xlate(lo:up:fileAdd);                                                                         002242
 002243      workFileDevice = %xlate(lo:up:fileDevice);                                                                      002243
 002244      workFileKeyed  = %xlate(lo:up:fileKeyed);                                                                       002244
 002245                                                                                                                      002245
 002246      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002246
 002247                                                                                                                      002247
 002248      If not inDeclaration;                                                                      B01                  002248
 002249                                                                                                                      002249
 002250         // Validate whether this can be converted.                                                                   002250
 002251         If workFileUsage = 'I'                                                                  B02                  002251
 002252         and (workFileDesig = 'P'                                                                B02                  002252
 002253         or workFileDesig = 'S'                                                                  B02                  002253
 002254         or workFileUsage = 'T')                                                                 B02                  002254
 002255                                                                                                 B02                  002255
 002256         or workFileUsage = 'O'                                                                  B02                  002256
 002257         and workFileAdd = 'A'                                                                   B02                  002257
 002258                                                                                                 B02                  002258
 002259         or workFileUsage = 'U'                                                                  B02                  002259
 002260         and (workFileDesig = 'P'                                                                B02                  002260
 002261         or workFileDesig = 'S')                                                                 B02                  002261
 002262                                                                                                 B02                  002262
 002263         or workFileUsage = 'C'                                                                  B02                  002263
 002264         and workFileDesig = 'T';                                                                B02                  002264
 002265                                                                                                                      002265
 002266            // Not supported in free-form.                                                                            002266
 002267            inDeclaration = *Off;                                                                 02                  002267
 002268            convert = *Off;                                                                       02                  002268
 002269            nonConvRsn = 'File usage not supported in free-form';                                 02                  002269
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     58
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002270            LeaveSr;                                                                              02                  002270
 002271         EndIf;                                                                                  E02                  002271
 002272                                                                                                                      002272
 002273         savedName = %trim(fileName);                                                             01                  002273
 002274                                                                                                                      002274
 002275         If %xlate(lo:up:fileExternal) = 'E';       // Externally-described file.                B02                  002275
 002276            inDeclaration = *On;                                                                  02                  002276
 002277                                                                                                                      002277
 002278            Clear DCLF;                                                                           02                  002278
 002279            DCLF.decl = 'Dcl-F ';                                                                 02                  002279
 002280            %subst(DCLF:7) = %xlate(lo:up:savedName);                                             02                  002280
 002281                                                                                                                      002281
 002282            // Set device type.                                                                                       002282
 002283            If workFileDevice <> 'DISK';                                                         B03                  002283
 002284               DCLF.device = workFileDevice;                                                      03                  002284
 002285            EndIf;                                                                               E03                  002285
 002286                                                                                                                      002286
 002287            // Set usage.                                                                                             002287
 002288            If workFileUsage = 'I';                                                              B03                  002288
 002289               If workFileAdd = ' ';                                                             B04                  002289
 002290                  If workFileDevice <> 'DISK'                                                    B05                  002290
 002291                  and workFileDevice <> 'SEQ'                                                    B05                  002291
 002292                  and workFileDevice <> 'SPECIAL';                                               B05                  002292
 002293                     DCLF.definition = '*INPUT';                                                  05                  002293
 002294                  EndIf;                                                                         E05                  002294
 002295               Else;                                                                             X04                  002295
 002296                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002296
 002297               EndIf;                                                                            E04                  002297
 002298            ElseIf workFileUsage = 'U';                                                          X03                  002298
 002299               If workFileAdd = ' ';                                                             B04                  002299
 002300                  DCLF.definition = '*UPDATE:*DELETE';                                            04                  002300
 002301               Else;                                                                             X04                  002301
 002302                  DCLF.definition = '*UPDATE:*DELETE:*OUTPUT';                                    04                  002302
 002303               EndIf;                                                                            E04                  002303
 002304            ElseIf workFileUsage = 'O';                                                          X03                  002304
 002305               If workFileDevice <> 'PRINTER';                                                   B04                  002305
 002306                  DCLF.definition = '*OUTPUT';                                                    04                  002306
 002307               EndIf;                                                                            E04                  002307
 002308            ElseIf workFileUsage = 'C';                                                          X03                  002308
 002309               If workFileDevice <> 'WORKSTN';                                                   B04                  002309
 002310                  DCLF.definition = '*INPUT:*OUTPUT';                                             04                  002310
 002311               EndIf;                                                                            E04                  002311
 002312            EndIf;                                                                               E03                  002312
 002313                                                                                                                      002313
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     59
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002314            // Pad out usage.                                                                                         002314
 002315            If DCLF.definition <> *Blanks;                                                       B03                  002315
 002316               DCLF.definition = 'Usage(' + %trim(DCLF.definition) + ')';                         03                  002316
 002317            EndIf;                                                                               E03                  002317
 002318                                                                                                                      002318
 002319            // Keyed file?                                                                                            002319
 002320            If workFileKeyed = 'K';                                                              B03                  002320
 002321               DCLF.definition = %trim(%trim(DCLF.definition)                                     03                  002321
 002322                                       + ' ' + 'Keyed');                                          03                  002322
 002323            EndIf;                                                                               E03                  002323
 002324                                                                                                                      002324
 002325            If comment <> *Blanks;                                                               B03                  002325
 002326               If %subst(%trim(comment):1:2) = '//';                                             B04                  002326
 002327                  DCLF.comment = '   ' + comment;                                                 04                  002327
 002328               Else;                                                                             X04                  002328
 002329                  DCLF.comment = '// ' + comment;                                                 04                  002329
 002330               EndIf;                                                                            E04                  002330
 002331            EndIf;                                                                               E03                  002331
 002332                                                                                                                      002332
 002333            // Keywords.                                                                                              002333
 002334            If fileKeyWords <> *Blanks;                                                          B03                  002334
 002335               // Do we have room to insert the keywords here?                                                        002335
 002336               checkLength = %len(%trim(%trim(DCLF.definition)                                    03                  002336
 002337                                       + ' ' + %trim(fileKeyWords))) + 1;                         03                  002337
 002338                                                                                                                      002338
 002339               If comment <> *Blanks;                                                            B04                  002339
 002340                  checkLength += 3;                                                               04                  002340
 002341               EndIf;                                                                            E04                  002341
 002342                                                                                                                      002342
 002343               If checkLength > %len(DCLF.definition);                                           B04                  002343
 002344                  // Not enoungh room for the keywords, so output the current line.                                   002344
 002345                  savedSRCDTA = SRCDTA;                                                           04                  002345
 002346                  lineType = *Blank;                                                              04                  002346
 002347                  directive = *Blanks;                                                            04                  002347
 002348                  codeLine = DCLF;                                                                04                  002348
 002349                  Exsr subUserWriteLine;                                                          04                  002349
 002350                  SRCDTA = savedSRCDTA;                                                           04                  002350
 002351                  // ...and move the keywords to their own line.                                                      002351
 002352                  Clear DCLF;                                                                     04                  002352
 002353                  DCLF.definition = fileKeywords;                                                 04                  002353
 002354                  savedComment = *Blanks;                                                         04                  002354
 002355               Else;                                                                             X04                  002355
 002356                  DCLF.definition = %trim(%trim(DCLF.definition)                                  04                  002356
 002357                                          + ' ' + %trim(fileKeyWords));                           04                  002357
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     60
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002358               EndIf;                                                                            E04                  002358
 002359            EndIf;                                                                               E03                  002359
 002360                                                                                                                      002360
 002361            If not inSpan;                                                                       B03                  002361
 002362               DCLF.definition = %trimr(DCLF.definition) + ';';                                   03                  002362
 002363               inDeclaration = *Off;                                                              03                  002363
 002364            Else;                                                                                X03                  002364
 002365               inSpan = *Off;                                                                     03                  002365
 002366            EndIf;                                                                               E03                  002366
 002367                                                                                                                      002367
 002368            // Converted line...                                                                                      002368
 002369            sourceLine = DCLF;                                                                    02                  002369
 002370                                                                                                                      002370
 002371         Else;                                                                                   X02                  002371
 002372            inDeclaration = *Off;                                                                 02                  002372
 002373            convert = *Off;                                                                       02                  002373
 002374            nonConvRsn = 'File not externally-described';                                         02                  002374
 002375            LeaveSr;                                                                              02                  002375
 002376         EndIf;                                                                                  E02                  002376
 002377                                                                                                                      002377
 002378      Else;                   // Second+ line of declaration                                     X01                  002378
 002379         Clear DCLF;                                                                              01                  002379
 002380         DCLF.definition = %trim(fileKeyWords);                                                   01                  002380
 002381         If not inSpan;                                                                          B02                  002381
 002382            DCLF.definition = %trim(DCLF.definition) + ';';                                       02                  002382
 002383         EndIf;                                                                                  E02                  002383
 002384         sourceLine = DCLF;                                                                       01                  002384
 002385         inSpan = *Off;                                                                           01                  002385
 002386      EndIf;                                                                                     E01                  002386
 002387                                                                                                                      002387
 002388      convert = *On;                                                                                                  002388
 002389                                                                                                                      002389
 002390   EndSr;                                                                                                             002390
 002391   //-------------------------------------------------------------------------------------------                      002391
 002392                                                                                                                      002392
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     61
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002394   //-------------------------------------------------------------------------------------------                      002394
 002395   // Convert Header spec to free-format.                                                                             002395
 002396   //-------------------------------------------------------------------------------------------                      002396
 002397   BegSr subUserConvertH_Spec;                                                                                        002397
 002398                                                                                                                      002398
 002399      // Keep blank lines.                                                                                            002399
 002400      If codeLine = *Blanks;                                                                     B01                  002400
 002401         sourceLine = *Blanks;                                                                    01                  002401
 002402         convert = *On;                                                                           01                  002402
 002403         LeaveSr;                                                                                 01                  002403
 002404      EndIf;                                                                                     E01                  002404
 002405                                                                                                                      002405
 002406      sourceLine = codeLine;                                                                                          002406
 002407                                                                                                                      002407
 002408      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002408
 002409                                                                                                                      002409
 002410      If not inDeclaration;                                                                      B01                  002410
 002411         inDeclaration = *On;                                                                     01                  002411
 002412                                                                                                                      002412
 002413         Clear DCLH;                                                                              01                  002413
 002414         DCLH.decl = 'Ctl-Opt ';                                                                  01                  002414
 002415         DCLH.options = %trim(declOptions);                                                       01                  002415
 002416                                                                                                                      002416
 002417         If comment <> *Blanks;                                                                  B02                  002417
 002418            If %subst(%trim(comment):1:2) = '//';                                                B03                  002418
 002419               DCLH.comment = '   ' + comment;                                                    03                  002419
 002420            Else;                                                                                X03                  002420
 002421               DCLH.comment = '// ' + comment;                                                    03                  002421
 002422            EndIf;                                                                               E03                  002422
 002423         EndIf;                                                                                  E02                  002423
 002424                                                                                                                      002424
 002425         If not inSpan;                                                                          B02                  002425
 002426            DCLH.options = %trimr(DCLH.options) + ';';                                            02                  002426
 002427            inDeclaration = *Off;                                                                 02                  002427
 002428         Else;                                                                                   X02                  002428
 002429            inSpan = *Off;                                                                        02                  002429
 002430         EndIf;                                                                                  E02                  002430
 002431                                                                                                                      002431
 002432         // Converted line...                                                                                         002432
 002433         sourceLine = DCLH;                                                                       01                  002433
 002434                                                                                                                      002434
 002435      Else;                   // Second+ line of declaration                                     X01                  002435
 002436         Clear DCLH;                                                                              01                  002436
 002437         DCLH.options = %trim(declOptions);                                                       01                  002437
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     62
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002438         If not inSpan;                                                                          B02                  002438
 002439            DCLH.options = %trim(DCLH.options) + ';';                                             02                  002439
 002440         EndIf;                                                                                  E02                  002440
 002441         sourceLine = DCLH;                                                                       01                  002441
 002442         inSpan = *Off;                                                                           01                  002442
 002443      EndIf;                                                                                     E01                  002443
 002444                                                                                                                      002444
 002445      convert = *On;                                                                                                  002445
 002446                                                                                                                      002446
 002447   EndSr;                                                                                                             002447
 002448   //-------------------------------------------------------------------------------------------                      002448
 002449                                                                                                                      002449
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     63
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002451   //-------------------------------------------------------------------------------------------                      002451
 002452   // Convert procedure declaration to free-format?                                                                   002452
 002453   //-------------------------------------------------------------------------------------------                      002453
 002454   BegSr subUserConvertP_Spec;                                                                                        002454
 002455                                                                                                                      002455
 002456      // Keep blank lines.                                                                                            002456
 002457      If codeLine = *Blanks;                                                                     B01                  002457
 002458         sourceLine = *Blanks;                                                                    01                  002458
 002459         convert = *On;                                                                           01                  002459
 002460         LeaveSr;                                                                                 01                  002460
 002461      EndIf;                                                                                     E01                  002461
 002462                                                                                                                      002462
 002463      sourceLine = fullLine;                                                                                          002463
 002464                                                                                                                      002464
 002465      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002465
 002466                                                                                                                      002466
 002467      If not inDeclaration;   // First line of procedure start/end.                              B01                  002467
 002468         If not inDeclaration;                                                                   B02                  002468
 002469            //Exsr subUserGetDeclarationType;                                                                         002469
 002470            GetDeclarationType(workDeclType:savedName:workDeclLine);                              02                  002470
 002471         EndIf;                                                                                  E02                  002471
 002472                                                                                                                      002472
 002473         If workDeclType = 'B'       // Begin.                                                   B02                  002473
 002474         or workDeclType = 'E'       // End.                                                     B02                  002474
 002475         or declName <> *Blanks;                                                                 B02                  002475
 002476            inDeclaration = *On;                                                                  02                  002476
 002477                                                                                                                      002477
 002478            Clear DCLP;                                                                           02                  002478
 002479            //            If savedName <> *Blanks;                                                                    002479
 002480            If workDeclType = 'B';                                                               B03                  002480
 002481               DCLP.decl = 'Dcl-Proc ';                                                           03                  002481
 002482            Else;                                                                                X03                  002482
 002483               DCLP.decl = 'End-Proc ';                                                           03                  002483
 002484            EndIf;                                                                               E03                  002484
 002485            DCLP.definition = savedName;                                                          02                  002485
 002486            //            EndIf;                                                                                      002486
 002487                                                                                                                      002487
 002488            If procKeyWords <> *Blanks;                                                          B03                  002488
 002489               DCLP.definition = %trimr(DCLP.definition)                                          03                  002489
 002490                               + ' ' + %trim(procKeyWords);                                       03                  002490
 002491            EndIf;                                                                               E03                  002491
 002492                                                                                                                      002492
 002493            If comment <> *Blanks;                                                               B03                  002493
 002494               If %subst(%trim(comment):1:2) = '//';                                             B04                  002494
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     64
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002495                  DCLP.comment = '   ' + comment;                                                 04                  002495
 002496               Else;                                                                             X04                  002496
 002497                  DCLP.comment = '// ' + comment;                                                 04                  002497
 002498               EndIf;                                                                            E04                  002498
 002499            EndIf;                                                                               E03                  002499
 002500                                                                                                                      002500
 002501            If not inSpan;                                                                       B03                  002501
 002502               DCLP.definition = %trimr(DCLP.definition) + ';';                                   03                  002502
 002503               inDeclaration = *Off;                                                              03                  002503
 002504            Else;                                                                                X03                  002504
 002505               inSpan = *Off;                                                                     03                  002505
 002506            EndIf;                                                                               E03                  002506
 002507                                                                                                                      002507
 002508            // Converted line...                                                                                      002508
 002509            sourceLine = DCLP;                                                                    02                  002509
 002510            savedName = *Blanks;                                                                  02                  002510
 002511                                                                                                                      002511
 002512         Else;                                                                                   X02                  002512
 002513            inDeclaration = *Off;                                                                 02                  002513
 002514            convert = *Off;                                                                       02                  002514
 002515            LeaveSr;                                                                              02                  002515
 002516         EndIf;                                                                                  E02                  002516
 002517                                                                                                                      002517
 002518      Else;                   // Second+ line of procedure start/end.                            X01                  002518
 002519         Clear DCLP;                                                                              01                  002519
 002520         DCLP.definition = %trim(declKeyWords);                                                   01                  002520
 002521         If not inSpan;                                                                          B02                  002521
 002522            DCLP.definition = %trimr(DCLP.definition) + ';';                                      02                  002522
 002523         EndIf;                                                                                  E02                  002523
 002524         sourceLine = DCLP;                                                                       01                  002524
 002525         inSpan = *Off;                                                                           01                  002525
 002526      EndIf;                                                                                     E01                  002526
 002527                                                                                                                      002527
 002528      convert = *On;                                                                                                  002528
 002529                                                                                                                      002529
 002530   EndSr;                                                                                                             002530
 002531   //-------------------------------------------------------------------------------------------                      002531
 002532                                                                                                                      002532
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     65
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002534   //-------------------------------------------------------------------------------------------                      002534
 002535   // Set Resulting Indicators.                                                                                       002535
 002536   //-------------------------------------------------------------------------------------------                      002536
 002537   BegSr subUserSetIndicators;                                                                                        002537
 002538                                                                                                                      002538
 002539      //-----------------------------------------------------------------------                                       002539
 002540      // Scan found.                                                                                                  002540
 002541      If foundCheck;                                                                             B01                  002541
 002542         Clear nonPrefix;                                                                         01                  002542
 002543                                                                                                                      002543
 002544         codeLine = '*IN' + foundInd + ' = %found();';                                            01                  002544
 002545         Exsr subUserReformatLine;                                                                01                  002545
 002546                                                                                                                      002546
 002547         foundCheck = *Off;                                                                       01                  002547
 002548      EndIf;                                                                                     E01                  002548
 002549                                                                                                                      002549
 002550      //-----------------------------------------------------------------------                                       002550
 002551      // Error indicator check.                                                                                       002551
 002552      If ERRCheck;                                                                               B01                  002552
 002553         Clear nonPrefix;                                                                         01                  002553
 002554                                                                                                                      002554
 002555         codeLine = '*IN' + ERRInd + ' = %error();';                                              01                  002555
 002556         Exsr subUserReformatLine;                                                                01                  002556
 002557                                                                                                                      002557
 002558         ERRCheck = *Off;                                                                         01                  002558
 002559      EndIf;                                                                                     E01                  002559
 002560                                                                                                                      002560
 002561      //-----------------------------------------------------------------------                                       002561
 002562      // Record not found check.                                                                                      002562
 002563      If NRFCheck;                                                                               B01                  002563
 002564         Clear nonPrefix;                                                                         01                  002564
 002565                                                                                                                      002565
 002566         codeLine = '*IN' + NRFInd + ' = not %found();';                                          01                  002566
 002567         Exsr subUserReformatLine;                                                                01                  002567
 002568                                                                                                                      002568
 002569         NRFCheck = *Off;                                                                         01                  002569
 002570      EndIf;                                                                                     E01                  002570
 002571                                                                                                                      002571
 002572      //-----------------------------------------------------------------------                                       002572
 002573      // End of File check.                                                                                           002573
 002574      If EOFCheck;                                                                               B01                  002574
 002575         Clear nonPrefix;                                                                         01                  002575
 002576                                                                                                                      002576
 002577         codeLine = '*IN' + EOFInd + ' = %eof();';                                                01                  002577
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     66
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002578         Exsr subUserReformatLine;                                                                01                  002578
 002579                                                                                                                      002579
 002580         EOFCheck = *Off;                                                                         01                  002580
 002581      EndIf;                                                                                     E01                  002581
 002582                                                                                                                      002582
 002583      //-----------------------------------------------------------------------                                       002583
 002584      // Matching Key check.                                                                                          002584
 002585      If equalCheck;                                                                             B01                  002585
 002586         Clear nonPrefix;                                                                         01                  002586
 002587                                                                                                                      002587
 002588         codeLine = '*IN' + equalInd + ' = %equal();';                                            01                  002588
 002589         Exsr subUserReformatLine;                                                                01                  002589
 002590                                                                                                                      002590
 002591         equalCheck = *Off;                                                                       01                  002591
 002592      EndIf;                                                                                     E01                  002592
 002593                                                                                                                      002593
 002594      //-----------------------------------------------------------------------                                       002594
 002595      // Perform SETOFF / SETON Expansion.                                                                            002595
 002596      If setOff;                                                                                 B01                  002596
 002597         Clear nonPrefix;                                                                         01                  002597
 002598         If setOffInd1 <> *Blanks;                                                               B02                  002598
 002599            codeLine = '*IN' + setOffInd1 + ' = *Off;';                                           02                  002599
 002600            Exsr subUserReformatLine;                                                             02                  002600
 002601         EndIf;                                                                                  E02                  002601
 002602         If setOffInd2 <> *Blanks;                                                               B02                  002602
 002603            codeLine = '*IN' + setOffInd2 + ' = *Off;';                                           02                  002603
 002604            Exsr subUserReformatLine;                                                             02                  002604
 002605         EndIf;                                                                                  E02                  002605
 002606         If setOffInd3 <> *Blanks;                                                               B02                  002606
 002607            codeLine = '*IN' + setOffInd3 + ' = *Off;';                                           02                  002607
 002608            Exsr subUserReformatLine;                                                             02                  002608
 002609         EndIf;                                                                                  E02                  002609
 002610         setOff = *Off;                                                                           01                  002610
 002611      EndIf;                                                                                     E01                  002611
 002612      If setOn;                                                                                  B01                  002612
 002613         Clear nonPrefix;                                                                         01                  002613
 002614         If setOnInd1 <> *Blanks;                                                                B02                  002614
 002615            codeLine = '*IN' + setOnInd1 + ' = *On;';                                             02                  002615
 002616            Exsr subUserReformatLine;                                                             02                  002616
 002617         EndIf;                                                                                  E02                  002617
 002618         If setOnInd2 <> *Blanks;                                                                B02                  002618
 002619            codeLine = '*IN' + setOnInd2 + ' = *On;';                                             02                  002619
 002620            Exsr subUserReformatLine;                                                             02                  002620
 002621         EndIf;                                                                                  E02                  002621
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     67
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002622         If setOnInd3 <> *Blanks;                                                                B02                  002622
 002623            codeLine = '*IN' + setOnInd3 + ' = *On;';                                             02                  002623
 002624            Exsr subUserReformatLine;                                                             02                  002624
 002625         EndIf;                                                                                  E02                  002625
 002626         setOn = *Off;                                                                            01                  002626
 002627      EndIf;                                                                                     E01                  002627
 002628                                                                                                                      002628
 002629      //-----------------------------------------------------------------------                                       002629
 002630      // Resulting indicators...                                                                                      002630
 002631                                                                                                                      002631
 002632      // Turn off all specified indicators first.                                                                     002632
 002633      If HICheck;                                                                                B01                  002633
 002634         Clear nonPrefix;                                                                         01                  002634
 002635         codeLine = '*IN' + HIInd + ' = *Off;';                                                   01                  002635
 002636         Exsr subUserReformatLine;                                                                01                  002636
 002637      EndIf;                                                                                     E01                  002637
 002638      If LWCheck;                                                                                B01                  002638
 002639         Clear nonPrefix;                                                                         01                  002639
 002640         codeLine = '*IN' + LWInd + ' = *Off;';                                                   01                  002640
 002641         Exsr subUserReformatLine;                                                                01                  002641
 002642      EndIf;                                                                                     E01                  002642
 002643      If EQCheck;                                                                                B01                  002643
 002644         Clear nonPrefix;                                                                         01                  002644
 002645         codeLine = '*IN' + EQInd + ' = *Off;';                                                   01                  002645
 002646         Exsr subUserReformatLine;                                                                01                  002646
 002647      EndIf;                                                                                     E01                  002647
 002648                                                                                                                      002648
 002649      // And now turn on those specified accordingly.                                                                 002649
 002650                                                                                                                      002650
 002651      // HI check.                                                                                                    002651
 002652      If HICheck;                                                                                B01                  002652
 002653         Clear nonPrefix;                                                                         01                  002653
 002654                                                                                                                      002654
 002655         codeLine = 'If ' + %trim(HIFactor1) + ' > '                                              01                  002655
 002656                  + %trim(HIFactor2) + ';';                                                       01                  002656
 002657         Exsr subUserReformatLine;                                                                01                  002657
 002658         codeLine = '*IN' + HIInd + ' = *On;';                                                    01                  002658
 002659         Exsr subUserReformatLine;                                                                01                  002659
 002660         codeLine = 'EndIf;';                                                                     01                  002660
 002661         Exsr subUserReformatLine;                                                                01                  002661
 002662                                                                                                                      002662
 002663         HICheck = *Off;                                                                          01                  002663
 002664      EndIf;                                                                                     E01                  002664
 002665                                                                                                                      002665
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     68
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002666      // LO check.                                                                                                    002666
 002667      If LWCheck;                                                                                B01                  002667
 002668         Clear nonPrefix;                                                                         01                  002668
 002669                                                                                                                      002669
 002670         codeLine = 'If ' + %trim(LWFactor1) + ' < '                                              01                  002670
 002671                  + %trim(LWFactor2) + ';';                                                       01                  002671
 002672         Exsr subUserReformatLine;                                                                01                  002672
 002673         codeLine = '*IN' + LWInd + ' = *On;';                                                    01                  002673
 002674         Exsr subUserReformatLine;                                                                01                  002674
 002675         codeLine = 'EndIf;';                                                                     01                  002675
 002676         Exsr subUserReformatLine;                                                                01                  002676
 002677                                                                                                                      002677
 002678         LWCheck = *Off;                                                                          01                  002678
 002679      EndIf;                                                                                     E01                  002679
 002680                                                                                                                      002680
 002681      // EQ check.                                                                                                    002681
 002682      If EQCheck;                                                                                B01                  002682
 002683         Clear nonPrefix;                                                                         01                  002683
 002684                                                                                                                      002684
 002685         codeLine = 'If ' + %trim(EQFactor1) + ' = '                                              01                  002685
 002686                  + %trim(EQFactor2) + ';';                                                       01                  002686
 002687         Exsr subUserReformatLine;                                                                01                  002687
 002688         codeLine = '*IN' + EQInd + ' = *On;';                                                    01                  002688
 002689         Exsr subUserReformatLine;                                                                01                  002689
 002690         codeLine = 'EndIf;';                                                                     01                  002690
 002691         Exsr subUserReformatLine;                                                                01                  002691
 002692                                                                                                                      002692
 002693         EQCheck = *Off;                                                                          01                  002693
 002694      EndIf;                                                                                     E01                  002694
 002695                                                                                                                      002695
 002696   EndSr;                                                                                                             002696
 002697   //-------------------------------------------------------------------------------------------                      002697
 002698                                                                                                                      002698
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     69
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002700   //-------------------------------------------------------------------------------------------                      002700
 002701   // Convert ACQ.                                                                                                    002701
 002702   //-------------------------------------------------------------------------------------------                      002702
 002703   BegSr subUserCvt_ACQ;                                                                                              002703
 002704                                                                                                                      002704
 002705      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             002705
 002706                 + ' ' + %trim(factor2) + ';';                                                                        002706
 002707                                                                                                                      002707
 002708      // Set resulting indicators?                                                                                    002708
 002709      If lw <> *Blanks;                                                                          B01                  002709
 002710         ERRCheck = *On;                                                                          01                  002710
 002711         ERRInd = lw;                                                                             01                  002711
 002712      EndIf;                                                                                     E01                  002712
 002713                                                                                                                      002713
 002714      convert = *On;                                                                                                  002714
 002715                                                                                                                      002715
 002716   EndSr;                                                                                                             002716
 002717   //-------------------------------------------------------------------------------------------                      002717
 002718                                                                                                                      002718
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     70
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002720   //-------------------------------------------------------------------------------------------                      002720
 002721   // Convert ADD.                                                                                                    002721
 002722   //-------------------------------------------------------------------------------------------                      002722
 002723   BegSr subUserCvt_ADD;                                                                                              002723
 002724                                                                                                                      002724
 002725      // Half-adjust?                                                                                                 002725
 002726      x = %scan('H':operator:4);                                                                                      002726
 002727      If x > 0;                                                                                  B01                  002727
 002728         sourceLine = 'Eval(H)';                                                                  01                  002728
 002729      Else;                                                                                      X01                  002729
 002730         sourceLine = *Blanks;                                                                    01                  002730
 002731      EndIf;                                                                                     E01                  002731
 002732                                                                                                                      002732
 002733      If factor1 = *Blanks;                                                                      B01                  002733
 002734         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002734
 002735                    + ' = ' + %trim(result)                                                       01                  002735
 002736                    + ' + ' + %trim(factor2) +';';                                                01                  002736
 002737      Else;                                                                                      X01                  002737
 002738         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  002738
 002739                    + ' = ' + %trim(factor1)                                                      01                  002739
 002740                    + ' + ' + %trim(factor2) + ';';                                               01                  002740
 002741      EndIf;                                                                                     E01                  002741
 002742                                                                                                                      002742
 002743      sourceLine = %trim(sourceLine);                                                                                 002743
 002744                                                                                                                      002744
 002745      convert = *On;                                                                                                  002745
 002746                                                                                                                      002746
 002747   EndSr;                                                                                                             002747
 002748   //-------------------------------------------------------------------------------------------                      002748
 002749                                                                                                                      002749
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     71
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002751   //-------------------------------------------------------------------------------------------                      002751
 002752   // Convert ADDDUR.                                                                                                 002752
 002753   //-------------------------------------------------------------------------------------------                      002753
 002754   BegSr subUserCvt_ADDDUR;                                                                                           002754
 002755                                                                                                                      002755
 002756      // Split out duration and code.                                                                                 002756
 002757      x = %scan(':':factor2);                                                                                         002757
 002758      If x = 0;                                                                                  B01                  002758
 002759         nonConvRsn =  'No duration code specified.';                                             01                  002759
 002760         LeaveSr;                                                                                 01                  002760
 002761      EndIf;                                                                                     E01                  002761
 002762                                                                                                                      002762
 002763      durDuration = %trim(%subst(factor2:1:x-1));                                                                     002763
 002764      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         002764
 002765                                                                                                                      002765
 002766      Select;                                                                                    B01                  002766
 002767         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  002767
 002768            durCode = '%years';                                                                   01                  002768
 002769         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  002769
 002770            durCode = '%months';                                                                  01                  002770
 002771         When durCode = '*D' or durCode = '*DAYS';                                               X01                  002771
 002772            durCode = '%days';                                                                    01                  002772
 002773         When durCode = '*H' or durCode = '*HOURS';                                              X01                  002773
 002774            durCode = '%hours';                                                                   01                  002774
 002775         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  002775
 002776            durCode = '%minutes';                                                                 01                  002776
 002777         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  002777
 002778            durCode = '%seconds';                                                                 01                  002778
 002779         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  002779
 002780            durCode = '%mseconds';                                                                01                  002780
 002781         Other;                                                                                  X01                  002781
 002782            nonConvRsn = 'Invalid duration code specified.';                                      01                  002782
 002783            LeaveSr;                                                                              01                  002783
 002784      EndSl;                                                                                     E01                  002784
 002785                                                                                                                      002785
 002786      If factor1 = *Blanks;                                                                      B01                  002786
 002787         sourceLine = %trim(result) + ' = ' + %trim(result);                                      01                  002787
 002788      Else;                                                                                      X01                  002788
 002789         sourceLine = %trim(result) + ' = ' + %trim(factor1);                                     01                  002789
 002790      EndIf;                                                                                     E01                  002790
 002791                                                                                                                      002791
 002792      sourceLine = %trimr(sourceLine) + ' + ' + %trim(durCode)                                                        002792
 002793                 + '(' + %trim(durDuration) + ');';                                                                   002793
 002794                                                                                                                      002794
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     72
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002795      // Set resulting indicators?                                                                                    002795
 002796      If lw <> *Blanks;                                                                          B01                  002796
 002797         ERRCheck = *On;                                                                          01                  002797
 002798         ERRInd = lw;                                                                             01                  002798
 002799      EndIf;                                                                                     E01                  002799
 002800                                                                                                                      002800
 002801      convert = *On;                                                                                                  002801
 002802                                                                                                                      002802
 002803   EndSr;                                                                                                             002803
 002804   //-------------------------------------------------------------------------------------------                      002804
 002805                                                                                                                      002805
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     73
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002807   //-------------------------------------------------------------------------------------------                      002807
 002808   // Convert ALLOC.                                                                                                  002808
 002809   //-------------------------------------------------------------------------------------------                      002809
 002810   BegSr subUserCvt_ALLOC;                                                                                            002810
 002811                                                                                                                      002811
 002812      sourceLine = %trim(result) + ' = %alloc(' + %trim(factor2) + ');';                                              002812
 002813                                                                                                                      002813
 002814      // Set resulting indicators?                                                                                    002814
 002815      If lw <> *Blanks;                                                                          B01                  002815
 002816         ERRCheck = *On;                                                                          01                  002816
 002817         ERRInd = lw;                                                                             01                  002817
 002818      EndIf;                                                                                     E01                  002818
 002819                                                                                                                      002819
 002820      convert = *On;                                                                                                  002820
 002821                                                                                                                      002821
 002822   EndSr;                                                                                                             002822
 002823   //-------------------------------------------------------------------------------------------                      002823
 002824                                                                                                                      002824
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     74
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002826   //-------------------------------------------------------------------------------------------                      002826
 002827   // Convert BEGSR.                                                                                                  002827
 002828   //-------------------------------------------------------------------------------------------                      002828
 002829   BegSr subUserCvt_BEGSR;                                                                                            002829
 002830                                                                                                                      002830
 002831      sourceLine = 'BegSr ' + %trim(factor1) + ';';                                                                   002831
 002832                                                                                                                      002832
 002833      convert = *On;                                                                                                  002833
 002834                                                                                                                      002834
 002835   EndSr;                                                                                                             002835
 002836   //-------------------------------------------------------------------------------------------                      002836
 002837                                                                                                                      002837
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     75
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002839   //-------------------------------------------------------------------------------------------                      002839
 002840   // Convert CALLP.                                                                                                  002840
 002841   //-------------------------------------------------------------------------------------------                      002841
 002842   BegSr subUserCvt_CALLP;                                                                                            002842
 002843                                                                                                                      002843
 002844      // Returning for a multi-line CALLP - restore the original opcode.                                              002844
 002845      If inCallP;                                                                                B01                  002845
 002846         operator = callPOperator;                                                                01                  002846
 002847      EndIf;                                                                                     E01                  002847
 002848                                                                                                                      002848
 002849      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              002849
 002850                                                                                                                      002850
 002851      If not inCallP;         // First line of CALLP.                                            B01                  002851
 002852         sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                                 01                  002852
 002853         If not inSpan;                                                                          B02                  002853
 002854            sourceLine = %trim(sourceLine) + ';';                                                 02                  002854
 002855         Else;                                                                                   X02                  002855
 002856            callPOffset = %len(%trim(operator)) + 2;                                              02                  002856
 002857            inCallP = *On;                                                                        02                  002857
 002858            inSpan = *Off;                                                                        02                  002858
 002859         EndIf;                                                                                  E02                  002859
 002860      Else;                   // Second+ line of CALLP.                                          X01                  002860
 002861         sourceLine = *Blanks;                                                                    01                  002861
 002862         sourceLine = %trim(extFactor2);                                                          01                  002862
 002863         If not inSpan;                                                                          B02                  002863
 002864            sourceLine = %trimr(sourceLine) + ';';                                                02                  002864
 002865            //            inCallP = *Off;                                                                             002865
 002866         EndIf;                                                                                  E02                  002866
 002867         inSpan = *Off;                                                                           01                  002867
 002868      EndIf;                                                                                     E01                  002868
 002869                                                                                                                      002869
 002870      // Multi-line CALLP?  Save the opcode.                                                                          002870
 002871      If inCallP;                                                                                B01                  002871
 002872         callPOperator = operator;                                                                01                  002872
 002873      Else;                                                                                      X01                  002873
 002874         callPOperator = *Blanks;                                                                 01                  002874
 002875      EndIf;                                                                                     E01                  002875
 002876                                                                                                                      002876
 002877      convert = *On;                                                                                                  002877
 002878                                                                                                                      002878
 002879   EndSr;                                                                                                             002879
 002880   //-------------------------------------------------------------------------------------------                      002880
 002881                                                                                                                      002881
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     76
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002883   //-------------------------------------------------------------------------------------------                      002883
 002884   // Convert CASxx.                                                                                                  002884
 002885   //-------------------------------------------------------------------------------------------                      002885
 002886   BegSr subUserCvt_CASxx;                                                                                            002886
 002887                                                                                                                      002887
 002888      // Extract components.                                                                                          002888
 002889      caseSubRoutine = %trim(result);                                                                                 002889
 002890      caseOperator = %subst(operator:4:2);                                                                            002890
 002891                                                                                                                      002891
 002892      // Determine comparator.                                                                                        002892
 002893      If caseOperator = 'EQ';                                                                    B01                  002893
 002894         caseOperator = '=';                                                                      01                  002894
 002895      ElseIf caseOperator = 'GT';                                                                X01                  002895
 002896         caseOperator = '>';                                                                      01                  002896
 002897      ElseIf caseOperator = 'LT';                                                                X01                  002897
 002898         caseOperator = '<';                                                                      01                  002898
 002899      ElseIf caseOperator = 'GE';                                                                X01                  002899
 002900         caseOperator = '>=';                                                                     01                  002900
 002901      ElseIf caseOperator = 'LE';                                                                X01                  002901
 002902         caseOperator = '<=';                                                                     01                  002902
 002903      ElseIf caseOperator = 'NE';                                                                X01                  002903
 002904         caseOperator = '<>';                                                                     01                  002904
 002905      Else;                                                                                      X01                  002905
 002906         caseOperator = 'Else';                                                                   01                  002906
 002907      EndIf;                                                                                     E01                  002907
 002908                                                                                                                      002908
 002909      // Build 'If' statement.                                                                                        002909
 002910      If not inCase;                                                                             B01                  002910
 002911         sourceLine = 'If ' +  %trim(factor1) + ' '                                               01                  002911
 002912                    + %trim(caseOperator) + ' ' + %trim(factor2)                                  01                  002912
 002913                    + ';';                                                                        01                  002913
 002914         inCase = *On;                                                                            01                  002914
 002915      Else;                                                                                      X01                  002915
 002916         If caseOperator = 'Else';                                                               B02                  002916
 002917            sourceLine = 'Else;';                                                                 02                  002917
 002918         Else;                                                                                   X02                  002918
 002919            sourceLine = 'ElseIf ' +  %trim(factor1) + ' '                                        02                  002919
 002920                       + %trim(caseOperator) + ' ' + %trim(factor2)                               02                  002920
 002921                       + ';';                                                                     02                  002921
 002922         EndIf;                                                                                  E02                  002922
 002923      EndIf;                                                                                     E01                  002923
 002924                                                                                                                      002924
 002925      // Do we need to set Resulting indicators?                                                                      002925
 002926      If hi <> *Blanks;                                                                          B01                  002926
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     77
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002927         HICheck = *On;                                                                           01                  002927
 002928         HIInd = hi;                                                                              01                  002928
 002929         HIFactor1 = %trim(factor1);                                                              01                  002929
 002930         HIFactor2 = %trim(factor2);                                                              01                  002930
 002931      EndIf;                                                                                     E01                  002931
 002932      If lw <> *Blanks;                                                                          B01                  002932
 002933         LWCheck = *On;                                                                           01                  002933
 002934         LWInd = lw;                                                                              01                  002934
 002935         LWFactor1 = %trim(factor1);                                                              01                  002935
 002936         LWFactor2 = %trim(factor2);                                                              01                  002936
 002937      EndIf;                                                                                     E01                  002937
 002938      If eq <> *Blanks;                                                                          B01                  002938
 002939         EQCheck = *On;                                                                           01                  002939
 002940         EQInd = eq;                                                                              01                  002940
 002941         EQFactor1 = %trim(factor1);                                                              01                  002941
 002942         EQFactor2 = %trim(factor2);                                                              01                  002942
 002943      EndIf;                                                                                     E01                  002943
 002944                                                                                                                      002944
 002945      convert = *On;                                                                                                  002945
 002946                                                                                                                      002946
 002947   EndSr;                                                                                                             002947
 002948   //-------------------------------------------------------------------------------------------                      002948
 002949                                                                                                                      002949
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     78
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002951   //-------------------------------------------------------------------------------------------                      002951
 002952   // Convert CAT.                                                                                                    002952
 002953   //-------------------------------------------------------------------------------------------                      002953
 002954   BegSr subUserCvt_CAT;                                                                                              002954
 002955                                                                                                                      002955
 002956      // Pad the result?                                                                                              002956
 002957      x = %scan('P':operator:4);                                                                                      002957
 002958      If x = 0                                              // Not padding.                      B01                  002958
 002959      and factor1 <> *Blanks                                // Factor1 specified.                B01                  002959
 002960      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  002960
 002961         nonConvRsn =  'No padding specified, result unpredictable.';                             01                  002961
 002962         LeaveSr;    // Don't convert - too difficult to get right.                               01                  002962
 002963      EndIf;                                                                                     E01                  002963
 002964                                                                                                                      002964
 002965      // Drop the extender.                                                                                           002965
 002966      operator = 'CAT';                                                                                               002966
 002967                                                                                                                      002967
 002968      // Determine first part of string.                                                                              002968
 002969      If factor1 = *Blanks;                                                                      B01                  002969
 002970         catFactor1 = %trim(result);                                                              01                  002970
 002971      Else;                                                                                      X01                  002971
 002972         catFactor1 = %trim(factor1);                                                             01                  002972
 002973      EndIf;                                                                                     E01                  002973
 002974                                                                                                                      002974
 002975      // Determine number of blanks.                                                                                  002975
 002976      x = %scan(':':factor2);                                                                                         002976
 002977      If x = 0;   // No trimming required;                                                       B01                  002977
 002978         catBlanks = *Blanks;                                                                     01                  002978
 002979         catFactor2 = %trim(factor2);                                                             01                  002979
 002980      Else;                                                                                      X01                  002980
 002981         catBlanks = %subst(factor2:x+1);                                                         01                  002981
 002982         catFactor2 = %subst(factor2:1:x-1);                                                      01                  002982
 002983      EndIf;                                                                                     E01                  002983
 002984                                                                                                                      002984
 002985      // Determine second part of String.                                                                             002985
 002986                                                                                                                      002986
 002987      // Blanks zero?                                                                                                 002987
 002988      If catBlanks <> *blanks;                                                                   B01                  002988
 002989         Monitor;                                                                                B02                  002989
 002990            catCount = %dec(catBlanks:3:0);                                                       02                  002990
 002991         On-Error;                                                                               X02                  002991
 002992            LeaveSr; // Uses a field to vary the number of blanks - don't convert.                02                  002992
 002993         EndMon;                                                                                 E02                  002993
 002994      EndIf;                                                                                     E01                  002994
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     79
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 002995                                                                                                                      002995
 002996      // Build the new line.                                                                                          002996
 002997      If catBlanks = *Blanks;                                                                    B01                  002997
 002998         // No trimming.                                                                                              002998
 002999         sourceLine = %trim(result) + ' = ' + %trim(catFactor1)                                   01                  002999
 003000                    + ' + ' + %trim(catFactor2) + ';';                                            01                  003000
 003001      ElseIf catCount = 0;                                                                       X01                  003001
 003002         // No spaces.                                                                                                003002
 003003         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003003
 003004                    + ') + %trim(' + %trim(catFactor2) + ');';                                    01                  003004
 003005      ElseIf catCount > 25;                                                                      X01                  003005
 003006         LeaveSr; // Arbitrary upper limit - don't convert.                                       01                  003006
 003007      Else;                                                                                      X01                  003007
 003008         sourceLine = %trim(result) + ' = %trimr(' + %trim(catFactor1)                            01                  003008
 003009                    + ') + ''' + %str(%addr(blanks):catCount)                                     01                  003009
 003010                    + ''' + %trim(' + %trim(catFactor2) + ');';                                   01                  003010
 003011      EndIf;                                                                                     E01                  003011
 003012                                                                                                                      003012
 003013      // Set resulting indicators?                                                                                    003013
 003014      If lw <> *Blanks;                                                                          B01                  003014
 003015         ERRCheck = *On;                                                                          01                  003015
 003016         ERRInd = lw;                                                                             01                  003016
 003017      EndIf;                                                                                     E01                  003017
 003018                                                                                                                      003018
 003019      convert = *On;                                                                                                  003019
 003020                                                                                                                      003020
 003021   EndSr;                                                                                                             003021
 003022   //-------------------------------------------------------------------------------------------                      003022
 003023                                                                                                                      003023
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     80
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003025   //-------------------------------------------------------------------------------------------                      003025
 003026   // Convert CHAIN.                                                                                                  003026
 003027   //-------------------------------------------------------------------------------------------                      003027
 003028   BegSr subUserCvt_CHAIN;                                                                                            003028
 003029                                                                                                                      003029
 003030      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       003030
 003031                 + %trim(factor2);                                                                                    003031
 003032                                                                                                                      003032
 003033      If result <> *Blanks;                                                                      B01                  003033
 003034         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003034
 003035      Else;                                                                                      X01                  003035
 003036         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003036
 003037      EndIf;                                                                                     E01                  003037
 003038                                                                                                                      003038
 003039      // Set resulting indicators?                                                                                    003039
 003040      If hi <> *Blanks;                                                                          B01                  003040
 003041         NRFCheck = *On;                                                                          01                  003041
 003042         NRFInd = hi;                                                                             01                  003042
 003043         NRFFile = %trim(factor2);                                                                01                  003043
 003044      EndIf;                                                                                     E01                  003044
 003045      If lw <> *Blanks;                                                                          B01                  003045
 003046         ERRCheck = *On;                                                                          01                  003046
 003047         ERRInd = lw;                                                                             01                  003047
 003048      EndIf;                                                                                     E01                  003048
 003049                                                                                                                      003049
 003050      convert = *On;                                                                                                  003050
 003051                                                                                                                      003051
 003052   EndSr;                                                                                                             003052
 003053   //-------------------------------------------------------------------------------------------                      003053
 003054                                                                                                                      003054
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     81
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003056   //-------------------------------------------------------------------------------------------                      003056
 003057   // Convert CHECK.                                                                                                  003057
 003058   //-------------------------------------------------------------------------------------------                      003058
 003059   BegSr subUserCvt_CHECKx;                                                                                           003059
 003060                                                                                                                      003060
 003061      // Don't convert of no result specified.                                                                        003061
 003062      If result = *Blanks;                                                                       B01                  003062
 003063         nonConvRsn = 'No result field specified.';                                               01                  003063
 003064         LeaveSr;                                                                                 01                  003064
 003065      EndIf;                                                                                     E01                  003065
 003066                                                                                                                      003066
 003067      If %subst(operator:1:5) = 'CHECKR';                                                        B01                  003067
 003068         operator = '%checkr(';                                                                   01                  003068
 003069      Else;                                                                                      X01                  003069
 003070         operator = '%check(';                                                                    01                  003070
 003071      EndIf;                                                                                     E01                  003071
 003072                                                                                                                      003072
 003073      // Determine starting point.                                                                                    003073
 003074      x = %scan(':':factor2);                                                                                         003074
 003075                                                                                                                      003075
 003076      // Build the new line.                                                                                          003076
 003077      If x = 0;                                                                                  B01                  003077
 003078         // No start specified.                                                                                       003078
 003079         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003079
 003080                    + %trim(factor1) + ':' + %trim(factor2) + ');';                               01                  003080
 003081      Else;                                                                                      X01                  003081
 003082         // Start from a specified point.                                                                             003082
 003083         sourceLine = %trim(result) + ' = ' + %trim(operator)                                     01                  003083
 003084                    + %trim(factor1) + ':' + %subst(factor2:1:x-1)                                01                  003084
 003085                    + ':' + %trim(%subst(factor2:x+1))                                            01                  003085
 003086                    + ');';                                                                       01                  003086
 003087      EndIf;                                                                                     E01                  003087
 003088                                                                                                                      003088
 003089      // Set resulting indicators?                                                                                    003089
 003090      If lw <> *Blanks;                                                                          B01                  003090
 003091         ERRCheck = *On;                                                                          01                  003091
 003092         ERRInd = lw;                                                                             01                  003092
 003093      EndIf;                                                                                     E01                  003093
 003094      If eq <> *Blanks;                                                                          B01                  003094
 003095         HICheck = *On;                                                                           01                  003095
 003096         HIInd = eq;                                                                              01                  003096
 003097         HIFactor1 = result;                                                                      01                  003097
 003098         HIFactor2 = '0';                                                                         01                  003098
 003099      EndIf;                                                                                     E01                  003099
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     82
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003100                                                                                                                      003100
 003101      convert = *On;                                                                                                  003101
 003102                                                                                                                      003102
 003103   EndSr;                                                                                                             003103
 003104   //-------------------------------------------------------------------------------------------                      003104
 003105                                                                                                                      003105
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     83
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003107   //-------------------------------------------------------------------------------------------                      003107
 003108   // Convert CLEAR.                                                                                                  003108
 003109   //-------------------------------------------------------------------------------------------                      003109
 003110   BegSr subUserCvt_CLEAR;                                                                                            003110
 003111                                                                                                                      003111
 003112      sourceLine = 'Clear ' + %trim(result) + ';';                                                                    003112
 003113                                                                                                                      003113
 003114      convert = *On;                                                                                                  003114
 003115                                                                                                                      003115
 003116   EndSr;                                                                                                             003116
 003117   //-------------------------------------------------------------------------------------------                      003117
 003118                                                                                                                      003118
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     84
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003120   //-------------------------------------------------------------------------------------------                      003120
 003121   // Convert CLOSE.                                                                                                  003121
 003122   //-------------------------------------------------------------------------------------------                      003122
 003123   BegSr subUserCvt_CLOSE;                                                                                            003123
 003124                                                                                                                      003124
 003125      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003125
 003126                                                                                                                      003126
 003127      If lw <> *Blanks;                                                                          B01                  003127
 003128         ERRCheck = *On;                                                                          01                  003128
 003129         ERRInd = lw;                                                                             01                  003129
 003130      EndIf;                                                                                     E01                  003130
 003131                                                                                                                      003131
 003132      convert = *On;                                                                                                  003132
 003133                                                                                                                      003133
 003134   EndSr;                                                                                                             003134
 003135   //-------------------------------------------------------------------------------------------                      003135
 003136                                                                                                                      003136
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     85
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003138   //-------------------------------------------------------------------------------------------                      003138
 003139   // Convert COMMIT.                                                                                                 003139
 003140   //-------------------------------------------------------------------------------------------                      003140
 003141   BegSr subUserCvt_COMMIT;                                                                                           003141
 003142                                                                                                                      003142
 003143      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            003143
 003144                                                                                                                      003144
 003145      sourceLine = %trim(sourceLine)  + ';';                                                                          003145
 003146                                                                                                                      003146
 003147      // Check indicators?                                                                                            003147
 003148      If lw <> *Blanks;                                                                          B01                  003148
 003149         ERRCheck = *On;                                                                          01                  003149
 003150         ERRInd = lw;                                                                             01                  003150
 003151      EndIf;                                                                                     E01                  003151
 003152                                                                                                                      003152
 003153      convert = *On;                                                                                                  003153
 003154                                                                                                                      003154
 003155   EndSr;                                                                                                             003155
 003156   //-------------------------------------------------------------------------------------------                      003156
 003157                                                                                                                      003157
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     86
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003159   //-------------------------------------------------------------------------------------------                      003159
 003160   // Convert COMP.                                                                                                   003160
 003161   //-------------------------------------------------------------------------------------------                      003161
 003162   BegSr subUserCvt_COMP;                                                                                             003162
 003163                                                                                                                      003163
 003164      // Set resulting indicators to check.                                                                           003164
 003165      If hi <> *Blanks;                                                                          B01                  003165
 003166         HICheck = *On;                                                                           01                  003166
 003167         HIInd = hi;                                                                              01                  003167
 003168         HIFactor1 = factor1;                                                                     01                  003168
 003169         HIFactor2 = factor2;                                                                     01                  003169
 003170      EndIf;                                                                                     E01                  003170
 003171                                                                                                                      003171
 003172      If lw <> *Blanks;                                                                          B01                  003172
 003173         LWCheck = *On;                                                                           01                  003173
 003174         LWInd = lw;                                                                              01                  003174
 003175         LWFactor1 = factor1;                                                                     01                  003175
 003176         LWFactor2 = factor2;                                                                     01                  003176
 003177      EndIf;                                                                                     E01                  003177
 003178                                                                                                                      003178
 003179      If eq <> *Blanks;                                                                          B01                  003179
 003180         EQCheck = *On;                                                                           01                  003180
 003181         EQInd = eq;                                                                              01                  003181
 003182         EQFactor1 = factor1;                                                                     01                  003182
 003183         EQFactor2 = factor2;                                                                     01                  003183
 003184      EndIf;                                                                                     E01                  003184
 003185                                                                                                                      003185
 003186      // Drop the current line.                                                                                       003186
 003187      dropLine = *On;                                                                                                 003187
 003188      convert = *On;                                                                                                  003188
 003189                                                                                                                      003189
 003190   EndSr;                                                                                                             003190
 003191   //-------------------------------------------------------------------------------------------                      003191
 003192                                                                                                                      003192
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     87
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003194   //-------------------------------------------------------------------------------------------                      003194
 003195   // Convert DEALLOC.                                                                                                003195
 003196   //-------------------------------------------------------------------------------------------                      003196
 003197   BegSr subUserCvt_DEALLOC;                                                                                          003197
 003198                                                                                                                      003198
 003199      sourceLine = %trim(operator) + ' ' + %trim(result);                                                             003199
 003200                                                                                                                      003200
 003201      sourceLine = %trim(sourceLine)  + ';';                                                                          003201
 003202                                                                                                                      003202
 003203      // Set resulting indicators?                                                                                    003203
 003204      If lw <> *Blanks;                                                                          B01                  003204
 003205         ERRCheck = *On;                                                                          01                  003205
 003206         ERRInd = lw;                                                                             01                  003206
 003207      EndIf;                                                                                     E01                  003207
 003208                                                                                                                      003208
 003209      convert = *On;                                                                                                  003209
 003210                                                                                                                      003210
 003211   EndSr;                                                                                                             003211
 003212   //-------------------------------------------------------------------------------------------                      003212
 003213                                                                                                                      003213
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     88
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003215   //-------------------------------------------------------------------------------------------                      003215
 003216   // Convert DELETE.                                                                                                 003216
 003217   //-------------------------------------------------------------------------------------------                      003217
 003218   BegSr subUserCvt_DELETE;                                                                                           003218
 003219                                                                                                                      003219
 003220      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003220
 003221                                                                                                                      003221
 003222      sourceLine = %trim(sourceLine)  + ';';                                                                          003222
 003223                                                                                                                      003223
 003224      // Check indicators?                                                                                            003224
 003225      If hi <> *Blanks;                                                                          B01                  003225
 003226         NRFCheck = *On;                                                                          01                  003226
 003227         NRFInd = eq;                                                                             01                  003227
 003228         NRFFile = %trim(factor2);                                                                01                  003228
 003229      EndIf;                                                                                     E01                  003229
 003230      If lw <> *Blanks;                                                                          B01                  003230
 003231         ERRCheck = *On;                                                                          01                  003231
 003232         ERRInd = lw;                                                                             01                  003232
 003233      EndIf;                                                                                     E01                  003233
 003234                                                                                                                      003234
 003235      convert = *On;                                                                                                  003235
 003236                                                                                                                      003236
 003237   EndSr;                                                                                                             003237
 003238   //-------------------------------------------------------------------------------------------                      003238
 003239                                                                                                                      003239
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     89
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003241   //-------------------------------------------------------------------------------------------                      003241
 003242   // Convert DIV.                                                                                                    003242
 003243   //-------------------------------------------------------------------------------------------                      003243
 003244   BegSr subUserCvt_DIV;                                                                                              003244
 003245                                                                                                                      003245
 003246      // Half-adjust?                                                                                                 003246
 003247      If %scan('H':operator:4) > 0;                                                              B01                  003247
 003248         sourceLine = 'Eval(H) ';                                                                 01                  003248
 003249      Else;                                                                                      X01                  003249
 003250         sourceLine = *Blanks;                                                                    01                  003250
 003251      EndIf;                                                                                     E01                  003251
 003252                                                                                                                      003252
 003253      If factor1 = *Blanks;                                                                      B01                  003253
 003254         divFactor1 = result;                                                                     01                  003254
 003255         divFactor2 = factor2;                                                                    01                  003255
 003256      Else;                                                                                      X01                  003256
 003257         divFactor1 = factor1;                                                                    01                  003257
 003258         divFactor2 = factor2;                                                                    01                  003258
 003259      EndIf;                                                                                     E01                  003259
 003260                                                                                                                      003260
 003261      sourceLine = %trim( %trimr(sourceLine) + ' ' + %trim(result)                                                    003261
 003262                 + ' = ' + %trim(divFactor1) + ' / '                                                                  003262
 003263                 + %trim(divFactor2) + ';');                                                                          003263
 003264                                                                                                                      003264
 003265      convert = *On;                                                                                                  003265
 003266                                                                                                                      003266
 003267   EndSr;                                                                                                             003267
 003268   //-------------------------------------------------------------------------------------------                      003268
 003269                                                                                                                      003269
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     90
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003271   //-------------------------------------------------------------------------------------------                      003271
 003272   // Convert DO.                                                                                                     003272
 003273   //-------------------------------------------------------------------------------------------                      003273
 003274   BegSr subUserCvt_DO;                                                                                               003274
 003275                                                                                                                      003275
 003276      If inDo;                                                                                   B01                  003276
 003277         operator = doOperator;                                                                   01                  003277
 003278      EndIf;                                                                                     E01                  003278
 003279                                                                                                                      003279
 003280      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003280
 003281                                                                                                                      003281
 003282      If operator = 'DOW'     // Use Extended Factor2.                                           B01                  003282
 003283      or operator = 'DOU';    // Use Extended Factor2.                                           B01                  003283
 003284         If not inDo;         // First line of DO.                                               B02                  003284
 003285            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003285
 003286            If not inSpan;                                                                       B03                  003286
 003287               sourceLine = %trim(sourceLine) + ';';                                              03                  003287
 003288            Else;                                                                                X03                  003288
 003289               inDo = *On;                                                                        03                  003289
 003290               inSpan = *Off;                                                                     03                  003290
 003291            EndIf;                                                                               E03                  003291
 003292         Else;                   // Second line of DO.                                           X02                  003292
 003293            sourceLine = *Blanks;                                                                 02                  003293
 003294            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003294
 003295            sourceLine = %trim(extFactor2);                                                       02                  003295
 003296            If not inSpan;                                                                       B03                  003296
 003297               sourceLine = %trimr(sourceLine) + ';';                                             03                  003297
 003298               //               inDo = *Off;                                                                          003298
 003299            EndIf;                                                                               E03                  003299
 003300            inSpan = *Off;                                                                        02                  003300
 003301         EndIf;                                                                                  E02                  003301
 003302         doCompare = '!!';    // Just a regular DO.                                               01                  003302
 003303      Else;                                                                                      X01                  003303
 003304         // Fixed format.                                                                                             003304
 003305         opCode = %xlate(lo:up:opCode);                                                           01                  003305
 003306         If not inDo;         // First line of DO.                                               B02                  003306
 003307            doCompare = %subst(opCode:4:2);                                                       02                  003307
 003308            sourceLine = %subst(opcode:1:3);                                                      02                  003308
 003309         Else;                // Second line of DO.                                              X02                  003309
 003310            If %subst(opCode:1:3) = 'AND';                                                       B03                  003310
 003311               doCompare = %subst(opCode:4:2);                                                    03                  003311
 003312               sourceLine = 'And';                                                                03                  003312
 003313            Else;                                                                                X03                  003313
 003314               doCompare = %subst(opCode:3:2);                                                    03                  003314
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     91
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003315               sourceLine = 'Or';                                                                 03                  003315
 003316            EndIf;                                                                               E03                  003316
 003317         EndIf;                                                                                  E02                  003317
 003318                                                                                                                      003318
 003319         If doCompare = 'EQ';                                                                    B02                  003319
 003320            doCompare = '=';                                                                      02                  003320
 003321         ElseIf doCompare = 'GT';                                                                X02                  003321
 003322            doCompare = '>';                                                                      02                  003322
 003323         ElseIf doCompare = 'GE';                                                                X02                  003323
 003324            doCompare = '>=';                                                                     02                  003324
 003325         ElseIf doCompare = 'LT';                                                                X02                  003325
 003326            doCompare = '<';                                                                      02                  003326
 003327         ElseIf doCompare = 'LE';                                                                X02                  003327
 003328            doCompare = '<=';                                                                     02                  003328
 003329         ElseIf doCompare = 'NE';                                                                X02                  003329
 003330            doCompare = '<>';                                                                     02                  003330
 003331         ElseIf doCompare = '!!';                                                                X02                  003331
 003332            // Do nothing.                                                                                            003332
 003333            Else;    // Just DO - convert to FOR.                                                X02                  003333
 003334            If factor1 = *Blanks;                                                                B03                  003334
 003335               forFactor1 = '1';                                                                  03                  003335
 003336            Else;                                                                                X03                  003336
 003337               forFactor1 = factor1;                                                              03                  003337
 003338            EndIf;                                                                               E03                  003338
 003339            forFactor2 = factor2;                                                                 02                  003339
 003340            factor1 = *Blanks;                                                                    02                  003340
 003341            factor2 = *Blanks;                                                                    02                  003341
 003342            doCompare = *Blanks;                                                                  02                  003342
 003343            If result = *Blanks;                                                                 B03                  003343
 003344               result = '???';                                                                    03                  003344
 003345            EndIf;                                                                               E03                  003345
 003346            sourceLine = 'For ' + %trim(result) + ' = '                                           02                  003346
 003347                       + %trim(forFactor1) + ' To '                                               02                  003347
 003348                       + %trim(forFactor2);                                                       02                  003348
 003349         EndIf;                                                                                  E02                  003349
 003350                                                                                                                      003350
 003351         //         If doCompare = *Blanks;                                                                           003351
 003352     //            // Save current indentation level to match up to the associated ENDDO later.                       003352
 003353         //            forCount += 1;                                                                                 003353
 003354         //            forLevel(forCount) = indentCount;                                                              003354
 003355         //         Else;                                                                                             003355
 003356     //            // Save current indentation level to match up to the associated ENDDO later.                       003356
 003357         //            doCount += 1;                                                                                  003357
 003358         //            doLevel(doCount) = indentCount;                                                                003358
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     92
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003359         //         EndIf;                                                                                            003359
 003360                                                                                                                      003360
 003361         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003361
 003362                            + ' ' + %trim(doCompare) + ' '                                        01                  003362
 003363                            + %trim(factor2);                                                     01                  003363
 003364         If not inSpan;                                                                          B02                  003364
 003365            sourceLine = %trimr(sourceLine) + ';';                                                02                  003365
 003366            inDo = *Off;                                                                          02                  003366
 003367         Else;                                                                                   X02                  003367
 003368            inDo = *On;                                                                           02                  003368
 003369            inSpan = *Off;                                                                        02                  003369
 003370         EndIf;                                                                                  E02                  003370
 003371      EndIf;                                                                                     E01                  003371
 003372                                                                                                                      003372
 003373      // If multi-line, retain the original opcode.                                                                   003373
 003374      If inDo;                                                                                   B01                  003374
 003375         doOperator = operator;                                                                   01                  003375
 003376      Else;                                                                                      X01                  003376
 003377         doOperator = *Blanks;                                                                    01                  003377
 003378      EndIf;                                                                                     E01                  003378
 003379                                                                                                                      003379
 003380      convert = *On;                                                                                                  003380
 003381                                                                                                                      003381
 003382   EndSr;                                                                                                             003382
 003383   //-------------------------------------------------------------------------------------------                      003383
 003384                                                                                                                      003384
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     93
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003386   //-------------------------------------------------------------------------------------------                      003386
 003387   // Convert DSPLY.                                                                                                  003387
 003388   //-------------------------------------------------------------------------------------------                      003388
 003389   BegSr subUserCvt_DSPLY;                                                                                            003389
 003390                                                                                                                      003390
 003391      sourceLine = %trim(operator);                                                                                   003391
 003392                                                                                                                      003392
 003393      If factor1 <> *Blanks;                                                                     B01                  003393
 003394         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  003394
 003395         If factor2 <> *Blanks;                                                                  B02                  003395
 003396            sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                               02                  003396
 003397         ElseIf result <> *Blanks;                                                               X02                  003397
 003398            sourceLine = %trimr(sourceLine) + ' ''''';                                            02                  003398
 003399         EndIf;                                                                                  E02                  003399
 003400         If result <> *Blanks;                                                                   B02                  003400
 003401            sourceLine = %trimr(sourceLine) + ' ' + %trim(result);                                02                  003401
 003402         EndIf;                                                                                  E02                  003402
 003403      EndIf;                                                                                     E01                  003403
 003404                                                                                                                      003404
 003405      sourceLine = %trimr(sourceLine) + ';';                                                                          003405
 003406                                                                                                                      003406
 003407      // Set resulting indicators?                                                                                    003407
 003408      If lw <> *Blanks;                                                                          B01                  003408
 003409         ERRCheck = *On;                                                                          01                  003409
 003410         ERRInd = lw;                                                                             01                  003410
 003411      EndIf;                                                                                     E01                  003411
 003412                                                                                                                      003412
 003413      convert = *On;                                                                                                  003413
 003414                                                                                                                      003414
 003415   EndSr;                                                                                                             003415
 003416   //-------------------------------------------------------------------------------------------                      003416
 003417                                                                                                                      003417
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     94
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003419   //-------------------------------------------------------------------------------------------                      003419
 003420   // Convert DUMP.                                                                                                   003420
 003421   //-------------------------------------------------------------------------------------------                      003421
 003422   BegSr subUserCvt_DUMP;                                                                                             003422
 003423                                                                                                                      003423
 003424      If factor1 <> *Blanks;                                                                     B01                  003424
 003425         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ';';                               01                  003425
 003426      Else;                                                                                      X01                  003426
 003427         sourceLine = %trim(operator) + ';';                                                      01                  003427
 003428      EndIf;                                                                                     E01                  003428
 003429                                                                                                                      003429
 003430      convert = *On;                                                                                                  003430
 003431                                                                                                                      003431
 003432   EndSr;                                                                                                             003432
 003433   //-------------------------------------------------------------------------------------------                      003433
 003434                                                                                                                      003434
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     95
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003436   //-------------------------------------------------------------------------------------------                      003436
 003437   // Convert ELSE.                                                                                                   003437
 003438   //-------------------------------------------------------------------------------------------                      003438
 003439   BegSr subUserCvt_ELSE;                                                                                             003439
 003440                                                                                                                      003440
 003441      sourceLine = 'Else;';                                                                                           003441
 003442                                                                                                                      003442
 003443      convert = *On;                                                                                                  003443
 003444                                                                                                                      003444
 003445   EndSr;                                                                                                             003445
 003446   //-------------------------------------------------------------------------------------------                      003446
 003447                                                                                                                      003447
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     96
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003449   //-------------------------------------------------------------------------------------------                      003449
 003450   // Convert ELSEIF.                                                                                                 003450
 003451   //-------------------------------------------------------------------------------------------                      003451
 003452   BegSr subUserCvt_ELSEIF;                                                                                           003452
 003453                                                                                                                      003453
 003454      sourceLine = 'ElseIf ' + %trim(factor2) + ';';                                                                  003454
 003455                                                                                                                      003455
 003456      convert = *On;                                                                                                  003456
 003457                                                                                                                      003457
 003458   EndSr;                                                                                                             003458
 003459   //-------------------------------------------------------------------------------------------                      003459
 003460                                                                                                                      003460
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     97
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003462   //-------------------------------------------------------------------------------------------                      003462
 003463   // Convert ENDxx.                                                                                                  003463
 003464   //-------------------------------------------------------------------------------------------                      003464
 003465   BegSr subUserCvt_ENDxx;                                                                                            003465
 003466                                                                                                                      003466
 003467      // Catch labels on ENDSR.                                                                                       003467
 003468      If %trim(operator) = 'ENDSR';                                                              B01                  003468
 003469         If %len(%trim(factor1)) > 0;                                                            B02                  003469
 003470            nonConvRsn = 'Label on ENDSR is not supported in free-form';                          02                  003470
 003471            LeaveSr;                                                                              02                  003471
 003472         EndIf;                                                                                  E02                  003472
 003473      EndIf;                                                                                     E01                  003473
 003474                                                                                                                      003474
 003475      // Do we need to convert an ENDDO to ENDFOR?                                                                    003475
 003476      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003476
 003477         If forCount > 0;                                                                        B02                  003477
 003478            If forLevel(forCount) = indentCount - 1;                                             B03                  003478
 003479               operator = 'ENDFOR' + ' ' + %trim(factor2);                                        03                  003479
 003480               If factor2 <> *Blanks;                                                            B04                  003480
 003481                  savedSRCDTA = SRCDTA;                                                           04                  003481
 003482                  codeLine = '* CHECK: This is a converted ENDDO -'                               04                  003482
 003483                           + ' Please add ''BY'' to the corresponding'                            04                  003483
 003484                           + ' FOR';                                                              04                  003484
 003485                  Exsr subUserWriteLine;                                                          04                  003485
 003486                  SRCDTA = savedSRCDTA;                                                           04                  003486
 003487               EndIf;                                                                            E04                  003487
 003488            EndIf;                                                                               E03                  003488
 003489         EndIf;                                                                                  E02                  003489
 003490      EndIf;                                                                                     E01                  003490
 003491                                                                                                                      003491
 003492      // Convert END to ENDDO?                                                                                        003492
 003493      If %trim(operator) = 'ENDDO' or %trim(operator) = 'END';                                   B01                  003493
 003494         If doCount > 0;                                                                         B02                  003494
 003495            If doLevel(doCount) = indentCount - 1;                                               B03                  003495
 003496               operator = 'ENDDO';                                                                03                  003496
 003497            EndIf;                                                                               E03                  003497
 003498         EndIf;                                                                                  E02                  003498
 003499      EndIf;                                                                                     E01                  003499
 003500                                                                                                                      003500
 003501      // Convert END to ENDSL?                                                                                        003501
 003502      If %trim(operator) = 'ENDSL' or %trim(operator) = 'END';                                   B01                  003502
 003503         If slCount > 0;                                                                         B02                  003503
 003504            If slLevel(slCount) = indentCount - 2;                                               B03                  003504
 003505               operator = 'ENDSL';                                                                03                  003505
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     98
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003506            EndIf;                                                                               E03                  003506
 003507         EndIf;                                                                                  E02                  003507
 003508      EndIf;                                                                                     E01                  003508
 003509                                                                                                                      003509
 003510      If %trim(operator) = 'END';                                                                B01                  003510
 003511         If inCase;                                                                              B02                  003511
 003512            operator = 'ENDCS';                                                                   02                  003512
 003513         Else;                                                                                   X02                  003513
 003514            operator = 'ENDIF';                                                                   02                  003514
 003515         EndIf;                                                                                  E02                  003515
 003516      EndIf;                                                                                     E01                  003516
 003517                                                                                                                      003517
 003518      sourceLine = %trim(operator) + ';';                                                                             003518
 003519                                                                                                                      003519
 003520      convert = *On;                                                                                                  003520
 003521                                                                                                                      003521
 003522      If operator = 'ENDCS';                                                                     B01                  003522
 003523         inCase = *Off;                                                                           01                  003523
 003524      EndIf;                                                                                     E01                  003524
 003525                                                                                                                      003525
 003526   EndSr;                                                                                                             003526
 003527   //-------------------------------------------------------------------------------------------                      003527
 003528                                                                                                                      003528
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page     99
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003530   //-------------------------------------------------------------------------------------------                      003530
 003531   // Convert EVALx.                                                                                                  003531
 003532   //-------------------------------------------------------------------------------------------                      003532
 003533   BegSr subUserCvt_EVALx;                                                                                            003533
 003534                                                                                                                      003534
 003535      // Returning for a multi-line EVAL - restore the original opcode.                                               003535
 003536      If inEval;                                                                                 B01                  003536
 003537         operator = evalOperator;                                                                 01                  003537
 003538      EndIf;                                                                                     E01                  003538
 003539                                                                                                                      003539
 003540      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003540
 003541                                                                                                                      003541
 003542      If not inEval;          // First line of EVAL.                                             B01                  003542
 003543         inEval = *On;                                                                            01                  003543
 003544         If %scan('H':operator:5) > 0  // Half-adjust.                                           B02                  003544
 003545         or %scan('R':operator:1) > 0; // EVALR.                                                 B02                  003545
 003546            sourceLine = %trimr(operator) + ' ' + %trim(extFactor2);                              02                  003546
 003547         Else;                                                                                   X02                  003547
 003548            sourceLine = %trim(extFactor2);                                                       02                  003548
 003549         EndIf;                                                                                  E02                  003549
 003550         If not inSpan;                                                                          B02                  003550
 003551            sourceLine = %trim(sourceLine) + ';';                                                 02                  003551
 003552         Else;                                                                                   X02                  003552
 003553            inSpan = *Off;                                                                        02                  003553
 003554         EndIf;                                                                                  E02                  003554
 003555      Else;                   // Second+ line of EVAL.                                           X01                  003555
 003556         sourceLine = *Blanks;                                                                    01                  003556
 003557         %subst(sourceLine:%len(%trim(operator)) + 2)                                             01                  003557
 003558               = %trim(extFactor2);                                                               01                  003558
 003559         If not inSpan;                                                                          B02                  003559
 003560            sourceLine = %trimr(sourceLine) + ';';                                                02                  003560
 003561         EndIf;                                                                                  E02                  003561
 003562         inSpan = *Off;                                                                           01                  003562
 003563      EndIf;                                                                                     E01                  003563
 003564                                                                                                                      003564
 003565      // Multi-line EVAL?  Save the opcode.                                                                           003565
 003566      If inEval;                                                                                 B01                  003566
 003567         evalOperator = operator;                                                                 01                  003567
 003568      Else;                                                                                      X01                  003568
 003569         evalOperator = *Blanks;                                                                  01                  003569
 003570      EndIf;                                                                                     E01                  003570
 003571                                                                                                                      003571
 003572      convert = *On;                                                                                                  003572
 003573                                                                                                                      003573
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    100
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003574   EndSr;                                                                                                             003574
 003575   //-------------------------------------------------------------------------------------------                      003575
 003576                                                                                                                      003576
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    101
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003578   //-------------------------------------------------------------------------------------------                      003578
 003579   // Convert EXCEPT.                                                                                                 003579
 003580   //-------------------------------------------------------------------------------------------                      003580
 003581   BegSr subUserCvt_EXCEPT;                                                                                           003581
 003582                                                                                                                      003582
 003583      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      003583
 003584                                                                                                                      003584
 003585      convert = *On;                                                                                                  003585
 003586                                                                                                                      003586
 003587   EndSr;                                                                                                             003587
 003588   //-------------------------------------------------------------------------------------------                      003588
 003589                                                                                                                      003589
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    102
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003591   //-------------------------------------------------------------------------------------------                      003591
 003592   // Convert Embedded SQL.                                                                                           003592
 003593   //-------------------------------------------------------------------------------------------                      003593
 003594   BegSr subUserCvt_EXEC_SQL;                                                                                         003594
 003595                                                                                                                      003595
 003596      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003596
 003597                                                                                                                      003597
 003598      If workDirective = '/EXEC SQL';                                                            B01                  003598
 003599         sourceLine = 'Exec SQL';                                                                 01                  003599
 003600         inSQL = *On;                                                                             01                  003600
 003601         inSpan = *Off;                                                                           01                  003601
 003602      Else;                                                                                      X01                  003602
 003603         sourceLine = %trimr(%subst(codeLine:2));                                                 01                  003603
 003604         If not inSpan;                                                                          B02                  003604
 003605            sourceLine = %trim(sourceLine) + ';';                                                 02                  003605
 003606         Else;                                                                                   X02                  003606
 003607            inSQL = *On;                                                                          02                  003607
 003608            inSpan = *Off;                                                                        02                  003608
 003609         EndIf;                                                                                  E02                  003609
 003610      EndIf;                                                                                     E01                  003610
 003611                                                                                                                      003611
 003612      convert = *On;                                                                                                  003612
 003613                                                                                                                      003613
 003614   EndSr;                                                                                                             003614
 003615   //-------------------------------------------------------------------------------------------                      003615
 003616                                                                                                                      003616
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    103
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003618   //-------------------------------------------------------------------------------------------                      003618
 003619   // Convert EXFMT.                                                                                                  003619
 003620   //-------------------------------------------------------------------------------------------                      003620
 003621   BegSr subUserCvt_EXFMT;                                                                                            003621
 003622                                                                                                                      003622
 003623      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            003623
 003624                                                                                                                      003624
 003625      // Append datastructure?                                                                                        003625
 003626      If result <> *Blanks;                                                                      B01                  003626
 003627         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  003627
 003628      Else;                                                                                      X01                  003628
 003629         sourceLine = %trim(sourceLine)  + ';';                                                   01                  003629
 003630      EndIf;                                                                                     E01                  003630
 003631                                                                                                                      003631
 003632      // Check indicators?                                                                                            003632
 003633      If lw <> *Blanks;                                                                          B01                  003633
 003634         ERRCheck = *On;                                                                          01                  003634
 003635         ERRInd = lw;                                                                             01                  003635
 003636      EndIf;                                                                                     E01                  003636
 003637                                                                                                                      003637
 003638      convert = *On;                                                                                                  003638
 003639                                                                                                                      003639
 003640   EndSr;                                                                                                             003640
 003641   //-------------------------------------------------------------------------------------------                      003641
 003642                                                                                                                      003642
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    104
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003644   //-------------------------------------------------------------------------------------------                      003644
 003645   // Convert EXSR.                                                                                                   003645
 003646   //-------------------------------------------------------------------------------------------                      003646
 003647   BegSr subUserCvt_EXSR;                                                                                             003647
 003648                                                                                                                      003648
 003649      sourceLine = 'ExSr ' + %trim(factor2) + ';';                                                                    003649
 003650                                                                                                                      003650
 003651      convert = *On;                                                                                                  003651
 003652                                                                                                                      003652
 003653   EndSr;                                                                                                             003653
 003654   //-------------------------------------------------------------------------------------------                      003654
 003655                                                                                                                      003655
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    105
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003657   //-------------------------------------------------------------------------------------------                      003657
 003658   // Convert EXTRCT                                                                                                  003658
 003659   //-------------------------------------------------------------------------------------------                      003659
 003660   BegSr subUserCvt_EXTRCT;                                                                                           003660
 003661                                                                                                                      003661
 003662      // Split out duration and code.                                                                                 003662
 003663      x = %scan(':':factor2);                                                                                         003663
 003664      If x = 0;                                                                                  B01                  003664
 003665         nonConvRsn =  'No duration code specified.';                                             01                  003665
 003666         LeaveSr;                                                                                 01                  003666
 003667      EndIf;                                                                                     E01                  003667
 003668                                                                                                                      003668
 003669      durDuration = %trim(%subst(factor2:1:x-1));                                                                     003669
 003670      durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                                         003670
 003671                                                                                                                      003671
 003672      Select;                                                                                    B01                  003672
 003673         When durCode = '*Y' or durCode = '*YEARS';                                              X01                  003673
 003674            durCode = '%years';                                                                   01                  003674
 003675         When durCode = '*M' or durCode = '*MONTHS';                                             X01                  003675
 003676            durCode = '%months';                                                                  01                  003676
 003677         When durCode = '*D' or durCode = '*DAYS';                                               X01                  003677
 003678            durCode = '%days';                                                                    01                  003678
 003679         When durCode = '*H' or durCode = '*HOURS';                                              X01                  003679
 003680            durCode = '%hours';                                                                   01                  003680
 003681         When durCode = '*MN' or durCode = '*MINUTES';                                           X01                  003681
 003682            durCode = '%minutes';                                                                 01                  003682
 003683         When durCode = '*S' or durCode = '*SECONDS';                                            X01                  003683
 003684            durCode = '%seconds';                                                                 01                  003684
 003685         When durCode = '*MS' or durCode = '*MSECONDS';                                          X01                  003685
 003686            durCode = '%mseconds';                                                                01                  003686
 003687         Other;                                                                                  X01                  003687
 003688            nonConvRsn = 'Invalid duration code specified.';                                      01                  003688
 003689            LeaveSr;                                                                              01                  003689
 003690      EndSl;                                                                                     E01                  003690
 003691                                                                                                                      003691
 003692      sourceLine = %trim(result) + ' = %subdt(' + %trim(durDuration)                                                  003692
 003693                 + ':' + %trim(durCode) + ');';                                                                       003693
 003694                                                                                                                      003694
 003695      // Check indicators?                                                                                            003695
 003696      If lw <> *Blanks;                                                                          B01                  003696
 003697         ERRCheck = *On;                                                                          01                  003697
 003698         ERRInd = lw;                                                                             01                  003698
 003699      EndIf;                                                                                     E01                  003699
 003700                                                                                                                      003700
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    106
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003701      convert = *On;                                                                                                  003701
 003702                                                                                                                      003702
 003703   EndSr;                                                                                                             003703
 003704   //-------------------------------------------------------------------------------------------                      003704
 003705                                                                                                                      003705
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    107
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003707   //-------------------------------------------------------------------------------------------                      003707
 003708   // Convert FEOD.                                                                                                   003708
 003709   //-------------------------------------------------------------------------------------------                      003709
 003710   BegSr subUserCvt_FEOD;                                                                                             003710
 003711                                                                                                                      003711
 003712      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003712
 003713                                                                                                                      003713
 003714      // Check indicators?                                                                                            003714
 003715      If lw <> *Blanks;                                                                          B01                  003715
 003716         ERRCheck = *On;                                                                          01                  003716
 003717         ERRInd = lw;                                                                             01                  003717
 003718      EndIf;                                                                                     E01                  003718
 003719                                                                                                                      003719
 003720      convert = *On;                                                                                                  003720
 003721                                                                                                                      003721
 003722   EndSr;                                                                                                             003722
 003723   //-------------------------------------------------------------------------------------------                      003723
 003724                                                                                                                      003724
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    108
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003726   //-------------------------------------------------------------------------------------------                      003726
 003727   // Convert FORCE.                                                                                                  003727
 003728   //-------------------------------------------------------------------------------------------                      003728
 003729   BegSr subUserCvt_FORCE;                                                                                            003729
 003730                                                                                                                      003730
 003731      sourceLine = %trim(operator) + %trim(extFactor2) + ';';                                                         003731
 003732                                                                                                                      003732
 003733      convert = *On;                                                                                                  003733
 003734                                                                                                                      003734
 003735   EndSr;                                                                                                             003735
 003736   //-------------------------------------------------------------------------------------------                      003736
 003737                                                                                                                      003737
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    109
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003739   //-------------------------------------------------------------------------------------------                      003739
 003740   // Convert FOR.                                                                                                    003740
 003741   //-------------------------------------------------------------------------------------------                      003741
 003742   BegSr subUserCvt_FOR;                                                                                              003742
 003743                                                                                                                      003743
 003744      sourceLine = 'For ' + %trim(extFactor2) + ';';                                                                  003744
 003745                                                                                                                      003745
 003746      convert = *On;                                                                                                  003746
 003747                                                                                                                      003747
 003748   EndSr;                                                                                                             003748
 003749   //-------------------------------------------------------------------------------------------                      003749
 003750                                                                                                                      003750
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    110
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003752   //-------------------------------------------------------------------------------------------                      003752
 003753   // Convert IF.                                                                                                     003753
 003754   //-------------------------------------------------------------------------------------------                      003754
 003755   BegSr subUserCvt_IF;                                                                                               003755
 003756                                                                                                                      003756
 003757      // Returning for a multi-line IF?  Reinstate original opcode.                                                   003757
 003758      If inIf;                                                                                   B01                  003758
 003759         operator = ifOperator;                                                                   01                  003759
 003760      EndIf;                                                                                     E01                  003760
 003761                                                                                                                      003761
 003762      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              003762
 003763                                                                                                                      003763
 003764      If operator = 'IF';     // Use Extended Factor2.                                           B01                  003764
 003765         If not inIf;            // First line of IF.                                            B02                  003765
 003766            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  003766
 003767            If not inSpan;                                                                       B03                  003767
 003768               sourceLine = %trim(sourceLine) + ';';                                              03                  003768
 003769            Else;                                                                                X03                  003769
 003770               inIf = *On;                                                                        03                  003770
 003771               inSpan = *Off;                                                                     03                  003771
 003772            EndIf;                                                                               E03                  003772
 003773         Else;                   // Second line of IF.                                           X02                  003773
 003774            //            sourceLine = *Blanks;                                                                       003774
 003775            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  003775
 003776            sourceLine = %trim(extFactor2);                                                       02                  003776
 003777            If not inSpan;                                                                       B03                  003777
 003778               sourceLine = %trimr(sourceLine) + ';';                                             03                  003778
 003779               //               inIf = *Off;                                                                          003779
 003780            EndIf;                                                                               E03                  003780
 003781            //            inSpan = *On;                                                                               003781
 003782            inSpan = *Off;                                                                        02                  003782
 003783         EndIf;                                                                                  E02                  003783
 003784      Else;                                                                                      X01                  003784
 003785         // Fixed format.                                                                                             003785
 003786         opCode = %xlate(lo:up:opCode);                                                           01                  003786
 003787         If not inIf;         // First line of IF.                                               B02                  003787
 003788            ifCompare = %subst(opCode:3:2);                                                       02                  003788
 003789            sourceLine = 'If';                                                                    02                  003789
 003790         Else;                // Second line of IF.                                              X02                  003790
 003791            If %subst(opCode:1:3) = 'AND';                                                       B03                  003791
 003792               ifCompare = %subst(opCode:4:2);                                                    03                  003792
 003793               sourceLine = 'And';                                                                03                  003793
 003794            Else;                                                                                X03                  003794
 003795               ifCompare = %subst(opCode:3:2);                                                    03                  003795
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    111
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003796               sourceLine = 'Or';                                                                 03                  003796
 003797            EndIf;                                                                               E03                  003797
 003798         EndIf;                                                                                  E02                  003798
 003799         If ifCompare = 'EQ';                                                                    B02                  003799
 003800            ifCompare = '=';                                                                      02                  003800
 003801         ElseIf ifCompare = 'GT';                                                                X02                  003801
 003802            ifCompare = '>';                                                                      02                  003802
 003803         ElseIf ifCompare = 'GE';                                                                X02                  003803
 003804            ifCompare = '>=';                                                                     02                  003804
 003805         ElseIf ifCompare = 'LT';                                                                X02                  003805
 003806            ifCompare = '<';                                                                      02                  003806
 003807         ElseIf ifCompare = 'LE';                                                                X02                  003807
 003808            ifCompare = '<=';                                                                     02                  003808
 003809         ElseIf ifCompare = 'NE';                                                                X02                  003809
 003810            ifCompare = '<>';                                                                     02                  003810
 003811         EndIf;                                                                                  E02                  003811
 003812         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  003812
 003813                            + ' ' + %trim(ifCompare) + ' '                                        01                  003813
 003814                            + %trim(factor2);                                                     01                  003814
 003815         If not inSpan;                                                                          B02                  003815
 003816            sourceLine = %trimr(sourceLine) + ';';                                                02                  003816
 003817            inIf = *Off;                                                                          02                  003817
 003818         Else;                                                                                   X02                  003818
 003819            inIf = *On;                                                                           02                  003819
 003820            inSpan = *Off;                                                                        02                  003820
 003821         EndIf;                                                                                  E02                  003821
 003822      EndIf;                                                                                     E01                  003822
 003823                                                                                                                      003823
 003824      // Multi-line IF?  Retain original opcode.                                                                      003824
 003825      If inIf;                                                                                   B01                  003825
 003826         ifOperator = operator;                                                                   01                  003826
 003827      Else;                                                                                      X01                  003827
 003828         ifOperator = *Blanks;                                                                    01                  003828
 003829      EndIf;                                                                                     E01                  003829
 003830                                                                                                                      003830
 003831      convert = *On;                                                                                                  003831
 003832                                                                                                                      003832
 003833   EndSr;                                                                                                             003833
 003834   //-------------------------------------------------------------------------------------------                      003834
 003835                                                                                                                      003835
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    112
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003837   //-------------------------------------------------------------------------------------------                      003837
 003838   // Convert IN.                                                                                                     003838
 003839   //-------------------------------------------------------------------------------------------                      003839
 003840   BegSr subUserCvt_IN;                                                                                               003840
 003841                                                                                                                      003841
 003842      If factor1 <> *Blanks;                                                                     B01                  003842
 003843         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  003843
 003844                    + %trim(factor2) + ';';                                                       01                  003844
 003845      Else;                                                                                      X01                  003845
 003846         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  003846
 003847      EndIf;                                                                                     E01                  003847
 003848                                                                                                                      003848
 003849      // Set resulting indicators?                                                                                    003849
 003850      If lw <> *Blanks;                                                                          B01                  003850
 003851         ERRCheck = *On;                                                                          01                  003851
 003852         ERRInd = lw;                                                                             01                  003852
 003853      EndIf;                                                                                     E01                  003853
 003854                                                                                                                      003854
 003855      convert = *On;                                                                                                  003855
 003856                                                                                                                      003856
 003857   EndSr;                                                                                                             003857
 003858   //-------------------------------------------------------------------------------------------                      003858
 003859                                                                                                                      003859
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    113
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003861   //-------------------------------------------------------------------------------------------                      003861
 003862   // Convert ITER.                                                                                                   003862
 003863   //-------------------------------------------------------------------------------------------                      003863
 003864   BegSr subUserCvt_ITER;                                                                                             003864
 003865                                                                                                                      003865
 003866      sourceLine = %trim(operator) + ';';                                                                             003866
 003867                                                                                                                      003867
 003868      convert = *On;                                                                                                  003868
 003869                                                                                                                      003869
 003870   EndSr;                                                                                                             003870
 003871   //-------------------------------------------------------------------------------------------                      003871
 003872                                                                                                                      003872
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    114
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003874   //-------------------------------------------------------------------------------------------                      003874
 003875   // Convert LEAVExx.                                                                                                003875
 003876   //-------------------------------------------------------------------------------------------                      003876
 003877   BegSr subUserCvt_LEAVE;                                                                                            003877
 003878                                                                                                                      003878
 003879      sourceLine = %trim(operator) + ';';                                                                             003879
 003880                                                                                                                      003880
 003881      convert = *On;                                                                                                  003881
 003882                                                                                                                      003882
 003883   EndSr;                                                                                                             003883
 003884   //-------------------------------------------------------------------------------------------                      003884
 003885                                                                                                                      003885
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    115
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003887   //-------------------------------------------------------------------------------------------                      003887
 003888   // Convert LOOKUP.                                                                                                 003888
 003889   //-------------------------------------------------------------------------------------------                      003889
 003890   BegSr subUserCvt_LOOKUP;                                                                                           003890
 003891                                                                                                                      003891
 003892      //            If %subst(factor2:1:3) = 'TAB';  // Table lookup.                                                 003892
 003893      //            Else;                            // Array lookup.                                                 003893
 003894      //               // Extract element variable.                                                                   003894
 003895      //               x = %scan('(':factor2);                                                                        003895
 003896      //               If x = 0;   // No variable specified, so use a substitute.                                     003896
 003897      //                  lookupVar = 'lookupIndex';                                                                  003897
 003898      //               Else;                                                                                          003898
 003899      //                  lookupVar = %subst(factor2:x+1:%scan(')':factor2:x)-x-1);                                   003899
 003900      //               EndIf;                                                                                         003900
 003901      //               If eq <> *Blanks and lw <> *Blanks;                                                            003901
 003902      //                  sourceLine = '%lookupLE(';                                                                  003902
 003903      //               ElseIf eq <> *Blanks and hi <> *Blanks;                                                        003903
 003904      //                  sourceLine = '%lookupGE(';                                                                  003904
 003905      //               ElseIf lw <> *Blanks;                                                                          003905
 003906      //                  sourceLine = '%lookupLT(';                                                                  003906
 003907      //               ElseIf hi <> *Blanks;                                                                          003907
 003908      //                  sourceLine = '%lookupGT(';                                                                  003908
 003909      //               Else;                                                                                          003909
 003910      //                  sourceLine = '%lookup(';                                                                    003910
 003911      //               EndIf;                                                                                         003911
 003912      //               sourceLine = %trim(sourceLine) + %trim(factor1) + ':'                                          003912
 003913      //                          + %trim(factor2) + ');';                                                            003913
 003914      //            EndIf;                                                                                            003914
 003915      //            convert = *On;                                                                                    003915
 003916                                                                                                                      003916
 003917   EndSr;                                                                                                             003917
 003918   //-------------------------------------------------------------------------------------------                      003918
 003919                                                                                                                      003919
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    116
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003921   //-------------------------------------------------------------------------------------------                      003921
 003922   // Convert MONITOR.                                                                                                003922
 003923   //-------------------------------------------------------------------------------------------                      003923
 003924   BegSr subUserCvt_MONITOR;                                                                                          003924
 003925                                                                                                                      003925
 003926      sourceLine = 'Monitor;';                                                                                        003926
 003927                                                                                                                      003927
 003928      convert = *On;                                                                                                  003928
 003929                                                                                                                      003929
 003930   EndSr;                                                                                                             003930
 003931   //-------------------------------------------------------------------------------------------                      003931
 003932                                                                                                                      003932
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    117
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003934   //-------------------------------------------------------------------------------------------                      003934
 003935   // Convert MOVE.                                                                                                   003935
 003936   //-------------------------------------------------------------------------------------------                      003936
 003937   BegSr subUserCvt_MOVE;                                                                                             003937
 003938                                                                                                                      003938
 003939      // Pad the result?                                                                                              003939
 003940      x = %scan('P':operator:5);                                                                                      003940
 003941                                                                                                                      003941
 003942      If x > 0 and %subst(operator:5:1) <> 'L';                                                  B01                  003942
 003943         // Move right and pad left.                                                                                  003943
 003944         sourceLine = 'EvalR ' + %trim(result) + ' = ' + %trim(factor2)                           01                  003944
 003945                    + ';';                                                                        01                  003945
 003946                                                                                                                      003946
 003947      ElseIf x > 0 and %subst(operator:5:1) = 'L';                                               X01                  003947
 003948         // Move left and pad right.                                                                                  003948
 003949         sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                               01                  003949
 003950                                                                                                                      003950
 003951      ElseIf factor1 = *Blanks;                                                                  X01                  003951
 003952         // Straight move.                                                                                            003952
 003953         If %lookup(%xlate(lo:up:%trim(result)):QopCodeUp) = 0;                                  B02                  003953
 003954            sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                            02                  003954
 003955         Else;                                                                                   X02                  003955
 003956            // Result is a reserved word - don't convert.                                                             003956
 003957            nonConvRsn = 'Result field name is a reserved word.';                                 02                  003957
 003958            LeaveSr;                                                                              02                  003958
 003959         EndIf;                                                                                  E02                  003959
 003960                                                                                                                      003960
 003961      Else;                                                                                      X01                  003961
 003962         // Conversion from one format to another...                                                                  003962
 003963         //         sourceLine = %xlate(lo:up:factor1);                                                               003963
 003964                                                                                                                      003964
 003965         //         If sourceLine = '*CYMD';   // Date.                                                               003965
 003966         //            sourceLine = %trim(result) + ' = %dec(' + %trim(factor2)                                       003966
 003967         //                       + ':*CYMD);';                                                                       003967
 003968         //         Else;                                                                                             003968
 003969         nonConvRsn = 'Data conversion is needed.';                                               01                  003969
 003970         LeaveSr; // Don't convert.                                                               01                  003970
 003971         //         EndIf;                                                                                            003971
 003972      EndIf;                                                                                     E01                  003972
 003973                                                                                                                      003973
 003974      convert = *On;                                                                                                  003974
 003975                                                                                                                      003975
 003976   EndSr;                                                                                                             003976
 003977   //-------------------------------------------------------------------------------------------                      003977
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    118
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003978                                                                                                                      003978
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    119
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003980   //-------------------------------------------------------------------------------------------                      003980
 003981   // Convert MOVEA.                                                                                                  003981
 003982   //-------------------------------------------------------------------------------------------                      003982
 003983   BegSr subUserCvt_MOVEA;                                                                                            003983
 003984                                                                                                                      003984
 003985      // Not supported.                                                                                               003985
 003986                                                                                                                      003986
 003987   EndSr;                                                                                                             003987
 003988   //-------------------------------------------------------------------------------------------                      003988
 003989                                                                                                                      003989
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    120
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 003991   //-------------------------------------------------------------------------------------------                      003991
 003992   // Convert MULT.                                                                                                   003992
 003993   //-------------------------------------------------------------------------------------------                      003993
 003994   BegSr subUserCvt_MULT;                                                                                             003994
 003995                                                                                                                      003995
 003996      // Half-adjust?                                                                                                 003996
 003997      x = %scan('H':operator:4);                                                                                      003997
 003998      If x > 0;                                                                                  B01                  003998
 003999         sourceLine = 'Eval(H)';                                                                  01                  003999
 004000      Else;                                                                                      X01                  004000
 004001         sourceLine = *Blanks;                                                                    01                  004001
 004002      EndIf;                                                                                     E01                  004002
 004003                                                                                                                      004003
 004004      If factor1 = *Blanks;                                                                      B01                  004004
 004005         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004005
 004006                    + ' = ' + %trim(result)                                                       01                  004006
 004007                    + ' * ' + %trim(factor2) +';';                                                01                  004007
 004008      Else;                                                                                      X01                  004008
 004009         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004009
 004010                    + ' = ' + %trim(factor1)                                                      01                  004010
 004011                    + ' * ' + %trim(factor2) + ';';                                               01                  004011
 004012      EndIf;                                                                                     E01                  004012
 004013                                                                                                                      004013
 004014      sourceLine = %trim(sourceLine);                                                                                 004014
 004015                                                                                                                      004015
 004016      convert = *On;                                                                                                  004016
 004017                                                                                                                      004017
 004018   EndSr;                                                                                                             004018
 004019   //-------------------------------------------------------------------------------------------                      004019
 004020                                                                                                                      004020
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    121
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004022   //-------------------------------------------------------------------------------------------                      004022
 004023   // Convert MVR.                                                                                                    004023
 004024   //-------------------------------------------------------------------------------------------                      004024
 004025   BegSr subUserCvt_MVR;                                                                                              004025
 004026                                                                                                                      004026
 004027      sourceLine = %trim(result) + ' = %rem(' + %trim(divFactor1)                                                     004027
 004028                 + ':' + %trim(divFactor2) + ');';                                                                    004028
 004029                                                                                                                      004029
 004030      convert = *On;                                                                                                  004030
 004031                                                                                                                      004031
 004032   EndSr;                                                                                                             004032
 004033   //-------------------------------------------------------------------------------------------                      004033
 004034                                                                                                                      004034
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    122
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004036   //-------------------------------------------------------------------------------------------                      004036
 004037   // Convert NEXT.                                                                                                   004037
 004038   //-------------------------------------------------------------------------------------------                      004038
 004039   BegSr subUserCvt_NEXT;                                                                                             004039
 004040                                                                                                                      004040
 004041      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004041
 004042                 + %trim(factor2) + ';';                                                                              004042
 004043                                                                                                                      004043
 004044                                                                                                                      004044
 004045      // Check indicators?                                                                                            004045
 004046      If lw <> *Blanks;                                                                          B01                  004046
 004047         ERRCheck = *On;                                                                          01                  004047
 004048         ERRInd = lw;                                                                             01                  004048
 004049      EndIf;                                                                                     E01                  004049
 004050                                                                                                                      004050
 004051      convert = *On;                                                                                                  004051
 004052                                                                                                                      004052
 004053   EndSr;                                                                                                             004053
 004054   //-------------------------------------------------------------------------------------------                      004054
 004055                                                                                                                      004055
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    123
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004057   //-------------------------------------------------------------------------------------------                      004057
 004058   // Convert OCCUR.                                                                                                  004058
 004059   //-------------------------------------------------------------------------------------------                      004059
 004060   BegSr subUserCvt_OCCUR;                                                                                            004060
 004061                                                                                                                      004061
 004062      If factor1 = *Blanks;      // Get occurrence.                                              B01                  004062
 004063         sourceLine = %trim(result) + ' = ' + '%occur('                                           01                  004063
 004064                    + %trim(factor2) + ');';                                                      01                  004064
 004065      ElseIf result = *Blanks;   // Set occurrent.                                               X01                  004065
 004066         sourceLine = '%occur(' + %trim(factor2) + ') = '                                         01                  004066
 004067                    + %trim(factor1) + ';';                                                       01                  004067
 004068      Else;                                                                                      X01                  004068
 004069         nonConvRsn = 'Cannot determine of OCCUR is used to set or '                              01                  004069
 004070                    + 'get the occurrence.';                                                      01                  004070
 004071         LeaveSr;                                                                                 01                  004071
 004072      EndIf;                                                                                     E01                  004072
 004073                                                                                                                      004073
 004074      // Check resulting indicators?                                                                                  004074
 004075      If lw <> *Blanks;                                                                          B01                  004075
 004076         ERRCheck = *On;                                                                          01                  004076
 004077         ERRInd = lw;                                                                             01                  004077
 004078      EndIf;                                                                                     E01                  004078
 004079                                                                                                                      004079
 004080      convert = *On;                                                                                                  004080
 004081                                                                                                                      004081
 004082   EndSr;                                                                                                             004082
 004083   //-------------------------------------------------------------------------------------------                      004083
 004084                                                                                                                      004084
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    124
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004086   //-------------------------------------------------------------------------------------------                      004086
 004087   // Convert ON-ERROR.                                                                                               004087
 004088   //-------------------------------------------------------------------------------------------                      004088
 004089   BegSr subUserCvt_ON_ERROR;                                                                                         004089
 004090                                                                                                                      004090
 004091      If extFactor2 = *Blanks;                                                                   B01                  004091
 004092         sourceLine = %trim(operator) + ';';                                                      01                  004092
 004093      Else;                                                                                      X01                  004093
 004094         sourceLine = %trim(operator) + ' ' + %trim(extFactor2) + ';';                            01                  004094
 004095      EndIf;                                                                                     E01                  004095
 004096                                                                                                                      004096
 004097      convert = *On;                                                                                                  004097
 004098                                                                                                                      004098
 004099   EndSr;                                                                                                             004099
 004100   //-------------------------------------------------------------------------------------------                      004100
 004101                                                                                                                      004101
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    125
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004103   //-------------------------------------------------------------------------------------------                      004103
 004104   // Convert OPEN.                                                                                                   004104
 004105   //-------------------------------------------------------------------------------------------                      004105
 004106   BegSr subUserCvt_OPEN;                                                                                             004106
 004107                                                                                                                      004107
 004108      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004108
 004109                                                                                                                      004109
 004110      // Check resulting indicators?                                                                                  004110
 004111      If lw <> *Blanks;                                                                          B01                  004111
 004112         ERRCheck = *On;                                                                          01                  004112
 004113         ERRInd = lw;                                                                             01                  004113
 004114      EndIf;                                                                                     E01                  004114
 004115                                                                                                                      004115
 004116      convert = *On;                                                                                                  004116
 004117                                                                                                                      004117
 004118   EndSr;                                                                                                             004118
 004119   //-------------------------------------------------------------------------------------------                      004119
 004120                                                                                                                      004120
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    126
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004122   //-------------------------------------------------------------------------------------------                      004122
 004123   // Convert OTHER.                                                                                                  004123
 004124   //-------------------------------------------------------------------------------------------                      004124
 004125   BegSr subUserCvt_OTHER;                                                                                            004125
 004126                                                                                                                      004126
 004127      sourceLine = 'Other;';                                                                                          004127
 004128                                                                                                                      004128
 004129      convert = *On;                                                                                                  004129
 004130                                                                                                                      004130
 004131   EndSr;                                                                                                             004131
 004132   //-------------------------------------------------------------------------------------------                      004132
 004133                                                                                                                      004133
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    127
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004135   //-------------------------------------------------------------------------------------------                      004135
 004136   // Convert OUT.                                                                                                    004136
 004137   //-------------------------------------------------------------------------------------------                      004137
 004138   BegSr subUserCvt_OUT;                                                                                              004138
 004139                                                                                                                      004139
 004140      If factor1 = *Blanks;                                                                      B01                  004140
 004141         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004141
 004142      Else;                                                                                      X01                  004142
 004143         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004143
 004144                    + %trim(factor2) + ';';                                                       01                  004144
 004145      EndIf;                                                                                     E01                  004145
 004146                                                                                                                      004146
 004147      // Set resulting indicators?                                                                                    004147
 004148      If lw <> *Blanks;                                                                          B01                  004148
 004149         ERRCheck = *On;                                                                          01                  004149
 004150         ERRInd = lw;                                                                             01                  004150
 004151      EndIf;                                                                                     E01                  004151
 004152                                                                                                                      004152
 004153      convert = *On;                                                                                                  004153
 004154                                                                                                                      004154
 004155   EndSr;                                                                                                             004155
 004156   //-------------------------------------------------------------------------------------------                      004156
 004157                                                                                                                      004157
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    128
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004159   //-------------------------------------------------------------------------------------------                      004159
 004160   // Convert POST.                                                                                                   004160
 004161   //-------------------------------------------------------------------------------------------                      004161
 004162   BegSr subUserCvt_POST;                                                                                             004162
 004163                                                                                                                      004163
 004164      If factor2 = *Blanks;                                                                      B01                  004164
 004165         nonConvRsn =  'No filename specified in Factor2.';                                       01                  004165
 004166         LeaveSr;                                                                                 01                  004166
 004167      EndIf;                                                                                     E01                  004167
 004168                                                                                                                      004168
 004169      If result <> *Blanks;                                                                      B01                  004169
 004170         nonConvRsn =  'INFDS specified in result.';                                              01                  004170
 004171         LeaveSr;                                                                                 01                  004171
 004172      EndIf;                                                                                     E01                  004172
 004173                                                                                                                      004173
 004174      If factor1 = *Blanks;                                                                      B01                  004174
 004175         sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                               01                  004175
 004176      Else;                                                                                      X01                  004176
 004177         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004177
 004178                    + %trim(factor2) + ';';                                                       01                  004178
 004179      EndIf;                                                                                     E01                  004179
 004180                                                                                                                      004180
 004181      // Set resulting indicators?                                                                                    004181
 004182      If lw <> *Blanks;                                                                          B01                  004182
 004183         ERRCheck = *On;                                                                          01                  004183
 004184         ERRInd = lw;                                                                             01                  004184
 004185      EndIf;                                                                                     E01                  004185
 004186                                                                                                                      004186
 004187      convert = *On;                                                                                                  004187
 004188                                                                                                                      004188
 004189   EndSr;                                                                                                             004189
 004190   //-------------------------------------------------------------------------------------------                      004190
 004191                                                                                                                      004191
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    129
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004193   //-------------------------------------------------------------------------------------------                      004193
 004194   // Convert READ.                                                                                                   004194
 004195   //-------------------------------------------------------------------------------------------                      004195
 004196   BegSr subUserCvt_READ;                                                                                             004196
 004197                                                                                                                      004197
 004198      If factor1 <> *Blanks;                                                                     B01                  004198
 004199         sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                01                  004199
 004200                    + %trim(factor2);                                                             01                  004200
 004201      Else;                                                                                      X01                  004201
 004202         sourceLine = %trim(operator) + ' ' + %trim(factor2);                                     01                  004202
 004203      EndIf;                                                                                     E01                  004203
 004204                                                                                                                      004204
 004205      // Append datastructure?                                                                                        004205
 004206      If result <> *Blanks;                                                                      B01                  004206
 004207         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004207
 004208      Else;                                                                                      X01                  004208
 004209         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004209
 004210      EndIf;                                                                                     E01                  004210
 004211                                                                                                                      004211
 004212      // Check indicators?                                                                                            004212
 004213      If eq <> *Blanks;                                                                          B01                  004213
 004214         EOFCheck = *On;                                                                          01                  004214
 004215         EOFInd = eq;                                                                             01                  004215
 004216         EOFFile = %trim(factor2);                                                                01                  004216
 004217      EndIf;                                                                                     E01                  004217
 004218      If lw <> *Blanks;                                                                          B01                  004218
 004219         ERRCheck = *On;                                                                          01                  004219
 004220         ERRInd = lw;                                                                             01                  004220
 004221      EndIf;                                                                                     E01                  004221
 004222                                                                                                                      004222
 004223      convert = *On;                                                                                                  004223
 004224                                                                                                                      004224
 004225   EndSr;                                                                                                             004225
 004226   //-------------------------------------------------------------------------------------------                      004226
 004227                                                                                                                      004227
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    130
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004229   //-------------------------------------------------------------------------------------------                      004229
 004230   // Convert REALLOC.                                                                                                004230
 004231   //-------------------------------------------------------------------------------------------                      004231
 004232   BegSr subUserCvt_REALLOC;                                                                                          004232
 004233                                                                                                                      004233
 004234      sourceLine = %trim(result) + ' = %realloc(' + %trim(factor2)                                                    004234
 004235                 + ');';                                                                                              004235
 004236                                                                                                                      004236
 004237      // Set resulting indicators?                                                                                    004237
 004238      If lw <> *Blanks;                                                                          B01                  004238
 004239         ERRCheck = *On;                                                                          01                  004239
 004240         ERRInd = lw;                                                                             01                  004240
 004241      EndIf;                                                                                     E01                  004241
 004242                                                                                                                      004242
 004243      convert = *On;                                                                                                  004243
 004244                                                                                                                      004244
 004245   EndSr;                                                                                                             004245
 004246   //-------------------------------------------------------------------------------------------                      004246
 004247                                                                                                                      004247
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    131
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004249   //-------------------------------------------------------------------------------------------                      004249
 004250   // Convert REL.                                                                                                    004250
 004251   //-------------------------------------------------------------------------------------------                      004251
 004252   BegSr subUserCvt_REL;                                                                                              004252
 004253                                                                                                                      004253
 004254      sourceLine = %trim(operator) + ' ' + %trim(factor1)                                                             004254
 004255                 + ' ' + %trim(factor2) + ';';                                                                        004255
 004256                                                                                                                      004256
 004257      // Check resulting indicators?                                                                                  004257
 004258      If lw <> *Blanks;                                                                          B01                  004258
 004259         ERRCheck = *On;                                                                          01                  004259
 004260         ERRInd = lw;                                                                             01                  004260
 004261      EndIf;                                                                                     E01                  004261
 004262                                                                                                                      004262
 004263      convert = *On;                                                                                                  004263
 004264                                                                                                                      004264
 004265   EndSr;                                                                                                             004265
 004266   //-------------------------------------------------------------------------------------------                      004266
 004267                                                                                                                      004267
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    132
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004269   //-------------------------------------------------------------------------------------------                      004269
 004270   // Convert RESET.                                                                                                  004270
 004271   //-------------------------------------------------------------------------------------------                      004271
 004272   BegSr subUserCvt_RESET;                                                                                            004272
 004273                                                                                                                      004273
 004274      sourceLine = %trim(operator);                                                                                   004274
 004275                                                                                                                      004275
 004276      If factor1 <> *Blanks;                                                                     B01                  004276
 004277         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1);                                  01                  004277
 004278      EndIf;                                                                                     E01                  004278
 004279                                                                                                                      004279
 004280      If factor2 <> *Blanks;                                                                     B01                  004280
 004281         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor2);                                  01                  004281
 004282      EndIf;                                                                                     E01                  004282
 004283                                                                                                                      004283
 004284      sourceLine = %trimr(sourceLine) + ' ' + %trim(result) + ';';                                                    004284
 004285                                                                                                                      004285
 004286      // Check indicators?                                                                                            004286
 004287      If hi <> *Blanks;                                                                          B01                  004287
 004288         NRFCheck = *On;                                                                          01                  004288
 004289         NRFInd = eq;                                                                             01                  004289
 004290         NRFFile = %trim(factor2);                                                                01                  004290
 004291      EndIf;                                                                                     E01                  004291
 004292      If lw <> *Blanks;                                                                          B01                  004292
 004293         ERRCheck = *On;                                                                          01                  004293
 004294         ERRInd = lw;                                                                             01                  004294
 004295      EndIf;                                                                                     E01                  004295
 004296                                                                                                                      004296
 004297      convert = *On;                                                                                                  004297
 004298                                                                                                                      004298
 004299   EndSr;                                                                                                             004299
 004300   //-------------------------------------------------------------------------------------------                      004300
 004301                                                                                                                      004301
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    133
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004303   //-------------------------------------------------------------------------------------------                      004303
 004304   // Convert RETURN;                                                                                                 004304
 004305   //-------------------------------------------------------------------------------------------                      004305
 004306   BegSr subUserCvt_RETURN;                                                                                           004306
 004307                                                                                                                      004307
 004308      sourceLine = 'Return ' + %trim(%subst(operator:7))                                                              004308
 004309                 + ' ' + %trim(extFactor2) + ';';                                                                     004309
 004310                                                                                                                      004310
 004311      convert = *On;                                                                                                  004311
 004312                                                                                                                      004312
 004313   EndSr;                                                                                                             004313
 004314   //-------------------------------------------------------------------------------------------                      004314
 004315                                                                                                                      004315
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    134
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004317   //-------------------------------------------------------------------------------------------                      004317
 004318   // Convert ROLBK.                                                                                                  004318
 004319   //-------------------------------------------------------------------------------------------                      004319
 004320   BegSr subUserCvt_ROLBK;                                                                                            004320
 004321                                                                                                                      004321
 004322      sourceLine = %trim(operator) + ' ' + %trim(factor1);                                                            004322
 004323                                                                                                                      004323
 004324      sourceLine = %trim(sourceLine)  + ';';                                                                          004324
 004325                                                                                                                      004325
 004326      // Check indicators?                                                                                            004326
 004327      If lw <> *Blanks;                                                                          B01                  004327
 004328         ERRCheck = *On;                                                                          01                  004328
 004329         ERRInd = lw;                                                                             01                  004329
 004330      EndIf;                                                                                     E01                  004330
 004331                                                                                                                      004331
 004332      convert = *On;                                                                                                  004332
 004333                                                                                                                      004333
 004334   EndSr;                                                                                                             004334
 004335   //-------------------------------------------------------------------------------------------                      004335
 004336                                                                                                                      004336
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    135
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004338   //-------------------------------------------------------------------------------------------                      004338
 004339   // Convert SCAN.                                                                                                   004339
 004340   //-------------------------------------------------------------------------------------------                      004340
 004341   BegSr subUserCvt_SCAN;                                                                                             004341
 004342                                                                                                                      004342
 004343      // Determine length of comparator.                                                                              004343
 004344      x = %scan(':':factor1);                                                                                         004344
 004345      If x = 0;   // No length specified.                                                        B01                  004345
 004346         scanLength = *Blanks;               // Scan length                                       01                  004346
 004347         scanString = %trim(factor1);        // Scan string                                       01                  004347
 004348      Else;                                                                                      X01                  004348
 004349         scanLength = %subst(factor1:x+1);   // Scan length                                       01                  004349
 004350         scanString = %subst(factor1:1:x-1); // Scan string                                       01                  004350
 004351      EndIf;                                                                                     E01                  004351
 004352                                                                                                                      004352
 004353      // Determine starting point.                                                                                    004353
 004354      x = %scan(':':factor2);                                                                                         004354
 004355      If x = 0;   // No start specified.                                                         B01                  004355
 004356         scanStart = '1';                    // Start position                                    01                  004356
 004357         scanBase = %trim(factor2);          // Base string                                       01                  004357
 004358      Else;                                                                                      X01                  004358
 004359         scanStart = %subst(factor2:x+1);    // Start position                                    01                  004359
 004360         scanBase = %subst(factor2:1:x-1);   // Base string                                       01                  004360
 004361      EndIf;                                                                                     E01                  004361
 004362                                                                                                                      004362
 004363      // Build the new line.                                                                                          004363
 004364      If scanLength = *Blanks;                                                                   B01                  004364
 004365         // No length specified.                                                                                      004365
 004366         sourceLine = '%scan(' + %trim(scanString)                                                01                  004366
 004367                    + ':' + %trim(scanBase) + ':' + %trim(scanStart)                              01                  004367
 004368                    + ')';                                                                        01                  004368
 004369      Else;                                                                                      X01                  004369
 004370         // Use a subset of the scan string.                                                                          004370
 004371         sourceLine = '%scan(%subst('                                                             01                  004371
 004372                    + %trim(scanString) + ':1:' + %trim(scanLength)                               01                  004372
 004373                    + '):' + %trim(scanBase) + ':' + %trim(scanStart)                             01                  004373
 004374                    + ')';                                                                        01                  004374
 004375      EndIf;                                                                                     E01                  004375
 004376                                                                                                                      004376
 004377      // Result specified?                                                                                            004377
 004378      If result = *Blanks;                                                                       B01                  004378
 004379         scanNoResult = *On;                                                                      01                  004379
 004380         sourceLine = 'If ' + %trimr(sourceLine) + ' = 0;';                                       01                  004380
 004381      Else;                                                                                      X01                  004381
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    136
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004382         scanNoResult = *Off;                                                                     01                  004382
 004383         sourceLine = %trim(result) + ' = ' + %trimr(sourceLine) + ';';                           01                  004383
 004384      EndIf;                                                                                     E01                  004384
 004385                                                                                                                      004385
 004386      // Set resulting indicators?                                                                                    004386
 004387      If lw <> *Blanks;                                                                          B01                  004387
 004388         ERRCheck = *On;                                                                          01                  004388
 004389         ERRInd = lw;                                                                             01                  004389
 004390      EndIf;                                                                                     E01                  004390
 004391      If eq <> *Blanks;                                                                          B01                  004391
 004392         foundCheck = *On;                                                                        01                  004392
 004393         foundInd = eq;                                                                           01                  004393
 004394      EndIf;                                                                                     E01                  004394
 004395                                                                                                                      004395
 004396      convert = *On;                                                                                                  004396
 004397                                                                                                                      004397
 004398   EndSr;                                                                                                             004398
 004399   //-------------------------------------------------------------------------------------------                      004399
 004400                                                                                                                      004400
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    137
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004402   //-------------------------------------------------------------------------------------------                      004402
 004403   // Convert SELECT                                                                                                  004403
 004404   //-------------------------------------------------------------------------------------------                      004404
 004405   BegSr subUserCvt_SELECT;                                                                                           004405
 004406                                                                                                                      004406
 004407      sourceLine = 'Select;';                                                                                         004407
 004408                                                                                                                      004408
 004409      convert = *On;                                                                                                  004409
 004410                                                                                                                      004410
 004411   EndSr;                                                                                                             004411
 004412   //-------------------------------------------------------------------------------------------                      004412
 004413                                                                                                                      004413
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    138
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004415   //-------------------------------------------------------------------------------------------                      004415
 004416   // Convert SETOFF                                                                                                  004416
 004417   //-------------------------------------------------------------------------------------------                      004417
 004418   BegSr subUserCvt_SETOFF;                                                                                           004418
 004419                                                                                                                      004419
 004420      setOff = *On;                                                                                                   004420
 004421      setOffInd1 = hi;                                                                                                004421
 004422      setOffInd2 = lw;                                                                                                004422
 004423      setOffInd3 = eq;                                                                                                004423
 004424                                                                                                                      004424
 004425      dropLine = *On;                                                                                                 004425
 004426                                                                                                                      004426
 004427      convert = *On;                                                                                                  004427
 004428                                                                                                                      004428
 004429   EndSr;                                                                                                             004429
 004430   //-------------------------------------------------------------------------------------------                      004430
 004431                                                                                                                      004431
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    139
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004433   //-------------------------------------------------------------------------------------------                      004433
 004434   // Convert SETON                                                                                                   004434
 004435   //-------------------------------------------------------------------------------------------                      004435
 004436   BegSr subUserCvt_SETON;                                                                                            004436
 004437                                                                                                                      004437
 004438      setOn = *On;                                                                                                    004438
 004439      setOnInd1 = hi;                                                                                                 004439
 004440      setOnInd2 = lw;                                                                                                 004440
 004441      setOnInd3 = eq;                                                                                                 004441
 004442                                                                                                                      004442
 004443      dropLine = *On;                                                                                                 004443
 004444                                                                                                                      004444
 004445      convert = *On;                                                                                                  004445
 004446                                                                                                                      004446
 004447   EndSr;                                                                                                             004447
 004448   //-------------------------------------------------------------------------------------------                      004448
 004449                                                                                                                      004449
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    140
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004451   //-------------------------------------------------------------------------------------------                      004451
 004452   // Convert SETxx.                                                                                                  004452
 004453   //-------------------------------------------------------------------------------------------                      004453
 004454   BegSr subUserCvt_SETxx;                                                                                            004454
 004455                                                                                                                      004455
 004456      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004456
 004457                 + %trim(factor2);                                                                                    004457
 004458      If result <> *Blanks;                                                                      B01                  004458
 004459         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004459
 004460      Else;                                                                                      X01                  004460
 004461         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004461
 004462      EndIf;                                                                                     E01                  004462
 004463                                                                                                                      004463
 004464      // Check resulting indicators.                                                                                  004464
 004465      If hi <> *Blanks;                                                                          B01                  004465
 004466         NRFCheck = *On;                                                                          01                  004466
 004467         NRFInd = hi;                                                                             01                  004467
 004468         NRFFile = %trim(factor2);                                                                01                  004468
 004469      EndIf;                                                                                     E01                  004469
 004470      If eq <> *Blanks;                                                                          B01                  004470
 004471         equalCheck = *On;                                                                        01                  004471
 004472         equalInd = eq;                                                                           01                  004472
 004473      EndIf;                                                                                     E01                  004473
 004474      If lw <> *Blanks;                                                                          B01                  004474
 004475         ERRCheck = *On;                                                                          01                  004475
 004476         ERRInd = lw;                                                                             01                  004476
 004477      EndIf;                                                                                     E01                  004477
 004478                                                                                                                      004478
 004479      convert = *On;                                                                                                  004479
 004480                                                                                                                      004480
 004481   EndSr;                                                                                                             004481
 004482   //-------------------------------------------------------------------------------------------                      004482
 004483                                                                                                                      004483
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    141
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004485   //-------------------------------------------------------------------------------------------                      004485
 004486   // Convert SHTDN                                                                                                   004486
 004487   //-------------------------------------------------------------------------------------------                      004487
 004488   BegSr subUserCvt_SHTDN;                                                                                            004488
 004489                                                                                                                      004489
 004490      sourceLine = '*IN' + hi + ' = %shtdn();';                                                                       004490
 004491                                                                                                                      004491
 004492      convert = *On;                                                                                                  004492
 004493                                                                                                                      004493
 004494   EndSr;                                                                                                             004494
 004495   //-------------------------------------------------------------------------------------------                      004495
 004496                                                                                                                      004496
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    142
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004498   //-------------------------------------------------------------------------------------------                      004498
 004499   // Convert SORTA.                                                                                                  004499
 004500   //-------------------------------------------------------------------------------------------                      004500
 004501   BegSr subUserCvt_SORTA;                                                                                            004501
 004502                                                                                                                      004502
 004503      sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                                                         004503
 004504                                                                                                                      004504
 004505      sourceLine = %trim(sourceLine)  + ';';                                                                          004505
 004506                                                                                                                      004506
 004507      convert = *On;                                                                                                  004507
 004508                                                                                                                      004508
 004509   EndSr;                                                                                                             004509
 004510   //-------------------------------------------------------------------------------------------                      004510
 004511                                                                                                                      004511
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    143
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004513   //-------------------------------------------------------------------------------------------                      004513
 004514   // Convert SQRT.                                                                                                   004514
 004515   //-------------------------------------------------------------------------------------------                      004515
 004516   BegSr subUserCvt_SQRT;                                                                                             004516
 004517                                                                                                                      004517
 004518      sourceLine = %trim(result) + ' = %sqrt(' + %trim(factor2) + ');';                                               004518
 004519                                                                                                                      004519
 004520      convert = *On;                                                                                                  004520
 004521                                                                                                                      004521
 004522   EndSr;                                                                                                             004522
 004523   //-------------------------------------------------------------------------------------------                      004523
 004524                                                                                                                      004524
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    144
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004526   //-------------------------------------------------------------------------------------------                      004526
 004527   // Convert SUB.                                                                                                    004527
 004528   //-------------------------------------------------------------------------------------------                      004528
 004529   BegSr subUserCvt_SUB;                                                                                              004529
 004530                                                                                                                      004530
 004531      // Half-adjust?                                                                                                 004531
 004532      x = %scan('H':operator:4);                                                                                      004532
 004533      If x > 0;                                                                                  B01                  004533
 004534         operator = 'SUB';                                                                        01                  004534
 004535         sourceLine = 'Eval(H)';                                                                  01                  004535
 004536      Else;                                                                                      X01                  004536
 004537         sourceLine = *Blanks;                                                                    01                  004537
 004538      EndIf;                                                                                     E01                  004538
 004539                                                                                                                      004539
 004540      If factor1 = *Blanks;                                                                      B01                  004540
 004541         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004541
 004542                    + ' = ' + %trim(result)                                                       01                  004542
 004543                    + ' - ' + %trim(factor2) +';';                                                01                  004543
 004544      Else;                                                                                      X01                  004544
 004545         sourceLine = %trimr(sourceLine) + ' ' + %trim(result)                                    01                  004545
 004546                    + ' = ' + %trim(factor1)                                                      01                  004546
 004547                    + ' - ' + %trim(factor2) + ';';                                               01                  004547
 004548      EndIf;                                                                                     E01                  004548
 004549                                                                                                                      004549
 004550      sourceLine = %trim(sourceLine);                                                                                 004550
 004551                                                                                                                      004551
 004552      convert = *On;                                                                                                  004552
 004553                                                                                                                      004553
 004554   EndSr;                                                                                                             004554
 004555   //-------------------------------------------------------------------------------------------                      004555
 004556                                                                                                                      004556
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    145
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004558   //-------------------------------------------------------------------------------------------                      004558
 004559   // Convert SUBDUR.                                                                                                 004559
 004560   //-------------------------------------------------------------------------------------------                      004560
 004561   BegSr subUserCvt_SUBDUR;                                                                                           004561
 004562                                                                                                                      004562
 004563      // Split out duration and code.                                                                                 004563
 004564      x = %scan(':':factor2);                                                                                         004564
 004565      If x = 0;                                                                                  B01                  004565
 004566         x = %scan(':':result);                                                                   01                  004566
 004567         If x = 0;                                                                               B02                  004567
 004568            nonConvRsn =  'No duration code specified.';                                          02                  004568
 004569            LeaveSr;                                                                              02                  004569
 004570         Else;                                                                                   X02                  004570
 004571            durNewDate = *Off;                                                                    02                  004571
 004572         EndIf;                                                                                  E02                  004572
 004573      Else;                                                                                      X01                  004573
 004574         durNewDate = *On;                                                                        01                  004574
 004575      EndIf;                                                                                     E01                  004575
 004576                                                                                                                      004576
 004577      If durNewDate;                                                                             B01                  004577
 004578         durDuration = %trim(%subst(factor2:1:x-1));                                              01                  004578
 004579         durCode     = %xlate(lo:up:%trim(%subst(factor2:x+1)));                                  01                  004579
 004580                                                                                                                      004580
 004581         Select;                                                                                 B02                  004581
 004582            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004582
 004583               durCode = '%years';                                                                02                  004583
 004584            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004584
 004585               durCode = '%months';                                                               02                  004585
 004586            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004586
 004587               durCode = '%days';                                                                 02                  004587
 004588            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004588
 004589               durCode = '%hours';                                                                02                  004589
 004590            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004590
 004591               durCode = '%minutes';                                                              02                  004591
 004592            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004592
 004593               durCode = '%seconds';                                                              02                  004593
 004594            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004594
 004595               durCode = '%mseconds';                                                             02                  004595
 004596            Other;                                                                               X02                  004596
 004597               nonConvRsn = 'Invalid duration code specified.';                                   02                  004597
 004598               LeaveSr;                                                                           02                  004598
 004599         EndSl;                                                                                  E02                  004599
 004600                                                                                                                      004600
 004601         If factor1 = *Blanks;                                                                   B02                  004601
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    146
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004602            sourceLine = %trim(result) + ' = ' + %trim(result);                                   02                  004602
 004603         Else;                                                                                   X02                  004603
 004604            sourceLine = %trim(result) + ' = ' + %trim(factor1);                                  02                  004604
 004605         EndIf;                                                                                  E02                  004605
 004606                                                                                                                      004606
 004607         sourceLine = %trimr(sourceLine) + ' - ' + %trim(durCode)                                 01                  004607
 004608                    + '(' + %trim(durDuration) + ');';                                            01                  004608
 004609      Else;                                                                                      X01                  004609
 004610         durDuration = %trim(%subst(result:1:x-1));                                               01                  004610
 004611         durCode     = %xlate(lo:up:%trim(%subst(result:x+1)));                                   01                  004611
 004612                                                                                                                      004612
 004613         Select;                                                                                 B02                  004613
 004614            When durCode = '*Y' or durCode = '*YEARS';                                           X02                  004614
 004615            When durCode = '*M' or durCode = '*MONTHS';                                          X02                  004615
 004616            When durCode = '*D' or durCode = '*DAYS';                                            X02                  004616
 004617            When durCode = '*H' or durCode = '*HOURS';                                           X02                  004617
 004618            When durCode = '*MN' or durCode = '*MINUTES';                                        X02                  004618
 004619            When durCode = '*S' or durCode = '*SECONDS';                                         X02                  004619
 004620            When durCode = '*MS' or durCode = '*MSECONDS';                                       X02                  004620
 004621            Other;                                                                               X02                  004621
 004622               nonConvRsn = 'Invalid duration code specified.';                                   02                  004622
 004623               LeaveSr;                                                                           02                  004623
 004624         EndSl;                                                                                  E02                  004624
 004625                                                                                                                      004625
 004626         sourceLine = %trim(durDuration) + ' = %diff(' + %trim(factor1)                           01                  004626
 004627                    + ':' + %trim(factor2) + ':' + %trim(durCode) + ');';                         01                  004627
 004628      EndIf;                                                                                     E01                  004628
 004629                                                                                                                      004629
 004630      // Set resulting indicators?                                                                                    004630
 004631      If lw <> *Blanks;                                                                          B01                  004631
 004632         ERRCheck = *On;                                                                          01                  004632
 004633         ERRInd = lw;                                                                             01                  004633
 004634      EndIf;                                                                                     E01                  004634
 004635                                                                                                                      004635
 004636      convert = *On;                                                                                                  004636
 004637                                                                                                                      004637
 004638   EndSr;                                                                                                             004638
 004639   //-------------------------------------------------------------------------------------------                      004639
 004640                                                                                                                      004640
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    147
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004642   //-------------------------------------------------------------------------------------------                      004642
 004643   // Convert SUBST.                                                                                                  004643
 004644   //-------------------------------------------------------------------------------------------                      004644
 004645   BegSr subUserCvt_SUBST;                                                                                            004645
 004646                                                                                                                      004646
 004647      // Pad the result?                                                                                              004647
 004648      x = %scan('P':operator:4);                                                                                      004648
 004649      If x = 0                                              // Not padding.                      B01                  004649
 004650      and factor1 <> *Blanks                                // Factor1 specified.                B01                  004650
 004651      and %xlate(lo:up:factor1) <> %xlate(lo:hi:result);    // Factor1 not the same as result    B01                  004651
 004652         nonConvRsn = 'No padding specified, and factor1 and result '                             01                  004652
 004653                    + 'are not the same.';                                                        01                  004653
 004654         LeaveSr;    // Don't convert - too difficult to get right.                               01                  004654
 004655      EndIf;                                                                                     E01                  004655
 004656                                                                                                                      004656
 004657      substLen = %trim(factor1);                                                                                      004657
 004658                                                                                                                      004658
 004659      x = %scan(':':factor2);                                                                                         004659
 004660      If x = 0;                                                                                  B01                  004660
 004661         substStart = '1';                                                                        01                  004661
 004662         x = %len(%trim(factor2)) + 1;                                                            01                  004662
 004663      Else;                                                                                      X01                  004663
 004664         substStart = %subst(factor2:x+1);                                                        01                  004664
 004665      EndIf;                                                                                     E01                  004665
 004666                                                                                                                      004666
 004667      sourceLine = %trim(result) + ' = %subst('                                                                       004667
 004668                 + %subst(factor2:1:x-1) + ':'                                                                        004668
 004669                 + %trim(substStart)                                                                                  004669
 004670                 + ':' + %trim(substLen) + ');';                                                                      004670
 004671                                                                                                                      004671
 004672      // Set resulting indicators?                                                                                    004672
 004673      If lw <> *Blanks;                                                                          B01                  004673
 004674         ERRCheck = *On;                                                                          01                  004674
 004675         ERRInd = lw;                                                                             01                  004675
 004676      EndIf;                                                                                     E01                  004676
 004677                                                                                                                      004677
 004678      convert = *On;                                                                                                  004678
 004679                                                                                                                      004679
 004680   EndSr;                                                                                                             004680
 004681   //-------------------------------------------------------------------------------------------                      004681
 004682                                                                                                                      004682
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    148
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004684   //-------------------------------------------------------------------------------------------                      004684
 004685   // Convert TEST.                                                                                                   004685
 004686   //-------------------------------------------------------------------------------------------                      004686
 004687   BegSr subUserCvt_TEST;                                                                                             004687
 004688                                                                                                                      004688
 004689      If operator = 'TEST';                                                                      B01                  004689
 004690         operator = 'Test(E)';                                                                    01                  004690
 004691      EndIf;                                                                                     E01                  004691
 004692                                                                                                                      004692
 004693      sourceLine = %trim(operator) + ' ' + %trim(factor1) + ' '                                                       004693
 004694                 + %trim(result) + ';';                                                                               004694
 004695                                                                                                                      004695
 004696      // Set resulting indicators?                                                                                    004696
 004697      If lw <> *Blanks;                                                                          B01                  004697
 004698         ERRCheck = *On;                                                                          01                  004698
 004699         ERRInd = lw;                                                                             01                  004699
 004700      EndIf;                                                                                     E01                  004700
 004701                                                                                                                      004701
 004702      convert = *On;                                                                                                  004702
 004703                                                                                                                      004703
 004704   EndSr;                                                                                                             004704
 004705   //-------------------------------------------------------------------------------------------                      004705
 004706                                                                                                                      004706
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    149
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004708   //-------------------------------------------------------------------------------------------                      004708
 004709   // Convert TIME.                                                                                                   004709
 004710   //-------------------------------------------------------------------------------------------                      004710
 004711   BegSr subUserCvt_TIME;                                                                                             004711
 004712                                                                                                                      004712
 004713      sourceLine = %trim(result) + ' = %time();';                                                                     004713
 004714                                                                                                                      004714
 004715      convert = *On;                                                                                                  004715
 004716                                                                                                                      004716
 004717   EndSr;                                                                                                             004717
 004718   //-------------------------------------------------------------------------------------------                      004718
 004719                                                                                                                      004719
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    150
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004721   //-------------------------------------------------------------------------------------------                      004721
 004722   // Convert UNLOCK.                                                                                                 004722
 004723   //-------------------------------------------------------------------------------------------                      004723
 004724   BegSr subUserCvt_UNLOCK;                                                                                           004724
 004725                                                                                                                      004725
 004726      sourceLine = %trim(operator) + ' ' + %trim(factor2) + ';';                                                      004726
 004727                                                                                                                      004727
 004728      // Check indicators?                                                                                            004728
 004729      If lw <> *Blanks;                                                                          B01                  004729
 004730         ERRCheck = *On;                                                                          01                  004730
 004731         ERRInd = lw;                                                                             01                  004731
 004732      EndIf;                                                                                     E01                  004732
 004733                                                                                                                      004733
 004734      convert = *On;                                                                                                  004734
 004735                                                                                                                      004735
 004736   EndSr;                                                                                                             004736
 004737   //-------------------------------------------------------------------------------------------                      004737
 004738                                                                                                                      004738
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    151
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004740   //-------------------------------------------------------------------------------------------                      004740
 004741   // Convert UPDATE.                                                                                                 004741
 004742   //-------------------------------------------------------------------------------------------                      004742
 004743   BegSr subUserCvt_UPDATE;                                                                                           004743
 004744                                                                                                                      004744
 004745      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004745
 004746                                                                                                                      004746
 004747      // Append datastructure?                                                                                        004747
 004748      If result <> *Blanks;                                                                      B01                  004748
 004749         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004749
 004750      Else;                                                                                      X01                  004750
 004751         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004751
 004752      EndIf;                                                                                     E01                  004752
 004753                                                                                                                      004753
 004754      // Check indicators?                                                                                            004754
 004755      If lw <> *Blanks;                                                                          B01                  004755
 004756         ERRCheck = *On;                                                                          01                  004756
 004757         ERRInd = lw;                                                                             01                  004757
 004758      EndIf;                                                                                     E01                  004758
 004759                                                                                                                      004759
 004760      convert = *On;                                                                                                  004760
 004761                                                                                                                      004761
 004762   EndSr;                                                                                                             004762
 004763   //-------------------------------------------------------------------------------------------                      004763
 004764                                                                                                                      004764
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    152
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004766   //-------------------------------------------------------------------------------------------                      004766
 004767   // Convert WHEN.                                                                                                   004767
 004768   //-------------------------------------------------------------------------------------------                      004768
 004769   BegSr subUserCvt_WHEN;                                                                                             004769
 004770                                                                                                                      004770
 004771      // Returning for a multi-line IF?  Reinstate original opcode.                                                   004771
 004772      If inWhen;                                                                                 B01                  004772
 004773         operator = whenOperator;                                                                 01                  004773
 004774      EndIf;                                                                                     E01                  004774
 004775                                                                                                                      004775
 004776      Exsr subUserCheckSpan;  // Does this line span more than one line?                                              004776
 004777                                                                                                                      004777
 004778      If operator = 'WHEN';     // Use Extended Factor2.                                         B01                  004778
 004779         If not inWhen;            // First line of IF.                                          B02                  004779
 004780            sourceLine = %trim(operator) + ' ' + %trim(extFactor2);                               02                  004780
 004781            If not inSpan;                                                                       B03                  004781
 004782               sourceLine = %trim(sourceLine) + ';';                                              03                  004782
 004783            Else;                                                                                X03                  004783
 004784               inWhen = *On;                                                                      03                  004784
 004785               inSpan = *Off;                                                                     03                  004785
 004786            EndIf;                                                                               E03                  004786
 004787         Else;                   // Second line of WHEN.                                         X02                  004787
 004788            //            sourceLine = *Blanks;                                                                       004788
 004789            //            %subst(sourceLine:40) = %trim(extFactor2);                                                  004789
 004790            sourceLine = %trim(extFactor2);                                                       02                  004790
 004791            If not inSpan;                                                                       B03                  004791
 004792               sourceLine = %trimr(sourceLine) + ';';                                             03                  004792
 004793               //               inWhen = *Off;                                                                        004793
 004794            EndIf;                                                                               E03                  004794
 004795            inSpan = *Off;                                                                        02                  004795
 004796         EndIf;                                                                                  E02                  004796
 004797      Else;                                                                                      X01                  004797
 004798         // Fixed format.                                                                                             004798
 004799         opCode = %xlate(lo:up:opCode);                                                           01                  004799
 004800         If not inWhen;         // First line of WHEN.                                           B02                  004800
 004801            whenCompare = %subst(opCode:5:2);                                                     02                  004801
 004802            sourceLine = 'When';                                                                  02                  004802
 004803         Else;                // Second line of WHEN.                                            X02                  004803
 004804            If %subst(opCode:1:3) = 'AND';                                                       B03                  004804
 004805               whenCompare = %subst(opCode:4:2);                                                  03                  004805
 004806               sourceLine = 'And';                                                                03                  004806
 004807            Else;                                                                                X03                  004807
 004808               whenCompare = %subst(opCode:3:2);                                                  03                  004808
 004809               sourceLine = 'Or';                                                                 03                  004809
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    153
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004810            EndIf;                                                                               E03                  004810
 004811         EndIf;                                                                                  E02                  004811
 004812         If whenCompare = 'EQ';                                                                  B02                  004812
 004813            whenCompare = '=';                                                                    02                  004813
 004814         ElseIf whenCompare = 'GT';                                                              X02                  004814
 004815            whenCompare = '>';                                                                    02                  004815
 004816         ElseIf whenCompare = 'GE';                                                              X02                  004816
 004817            whenCompare = '>=';                                                                   02                  004817
 004818         ElseIf whenCompare = 'LT';                                                              X02                  004818
 004819            whenCompare = '<';                                                                    02                  004819
 004820         ElseIf whenCompare = 'LE';                                                              X02                  004820
 004821            whenCompare = '<=';                                                                   02                  004821
 004822         ElseIf whenCompare = 'NE';                                                              X02                  004822
 004823            whenCompare = '<>';                                                                   02                  004823
 004824         EndIf;                                                                                  E02                  004824
 004825         sourceLine = %trimr(sourceLine) + ' ' + %trim(factor1)                                   01                  004825
 004826                            + ' ' + %trim(whenCompare) + ' '                                      01                  004826
 004827                            + %trim(factor2);                                                     01                  004827
 004828         If not inSpan;                                                                          B02                  004828
 004829            sourceLine = %trimr(sourceLine) + ';';                                                02                  004829
 004830            inWhen = *Off;                                                                        02                  004830
 004831         Else;                                                                                   X02                  004831
 004832            inWhen = *On;                                                                         02                  004832
 004833            inSpan = *Off;                                                                        02                  004833
 004834         EndIf;                                                                                  E02                  004834
 004835      EndIf;                                                                                     E01                  004835
 004836                                                                                                                      004836
 004837      // Multi-line IF?  Retain original opcode.                                                                      004837
 004838      If inWhen;                                                                                 B01                  004838
 004839         whenOperator = operator;                                                                 01                  004839
 004840      Else;                                                                                      X01                  004840
 004841         whenOperator = *Blanks;                                                                  01                  004841
 004842      EndIf;                                                                                     E01                  004842
 004843                                                                                                                      004843
 004844      convert = *On;                                                                                                  004844
 004845                                                                                                                      004845
 004846   EndSr;                                                                                                             004846
 004847   //-------------------------------------------------------------------------------------------                      004847
 004848                                                                                                                      004848
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    154
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004850   //-------------------------------------------------------------------------------------------                      004850
 004851   // Convert WRITE.                                                                                                  004851
 004852   //-------------------------------------------------------------------------------------------                      004852
 004853   BegSr subUserCvt_WRITE;                                                                                            004853
 004854                                                                                                                      004854
 004855      sourceLine = %trim(operator) + ' ' + %trim(factor2);                                                            004855
 004856                                                                                                                      004856
 004857      // Append datastructure?                                                                                        004857
 004858      If result <> *Blanks;                                                                      B01                  004858
 004859         sourceLine = %trim(sourceLine)  + ' ' + %trim(result) + ';';                             01                  004859
 004860      Else;                                                                                      X01                  004860
 004861         sourceLine = %trim(sourceLine)  + ';';                                                   01                  004861
 004862      EndIf;                                                                                     E01                  004862
 004863                                                                                                                      004863
 004864      // Check indicators?                                                                                            004864
 004865      If eq <> *Blanks;                                                                          B01                  004865
 004866         EOFCheck = *On;                                                                          01                  004866
 004867         EOFInd = eq;                                                                             01                  004867
 004868         EOFFile = %trim(factor2);                                                                01                  004868
 004869      EndIf;                                                                                     E01                  004869
 004870      If lw <> *Blanks;                                                                          B01                  004870
 004871         ERRCheck = *On;                                                                          01                  004871
 004872         ERRInd = lw;                                                                             01                  004872
 004873      EndIf;                                                                                     E01                  004873
 004874                                                                                                                      004874
 004875      convert = *On;                                                                                                  004875
 004876                                                                                                                      004876
 004877   EndSr;                                                                                                             004877
 004878   //-------------------------------------------------------------------------------------------                      004878
 004879                                                                                                                      004879
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    155
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004881   //-------------------------------------------------------------------------------------------                      004881
 004882   // Convert XFOOT.                                                                                                  004882
 004883   //-------------------------------------------------------------------------------------------                      004883
 004884   BegSr subUserCvt_XFOOT;                                                                                            004884
 004885                                                                                                                      004885
 004886      If %scan('H':operator) = 0;                                                                B01                  004886
 004887         sourceLine = %trim(result) + ' = %xfoot(' + %trim(factor2)                               01                  004887
 004888                    + ');';                                                                       01                  004888
 004889      Else;                                                                                      X01                  004889
 004890         // Half-adjust.                                                                                              004890
 004891         sourceLine = 'Eval(H) ' + %trim(result) + ' = %xfoot('                                   01                  004891
 004892                    + %trim(factor2) + ');';                                                      01                  004892
 004893      EndIf;                                                                                     E01                  004893
 004894                                                                                                                      004894
 004895      convert = *On;                                                                                                  004895
 004896                                                                                                                      004896
 004897   EndSr;                                                                                                             004897
 004898   //-------------------------------------------------------------------------------------------                      004898
 004899                                                                                                                      004899
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    156
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004901   //-------------------------------------------------------------------------------------------                      004901
 004902   // Convert XLATE.                                                                                                  004902
 004903   //-------------------------------------------------------------------------------------------                      004903
 004904   BegSr subUserCvt_XLATE;                                                                                            004904
 004905                                                                                                                      004905
 004906      //      // Pad the result?                                                                                      004906
 004907      //      x = %scan('P':operator:6);                                                                              004907
 004908      //      If x > 0;                                                                                               004908
 004909      //         padResult = *On;                                                                                     004909
 004910      //         padTarget = result;                                                                                  004910
 004911      //         // Drop the extender.                                                                                004911
 004912      //         operator = 'XLATE';                                                                                  004912
 004913      //      EndIf;                                                                                                  004913
 004914                                                                                                                      004914
 004915      // Derive from and to.                                                                                          004915
 004916      x = %scan(':':factor1);                                                                                         004916
 004917      If x = 0;                                                                                  B01                  004917
 004918         LeaveSr;    // Invalid specification - there MUST be a from and to - don't convert.      01                  004918
 004919      Else;                                                                                      X01                  004919
 004920         xlateFrom = %subst(factor1:1:x-1);                                                       01                  004920
 004921         xlateTo = %subst(factor1:x+1);                                                           01                  004921
 004922      EndIf;                                                                                     E01                  004922
 004923                                                                                                                      004923
 004924      // Check for start position.                                                                                    004924
 004925      x = %scan(':':factor2);                                                                                         004925
 004926      If x = 0;                                                                                  B01                  004926
 004927         xlateStart = *Blanks;                                                                    01                  004927
 004928         xlateBase = factor2;                                                                     01                  004928
 004929      Else;                                                                                      X01                  004929
 004930         xlateStart = %subst(factor2:x+1);                                                        01                  004930
 004931         xlateBase = %subst(factor2:1:x-1);                                                       01                  004931
 004932      EndIf;                                                                                     E01                  004932
 004933                                                                                                                      004933
 004934      // Build new line.                                                                                              004934
 004935      sourceLine = %trim(result) + ' = %xlate('                                                                       004935
 004936                 + %trim(xlateFrom) + ':' + %trim(xlateTo) + ':'                                                      004936
 004937                 + %trim(xlateBase);                                                                                  004937
 004938      If xlateStart <> *Blanks;                                                                  B01                  004938
 004939         sourceLine = %trimr(sourceLine) + ':' + %trim(xlateStart);                               01                  004939
 004940      EndIf;                                                                                     E01                  004940
 004941      sourceLine = %trimr(sourceLine) + ');';                                                                         004941
 004942                                                                                                                      004942
 004943      // Set resulting indicators?                                                                                    004943
 004944      If lw <> *Blanks;                                                                          B01                  004944
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    157
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004945         ERRCheck = *On;                                                                          01                  004945
 004946         ERRInd = lw;                                                                             01                  004946
 004947      EndIf;                                                                                     E01                  004947
 004948                                                                                                                      004948
 004949      convert = *On;                                                                                                  004949
 004950                                                                                                                      004950
 004951   EndSr;                                                                                                             004951
 004952   //-------------------------------------------------------------------------------------------                      004952
 004953                                                                                                                      004953
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    158
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004955   //-------------------------------------------------------------------------------------------                      004955
 004956   // Convert Z-ADD.                                                                                                  004956
 004957   //-------------------------------------------------------------------------------------------                      004957
 004958   BegSr subUserCvt_Z_ADD;                                                                                            004958
 004959                                                                                                                      004959
 004960      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ';';                                                      004960
 004961                                                                                                                      004961
 004962      // Half-adjust required?                                                                                        004962
 004963      If %len(%trim(operator)) > 5;                                                              B01                  004963
 004964         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004964
 004965      EndIf;                                                                                     E01                  004965
 004966                                                                                                                      004966
 004967      convert = *On;                                                                                                  004967
 004968                                                                                                                      004968
 004969   EndSr;                                                                                                             004969
 004970   //-------------------------------------------------------------------------------------------                      004970
 004971                                                                                                                      004971
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    159
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004973   //-------------------------------------------------------------------------------------------                      004973
 004974   // Convert Z-SUB.                                                                                                  004974
 004975   //-------------------------------------------------------------------------------------------                      004975
 004976   BegSr subUserCvt_Z_SUB;                                                                                            004976
 004977                                                                                                                      004977
 004978                                                                                                                      004978
 004979      sourceLine = %trim(result) + ' = ' + %trim(factor2) + ' * -1;';                                                 004979
 004980                                                                                                                      004980
 004981      // Half-adjust required?                                                                                        004981
 004982      If %len(%trim(operator)) > 5;                                                              B01                  004982
 004983         sourceLine = 'Eval(H) ' + %trim(sourceLine);                                             01                  004983
 004984      EndIf;                                                                                     E01                  004984
 004985                                                                                                                      004985
 004986      convert = *On;                                                                                                  004986
 004987                                                                                                                      004987
 004988   EndSr;                                                                                                             004988
 004989   //-------------------------------------------------------------------------------------------                      004989
 004990                                                                                                                      004990
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    160
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 004992   //-------------------------------------------------------------------------------------------                      004992
 004993   // Check if the next line is a continuation of the current line.                                                   004993
 004994   //-------------------------------------------------------------------------------------------                      004994
 004995   BegSr subUserCheckSpan;                                                                                            004995
 004996                                                                                                                      004996
 004997      inspan = *Off;                                                                                                  004997
 004998      savedSRCDTA = SRCDTA;                                                                                           004998
 004999      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          004999
 005000      x = 0;                                                                                                          005000
 005001                                                                                                                      005001
 005002      // Is the current line a continuation line?                                                                     005002
 005003      If savedLineType = 'D';                                                                    B01                  005003
 005004         If declName <> *Blanks;                                                                 B02                  005004
 005005            If %scan('...':%trim(declOptions)) > 0;                                              B03                  005005
 005006               // Yes - so we must be in a span.                                                                      005006
 005007               inSpan = *On;                                                                      03                  005007
 005008            EndIf;                                                                               E03                  005008
 005009         EndIf;                                                                                  E02                  005009
 005010      EndIf;                                                                                     E01                  005010
 005011                                                                                                                      005011
 005012      If not inSpan;                                                                             B01                  005012
 005013         Read SRCREC;                                                                             01                  005013
 005014         DoW not %eof();                                                                         B02                  005014
 005015            x += 1;     // Keep a track of how many lines we have read.                           02                  005015
 005016                                                                                                                      005016
 005017            lineType = %xlate(lo:up:lineType);                                                    02                  005017
 005018                                                                                                                      005018
 005019            If lineType <> *Blank                                                                B03                  005019
 005020            and lineType <> savedLineType;                                                       B03                  005020
 005021               // Not a spanned line.                                                                                 005021
 005022               Leave;                                                                             03                  005022
 005023                                                                                                                      005023
 005024            ElseIf lineType = 'D'                                                                X03                  005024
 005025            and %subst(directive:1:1) <> '*';                       // D-spec and no comment     X03                  005025
 005026               If declName = *Blanks                                                             B04                  005026
 005027               and declType = *Blanks                                                            B04                  005027
 005028               and declLen = *Blanks                                                             B04                  005028
 005029               and declKeyWords <> *Blanks;                                                      B04                  005029
 005030                  //               and ((declType <> *Blanks and workDeclType = *Blanks)                              005030
 005031                  //                    or (declType <> *Blanks and declType <> workDeclType)                         005031
 005032                  //                    or (declType = *Blanks and declKeyWords <> *Blanks));                         005032
 005033                  inSpan = *On;                                                                   04                  005033
 005034               EndIf;                                                                            E04                  005034
 005035               Leave;                                                                             03                  005035
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    161
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005036                                                                                                                      005036
 005037            ElseIf lineType = 'P'                                                                X03                  005037
 005038            and %subst(directive:1:1) <> '*';                       // P-spec and no comment     X03                  005038
 005039               If declName = *Blanks                                                             B04                  005039
 005040               and (procType <> *Blanks or procKeyWords <> *Blanks);                             B04                  005040
 005041                  inSpan = *On;                                                                   04                  005041
 005042               EndIf;                                                                            E04                  005042
 005043               Leave;                                                                             03                  005043
 005044                                                                                                                      005044
 005045            ElseIf lineType = 'H'                                                                X03                  005045
 005046            and %subst(directive:1:1) = *Blank;                     // H-spec and no comment     X03                  005046
 005047               inSpan = *On;                                                                      03                  005047
 005048               Leave;                                                                             03                  005048
 005049                                                                                                                      005049
 005050            ElseIf lineType = 'C'                                                                X03                  005050
 005051            and %subst(directive:1:1) = *Blank;                      // C-spec and no comment    X03                  005051
 005052               opCode = %xlate(lo:up:opCode);                                                     03                  005052
 005053               If %subst(operator:1:4) = 'EVAL';                                                 B04                  005053
 005054                  If opCode = *Blanks and extFactor2 <> *Blanks;     // EVAL continues.          B05                  005054
 005055                     inSpan = *On;                                                                05                  005055
 005056                  EndIf;                                                                         E05                  005056
 005057                  Leave;                                                                          04                  005057
 005058               ElseIf %subst(operator:1:6) = 'CALLP';                                            X04                  005058
 005059                  If opCode = *Blanks;                               // CALLP continues.         B05                  005059
 005060                     inSpan = *On;                                                                05                  005060
 005061                  EndIf;                                                                         E05                  005061
 005062                  Leave;                                                                          04                  005062
 005063               ElseIf operator = 'IF';                               // IF Continues.            X04                  005063
 005064                  If opCode = *Blanks;                                                           B05                  005064
 005065                     inSpan = *On;                                                                05                  005065
 005066                  EndIf;                                                                         E05                  005066
 005067                  Leave;                                                                          04                  005067
 005068               ElseIf %subst(operator:1:2) = 'IF';                   // IF Continues.            X04                  005068
 005069                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005069
 005070                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005070
 005071                  or opCode = *Blanks;                                                           B05                  005071
 005072                     inSpan = *On;                                                                05                  005072
 005073                  EndIf;                                                                         E05                  005073
 005074                  Leave;                                                                          04                  005074
 005075               ElseIf %subst(operator:1:2) = 'DO';                   // DO Continues.            X04                  005075
 005076                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005076
 005077                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005077
 005078                  or opCode = *Blanks;                                                           B05                  005078
 005079                     inSpan = *On;                                                                05                  005079
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    162
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005080                  EndIf;                                                                         E05                  005080
 005081                  Leave;                                                                          04                  005081
 005082               ElseIf %subst(operator:1:4) = 'WHEN';                 // WHEN Continues.          X04                  005082
 005083                  If %subst(opCode:1:2) = 'OR'                                                   B05                  005083
 005084                  or %subst(opCode:1:3) = 'AND'                                                  B05                  005084
 005085                  or opCode = *Blanks;                                                           B05                  005085
 005086                     inSpan = *On;                                                                05                  005086
 005087                  EndIf;                                                                         E05                  005087
 005088                  Leave;                                                                          04                  005088
 005089               EndIf;                                                                            E04                  005089
 005090                                                                                                                      005090
 005091            ElseIf lineType = 'C'                                                                X03                  005091
 005092            and %subst(directive:1:1) = '+';                        // Embedded SQL              X03                  005092
 005093               inSpan = *On;                                                                      03                  005093
 005094               Leave;                                                                             03                  005094
 005095                                                                                                                      005095
 005096            ElseIf lineType = 'F'                                                                X03                  005096
 005097            and %subst(directive:1:1) <> '*';                       // F-spec and no comment     X03                  005097
 005098               If fileName = *Blanks and fileKeyWords <> *Blanks;                                B04                  005098
 005099                  inSpan = *On;                                                                   04                  005099
 005100               EndIf;                                                                            E04                  005100
 005101               Leave;                                                                             03                  005101
 005102                                                                                                                      005102
 005103            ElseIf %subst(directive:1:1) = '/';          // Directive, so line must end here.    X03                  005103
 005104               Leave;                                                                             03                  005104
 005105               //            ElseIf lineType = ' '                                                                    005105
 005106               //            and opCode <> *Blanks;                                                                   005106
 005107             //               Leave;                                       // Free-format line.                       005107
 005108            EndIf;                                                                               E03                  005108
 005109                                                                                                                      005109
 005110            Read SRCREC;                                                                          02                  005110
 005111         EndDo;                                                                                  E02                  005111
 005112      EndIf;                                                                                     E01                  005112
 005113                                                                                                                      005113
 005114      // End of file breaks the logic!  We need to reposition to the last record before                               005114
 005115      // continuing.                                                                                                  005115
 005116      If %eof(QRPGLESRC);                                                                        B01                  005116
 005117         SetGT *HIVAL SRCREC;                                                                     01                  005117
 005118         ReadP SRCREC;                                                                            01                  005118
 005119      EndIf;                                                                                     E01                  005119
 005120                                                                                                                      005120
 005121      // Return to the previous point.                                                                                005121
 005122      For i = 1 to x;                                                                            B01                  005122
 005123         ReadP SRCREC;                                                                            01                  005123
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    163
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005124      EndFor;                                                                                    E01                  005124
 005125                                                                                                                      005125
 005126      SRCDTA = savedSRCDTA;                                                                                           005126
 005127                                                                                                                      005127
 005128   EndSr;                                                                                                             005128
 005129   //-------------------------------------------------------------------------------------------                      005129
 005130                                                                                                                      005130
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    164
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005132   //-------------------------------------------------------------------------------------------                      005132
 005133   // Get the type of declaration encountered - it may not be on the current line!                                    005133
 005134   //-------------------------------------------------------------------------------------------                      005134
 005135   BegSr subUserGetDeclarationType;                                                                                   005135
 005136                                                                                                                      005136
 005137      // Start with what we've got.                                                                                   005137
 005138      If declSuffix  = ' '                                                                       B01                  005138
 005139      and (declPrefix = ' '                                                                      B01                  005139
 005140      or declPrefix = 'U' or declPrefix = 'S');                                                  B01                  005140
 005141         workDeclType = %xlate(lo:up:declType);                                                   01                  005141
 005142         savedName = %trim(declName);                                                             01                  005142
 005143      Else;                                                                                      X01                  005143
 005144         workDeclType = *Blank;                                                                   01                  005144
 005145         savedName = %trim(%subst(fullLine:1:74));                                                01                  005145
 005146      EndIf;                                                                                     E01                  005146
 005147                                                                                                                      005147
 005148      // If we already have the declaration type, then stop.                                                          005148
 005149      If workDeclType = 'S'                                                                      B01                  005149
 005150      or workDeclType = 'DS'                                                                     B01                  005150
 005151      or workDeclType = 'C'                                                                      B01                  005151
 005152      or workDeclType = 'B'                                                                      B01                  005152
 005153      or workDeclType = 'E'                                                                      B01                  005153
 005154      or workDeclType = 'PR'                                                                     B01                  005154
 005155      or workDeclType = 'PI'                                                                     B01                  005155
 005156      or workDeclType = *Blanks and inPrototype;                                                 B01                  005156
 005157         workDeclLine = SRCSEQ;                                                                   01                  005157
 005158         LeaveSr;                                                                                 01                  005158
 005159      EndIf;                                                                                     E01                  005159
 005160                                                                                                                      005160
 005161      savedSRCDTA = SRCDTA;                                                                                           005161
 005162      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005162
 005163      x = 0;                                                                                                          005163
 005164      workDeclLine = 0;                                                                                               005164
 005165                                                                                                                      005165
 005166      //      // Name of the variable/routine should be on this line.                                                 005166
 005167      //      savedName = %trim(declOptions);                                                                         005167
 005168                                                                                                                      005168
 005169      // Trim any ellipsis from the name as this is not valid in free-form.                                           005169
 005170      x = %scan('...':savedName);                                                                                     005170
 005171      If x > 0;                                                                                  B01                  005171
 005172         savedName = %subst(savedName:1:x-1);                                                     01                  005172
 005173         x = 0;                                                                                   01                  005173
 005174      EndIf;                                                                                     E01                  005174
 005175                                                                                                                      005175
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    165
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005176      // Read ahead to find the next line with a declaration type.                                                    005176
 005177      Read SRCREC;                                                                                                    005177
 005178      DoW not %eof();                                                                            B01                  005178
 005179         x += 1;     // Keep a track of how many lines we have read.                              01                  005179
 005180                                                                                                                      005180
 005181         lineType = %xlate(lo:up:lineType);                                                       01                  005181
 005182                                                                                                                      005182
 005183         If lineType <> savedLineType;                                                           B02                  005183
 005184            // End of this declaration.                                                                               005184
 005185            Leave;                                                                                02                  005185
 005186         EndIf;                                                                                  E02                  005186
 005187                                                                                                                      005187
 005188         If declType <> *Blanks;                                                                 B02                  005188
 005189            workDeclType = %xlate(lo:up:declType);                                                02                  005189
 005190            workDeclLine = SRCSEQ;                                                                02                  005190
 005191            Leave;                                                                                02                  005191
 005192         EndIf;                                                                                  E02                  005192
 005193                                                                                                                      005193
 005194         Read SRCREC;                                                                             01                  005194
 005195      EndDo;                                                                                     E01                  005195
 005196                                                                                                                      005196
 005197      // End of file breaks the logic!  We need to reposition to the last record before                               005197
 005198      // continuing.                                                                                                  005198
 005199      If %eof(QRPGLESRC);                                                                        B01                  005199
 005200         SetGT *HIVAL SRCREC;                                                                     01                  005200
 005201         ReadP SRCREC;                                                                            01                  005201
 005202      EndIf;                                                                                     E01                  005202
 005203                                                                                                                      005203
 005204      // Return to the previous point.                                                                                005204
 005205      For i = 1 to x;                                                                            B01                  005205
 005206         ReadP SRCREC;                                                                            01                  005206
 005207      EndFor;                                                                                    E01                  005207
 005208                                                                                                                      005208
 005209      SRCDTA = savedSRCDTA;                                                                                           005209
 005210                                                                                                                      005210
 005211   EndSr;                                                                                                             005211
 005212   //-------------------------------------------------------------------------------------------                      005212
 005213                                                                                                                      005213
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    166
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005215   //-------------------------------------------------------------------------------------------                      005215
 005216   // Get the line number at which the current structure ends.                                                        005216
 005217   //-------------------------------------------------------------------------------------------                      005217
 005218   BegSr subUserGetEndLine;                                                                                           005218
 005219                                                                                                                      005219
 005220      savedSRCDTA = SRCDTA;                                                                                           005220
 005221      endLine = 0;                                                                                                    005221
 005222      endFound = *Off;                                                                                                005222
 005223                                                                                                                      005223
 005224      // Read ahead to find the start of the next declaration.                                                        005224
 005225      Read SRCREC;                                                                                                    005225
 005226      x = 1;                                                                                                          005226
 005227      DoW not %eof();                                                                            B01                  005227
 005228         If lineType <> *Blanks                                                                  B02                  005228
 005229         and %xlate(lo:up:lineType) <> workLineType;                                             B02                  005229
 005230            // We've found a different line type.                                                                     005230
 005231            Leave;                                                                                02                  005231
 005232         Else;                                                                                   X02                  005232
 005233            If %len(%trim(codeLine)) >= 4;                                                       B03                  005233
 005234               If %xlate(lo:up:%subst(codeLine:1:4)) = 'DCL-';                                   B04                  005234
 005235                  // We've found a different line type.                                                               005235
 005236                  Leave;                                                                          04                  005236
 005237               EndIf;                                                                            E04                  005237
 005238            EndIf;                                                                               E03                  005238
 005239         EndIf;                                                                                  E02                  005239
 005240                                                                                                                      005240
 005241         If codeLine = *Blanks;                                                                  B02                  005241
 005242            // Ignore empty lines.                                                                                    005242
 005243   //      ElseIf %subst(directive:1:1) = '/';                                                                        005243
 005244   //         // Ignore directives.                                                                                   005244
 005245         ElseIf %subst(directive:2:1) = '*'                                                      X02                  005245
 005246             or %len(%trim(codeLine)) >= 2                                                       X02                  005246
 005247            and %subst(%trim(codeLine):1:2) = '//';                                              X02                  005247
 005248            // Ignore comment.                                                                                        005248
 005249         ElseIf inSpan                                                                           X02                  005249
 005250            and declName = *Blanks                                                               X02                  005250
 005251            and SRCSEQ = workDeclLine;                                                           X02                  005251
 005252            // Ignore the curent declaration.                                                                         005252
 005253         ElseIf declType = *Blanks                                                               X02                  005253
 005254            and (declLen <> *Blanks or declKeywords <> *Blanks);                                 X02                  005254
 005255            // Ignore sub-field definition.                                                                           005255
 005256         ElseIf declType = *Blanks                                                               X02                  005256
 005257            and declName <> *Blanks                                                              X02                  005257
 005258            and %scan('...':declOptions) = 0;                                                    X02                  005258
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    167
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005259            // Ignore sub-field definition.                                                                           005259
 005260         ElseIf %scan('...':declOptions) > 0;                                                    X02                  005260
 005261            // We have a continuation line, but is it a sub-field or a new                                            005261
 005262            // delcaration?                                                                                           005262
 005263            GetDeclarationType(tempDeclType                                                       02                  005263
 005264                              :tempSavedName                                                      02                  005264
 005265                              :tempDeclLine);                                                     02                  005265
 005266            If tempDeclType <> *Blanks;                                                          B03                  005266
 005267               // We've hit the next declaration or code.                                                             005267
 005268               Leave;                                                                             03                  005268
 005269            EndIf;                                                                               E03                  005269
 005270         Else;                                                                                   X02                  005270
 005271            // We've hit the next declaration or code.                                                                005271
 005272            Leave;                                                                                02                  005272
 005273         EndIf;                                                                                  E02                  005273
 005274                                                                                                                      005274
 005275         Read SRCREC;                                                                             01                  005275
 005276         x += 1;     // Keep a track of how many lines we have read.                              01                  005276
 005277      EndDo;                                                                                     E01                  005277
 005278                                                                                                                      005278
 005279      // We are now at the start of the next declaration.                                                             005279
 005280      endLine = SRCSEQ;                                                                                               005280
 005281                                                                                                                      005281
 005282      // End of file breaks the logic!  We need to reposition to the last record before                               005282
 005283      // continuing.                                                                                                  005283
 005284      If %eof(QRPGLESRC);                                                                        B01                  005284
 005285         SetGT *HIVAL SRCREC;                                                                     01                  005285
 005286         //ReadP SRCREC;                                                                                              005286
 005287      EndIf;                                                                                     E01                  005287
 005288                                                                                                                      005288
 005289      // Return to the previous point.                                                                                005289
 005290      For i = 1 to x;                                                                            B01                  005290
 005291         ReadP SRCREC;                                                                            01                  005291
 005292                                                                                                                      005292
 005293         // Move the end point for blank lines or comments.                                                           005293
 005294         If not endFound;                                                                        B02                  005294
 005295            If (lineType = *Blanks                                                               B03                  005295
 005296            or %subst(directive:1:1) = '*'                                                       B03                  005296
 005297            or %subst(directive:1:2) = '//'                                                      B03                  005297
 005298            or (%len(%trim(codeLine)) > 0                                                        B03                  005298
 005299            and %subst(%trim(codeLine):1:2) = '//'));                                            B03                  005299
 005300               //            and %subst(directive:1:1) <> '/';                                                        005300
 005301            Else;                                                                                X03                  005301
 005302               endFound = *On;                                                                    03                  005302
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    168
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005303               endLine = SRCSEQ;                                                                  03                  005303
 005304            EndIf;                                                                               E03                  005304
 005305         EndIf;                                                                                  E02                  005305
 005306      EndFor;                                                                                    E01                  005306
 005307                                                                                                                      005307
 005308      SRCDTA = savedSRCDTA;                                                                                           005308
 005309                                                                                                                      005309
 005310   EndSr;                                                                                                             005310
 005311   //-------------------------------------------------------------------------------------------                      005311
 005312                                                                                                                      005312
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    169
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005314   //-------------------------------------------------------------------------------------------                      005314
 005315   // Move field definitions to D-specs.                                                                              005315
 005316   //-------------------------------------------------------------------------------------------                      005316
 005317   BegSr subUserMoveDefs;                                                                                             005317
 005318                                                                                                                      005318
 005319      codeStart = SRCSEQ;   // Save the start of the source.                                                          005319
 005320      savedSRCDTA = SRCDTA;                                                                                           005320
 005321                                                                                                                      005321
 005322      Clear movedDefs;                                                                                                005322
 005323      Reset DCLS;                                                                                                     005323
 005324                                                                                                                      005324
 005325      // Read through the source and create a D-spec for every field definition found.                                005325
 005326      DoW not %eof(QRPGLESRC);                                                                   B01                  005326
 005327         // Stop if we hit either the start or end of a procedure (to preserve local                                  005327
 005328         // definitions of variables).                                                                                005328
 005329         If lineType = 'P'                                                                       B02                  005329
 005330         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005330
 005331                                                      = 'DCL-PROC'                               B02                  005331
 005332         or %xlate(lo:up:%subst(%trim(codeLine) + '        ':1:8))                               B02                  005332
 005333                                                      = 'END-PROC';                              B02                  005333
 005334            Leave;                                                                                02                  005334
 005335         EndIf;                                                                                  E02                  005335
 005336                                                                                                                      005336
 005337         If %xlate(lo:up:lineType) = 'C'                                                         B02                  005337
 005338         and %subst(directive:1:1) = ' ';                                                        B02                  005338
 005339            opCode = %xlate(lo:up:opCode);                                                        02                  005339
 005340            // C-Spec with a size definition.                                                                         005340
 005341            If opCode <> *Blanks                                                                 B03                  005341
 005342            and %subst(opCode:1:4) <> 'EVAL'                                                     B03                  005342
 005343            and opCode <> 'IF'                                                                   B03                  005343
 005344            and opCode <> 'WHEN'                                                                 B03                  005344
 005345            and opCode <> 'DOW'                                                                  B03                  005345
 005346            and opCode <> 'DOU'                                                                  B03                  005346
 005347            and opCode <> 'DSPLY'                                                                B03                  005347
 005348            and opCode <> 'CALLP'                                                                B03                  005348
 005349            and (len <> *Blanks or opCode = 'DEFINE');                                           B03                  005349
 005350               moveDef = *Off;                                                                    03                  005350
 005351               // Only do if not already moved.                                                                       005351
 005352               If %lookup(%xlate(lo:up:result):movedDefs) = 0;                                   B04                  005352
 005353                  Reset DCLS;                                                                     04                  005353
 005354                  // In-line definition.                                                                              005354
 005355                  If len <> *Blanks                                                              B05                  005355
 005356                  and %scan('+':len) = 0 and %scan('-':len) = 0;                                 B05                  005356
 005357                     moveDef = *On;                                                               05                  005357
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    170
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005358                     DCLS.fieldName = result;                                                     05                  005358
 005359                     If dec = *Blanks;                                                           B06                  005359
 005360                        DCLS.type = '     Char';                                                  06                  005360
 005361                     Else;                                                                       X06                  005361
 005362                        DCLS.type = '   Packed';                                                  06                  005362
 005363                     EndIf;                                                                      E06                  005363
 005364                     DCLS.definition = '(' + %trim(len);                                          05                  005364
 005365                     If dec <> *Blanks;                                                          B06                  005365
 005366                        DCLS.definition = %trimr(DCLS.definition)                                 06                  005366
 005367                                        + ':' + %trim(dec);                                       06                  005367
 005368                     EndIf;                                                                      E06                  005368
 005369                     DCLS.definition = %trimr(DCLS.definition) + ')';                             05                  005369
 005370                  EndIf;                                                                         E05                  005370
 005371                                                                                                                      005371
 005372                  // *LIKE Definition                                                                                 005372
 005373                  If %xlate(lo:up:opCode) = 'DEFINE';                                            B05                  005373
 005374                     moveDef = *On;                                                               05                  005374
 005375                     DCLS.fieldName = result;                                                     05                  005375
 005376                     If %xlate(lo:up:factor1) = '*LIKE';                                         B06                  005376
 005377                        %subst(DCLS.definition:8)                                                 06                  005377
 005378                                    = 'LIKE(' + %trimr(factor2);                                  06                  005378
 005379                        // Length adjustment?                                                                         005379
 005380                        If %scan('+':len) > 0 or %scan('-':len) > 0;                             B07                  005380
 005381                           len = %scanrpl(' ':'':len);                                            07                  005381
 005382                           DCLS.definition = %trimr(DCLS.definition)                              07                  005382
 005383                                           + ':' + %trim(len);                                    07                  005383
 005384                        EndIf;                                                                   E07                  005384
 005385                        DCLS.definition = %trimr(DCLS.definition) + ')';                          06                  005385
 005386                     Else;                                                                       X06                  005386
 005387                        If %xlate(lo:up:%trim(factor2)) = '*LDA';                                B07                  005387
 005388                           DCLS.definition = %trimr(DCLS.definition)                              07                  005388
 005389                                 + ' DTAARA(' + %trimr(factor2) + ')';                            07                  005389
 005390                        Else;                                                                    X07                  005390
 005391                           DCLS.definition = %trimr(DCLS.definition)                              07                  005391
 005392                             + ' DTAARA(''' + %trimr(factor2) + ''')';                            07                  005392
 005393                        EndIf;                                                                   E07                  005393
 005394                     EndIf;                                                                      E06                  005394
 005395                  EndIf;                                                                         E05                  005395
 005396                                                                                                                      005396
 005397                  If moveDef;                                                                    B05                  005397
 005398                     // Put any additional keywords needed here!                                                      005398
 005399                     DCLS.definition = %trimr(DCLS.definition) + ';';                             05                  005399
 005400                     If comment <> *Blanks;                                                      B06                  005400
 005401                        DCLS.comment = '// ' + comment;                                           06                  005401
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    171
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005402                     EndIf;                                                                      E06                  005402
 005403                                                                                                                      005403
 005404                     // Store the moved definition.                                                                   005404
 005405                     x = %lookup(' ':movedDefs);                                                  05                  005405
 005406                     movedDefs(x) = %xlate(lo:up:result);                                         05                  005406
 005407                  EndIf;                                                                         E05                  005407
 005408               EndIf;                                                                            E04                  005408
 005409            EndIf;                                                                               E03                  005409
 005410         EndIf;                                                                                  E02                  005410
 005411                                                                                                                      005411
 005412         // Anything to output?                                                                                       005412
 005413         If DCLS.fieldName <> *Blanks;                                                           B02                  005413
 005414            DCLS.decl = 'Dcl-S ';                                                                 02                  005414
 005415            If not defsMoved;                                                                    B03                  005415
 005416               // Log start of moved field block;                                                                     005416
 005417               SRCDTA = *Blanks;                                                                  03                  005417
 005418               codeLine = Qcomments(1);                                                           03                  005418
 005419               Exsr subUserWriteLine;                                                             03                  005419
 005420               codeLine = Qcomments(2);                                                           03                  005420
 005421               Exsr subUserWriteLine;                                                             03                  005421
 005422               codeLine = Qcomments(1);                                                           03                  005422
 005423               Exsr subUserWriteLine;                                                             03                  005423
 005424               defsMoved = *On;                                                                   03                  005424
 005425            EndIf;                                                                               E03                  005425
 005426                                                                                                                      005426
 005427            lineType = ' ';                                                                       02                  005427
 005428            codeLine = DCLS;                                                                      02                  005428
 005429            countMoved += 1;                                                                      02                  005429
 005430            Clear DCLS.fieldName;                                                                 02                  005430
 005431                                                                                                                      005431
 005432            Exsr subUserWriteLine;                                                                02                  005432
 005433         EndIf;                                                                                  E02                  005433
 005434                                                                                                                      005434
 005435         Read QRPGLESRC;                                                                          01                  005435
 005436      EndDo;                                                                                     E01                  005436
 005437                                                                                                                      005437
 005438      If defsMoved;                                                                              B01                  005438
 005439         // Log end of moved field block;                                                                             005439
 005440         SRCDTA = *Blanks;                                                                        01                  005440
 005441         codeLine = Qcomments(1);                                                                 01                  005441
 005442         Exsr subUserWriteLine;                                                                   01                  005442
 005443         codeLine = Qcomments(3);                                                                 01                  005443
 005444         Exsr subUserWriteLine;                                                                   01                  005444
 005445         codeLine = Qcomments(1);                                                                 01                  005445
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    172
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005446         Exsr subUserWriteLine;                                                                   01                  005446
 005447      EndIf;                                                                                     E01                  005447
 005448                                                                                                                      005448
 005449      // Reposition source file pointer to the start of the source again.                                             005449
 005450      Close QRPGLESRC;                                                                                                005450
 005451      Open QRPGLESRC;                                                                                                 005451
 005452      Read SRCREC;                                                                                                    005452
 005453      DoW SRCSEQ <> codeStart;                                                                   B01                  005453
 005454         Read SRCREC;                                                                             01                  005454
 005455      EndDo;                                                                                     E01                  005455
 005456                                                                                                                      005456
 005457      defsMoved = *On;                                                                                                005457
 005458      SRCDTA = savedSRCDTA;                                                                                           005458
 005459                                                                                                                      005459
 005460   EndSr;                                                                                                             005460
 005461   //-------------------------------------------------------------------------------------------                      005461
 005462                                                                                                                      005462
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    173
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005464   //-------------------------------------------------------------------------------------------                      005464
 005465   // Output the current line.                                                                                        005465
 005466   //-------------------------------------------------------------------------------------------                      005466
 005467   BegSr subUserWriteLine;                                                                                            005467
 005468                                                                                                                      005468
 005469      countTarget += 1;                                                                                               005469
 005470                                                                                                                      005470
 005471      Write OUTREC;                                                                                                   005471
 005472      //Except OUTREC;                                                                                                005472
 005473                                                                                                                      005473
 005474   EndSr;                                                                                                             005474
 005475   //-------------------------------------------------------------------------------------------                      005475
 005476                                                                                                                      005476
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    174
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005478   //-------------------------------------------------------------------------------------------                      005478
 005479   // Exit the program directly.                                                                                      005479
 005480   //-------------------------------------------------------------------------------------------                      005480
 005481   BegSr subExitProgram;                                                                                              005481
 005482                                                                                                                      005482
 005483      Exsr subUserExitProgram;     // Perform any user-specified exit processing.                                     005483
 005484                                                                                                                      005484
 005485      // If commitment control is active, a commit should have been done if everything                                005485
 005486      // was OK, so issue a rollback here to catch and remove any uncommitted changes.                                005486
 005487      If cfgCommitControl = '*MASTER';                                                           B01                  005487
 005488         RolBk;                                                                                   01                  005488
 005489      EndIf;                                                                                     E01                  005489
 005490                                                                                                                      005490
 005491      If cfgCloseDown = 'Y';                                                                     B01                  005491
 005492         *INLR = *On;                  // Close down the program.                                 01                  005492
 005493      EndIf;                                                                                     E01                  005493
 005494                                                                                                                      005494
 005495      Return;                          // Exit the program.                                                           005495
 005496                                                                                                                      005496
 005497   EndSr;                                                                                                             005497
 005498   //-------------------------------------------------------------------------------------------                      005498
 005499                                                                                                                      005499
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    175
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005501   //-------------------------------------------------------------------------------------------                      005501
 005502   // USER: Exit processing.                                                                                          005502
 005503   //-------------------------------------------------------------------------------------------                      005503
 005504   BegSr subUserExitProgram;                                                                                          005504
 005505                                                                                                                      005505
 005506      // ** Place any program-specific exit code here.                                                                005506
 005507      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005507
 005508                                                                                                                      005508
 005509      If QpShutDown <> 'Y';                                                                      B01                  005509
 005510         Close QRPGLESRC;                                                                         01                  005510
 005511         Close QRPGLESRC2;                                                                        01                  005511
 005512      EndIf;                                                                                     E01                  005512
 005513                                                                                                                      005513
 005514      If QpShutDown = 'Y' and initialCall <> 'Y';                                                B01                  005514
 005515         cfgCloseDown = 'Y';                                                                      01                  005515
 005516         Write Z1ENDRPT;                                                                          01                  005516
 005517         Close CVTRPGFREP;                                                                        01                  005517
 005518      EndIf;                                                                                     E01                  005518
 005519                                                                                                                      005519
 005520      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005520
 005521                                                                                                                      005521
 005522   EndSr;                                                                                                             005522
 005523   //-------------------------------------------------------------------------------------------                      005523
 005524                                                                                                                      005524
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    176
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005526   //-------------------------------------------------------------------------------------------                      005526
 005527   // Initialisation                                                                                                  005527
 005528   //-------------------------------------------------------------------------------------------                      005528
 005529   BegSr subInitialise;                                                                                               005529
 005530                                                                                                                      005530
 005531      // Flag initial call.                                                                                           005531
 005532      If initialCall = *Blank;                                                                   B01                  005532
 005533         initialCall = 'Y';                                                                       01                  005533
 005534      Else;                                                                                      X01                  005534
 005535         initialCall = 'N';                                                                       01                  005535
 005536      EndIf;                                                                                     E01                  005536
 005537                                                                                                                      005537
 005538      // Perform user-specified intialisation processing.                                                             005538
 005539      Exsr subUserInitialise;                                                                                         005539
 005540                                                                                                                      005540
 005541   EndSr;                                                                                                             005541
 005542   //-------------------------------------------------------------------------------------------                      005542
 005543                                                                                                                      005543
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    177
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005545   //-------------------------------------------------------------------------------------------                      005545
 005546   // USER: Initialisation                                                                                            005546
 005547   //-------------------------------------------------------------------------------------------                      005547
 005548   BegSr subUserInitialise;                                                                                           005548
 005549                                                                                                                      005549
 005550      // Set configuration/processing options:                                                                        005550
 005551      cfgCommitControl   = '*NONE  '; // Commitment control setting: *MASTER/*SLAVE                                   005551
 005552      cfgCloseDown       = 'N';       // Close down the program on exit?                                              005552
 005553                                                                                                                      005553
 005554                                                                                                                      005554
 005555      // >>>>> Start of User-Point >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>                         005555
 005556                                                                                                                      005556
 005557      // Shut down?                                                                                                   005557
 005558      If QpShutDown = 'Y';                                                                       B01                  005558
 005559         Exsr subExitProgram;                                                                     01                  005559
 005560      EndIf;                                                                                     E01                  005560
 005561                                                                                                                      005561
 005562      // Open audit report.                                                                                           005562
 005563      If initialCall = 'Y';                                                                      B01                  005563
 005564         Open CVTRPGFREP;                                                                         01                  005564
 005565         Z1QTTL = 'RPG/ILE to Free-Format Conversion Report';                                     01                  005565
 005566         overflow = *On;                                                                          01                  005566
 005567      EndIf;                                                                                     E01                  005567
 005568                                                                                                                      005568
 005569      fromFileLib = %trim(QpFromLib) + '/' + %trim(QpFromFile);                                                       005569
 005570      Open QRPGLESRC;                                                                                                 005570
 005571                                                                                                                      005571
 005572      toFileLib = %trim(QpToLib) + '/' + %trim(QpToFile);                                                             005572
 005573      Open QRPGLESRC2;                                                                                                005573
 005574                                                                                                                      005574
 005575      Reset countSource;                                                                                              005575
 005576      Reset countTarget;                                                                                              005576
 005577      Reset countEligible;                                                                                            005577
 005578      Reset countConv;                                                                                                005578
 005579      Reset CountNotConv;                                                                                             005579
 005580                                                                                                                      005580
 005581      Reset maxIndent;                                                                                                005581
 005582      Reset movedDefs;                                                                                                005582
 005583      Reset moveDef;                                                                                                  005583
 005584      Reset inCode;                                                                                                   005584
 005585      Reset inArrayData;                                                                                              005585
 005586      Reset indentCount;                                                                                              005586
 005587                                                                                                                      005587
 005588      indentCount = mainlineIndent;                                                                                   005588
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    178
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005589                                                                                                                      005589
 005590      // <<<<< End of User-Point   <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<                         005590
 005591                                                                                                                      005591
 005592   EndSr;                                                                                                             005592
 005593   //-------------------------------------------------------------------------------------------                      005593
 005594   //===========================================================================================                      005594
 005595                                                                                                                      005595
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    179
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005597   //==========================================================================================                       005597
 005598   // Get the type of declaration encountered - it may not be on the current line!                                    005598
 005599   //==========================================================================================                       005599
 000001=OOUTREC                                                                                                             2000001
         *--------------------------------------------------------------------------------------------*                     2
         * RPG record format  . . . . :  OUTREC                                                       *                     2
         * External format  . . . . . :  QRPGLESRC2 : CVTRPGFREE/QRPGLESRC2                           *                     2
         *--------------------------------------------------------------------------------------------*                     2
 000002=O                       SRCSEQ               6S ZONE      6,2                                                       2000002
 000003=O                       SRCDAT              12S ZONE      6,0                                                       2000003
 000004=O                       SRCDTA             112A CHAR      100                                                       2000004
 000001=OZ1PAGHDG                                                                                                           3000001
         *--------------------------------------------------------------------------------------------*                     3
         * RPG record format  . . . . :  Z1PAGHDG                                                     *                     3
         * External format  . . . . . :  Z1PAGHDG : CVTRPGFREE/CVTRPGFREP                             *                     3
         *--------------------------------------------------------------------------------------------*                     3
 000002=O                       Z1QPGM              10A CHAR       10                                                       3000002
 000003=O                       Z1QUSR              20A CHAR       10                                                       3000003
 000004=O                       Z1QTTL              60A CHAR       40                                                       3000004
 000005=O                       Z1QPAG              64S ZONE      4,0                                                       3000005
 000001=OZ1TOPPAG                                                                                                           4000001
         *--------------------------------------------------------------------------------------------*                     4
         * RPG record format  . . . . :  Z1TOPPAG                                                     *                     4
         * External format  . . . . . :  Z1TOPPAG : CVTRPGFREE/CVTRPGFREP                             *                     4
         *--------------------------------------------------------------------------------------------*                     4
 000002=O                       ZTFRFL              21A CHAR       21                                                       4000002
 000003=O                       ZTTOFL              42A CHAR       21                                                       4000003
 000001=OZL01HDG                                                                                                            5000001
         *--------------------------------------------------------------------------------------------*                     5
         * RPG record format  . . . . :  ZL01HDG                                                      *                     5
         * External format  . . . . . :  ZL01HDG : CVTRPGFREE/CVTRPGFREP                              *                     5
         *--------------------------------------------------------------------------------------------*                     5
 000001=OZ1DETAIL                                                                                                           6000001
         *--------------------------------------------------------------------------------------------*                     6
         * RPG record format  . . . . :  Z1DETAIL                                                     *                     6
         * External format  . . . . . :  Z1DETAIL : CVTRPGFREE/CVTRPGFREP                             *                     6
         *--------------------------------------------------------------------------------------------*                     6
 000002=O                       Z1FRMB              10A CHAR       10                                                       6000002
 000003=O                       Z1TOMB              20A CHAR       10                                                       6000003
 000004=O                       Z1CTSC              27S ZONE      7,0                                                       6000004
 000005=O                       Z1CTTG              34S ZONE      7,0                                                       6000005
 000006=O                       Z1CTMV              41S ZONE      7,0                                                       6000006
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    180
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 000007=O                       Z1CTEL              48S ZONE      7,0                                                       6000007
 000008=O                       Z1CTCV              55S ZONE      7,0                                                       6000008
 000009=O                       Z1CTNV              62S ZONE      7,0                                                       6000009
 000010=O                       Z1CNVR              67S ZONE      5,2                                                       6000010
 000001=OZ1ENDRPT                                                                                                           7000001
         *--------------------------------------------------------------------------------------------*                     7
         * RPG record format  . . . . :  Z1ENDRPT                                                     *                     7
         * External format  . . . . . :  Z1ENDRPT : CVTRPGFREE/CVTRPGFREP                             *                     7
         *--------------------------------------------------------------------------------------------*                     7
 005600   Dcl-Proc GetDeclarationType;                                                                                       005600
 005601                                                                                                                      005601
 005602   // -- Procedure Interface ------------------------------------------------------------------                       005602
 005603   Dcl-PI GetDeclarationType;                                                                                         005603
 005604      QpDeclType               Char( 2 );                                                                             005604
 005605      QpSavedName              Char( 80 );                                                                            005605
 005606      QpDeclLine                        Like(SRCSEQ);                                                                 005606
 005607   End-PI;                                                                                                            005607
 005608                                                                                                                      005608
 005609   // -- Data Structures ----------------------------------------------------------------------                       005609
 005610                                                                                                                      005610
 005611   // -- Variables ----------------------------------------------------------------------------                       005611
 005612   Dcl-S savedLineType        Char(  1 );                                                                             005612
 005613   Dcl-S x                  Packed( 3:0 );                                                                            005613
 005614   Dcl-S savedSRCDTA          Char( 100 );                                                                            005614
 005615                                                                                                                      005615
 005616   //-------------------------------------------------------------------------------------------                      005616
 005617                                                                                                                      005617
 005618      // Start with what we've got.                                                                                   005618
 005619      If ((declExt = ' ' and declPrefix  = ' ')                                                  B01                  005619
 005620      or declPrefix = 'S' or declPrefix = 'U')                                                   B01                  005620
 005621      and declSuffix = ' ';                                                                      B01                  005621
 005622         QpDeclType = %xlate(lo:up:declType);                                                     01                  005622
 005623         QpSavedName = %trim(declName);                                                           01                  005623
 005624      Else;                                                                                      X01                  005624
 005625         QpDeclType = *Blank;                                                                     01                  005625
 005626         QpSavedName = %trim(%subst(fullLine:1:74));                                              01                  005626
 005627      EndIf;                                                                                     E01                  005627
 005628                                                                                                                      005628
 005629      x = %scan(' ':QpSavedName);                                                                                     005629
 005630      If x > 1;                                                                                  B01                  005630
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    181
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005631         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005631
 005632      EndIf;                                                                                     E01                  005632
 005633                                                                                                                      005633
 005634      // If we already have the declaration type, then stop.                                                          005634
 005635      If QpDeclType = 'S'                                                                        B01                  005635
 005636      or QpDeclType = 'DS'                                                                       B01                  005636
 005637      or QpDeclType = 'C'                                                                        B01                  005637
 005638      or QpDeclType = 'B'                                                                        B01                  005638
 005639      or QpDeclType = 'E'                                                                        B01                  005639
 005640      or QpDeclType = 'PR'                                                                       B01                  005640
 005641      or QpDeclType = 'PI'                                                                       B01                  005641
 005642      or QpDeclType = *Blanks and inPrototype;                                                   B01                  005642
 005643         QpDeclLine = SRCSEQ;                                                                     01                  005643
 005644         Return;                                                                                  01                  005644
 005645      EndIf;                                                                                     E01                  005645
 005646                                                                                                                      005646
 005647      savedSRCDTA = SRCDTA;                                                                                           005647
 005648      savedLineType = %xlate(lo:up:lineType);      // Save current line type for comparison.                          005648
 005649      x = 0;                                                                                                          005649
 005650      QpDeclLine = 0;                                                                                                 005650
 005651                                                                                                                      005651
 005652      //   // Name of the variable/routine should be on this line.                                                    005652
 005653      //   savedName = %trim(declOptions);                                                                            005653
 005654                                                                                                                      005654
 005655      // Trim any ellipsis from the name as this is not valid in free-form.                                           005655
 005656      x = %scan('...':QpSavedName);                                                                                   005656
 005657      If x > 0;                                                                                  B01                  005657
 005658         QpSavedName = %subst(QpSavedName:1:x-1);                                                 01                  005658
 005659         x = 0;                                                                                   01                  005659
 005660      ElseIf declFrom <> *Blanks                                                                 X01                  005660
 005661          or declLen <> *Blanks                                                                  X01                  005661
 005662          or declOptions <> *BLanks;                                                             X01                  005662
 005663         // It's not a declaration - it's a subfield.                                                                 005663
 005664         QpDeclType = %xlate(lo:up:declType);                                                     01                  005664
 005665         QpDeclLine = SRCSEQ;                                                                     01                  005665
 005666         Return;                                                                                  01                  005666
 005667      EndIf;                                                                                     E01                  005667
 005668                                                                                                                      005668
 005669      // Read ahead to find the next line with a declaration type.                                                    005669
 005670      Read SRCREC;                                                                                                    005670
 005671      DoW not %eof();                                                                            B01                  005671
 005672         x += 1;     // Keep a track of how many lines we have read.                              01                  005672
 005673                                                                                                                      005673
 005674         lineType = %xlate(lo:up:lineType);                                                       01                  005674
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    182
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005675                                                                                                                      005675
 005676         If lineType <> savedLineType;                                                           B02                  005676
 005677            // End of this declaration.                                                                               005677
 005678            Leave;                                                                                02                  005678
 005679         EndIf;                                                                                  E02                  005679
 005680                                                                                                                      005680
 005681         If declType <> *Blanks;                                                                 B02                  005681
 005682            // We have found the declaration.                                                                         005682
 005683            QpDeclType = %xlate(lo:up:declType);                                                  02                  005683
 005684            QpDeclLine = SRCSEQ;                                                                  02                  005684
 005685            Leave;                                                                                02                  005685
 005686         ElseIf declFrom <> *Blanks                                                              X02                  005686
 005687             or declLen <> *Blanks                                                               X02                  005687
 005688             or declOptions <> *BLanks;                                                          X02                  005688
 005689            // It's not a declaration - it's a subfield.                                                              005689
 005690            QpDeclType = %xlate(lo:up:declType);                                                  02                  005690
 005691            QpDeclLine = SRCSEQ;                                                                  02                  005691
 005692            Leave;                                                                                02                  005692
 005693         EndIf;                                                                                  E02                  005693
 005694                                                                                                                      005694
 005695         Read SRCREC;                                                                             01                  005695
 005696      EndDo;                                                                                     E01                  005696
 005697                                                                                                                      005697
 005698      // End of file breaks the logic!  We need to reposition to the last record before                               005698
 005699      // continuing.                                                                                                  005699
 005700      If %eof(QRPGLESRC);                                                                        B01                  005700
 005701         SetGT *HIVAL SRCREC;                                                                     01                  005701
 005702         ReadP SRCREC;                                                                            01                  005702
 005703      EndIf;                                                                                     E01                  005703
 005704                                                                                                                      005704
 005705      // Return to the previous point.                                                                                005705
 005706      For i = 1 to x;                                                                            B01                  005706
 005707         ReadP SRCREC;                                                                            01                  005707
 005708      EndFor;                                                                                    E01                  005708
 005709                                                                                                                      005709
 005710      SRCDTA = savedSRCDTA;                                                                                           005710
 005711                                                                                                                      005711
 005712      Return;                                                                                                         005712
 005713                                                                                                                      005713
 005714   //------------------------------------------------------------------------------------------                       005714
 005715      End-Proc;                                                                                                       005715
 005716                                                                                                                      005716
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    183
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005718   //==========================================================================================                       005718
 005719   // Split a line at a logical break based on a max length.                                                          005719
 005720   //==========================================================================================                       005720
 005721      Dcl-Proc SplitLine;                                                                                             005721
 005722                                                                                                                      005722
 005723   // -- Procedure Interface ------------------------------------------------------------------                       005723
 005724      Dcl-PI SplitLine;                                                                                               005724
 005725         QpCurrentLine        VarChar(92);                                                                            005725
 005726         QpOverflow           VarChar(92);                                                                            005726
 005727         QpMaxLength           Packed( 3:0 ) CONST;                                                                   005727
 005728      End-PI;                                                                                                         005728
 005729                                                                                                                      005729
 005730   // -- Data Structures ----------------------------------------------------------------------                       005730
 005731                                                                                                                      005731
 005732   // -- Variables ----------------------------------------------------------------------------                       005732
 005733      Dcl-S x                  Packed( 3:0 );                                                                         005733
 005734                                                                                                                      005734
 005735   //-------------------------------------------------------------------------------------------                      005735
 005736                                                                                                                      005736
 005737      QpOverflow = *Blanks;                                                                                           005737
 005738      x = %len(%trim(QpCurrentLine));                                                                                 005738
 005739      If x > QpMaxLength;                                                                        B01                  005739
 005740         x = QpMaxLength;                                                                         01                  005740
 005741      EndIf;                                                                                     E01                  005741
 005742                                                                                                                      005742
 005743      // Scan backwards through the line, looking for a place to break it.                                            005743
 005744      For x = x downto 1;                                                                        B01                  005744
 005745         If %scan(%subst(QpCurrentLine:x:1):' ') > 0;                                            B02                  005745
 005746            // Break here, and put the rest into a new line.                                                          005746
 005747            QpOverflow = %subst(QpCurrentLine:x);                                                 02                  005747
 005748            QpCurrentLine = %subst(QpCurrentLine:1:x-1);                                          02                  005748
 005749            Leave;                                                                                02                  005749
 005750         EndIf;                                                                                  E02                  005750
 005751      EndFor;                                                                                    E01                  005751
 005752                                                                                                                      005752
 005753      Return;                                                                                                         005753
 005754                                                                                                                      005754
 005755   //------------------------------------------------------------------------------------------                       005755
 005756      End-Proc;                                                                                                       005756
 005757                                                                                                                      005757
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    184
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005759   //==========================================================================================                       005759
 005760   // Check for an array definition and adjust the length according to the number of elements.                        005760
 005761   //==========================================================================================                       005761
 005762      Dcl-Proc AdjustArrayLength;                                                                                     005762
 005763                                                                                                                      005763
 005764   // -- Procedure Interface ------------------------------------------------------------------                       005764
 005765      Dcl-PI AdjustArrayLength;                                                                                       005765
 005766      QpLength               Packed( 7:0 );                                                                           005766
 005767      End-PI;                                                                                                         005767
 005768                                                                                                                      005768
 005769   // -- Data Structures ----------------------------------------------------------------------                       005769
 005770                                                                                                                      005770
 005771   // -- Variables ----------------------------------------------------------------------------                       005771
 005772      Dcl-S x                  Packed( 3:0 );                                                                         005772
 005773      Dcl-S i                  Packed( 3:0 );                                                                         005773
 005774      Dcl-S j                  Packed( 3:0 );                                                                         005774
 005775      Dcl-S elements           Packed( 5:0 );                                                                         005775
 005776      Dcl-S savedSRCDTA          Char( 100 );                                                                         005776
 005777                                                                                                                      005777
 005778   //-------------------------------------------------------------------------------------------                      005778
 005779                                                                                                                      005779
 005780      savedSRCDTA = SRCDTA;                                                                                           005780
 005781      x = 0;                                                                                                          005781
 005782                                                                                                                      005782
 005783      // Read ahead to find the next line with a declaration type.                                                    005783
 005784      DoW not %eof();                                                                            B01                  005784
 005785         // Array definition on the current line?                                                                     005785
 005786         i = %scan('DIM(':%xlate(lo:up:declKeywords));                                            01                  005786
 005787                                                                                                                      005787
 005788         If i > 0;                                                                               B02                  005788
 005789            j = %scan(')':declKeywords:i+4);                                                      02                  005789
 005790            elements = %dec(%subst(declKeywords:i + 4:j - i - 4):7:0);                            02                  005790
 005791            // Adjust the length of the variable.                                                                     005791
 005792            If %rem(QpLength:elements) = 0;                                                      B03                  005792
 005793               QpLength = %div(QpLength:elements);                                                03                  005793
 005794            EndIf;                                                                               E03                  005794
 005795            Leave;                                                                                02                  005795
 005796         EndIf;                                                                                  E02                  005796
 005797                                                                                                                      005797
 005798         Read SRCREC;                                                                             01                  005798
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    185
 Line   <---------------------- Source Specifications ----------------------------><---- Comments ----> Do  Page  Change Src Seq
 Number ....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10 Num Line  Date   Id  Number
 005799         x += 1;     // Keep a track of how many lines we have read.                              01                  005799
 005800                                                                                                                      005800
 005801         lineType = %xlate(lo:up:lineType);                                                       01                  005801
 005802                                                                                                                      005802
 005803         If lineType <> *Blank                                                                   B02                  005803
 005804         and lineType <> 'D';                                                                    B02                  005804
 005805            // Not part of this definition - stop looking for array definition.                                       005805
 005806            Leave;                                                                                02                  005806
 005807                                                                                                                      005807
 005808         ElseIf lineType = 'D'                                                                   X02                  005808
 005809         and %subst(directive:1:1) <> '*';                       // D-spec and no comment        X02                  005809
 005810            If declName <> *Blanks;                                                              B03                  005810
 005811               // A new declaration - stop looking for array definition.                                              005811
 005812               Leave;                                                                             03                  005812
 005813            EndIf;                                                                               E03                  005813
 005814         EndIf;                                                                                  E02                  005814
 005815      EndDo;                                                                                     E01                  005815
 005816                                                                                                                      005816
 005817      // End of file breaks the logic!  We need to reposition to the last record before                               005817
 005818      // continuing.                                                                                                  005818
 005819      If %eof(QRPGLESRC);                                                                        B01                  005819
 005820         SetGT *HIVAL SRCREC;                                                                     01                  005820
 005821         ReadP SRCREC;                                                                            01                  005821
 005822      EndIf;                                                                                     E01                  005822
 005823                                                                                                                      005823
 005824      // Return to the previous point.                                                                                005824
 005825      For i = 1 to x;                                                                            B01                  005825
 005826         ReadP SRCREC;                                                                            01                  005826
 005827      EndFor;                                                                                    E01                  005827
 005828                                                                                                                      005828
 005829      SRCDTA = savedSRCDTA;                                                                                           005829
 005830                                                                                                                      005830
 005831      Return;                                                                                                         005831
 005832                                                                                                                      005832
 005833   //------------------------------------------------------------------------------------------                       005833
 005834      End-Proc;                                                                                                       005834
 005835   //==========================================================================================                       005835
 005836 O*QRPGLESRC2E            OUTREC                                                                                      005836
 005837 O*                       SRCSEQ                                                                                      005837
 005838 O*                       SRCDAT                                                                                      005838
 005839 O*                       SRCDTA                                                                                      005839
        * * * * *   E N D   O F   S O U R C E   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    186
           A d d i t i o n a l   D i a g n o s t i c   M e s s a g e s
  Msg id  Sv   Statement    Message text
 *RNF7066 00        000032  Record-Format ZL01HDG not used for input or output.
 *RNF7099 00        005488  A COMMIT or ROLBK operation is used in the program with no
                            files defined with commitment control.
 *RNF7086 00        000027  RPG handles blocking for file QRPGLESRC2. INFDS is updated
                            only when blocks of data are transferred.
  * * * * *   E N D   O F   A D D I T I O N A L   D I A G N O S T I C   M E S S A G E S   * * * * *
                  O u t p u t   B u f f e r   P o s i t i o n s
 Line   Start End   Field or Constant
 Number Pos   Pos
    2000002     1     6 SRCSEQ
    2000003     7    12 SRCDAT
    2000004    13   112 SRCDTA
    3000002     1    10 Z1QPGM
    3000003    11    20 Z1QUSR
    3000004    21    60 Z1QTTL
    3000005    61    64 Z1QPAG
    4000002     1    21 ZTFRFL
    4000003    22    42 ZTTOFL
    6000002     1    10 Z1FRMB
    6000003    11    20 Z1TOMB
    6000004    21    27 Z1CTSC
    6000005    28    34 Z1CTTG
    6000006    35    41 Z1CTMV
    6000007    42    48 Z1CTEL
    6000008    49    55 Z1CTCV
    6000009    56    62 Z1CTNV
    6000010    63    67 Z1CNVR
  * * * * *   E N D   O F   O U T P U T   B U F F E R   P O S I T I O N   *  * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    187
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
                        C o m p i l e   T i m e   D a t a
 005840 **CTDATA QopCodeUP                                                                                                   005840
         *--------------------------------------------------------------------*
         * Array . . . : QOPCODEUP    Alternating Array  . . . . : QOPCODELO  *
         *--------------------------------------------------------------------*
 005841 ACQ       Acq                                                                                                        005841
 005842 BEGSR     BegSr                                                                                                      005842
 005843 CALLP     CallP                                                                                                      005843
 005844 CHAIN     Chain                                                                                                      005844
 005845 CLEAR     Clear                                                                                                      005845
 005846 CLOSE     Close                                                                                                      005846
 005847 COMMIT    Commit                                                                                                     005847
 005848 DEALLOC   DeAlloc                                                                                                    005848
 005849 DELETE    Delete                                                                                                     005849
 005850 DOU       DoU                                                                                                        005850
 005851 DOW       DoW                                                                                                        005851
 005852 DSPLY     Dsply                                                                                                      005852
 005853 DUMP      Dump                                                                                                       005853
 005854 ELSE      Else                                                                                                       005854
 005855 ELSEIF    ElseIf                                                                                                     005855
 005856 ENDDO     EndDo                                                                                                      005856
 005857 ENDFOR    EndFor                                                                                                     005857
 005858 ENDIF     EndIf                                                                                                      005858
 005859 ENDMON    EndMon                                                                                                     005859
 005860 ENDSL     EndSl                                                                                                      005860
 005861 ENDSR     EndSr                                                                                                      005861
 005862 EVAL      Eval                                                                                                       005862
 005863 EVALR     EvalR                                                                                                      005863
 005864 EVAL-CORR Eval-Corr                                                                                                  005864
 005865 EXCEPT    Except                                                                                                     005865
 005866 EXFMT     Exfmt                                                                                                      005866
 005867 EXSR      Exsr                                                                                                       005867
 005868 EXEC SQL  Exec SQL                                                                                                   005868
 005869 FEOD      FEOD                                                                                                       005869
 005870 FOR       For                                                                                                        005870
 005871 FORCE     Force                                                                                                      005871
 005872 IF        If                                                                                                         005872
 005873 IN        In                                                                                                         005873
 005874 ITER      Iter                                                                                                       005874
 005875 LEAVE     Leave                                                                                                      005875
 005876 LEAVESR   LeaveSr                                                                                                    005876
 005877 MONITOR   Monitor                                                                                                    005877
 005878 NEXT      Next                                                                                                       005878
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    188
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005879 ON-ERROR  On-Error                                                                                                   005879
 005880 OPEN      Open                                                                                                       005880
 005881 OTHER     Other                                                                                                      005881
 005882 OUT       Out                                                                                                        005882
 005883 POST      Post                                                                                                       005883
 005884 READ      Read                                                                                                       005884
 005885 READC     ReadC                                                                                                      005885
 005886 READE     ReadE                                                                                                      005886
 005887 READP     ReadP                                                                                                      005887
 005888 READPE    ReadPE                                                                                                     005888
 005889 REL       Rel                                                                                                        005889
 005890 RESET     Reset                                                                                                      005890
 005891 RETURN    Return                                                                                                     005891
 005892 ROLBK     RolBk                                                                                                      005892
 005893 SELECT    Select                                                                                                     005893
 005894 SETGT     SetGT                                                                                                      005894
 005895 SETLL     SetLL                                                                                                      005895
 005896 SORTA     SortA                                                                                                      005896
 005897 TEST      Test                                                                                                       005897
 005898 UNLOCK    Unlock                                                                                                     005898
 005899 UPDATE    Update                                                                                                     005899
 005900 WHEN      When                                                                                                       005900
 005901 WRITE     Write                                                                                                      005901
 005902 XML-INTO  XML-Into                                                                                                   005902
 005903 XMLSAX    XMLSAX                                                                                                     005903
 005904 ENDCS     ----------                                                                                                 005904
 005905 AND       and                                                                                                        005905
 005906 OR        or                                                                                                         005906
 005907 **CTDATA QdeclUP                                                                                                     005907
         *--------------------------------------------------------------------*
         * Array . . . : QDECLUP      Alternating Array  . . . . : QDECLLO    *
         *--------------------------------------------------------------------*
 005908 DCL-F     Dcl-F                                                                                                      005908
 005909 DCL-S     Dcl-S                                                                                                      005909
 005910 DCL-C     Dcl-C                                                                                                      005910
 005911 DCL-PR    Dcl-PR                                                                                                     005911
 005912 DCL-PI    Dcl-PI                                                                                                     005912
 005913 DCL-PROC  Dcl-Proc                                                                                                   005913
 005914 DCL-DS    Dcl-DS                                                                                                     005914
 005915 END-DS    End-DS                                                                                                     005915
 005916 END-PR    End-PR                                                                                                     005916
 005917 END-PI    End-PI                                                                                                     005917
 005918 END-PROC  End-Proc                                                                                                   005918
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    189
 Line   <---------------------- Data Records -------------------------------------------------------------->      Change Src Seq
 Number ....+....1....+....2....+....3....+....4....+....5....+....6....+....7....+....8....+....9....+...10      Date   Id  Number
 005919 CTL-OPT   Ctl-Opt                                                                                                    005919
 005920 **CTDATA Qcomments                                                                                                   005920
         *--------------------------------------------------------------------*
         * Array . . . : QCOMMENTS                                            *
         *--------------------------------------------------------------------*
 005921 //===========================================================================================                        005921
 005922 // Start of moved field definitions.                                                                                 005922
 005923 // End of moved field definitions.                                                                                   005923
     * * * * *   E N D   O F   C O M P I L E   T I M E   D A T A   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    190
                           C r o s s   R e f e r e n c e
       File and Record References:
          File              Device             References (D=Defined)
            Record
          CVTRPGFREP        PRINTER                000032D     005517      005564
            Z1PAGHDG                               000032D     000459     3000001
            Z1TOPPAG                               000032D     000464     4000001
            ZL01HDG                                000032D    5000001
            Z1DETAIL                               000032D     000484     6000001
            Z1ENDRPT                               000032D     005516     7000001
          QRPGLESRC         DISK                   000022D     000425      005116      005199
                                                   005284      005326      005435      005450
                                                   005451      005510      005570      005700
                                                   005819
            SRCREC                                 000024     1000001      000423      000451
                                                   005013      005110      005117      005118
                                                   005123      005177      005194      005200
                                                   005201      005206      005225      005275
                                                   005285      005291      005452      005454
                                                   005670      005695      005701      005702
                                                   005707      005798      005820      005821
                                                   005826
          QRPGLESRC2        DISK                   000027D     005511      005573
            OUTREC                                 000029      005471     2000001
       Global Field References:
          Field             Attributes         References (D=Defined M=Modified)
          *INLR             N(1)                   005492M
          ADJUSTARRAYLENGTH PROTOTYPE              002016M     005762      005765
          BLANKS            A(30)                  000209D     003009
          CALLPOFFSET       P(5,0)                 000329D     001050      002856M
          CALLPOPERATOR     A(10)                  000328D     002846      002872M     002874M
          CASEOPERATOR      A(4)                   000312D     002890M     002893      002894M
                                                   002895      002896M     002897      002898M
                                                   002899      002900M     002901      002902M
                                                   002903      002904M     002906M     002912
                                                   002916      002920
          CASESUBROUTINE    A(10)                  000311D     000445      000446      000448M
                                                   002889M
          CATBLANKS         A(14)                  000317D     002978M     002981M     002988
                                                   002990      002997
          CATCOUNT          P(5,0)                 000316D     002990M     003001      003005
                                                   003009
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    191
          CATFACTOR1        A(14)                  000314D     002970M     002972M     002999
                                                   003003      003008
          CATFACTOR2        A(14)                  000315D     002979M     002982M     003000
                                                   003004      003010
          CFGCLOSEDOWN      A(1)                   000195D     005491      005515M     005552M
          CFGCOMMITCONTROL  A(7)                   000193D     005487      005551M
          CHECKLENGTH       P(5,0)                 000278D     002336M     002340M     002343
 *RNF7031 CNDINDICATORS(79) N(1)                   000145D
          CODELINE          A(93)                  000091D     000220      000436M     000438M
                                                   000446M     000507      000613      000616M
                                                   000616      000622      000626      000627
                                                   000634      000637M     000640      000642M
                                                   000725      000726      000727      000731
                                                   000733      000735      000738      000780M
                                                   000788      001033M     001034M     001091M
                                                   001092M     001096M     001099      001113M
                                                   001121M     001122M     001167M     001192
                                                   001613      002232      002348M     002400
                                                   002406      002457      002544M     002555M
                                                   002566M     002577M     002588M     002599M
                                                   002603M     002607M     002615M     002619M
                                                   002623M     002635M     002640M     002645M
                                                   002655M     002658M     002660M     002670M
                                                   002673M     002675M     002685M     002688M
                                                   002690M     003482M     003603      005233
                                                   005234      005241      005246      005247
                                                   005298      005299      005330      005332
                                                   005418M     005420M     005422M     005428M
                                                   005441M     005443M     005445M
          CODESTART         P(6,2)                 000242D     005319M     005453
          COMMENT           A(20)                  000105D     000639      000655      000668
                                                   000680      000692      000704      001799
                                                   001800      001801      001803      001836
                                                   001837      001838      001840      002184
                                                   002185      002186      002188      002325
                                                   002326      002327      002329      002339
                                                   002417      002418      002419      002421
                                                   002493      002494      002495      002497
                                                   005400      005401
          CONDIND           A(2)                   000095D     001208
 *RNF7031 CONDNOT           A(1)                   000094D
          CONVERT           N(1)                   000238D     000504M     000659      000672
                                                   000684      000696      000708      000742
                                                   000760      001094      001108      001194M
                                                   001204M     001615M     001646M     001734M
                                                   001995M     002203M     002220M     002234M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    192
                                                   002268M     002373M     002388M     002402M
                                                   002445M     002459M     002514M     002528M
                                                   002714M     002745M     002801M     002820M
                                                   002833M     002877M     002945M     003019M
                                                   003050M     003101M     003114M     003132M
                                                   003153M     003188M     003209M     003235M
                                                   003265M     003380M     003413M     003430M
                                                   003443M     003456M     003520M     003572M
                                                   003585M     003612M     003638M     003651M
                                                   003701M     003720M     003733M     003746M
                                                   003831M     003855M     003868M     003881M
                                                   003928M     003974M     004016M     004030M
                                                   004051M     004080M     004097M     004116M
                                                   004129M     004153M     004187M     004223M
                                                   004243M     004263M     004297M     004311M
                                                   004332M     004396M     004409M     004427M
                                                   004445M     004479M     004492M     004507M
                                                   004520M     004552M     004636M     004678M
                                                   004702M     004715M     004734M     004760M
                                                   004844M     004875M     004895M     004949M
                                                   004967M     004986M
          COUNTCONV         P(7,0)                 000394D     000474      000480      000743M
                                                   005578M
          COUNTELIGIBLE     P(7,0)                 000393D     000473      000477      000480
                                                   000652M     000665M     000678M     000690M
                                                   000702M     005577M
          COUNTMOVED        P(7,0)                 000396D     000476      005429M
          COUNTNOTCONV      P(7,0)                 000395D     000475      000653M     000666M
                                                   000679M     000691M     000703M     000744M
                                                   005579M
          COUNTSOURCE       P(7,0)                 000391D     000426M     000471      005575M
          COUNTTARGET       P(7,0)                 000392D     000472      005469M     005576M
          CURROFFSET        P(5,0)                 000254D     000731M     001054
 *RNF7031 CVTRPGFREE        PROTOTYPE              000039D
          DCLF              DS(92)                 000175D     002278M     002279M     002280M
                                                   002284M     002293M     002296M     002300M
                                                   002302M     002306M     002310M     002315
                                                   002316M     002316      002321M     002321
                                                   002327M     002329M     002336      002343
                                                   002348      002352M     002353M     002356M
                                                   002356      002362M     002362      002369
                                                   002379M     002380M     002382M     002382
                                                   002384
            COMMENT         A(23)                  000180D     002327      002329
            DECL            A(6)                   000176D     002279
            DEFINITION      A(44)                  000179D     002293      002296      002300
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    193
                                                   002302      002306      002310      002315
                                                   002316      002316      002321      002321
                                                   002336      002343      002353      002356
                                                   002356      002362      002362      002380
                                                   002382      002382
            DEVICE          A(8)                   000178D     002284
 *RNF7031   FILENAME        A(15)                  000177D
          DCLH              DS(93)                 000183D     002413M     002414M     002415M
                                                   002419M     002421M     002426M     002426
                                                   002433      002436M     002437M     002439M
                                                   002439      002441
            COMMENT         A(23)                  000186D     002419      002421
            DECL            A(8)                   000184D     002414
            OPTIONS         A(62)                  000185D     002415      002426      002426
                                                   002437      002439      002439
          DCLP              DS(93)                 000161D     002478M     002481M     002483M
                                                   002485M     002489M     002489      002495M
                                                   002497M     002502M     002502      002509
                                                   002519M     002520M     002522M     002522
                                                   002524
            COMMENT         A(23)                  000164D     002495      002497
            DECL            A(9)                   000162D     002481      002483
            DEFINITION      A(61)                  000163D     002485      002489      002489
                                                   002502      002502      002520      002522
                                                   002522
          DCLPR             DS(92)                 000152D     001872M     001887M     001891M
                                                   001908M     001914      001931      001933M
                                                   001938M     001946M     001950M     001952M
                                                   001957M     001963M     001968M     001974M
                                                   001976M     001978M     001980M     001982M
                                                   001984M     001988M     001991M     002006
                                                   002007M     002017M     002017      002020M
                                                   002020      002025M     002025      002028M
                                                   002028      002083      002086M     002098M
                                                   002107M     002155      002156M     002156
                                                   002158M     002158      002169      002171
                                                   002176      002176      002177M     002179M
                                                   002179      002186M     002188M     002193
            COMMENT         A(23)                  000157D     002186      002188
            DECL            A(7)                   000153D     001887      001931
            DEFINITION      A(37)                  000156D     001957      001968      002007
                                                   002017      002017      002020      002020
                                                   002025      002025      002028      002028
                                                   002158      002158      002169      002171
                                                   002176      002177      002179      002179
            FIELDNAME       A(23)                  000158D     001908
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    194
            PROCNAME        A(16)                  000154D     002083      002086      002098
                                                   002156      002156
            TYPE            A(9)                   000155D     001914      001933      001938
                                                   001946      001950      001952      001963
                                                   001974      001976      001978      001980
                                                   001982      001984      001988      001991
                                                   002006      002155      002176
          DCLS              DS(92)                 000167D     001640M     001651M     001652M
                                                   001657      001676M     001684M     001687M
                                                   001689M     001694M     001700M     001705M
                                                   001711M     001713M     001715M     001717M
                                                   001719M     001721M     001723M     001727M
                                                   001730M     001745      001746M     001748M
                                                   001748      001751M     001751      001774M
                                                   001774      001784      001786      001791
                                                   001791      001792M     001794M     001794
                                                   001801M     001803M     001808      001819M
                                                   001821M     001822M     001827      001828M
                                                   001830M     001830      001838M     001840M
                                                   001845M     001845      001852      001853M
                                                   001853      001857      002211M     002212M
                                                   002214M     002214      002216      005323M
                                                   005353M     005358M     005360M     005362M
                                                   005364M     005366M     005366      005369M
                                                   005369      005375M     005377M     005382M
                                                   005382      005385M     005385      005388M
                                                   005388      005391M     005391      005399M
                                                   005399      005401M     005413      005414M
                                                   005428      005430M
            COMMENT         A(23)                  000172D     001801      001803      001838
                                                   001840      005401
            DECL            A(6)                   000168D     001651      001821      001852
                                                   005414
            DEFINITION      A(37)                  000171D     001694      001705      001746
                                                   001748      001748      001751      001751
                                                   001774      001774      001784      001786
                                                   001791      001792      001794      001794
                                                   001827      001828      001830      001830
                                                   001845      001845      001853      002212
                                                   002214      002214      005364      005366
                                                   005366      005369      005369      005377
                                                   005382      005382      005385      005385
                                                   005388      005388      005391      005391
                                                   005399      005399
            FIELDNAME       A(17)                  000169D     005358      005375      005413
                                                   005430
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    195
            TYPE            A(9)                   000170D     001657      001676      001684
                                                   001687      001689      001700      001711
                                                   001713      001715      001717      001719
                                                   001721      001723      001727      001730
                                                   001745      001791      005360      005362
          DEC               A(2)                   000101D     000861M     005359      005365
                                                   005367
          DECLATTR          A(1)                   000121D     001622
          DECLEXT           A(1)                   000115D     005619
          DECLFROM          A(7)                   000119D     002008      002010      002033
                                                   002035      002036      002038      005660
                                                   005686
          DECLKEYWORDS      A(37)                  000123D     001623      002520      005029
                                                   005254      005786      005789      005790
          DECLLEN           A(7)                   000120D     001658      001746      001915
                                                   001932      002009      002021      005028
                                                   005254      005661      005687
          DECLNAME          A(15)                  000114D     001628      002091      002475
                                                   005004      005026      005039      005142
                                                   005250      005257      005623      005810
          DECLOPTIONS       A(73)                  000124D     002034      002415      002437
                                                   005005      005258      005260      005662
                                                   005688
          DECLPREFIX        A(1)                   000116D     002081      002088      005139
                                                   005140      005140      005619      005620
                                                   005620
          DECLSCALE         A(3)                   000122D     001660      001747      001749
                                                   001917      002024      002026
          DECLSUFFIX        A(1)                   000118D     005138      005621
          DECLTYPE          A(2)                   000117D     001901      005027      005141
                                                   005188      005189      005253      005256
                                                   005622      005664      005681      005683
                                                   005690
          DEFSMOVED         N(1)                   000240D     000529M     000904M     000966
                                                   005415      005424M     005438      005457M
          DIRECTIVE         A(10)                  000090D     000501      000554M     000604M
                                                   000606M     000750M     000755M     000767M
                                                   000773M     001112      002347M     005025
                                                   005038      005046      005051      005092
                                                   005097      005103      005245      005296
                                                   005297      005338      005809
          DIVFACTOR1        A(14)                  000356D     003254M     003257M     003262
                                                   004027
          DIVFACTOR2        A(14)                  000357D     003255M     003258M     003263
                                                   004028
          DOCOMPARE         A(2)                   000333D     003302M     003307M     003311M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    196
                                                   003314M     003319      003320M     003321
                                                   003322M     003323      003324M     003325
                                                   003326M     003327      003328M     003329
                                                   003330M     003331      003342M     003362
          DOCOUNT           P(5,0)                 000350D     000886M     000887      000921M
                                                   003494      003495
          DOLEVEL(99)       P(5,0)                 000351D     000887M     003495
          DOOPERATOR        A(10)                  000332D     003277      003375M     003377M
          DROPLINE          N(1)                   000241D     000556M     000559M     000566M
                                                   000660      000673      000685      000697
                                                   000709      000797      000877M     000985
                                                   001107      001127M     001290M     003187M
                                                   004425M     004443M
          DURCODE           A(14)                  000320D     002764M     002767      002767
                                                   002768M     002769      002769      002770M
                                                   002771      002771      002772M     002773
                                                   002773      002774M     002775      002775
                                                   002776M     002777      002777      002778M
                                                   002779      002779      002780M     002792
                                                   003670M     003673      003673      003674M
                                                   003675      003675      003676M     003677
                                                   003677      003678M     003679      003679
                                                   003680M     003681      003681      003682M
                                                   003683      003683      003684M     003685
                                                   003685      003686M     003693      004579M
                                                   004582      004582      004583M     004584
                                                   004584      004585M     004586      004586
                                                   004587M     004588      004588      004589M
                                                   004590      004590      004591M     004592
                                                   004592      004593M     004594      004594
                                                   004595M     004607      004611M     004614
                                                   004614      004615      004615      004616
                                                   004616      004617      004617      004618
                                                   004618      004619      004619      004620
                                                   004620      004627
          DURDURATION       A(14)                  000319D     002763M     002793      003669M
                                                   003692      004578M     004608      004610M
                                                   004626
          DURNEWDATE        N(1)                   000321D     004571M     004574M     004577
          ENDDECLTYPE       A(2)                   000245D     001167      001893M
          ENDDS             N(1)                   000231D     001164      001885M     002077M
          ENDFOUND          N(1)                   000244D     005222M     005294      005302M
          ENDLINE           P(6,2)                 000243D     001162      005221M     005280M
                                                   005303M
          EOFCHECK          N(1)                   000369D     002574      002580M     004214M
                                                   004866M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    197
          EOFFILE           A(14)                  000371D     004216M     004868M
          EOFIND            A(2)                   000370D     002577      004215M     004867M
          EQ                A(2)                   000104D     002938      002940      003094
                                                   003096      003179      003181      003227
                                                   004213      004215      004289      004391
                                                   004393      004423      004441      004470
                                                   004472      004865      004867
          EQCHECK           N(1)                   000383D     002643      002682      002693M
                                                   002939M     003180M
          EQFACTOR1         A(14)                  000385D     002685      002941M     003182M
          EQFACTOR2         A(14)                  000386D     002686      002942M     003183M
          EQIND             A(2)                   000384D     002645      002688      002940M
                                                   003181M
          EQUALCHECK        N(1)                   000388D     002585      002591M     004471M
          EQUALIND          A(2)                   000389D     002588      004472M
          ERRCHECK          N(1)                   000359D     002552      002558M     002710M
                                                   002797M     002816M     003015M     003046M
                                                   003091M     003128M     003149M     003205M
                                                   003231M     003409M     003634M     003697M
                                                   003716M     003851M     004047M     004076M
                                                   004112M     004149M     004183M     004219M
                                                   004239M     004259M     004293M     004328M
                                                   004388M     004475M     004632M     004674M
                                                   004698M     004730M     004756M     004871M
                                                   004945M
          ERRIND            A(2)                   000360D     002555      002711M     002798M
                                                   002817M     003016M     003047M     003092M
                                                   003129M     003150M     003206M     003232M
                                                   003410M     003635M     003698M     003717M
                                                   003852M     004048M     004077M     004113M
                                                   004150M     004184M     004220M     004240M
                                                   004260M     004294M     004329M     004389M
                                                   004476M     004633M     004675M     004699M
                                                   004731M     004757M     004872M     004946M
 *RNF7031 ERRORIND          N(1)                   000149D
          EVALOFFSET        P(5,0)                 000325D     001052
          EVALOPERATOR      A(10)                  000324D     003537      003567M     003569M
          EXTFACTOR2        A(45)                  000107D     002852      002862      003285
                                                   003295      003546      003548      003558
                                                   003712      003731      003744      003766
                                                   003776      004091      004094      004309
                                                   004503      004780      004790      005054
          FACTOR1           A(14)                  000096D     000287      000306      000307
                                                   000314      000347      000356      000375
                                                   000380      000385      002705      002733
                                                   002739      002786      002789      002831
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    198
                                                   002911      002919      002929      002935
                                                   002941      002959      002960      002969
                                                   002972      003030      003080      003084
                                                   003143      003168      003175      003182
                                                   003253      003257      003334      003337
                                                   003340M     003361      003393      003394
                                                   003424      003425      003469      003812
                                                   003842      003843      003951      004004
                                                   004010      004041      004062      004067
                                                   004140      004143      004174      004177
                                                   004198      004199      004254      004276
                                                   004277      004322      004344      004347
                                                   004349      004350      004456      004540
                                                   004546      004601      004604      004626
                                                   004650      004651      004657      004693
                                                   004825      004916      004920      004921
                                                   005376
          FACTOR2           A(14)                  000098D     000288      000308      000315
                                                   000317      000319      000320      000348
                                                   000357      000367      000371      000376
                                                   000381      000386      002706      002736
                                                   002740      002757      002763      002764
                                                   002812      002912      002920      002930
                                                   002936      002942      002976      002979
                                                   002981      002982      003031      003043
                                                   003074      003080      003084      003085
                                                   003125      003169      003176      003183
                                                   003220      003228      003255      003258
                                                   003339      003341M     003363      003395
                                                   003396      003454      003479      003480
                                                   003583      003623      003649      003663
                                                   003669      003670      003814      003844
                                                   003846      003944      003949      003954
                                                   004007      004011      004042      004064
                                                   004066      004108      004141      004144
                                                   004164      004175      004178      004200
                                                   004202      004216      004234      004255
                                                   004280      004281      004290      004354
                                                   004357      004359      004360      004457
                                                   004468      004518      004543      004547
                                                   004564      004578      004579      004627
                                                   004659      004662      004664      004668
                                                   004726      004745      004827      004855
                                                   004868      004887      004892      004925
                                                   004928      004930      004931      004960
                                                   004979      005378      005387      005389
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    199
                                                   005392
          FILEADD           A(1)                   000130D     002242
          FILEDESIG         A(1)                   000129D     002241
          FILEDEVICE        A(7)                   000133D     002243
          FILEEXTERNAL      A(1)                   000131D     002275
          FILEKEYED         A(1)                   000132D     002244
          FILEKEYWORDS      A(37)                  000134D     002334      002337      002353
                                                   002357      002380      005098
          FILENAME          A(10)                  000127D     002273      005098
          FILESPEC          A(100)                 000126D     000127      000128      000129
                                                   000130      000131      000132      000133
                                                   000134
          FILEUSAGE         A(1)                   000128D     002240
          FORCOUNT          P(5,0)                 000345D     000890M     000891      000925M
                                                   003477      003478
          FORFACTOR1        A(14)                  000347D     003335M     003337M     003347
          FORFACTOR2        A(14)                  000348D     003339M     003348
          FORLEVEL(99)      P(5,0)                 000346D     000891M     003478
          FOUNDCHECK        N(1)                   000362D     002541      002547M     004392M
          FOUNDIND          A(2)                   000363D     002544      004393M
          FROMFILELIB       A(21)                  000214D     000461      005569M
          FULLLINE          A(94)                  000092D     000714      000717      001115M
                                                   001619      002238      002463      005145
                                                   005626
          GETDECLARATIONTYPE...
                            PROTOTYPE              000069D     001631M     002470M     005263M
                                                   005600      005603
          HI                A(2)                   000102D     002926      002928      002960
                                                   003040      003042      003165      003167
                                                   003225      004287      004421      004439
                                                   004465      004467      004490      004651
          HICHECK           N(1)                   000373D     002633      002652      002663M
                                                   002927M     003095M     003166M
          HIFACTOR1         A(14)                  000375D     002655      002929M     003097M
                                                   003168M
          HIFACTOR2         A(14)                  000376D     002656      002930M     003098M
                                                   003169M
          HIIND             A(2)                   000374D     002635      002658      002928M
                                                   003096M     003167M
          I                 P(5,0)                 000207D     001759M     001760      001761
                                                   001764      001766      002046M     002047
                                                   002049      002051      002056      002056
                                                   002062      002062      002115M     002116
                                                   002117      002120      002122      002130M
                                                   002131      002132      002135      002137
                                                   002145M     002146      005122      005205
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    200
                                                   005290      005706
          IFCOMPARE         A(2)                   000337D     003788M     003792M     003795M
                                                   003799      003800M     003801      003802M
                                                   003803      003804M     003805      003806M
                                                   003807      003808M     003809      003810M
                                                   003813
          IFOPERATOR        A(10)                  000336D     003759      003826M     003828M
          INARRAYDATA       N(1)                   000223D     000514M     000517      001111
                                                   005585M
          INCALLP           N(1)                   000327D     001049      001143      001152M
                                                   001239      002845      002851      002857M
                                                   002871
          INCASE            N(1)                   000237D     000445      002910      002914M
                                                   003511      003523M
          INCODE            N(1)                   000222D     000512M     000521M     000528M
                                                   000531M     000533M     000535M     000537M
                                                   000539M     000549M     000597      000628
                                                   000719      000834M     000844M     000966
                                                   001029      001111      001139M     005584M
          INCOMMENT         N(1)                   000224D     000498M     000601M     000621M
                                                   000631M     000643M     000648      000659
                                                   000672      000684      000696      000708
                                                   000796      000984      000998M     001063
                                                   001145
          INCREMENT         P(1,0)                 000249D     000499M     000872M     000876M
                                                   000881M     000884M     000889M     000893M
                                                   000897M     000901M     000906M     000909M
                                                   000912M     000917M     000920M     000924M
                                                   000928M     000932M     000936M     000940M
                                                   000944M     000948M     000953M     000957M
                                                   000959M     000973      000974M     001130
          INDATASTRUCTURE   N(1)                   000228D     001161      001163      001164
                                                   001174M     001663      001870      001877
                                                   001884M     001920      002008      002032
          INDECLARATION     N(1)                   000225D     000513M     000746      000763
                                                   000833      000961      001144      001155M
                                                   001176M     001628      001629      001638M
                                                   001644M     001733M     001778M     001817M
                                                   001846M     001871M     001994M     002162M
                                                   002202M     002248      002267M     002276M
                                                   002363M     002372M     002410      002411M
                                                   002427M     002467      002468      002476M
                                                   002503M     002513M
 *RNF7031 INDECLPROC        N(1)                   000234D
          INDENT            N(1)                   000235D     000931M     000935M     000939M
                                                   000943M     000947M     000952M     000956M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    201
                                                   001133      001135M
          INDENTCOUNT       P(5,0)                 000250D     000887      000891      000895
                                                   000899M     000903M     000907M     000973M
                                                   001042      001045      001130M     001134M
                                                   001138M     003478      003495      003504
                                                   005586M     005588M
          INDENTOFFSET      P(5,0)                 000252D     001034      001043M     001045M
                                                   001050M     001052M     001054M     001054
                                                   001058      001059M     001080      001082M
                                                   001082      001086      001087M     001092
                                                   001122      001788M     002173M
          INDENTSIZE        P(1,0)                 000251D     001043      001045
 *RNF7031 INDICATORDS       DS(99)                 000138D
          INDIRECTIVE       N(1)                   000232D     000497M     000548M     000568M
                                                   000572M     000576M     000580M     000584M
                                                   000588M     000592M     000649      000772
                                                   000795      000982
          INDO              N(1)                   000331D     000885M     000950      001073
                                                   001143      001150M     001320      003276
                                                   003284      003289M     003306      003366M
                                                   003368M     003374
          INEVAL            N(1)                   000323D     001051      001143      001153M
                                                   001350      003536      003542      003543M
                                                   003566
          INEXTPROC         N(1)                   000230D     001172M     001177M     001902
                                                   002105      002109M     002148M
          INFREEFORMAT      N(1)                   000233D     000547      000550M     000720M
                                                   000737M     000746      000754M     000763
                                                   000771M     000800      000981
          INIF              N(1)                   000335D     000725      000882M     000950
                                                   001073      001143      001149M     001390
                                                   003758      003765      003770M     003787
                                                   003817M     003819M     003825
          ININTERFACE       N(1)                   000227D     001161      001173M     001868
                                                   001876      001882M
          INITIALCALL       A(1)                   000196D     005514      005532      005533M
                                                   005535M     005563
          INPROTOTYPE       N(1)                   000226D     001161      001171M     001866
                                                   001875      001880M     001899      005156
                                                   005642
          INSPAN            N(1)                   000236D     000728M     000730      000784M
                                                   001053      001074M     001143      001148M
                                                   001175M     001772      001780M     001809
                                                   001844      001848M     001858      001903
                                                   002154      002165M     002194      002213
                                                   002217M     002361      002365M     002381
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    202
                                                   002385M     002425      002429M     002438
                                                   002442M     002501      002505M     002521
                                                   002525M     002853      002858M     002863
                                                   002867M     003286      003290M     003296
                                                   003300M     003364      003369M     003550
                                                   003553M     003559      003562M     003601M
                                                   003604      003608M     003767      003771M
                                                   003777      003782M     003815      003820M
                                                   004781      004785M     004791      004795M
                                                   004828      004833M     004997M     005007M
                                                   005012      005033M     005041M     005047M
                                                   005055M     005060M     005065M     005072M
                                                   005079M     005086M     005093M     005099M
                                                   005249
          INSQL             N(1)                   000343D     000803      000823M     000873M
                                                   000878      001144      001154M     001198
                                                   003600M     003607M
          INWHEN            N(1)                   000339D     000945      000949M     001073
                                                   001143      001151M     001579      004772
                                                   004779      004784M     004800      004830M
                                                   004832M     004838
          J                 P(5,0)                 000208D     002051M     002052      002056
                                                   002057      002062      002063
          LEN               A(5)                   000100D     000860M     005349      005355
                                                   005356      005356      005364      005380
                                                   005380      005381M     005381      005383
          LINEEND           P(5,0)                 000255D     001064M     001065      001066M
                                                   001067      001068M     001069      001071M
                                                   001080      001082      001146M     001147
          LINETYPE          A(1)                   000089D     000502      000542M     000551M
                                                   000569M     000573M     000577M     000581M
                                                   000585M     000589M     000593M     000597
                                                   000609M     000624M     000760      001112
                                                   002346M     004999      005017M     005017
                                                   005019      005020      005024      005037
                                                   005045      005050      005091      005096
                                                   005162      005181M     005181      005183
                                                   005228      005229      005295      005329
                                                   005337      005427M     005648      005674M
                                                   005674      005676      005801M     005801
                                                   005803      005804      005808
          LO                CONST                  000078D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
                                                   001701      001725      001757      001764
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    203
                                                   001822      001936      001953      001964
                                                   001986      002044      002048      002050
                                                   002071      002073      002090      002113
                                                   002120      002128      002135      002143
                                                   002240      002241      002242      002243
                                                   002244      002275      002280      002764
                                                   002960      002960      003305      003670
                                                   003786      003953      004579      004611
                                                   004651      004651      004799      004999
                                                   005017      005052      005141      005162
                                                   005181      005189      005229      005234
                                                   005330      005332      005337      005339
                                                   005352      005373      005376      005387
                                                   005406      005622      005648      005664
                                                   005674      005683      005690      005786
                                                   005801
          LW                A(2)                   000103D     002709      002711      002796
                                                   002798      002815      002817      002932
                                                   002934      003014      003016      003045
                                                   003047      003090      003092      003127
                                                   003129      003148      003150      003172
                                                   003174      003204      003206      003230
                                                   003232      003408      003410      003633
                                                   003635      003696      003698      003715
                                                   003717      003850      003852      004046
                                                   004048      004075      004077      004111
                                                   004113      004148      004150      004182
                                                   004184      004218      004220      004238
                                                   004240      004258      004260      004292
                                                   004294      004327      004329      004387
                                                   004389      004422      004440      004474
                                                   004476      004631      004633      004673
                                                   004675      004697      004699      004729
                                                   004731      004755      004757      004870
                                                   004872      004944      004946
          LWCHECK           N(1)                   000378D     002638      002667      002678M
                                                   002933M     003173M
          LWFACTOR1         A(14)                  000380D     002670      002935M     003175M
          LWFACTOR2         A(14)                  000381D     002671      002936M     003176M
          LWIND             A(2)                   000379D     002640      002673      002934M
                                                   003174M
          MAINLINEINDENT    P(5,0)                 000256D     000898M     000899      000902M
                                                   000903      000907      001138      005588
          MAXINDENT         P(5,0)                 000210D     001042      001043      005581M
          MOVEDDEFS(9999)   A(14)                  000211D     005322M     005352      005405
                                                   005406M     005582M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    204
          MOVEDEF           N(1)                   000212D     005350M     005357M     005374M
                                                   005397      005583M
          NEWOPERATOR       A(10)                  000219D     000989M     000993M     000999M
                            VARYING(2)             001002M     001008      001009      001011
                                                   001026
          NONCONVRSN        A(93)                  000220D     000505M     000660      000661M
                                                   000673      000674M     000685      000697
                                                   000709      000777      000780      001209M
                                                   001645M     002269M     002374M     002759M
                                                   002782M     002961M     003063M     003470M
                                                   003665M     003688M     003957M     003969M
                                                   004069M     004165M     004170M     004568M
                                                   004597M     004622M     004652M
          NONPREFIX         A(95)                  000109D     000434M     001109M     002542M
                                                   002553M     002564M     002575M     002586M
                                                   002597M     002613M     002634M     002639M
                                                   002644M     002653M     002668M     002683M
          NRFCHECK          N(1)                   000365D     002563      002569M     003041M
                                                   003226M     004288M     004466M
          NRFFILE           A(14)                  000367D     003043M     003228M     004290M
                                                   004468M
          NRFIND            A(2)                   000366D     002566      003042M     003227M
                                                   004289M     004467M
          OPCODE            A(10)                  000097D     000324      000328      000332
                                                   000336      000340      000654      000856
                                                   003305M     003305      003307      003308
                                                   003310      003311      003314      003786M
                                                   003786      003788      003791      003792
                                                   003795      004799M     004799      004801
                                                   004804      004805      004808      005052M
                                                   005052      005054      005059      005064
                                                   005069      005070      005071      005076
                                                   005077      005078      005083      005084
                                                   005085      005339M     005339      005341
                                                   005342      005343      005344      005345
                                                   005346      005347      005348      005349
                                                   005373
          OPERATOR          A(10)                  000217D     000654M     000667M     000802M
                                                   000804M     000807M     000808      000810
                                                   000812      000817M     000817      000819
                                                   000822M     000826      000828M     000828
                                                   000832      000836      000840M     000843M
                                                   000854M     000856M     000857      000858
                                                   000867M     000867      000880      000883
                                                   000888      000892      000896      000900
                                                   000905      000908      000910      000914
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    205
                                                   000915M     000918      000922      000926
                                                   000929      000933      000937      000941
                                                   000945      000954      000987      000991
                                                   001000M     001049      001051      001137
                                                   001214      001219      001224      001229
                                                   001234      001239      001244      001249
                                                   001254      001259      001264      001269
                                                   001274      001279      001284      001289
                                                   001294      001299      001304      001305
                                                   001306      001307      001308      001309
                                                   001310      001311      001312      001313
                                                   001314      001315      001316      001317
                                                   001318      001319      001325      001330
                                                   001335      001340      001345      001350
                                                   001355      001360      001365      001370
                                                   001375      001380      001385      001390
                                                   001395      001400      001405      001410
                                                   001415      001421      001426      001431
                                                   001436      001441      001446      001451
                                                   001456      001461      001466      001471
                                                   001476      001481      001486      001491
                                                   001496      001501      001506      001507
                                                   001512      001517      001522      001527
                                                   001532      001537      001542      001547
                                                   001551      001555      001559      001564
                                                   001569      001574      001579      001584
                                                   001589      001594      001599      002705
                                                   002726      002846M     002852      002856
                                                   002872      002890      002957      002966M
                                                   003030      003067      003068M     003070M
                                                   003079      003083      003125      003143
                                                   003199      003220      003247      003277M
                                                   003282      003283      003285      003375
                                                   003391      003425      003427      003468
                                                   003476      003476      003479M     003493
                                                   003493      003496M     003502      003502
                                                   003505M     003510      003512M     003514M
                                                   003518      003522      003537M     003544
                                                   003545      003546      003557      003567
                                                   003583      003623      003712      003731
                                                   003759M     003764      003766      003826
                                                   003843      003846      003866      003879
                                                   003940      003942      003947      003997
                                                   004041      004092      004094      004108
                                                   004141      004143      004175      004177
                                                   004199      004202      004254      004274
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    206
                                                   004308      004322      004456      004503
                                                   004532      004534M     004648      004689
                                                   004690M     004693      004726      004745
                                                   004773M     004778      004780      004839
                                                   004855      004886      004963      004982
                                                   005053      005058      005063      005068
                                                   005075      005082
          OPERATOREND       P(5,0)                 000218D     000808M     000809      000810M
                                                   000811      000812M     000816      000817
                                                   000826M     000827      000828
          OVERFLOW          N(1)                   000033D     000147D     000455      000466M
                                                   005566M
          OVERFLOWLINE      A(92)                  000260D     001120      001122      001123M
                            VARYING(2)             001787      002172
          PADRESULT         N(1)                   000284D     001031      001038M
          PADTARGET         A(14)                  000285D     001035
          PREFIX            A(5)                   000088D     000510
          PREVOFFSET        P(5,0)                 000253D     000733M     001054
          PROCKEYWORDS      A(37)                  000112D     002488      002490      005040
          PROCTYPE          A(1)                   000111D     005040
          QCOMMENTS(3)      A(92)                  000204D     005418      005420      005422
                                                   005441      005443      005445      005920M
          QDECLLO(12)       A(10)                  000203D     000993
          QDECLUP(12)       A(10)                  000202D     000203      000836      000991
                                                   005907M
          QOPCODELO(66)     A(10)                  000201D     000989
          QOPCODEUP(66)     A(10)                  000200D     000201      000832      000987
                                                   003953      005840M
          QPDIRECTIVES      A(1)                   000063D     000553      000747      000764
                            BASED(_QRNL_PRM+)
          QPFROMFILE        A(10)                  000055D     005569
                            BASED(_QRNL_PRM+)
          QPFROMLIB         A(10)                  000056D     005569
                            BASED(_QRNL_PRM+)
          QPFROMMBR         A(10)                  000022      000057D     000469
                            BASED(_QRNL_PRM+)
          QPINDCOMMENT      A(1)                   000061D     000600      000630
                            BASED(_QRNL_PRM+)
          QPRETBLNKCMT      A(1)                   000062D     000613      000634
                            BASED(_QRNL_PRM+)
          QPSHUTDOWN        A(1)                   000054D     005509      005514      005558
                            BASED(_QRNL_PRM+)
          QPTOFILE          A(10)                  000058D     005572
                            BASED(_QRNL_PRM+)
          QPTOLIB           A(10)                  000059D     005572
                            BASED(_QRNL_PRM+)
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    207
          QPTOMBR           A(10)                  000027      000060D     000470
                            BASED(_QRNL_PRM+)
          RESULT            A(14)                  000099D     000211      000285      002734
                                                   002735      002738      002787      002787
                                                   002789      002812      002889      002960
                                                   002970      002999      003003      003008
                                                   003033      003034      003062      003079
                                                   003083      003097      003112      003199
                                                   003254      003261      003343      003344M
                                                   003346      003397      003400      003401
                                                   003626      003627      003692      003944
                                                   003949      003953      003954      004005
                                                   004006      004009      004027      004063
                                                   004065      004169      004206      004207
                                                   004234      004284      004378      004383
                                                   004458      004459      004518      004541
                                                   004542      004545      004566      004602
                                                   004602      004604      004610      004611
                                                   004651      004667      004694      004713
                                                   004748      004749      004858      004859
                                                   004887      004891      004935      004960
                                                   004979      005352      005358      005375
                                                   005406
          SAVEDCOMMENT      A(20)                  000281D     000655M     000668M     000680M
                                                   000692M     000704M     001095      001096
                                                   001097M     002354M
          SAVEDLINETYPE     A(1)                   000247D     004999M     005003      005020
                                                   005162M     005183
          SAVEDNAME         A(80)                  000282D     001631      001650      001652
                                                   001810M     001820      001822      001859M
                                                   001888      001889M     001891      001894
                                                   001900      001904M     001907      001908
                                                   002083      002084M     002163M     002194
                                                   002195M     002273M     002280      002470
                                                   002485      002510M     005142M     005145M
                                                   005170      005172M     005172
          SAVEDSRCDTA       A(100)                 000258D     000748M     000752      000765M
                                                   000769      000778M     000782      001032M
                                                   001037      001090M     001100      001165M
                                                   001169      002345M     002350      003481M
                                                   003486      004998M     005126      005161M
                                                   005209      005220M     005308      005320M
                                                   005458
          SCANBASE          A(14)                  000288D     004357M     004360M     004367
                                                   004373
          SCANLENGTH        A(10)                  000289D     004346M     004349M     004364
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    208
                                                   004372
          SCANNORESULT      N(1)                   000291D     000433      000441M     004379M
                                                   004382M
          SCANSTART         A(10)                  000290D     004356M     004359M     004367
                                                   004373
          SCANSTRING        A(14)                  000287D     004347M     004350M     004366
                                                   004372
          SETOFF            N(1)                   000296D     001094      002596      002610M
                                                   004420M
          SETOFFIND1        A(2)                   000297D     002598      002599      004421M
          SETOFFIND2        A(2)                   000298D     002602      002603      004422M
          SETOFFIND3        A(2)                   000299D     002606      002607      004423M
          SETON             N(1)                   000301D     001094      002612      002626M
                                                   004438M
          SETONIND1         A(2)                   000302D     002614      002615      004439M
          SETONIND2         A(2)                   000303D     002618      002619      004440M
          SETONIND3         A(2)                   000304D     002622      002623      004441M
          SLCOUNT           P(5,0)                 000353D     000894M     000895      000913M
                                                   003503      003504
          SLLEVEL(99)       P(5,0)                 000354D     000895M     003504
 *RNF7031 SOURCEDATA        DS(100)                000086D
          SOURCELINE        A(93)                  000259D     000507M     000714M     000717M
                                                   000735M     000738M     000788M     000801
                                                   000807      000820      000841      000846M
                                                   000846      000853      000983      000996
                                                   001009      001010M     001010      001015M
                                                   001019      001020      001021      001022
                                                   001023      001024M     001024      001026M
                                                   001026      001058      001059      001064
                                                   001066      001069      001071      001092
                                                   001099M     001113      001115      001146
                                                   001193M     001614M     001619M     001808M
                                                   001857M     001895      002193M     002216M
                                                   002233M     002238M     002369M     002384M
                                                   002401M     002406M     002433M     002441M
                                                   002458M     002463M     002509M     002524M
                                                   002705M     002728M     002730M     002734M
                                                   002734      002738M     002738      002743M
                                                   002743      002787M     002789M     002792M
                                                   002792      002812M     002831M     002852M
                                                   002854M     002854      002861M     002862M
                                                   002864M     002864      002911M     002917M
                                                   002919M     002999M     003003M     003008M
                                                   003030M     003034M     003034      003036M
                                                   003036      003079M     003083M     003112M
                                                   003125M     003143M     003145M     003145
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    209
                                                   003199M     003201M     003201      003220M
                                                   003222M     003222      003248M     003250M
                                                   003261M     003261      003285M     003287M
                                                   003287      003293M     003295M     003297M
                                                   003297      003308M     003312M     003315M
                                                   003346M     003361M     003361      003365M
                                                   003365      003391M     003394M     003394
                                                   003396M     003396      003398M     003398
                                                   003401M     003401      003405M     003405
                                                   003425M     003427M     003441M     003454M
                                                   003518M     003546M     003548M     003551M
                                                   003551      003556M     003557M     003560M
                                                   003560      003583M     003599M     003603M
                                                   003605M     003605      003623M     003627M
                                                   003627      003629M     003629      003649M
                                                   003692M     003712M     003731M     003744M
                                                   003766M     003768M     003768      003776M
                                                   003778M     003778      003789M     003793M
                                                   003796M     003812M     003812      003816M
                                                   003816      003843M     003846M     003866M
                                                   003879M     003926M     003944M     003949M
                                                   003954M     003999M     004001M     004005M
                                                   004005      004009M     004009      004014M
                                                   004014      004027M     004041M     004063M
                                                   004066M     004092M     004094M     004108M
                                                   004127M     004141M     004143M     004175M
                                                   004177M     004199M     004202M     004207M
                                                   004207      004209M     004209      004234M
                                                   004254M     004274M     004277M     004277
                                                   004281M     004281      004284M     004284
                                                   004308M     004322M     004324M     004324
                                                   004366M     004371M     004380M     004380
                                                   004383M     004383      004407M     004456M
                                                   004459M     004459      004461M     004461
                                                   004490M     004503M     004505M     004505
                                                   004518M     004535M     004537M     004541M
                                                   004541      004545M     004545      004550M
                                                   004550      004602M     004604M     004607M
                                                   004607      004626M     004667M     004693M
                                                   004713M     004726M     004745M     004749M
                                                   004749      004751M     004751      004780M
                                                   004782M     004782      004790M     004792M
                                                   004792      004802M     004806M     004809M
                                                   004825M     004825      004829M     004829
                                                   004855M     004859M     004859      004861M
                                                   004861      004887M     004891M     004935M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    210
                                                   004939M     004939      004941M     004941
                                                   004960M     004964M     004964      004979M
                                                   004983M     004983
          SPLITLINE         PROTOTYPE              001787M     002172M     005721      005724
          SRCDAT            P(6,0)                1000003M    2000003
          SRCDTA            A(100)                 000087D     000088      000089      000090
                                                   000091      000092      000094      000095
                                                   000096      000097      000098      000099
                                                   000100      000101      000102      000103
                                                   000104      000105      000107      000109
                                                   000111      000112      000114      000115
                                                   000116      000117      000118      000119
                                                   000120      000121      000122      000123
                                                   000124      000126      000258     1000004M
                                                   000511      000748      000749M     000752M
                                                   000765      000766M     000769M     000778
                                                   000779M     000782M     001032      001037M
                                                   001090      001100M     001165      001166M
                                                   001169M     002345      002350M     003481
                                                   003486M     004998      005126M     005161
                                                   005209M     005220      005308M     005320
                                                   005417M     005440M     005458M    2000004
                                                   005647      005710M     005780      005829M
          SRCSEQ            P(6,2)                 000072      000242      000243      000266
                                                   000270     1000002M     001162      005157
                                                   005190      005251      005280      005303
                                                   005319      005453     2000002      005606
                                                   005643      005665      005684      005691
          SUBEXITPROGRAM    BEGSR                  000410      005481D     005559
          SUBINITIALISE     BEGSR                  000404      005529D
          SUBSTLEN          A(10)                  000293D     004657M     004670
          SUBSTSTART        A(10)                  000294D     004661M     004664M     004669
          SUBUSERCHECKSPAN  BEGSR                  001625      002246      002408      002465
                                                   002849      003280      003540      003596
                                                   003762      004776      004995D
          SUBUSERCONVERTC_SPEC...
                            BEGSR                  000657      001188D
          SUBUSERCONVERTD_SPEC...
                            BEGSR                  000682      001610D
          SUBUSERCONVERTF_SPEC...
                            BEGSR                  000694      002229D
          SUBUSERCONVERTH_SPEC...
                            BEGSR                  000706      002397D
          SUBUSERCONVERTP_SPEC...
                            BEGSR                  000670      002454D
          SUBUSERCVT_ACQ    BEGSR                  001215      002703D
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    211
          SUBUSERCVT_ADD    BEGSR                  001225      002723D
          SUBUSERCVT_ADDDUR BEGSR                  001220      002754D
          SUBUSERCVT_ALLOC  BEGSR                  001230      002810D
          SUBUSERCVT_BEGSR  BEGSR                  001235      002829D
          SUBUSERCVT_CALLP  BEGSR                  001240      002842D
          SUBUSERCVT_CASXX  BEGSR                  001245      002886D
          SUBUSERCVT_CAT    BEGSR                  001250      002954D
          SUBUSERCVT_CHAIN  BEGSR                  001255      003028D
          SUBUSERCVT_CHECKX BEGSR                  001260      003059D
          SUBUSERCVT_CLEAR  BEGSR                  001265      003110D
          SUBUSERCVT_CLOSE  BEGSR                  001270      003123D
          SUBUSERCVT_COMMIT BEGSR                  001275      003141D
          SUBUSERCVT_COMP   BEGSR                  001280      003162D
          SUBUSERCVT_DEALLOC...
                            BEGSR                  001285      003197D
          SUBUSERCVT_DELETE BEGSR                  001295      003218D
          SUBUSERCVT_DIV    BEGSR                  001300      003244D
          SUBUSERCVT_DO     BEGSR                  001321      003274D
          SUBUSERCVT_DSPLY  BEGSR                  001326      003389D
          SUBUSERCVT_DUMP   BEGSR                  001331      003422D
          SUBUSERCVT_ELSE   BEGSR                  001336      003439D
          SUBUSERCVT_ELSEIF BEGSR                  001341      003452D
          SUBUSERCVT_ENDXX  BEGSR                  001346      003465D
          SUBUSERCVT_EVALX  BEGSR                  001351      003533D
          SUBUSERCVT_EXCEPT BEGSR                  001356      003581D
          SUBUSERCVT_EXEC_SQL...
                            BEGSR                  001199      003594D
          SUBUSERCVT_EXFMT  BEGSR                  001361      003621D
          SUBUSERCVT_EXSR   BEGSR                  001366      003647D
          SUBUSERCVT_EXTRCT BEGSR                  001371      003660D
          SUBUSERCVT_FEOD   BEGSR                  001376      003710D
          SUBUSERCVT_FOR    BEGSR                  001381      003742D
          SUBUSERCVT_FORCE  BEGSR                  001386      003729D
          SUBUSERCVT_IF     BEGSR                  001391      003755D
          SUBUSERCVT_IN     BEGSR                  001396      003840D
          SUBUSERCVT_ITER   BEGSR                  001401      003864D
          SUBUSERCVT_LEAVE  BEGSR                  001406      003877D
          SUBUSERCVT_LOOKUP BEGSR                  001411      003890D
          SUBUSERCVT_MONITOR...
                            BEGSR                  001422      003924D
          SUBUSERCVT_MOVE   BEGSR                  001427      003937D
          SUBUSERCVT_MOVEA  BEGSR                  001416      003983D
          SUBUSERCVT_MULT   BEGSR                  001432      003994D
          SUBUSERCVT_MVR    BEGSR                  001437      004025D
 *RNF7031 SUBUSERCVT_NEXT   BEGSR                  004039D
          SUBUSERCVT_OCCUR  BEGSR                  001442      004060D
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    212
          SUBUSERCVT_ON_ERROR...
                            BEGSR                  001447      004089D
          SUBUSERCVT_OPEN   BEGSR                  001452      004106D
          SUBUSERCVT_OTHER  BEGSR                  001457      004125D
          SUBUSERCVT_OUT    BEGSR                  001462      004138D
          SUBUSERCVT_POST   BEGSR                  001467      004162D
          SUBUSERCVT_READ   BEGSR                  001472      004196D
 *RNF7031 SUBUSERCVT_REALLOC...
                            BEGSR                  004232D
          SUBUSERCVT_REL    BEGSR                  001477      004252D
          SUBUSERCVT_RESET  BEGSR                  001482      004272D
          SUBUSERCVT_RETURN BEGSR                  001487      004306D
          SUBUSERCVT_ROLBK  BEGSR                  001492      004320D
          SUBUSERCVT_SCAN   BEGSR                  001497      004341D
          SUBUSERCVT_SELECT BEGSR                  001502      004405D
          SUBUSERCVT_SETOFF BEGSR                  001513      004418D
          SUBUSERCVT_SETON  BEGSR                  001518      004436D
          SUBUSERCVT_SETXX  BEGSR                  001508      004454D
          SUBUSERCVT_SHTDN  BEGSR                  001523      004488D
          SUBUSERCVT_SORTA  BEGSR                  001528      004501D
 *RNF7031 SUBUSERCVT_SQRT   BEGSR                  004516D
          SUBUSERCVT_SUB    BEGSR                  001543      004529D
          SUBUSERCVT_SUBDUR BEGSR                  001533      004561D
          SUBUSERCVT_SUBST  BEGSR                  001538      004645D
          SUBUSERCVT_TEST   BEGSR                  001560      004687D
          SUBUSERCVT_TIME   BEGSR                  001565      004711D
          SUBUSERCVT_UNLOCK BEGSR                  001575      004724D
          SUBUSERCVT_UPDATE BEGSR                  001570      004743D
          SUBUSERCVT_WHEN   BEGSR                  001580      004769D
          SUBUSERCVT_WRITE  BEGSR                  001585      004853D
 *RNF7031 SUBUSERCVT_XFOOT  BEGSR                  004884D
          SUBUSERCVT_XLATE  BEGSR                  001590      004904D
          SUBUSERCVT_Z_ADD  BEGSR                  001595      004958D
          SUBUSERCVT_Z_SUB  BEGSR                  001600      004976D
          SUBUSEREXITPROGRAM...
                            BEGSR                  005483      005504D
          SUBUSERFUNCTION   BEGSR                  000407      000417D
 *RNF7031 SUBUSERGETDECLARATIONTYPE...
                            BEGSR                  005135D
          SUBUSERGETENDLINE BEGSR                  001878      005218D
          SUBUSERINITIALISE BEGSR                  005539      005548D
          SUBUSERMOVEDEFS   BEGSR                  000967      005317D
          SUBUSERREFORMATLINE...
                            BEGSR                  000428      000437      000439      000447
                                                   000495D     002545      002556      002567
                                                   002578      002589      002600      002604
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    213
                                                   002608      002616      002620      002624
                                                   002636      002641      002646      002657
                                                   002659      002661      002672      002674
                                                   002676      002687      002689      002691
          SUBUSERSETINDICATORS...
                            BEGSR                  000430      002537D
          SUBUSERWRITELINE  BEGSR                  000751      000768      000781      001036
                                                   001117      001124      001168      002349
                                                   003485      005419      005421      005423
                                                   005432      005442      005444      005446
                                                   005467D
          TEMPDECLLINE      P(6,2)                 000270D     005265
          TEMPDECLTYPE      A(2)                   000269D     005263      005266
          TEMPSAVEDNAME     A(80)                  000271D     005264
          TOFILELIB         A(21)                  000215D     000462      005572M
          UNINDENT          N(1)                   000239D     000875M     000911M     000916M
                                                   000919M     000923M     000927M     000930M
                                                   000934M     000938M     000942M     000946M
                                                   000951M     000955M     000972      000975M
          UP                CONST                  000079D     000501      000502      000654
                                                   000726      000727      000819      000820
                                                   000832      000836      000856      000867
                                                   001622      001643      001674      001690
                                                   001701      001725      001757      001764
                                                   001822      001936      001953      001964
                                                   001986      002044      002048      002050
                                                   002071      002073      002090      002113
                                                   002120      002128      002135      002143
                                                   002240      002241      002242      002243
                                                   002244      002275      002280      002764
                                                   002960      003305      003670      003786
                                                   003953      004579      004611      004651
                                                   004799      004999      005017      005052
                                                   005141      005162      005181      005189
                                                   005229      005234      005330      005332
                                                   005337      005339      005352      005373
                                                   005376      005387      005406      005622
                                                   005648      005664      005674      005683
                                                   005690      005786      005801
          VALIDSPECS        CONST                  000080D     000540
          WHENCOMPARE       A(2)                   000341D     004801M     004805M     004808M
                                                   004812      004813M     004814      004815M
                                                   004816      004817M     004818      004819M
                                                   004820      004821M     004822      004823M
                                                   004826
          WHENOPERATOR      A(10)                  000340D     004773      004839M     004841M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    214
          WORKDECLATTR      A(1)                   000264D     001622M     001656      001661M
                                                   001664M     001666M     001671      001673
                                                   001686      001688      001699      001710
                                                   001712      001714      001716      001718
                                                   001720      001722      001724      001739
                                                   001740      001741      001742      001743
                                                   001744      001896M     001913      001918M
                                                   001921M     001923M     001928      001930
                                                   001949      001951      001962      001973
                                                   001975      001977      001979      001981
                                                   001983      001985      002000      002001
                                                   002002      002003      002004      002005
                                                   002011      002013
          WORKDECLKEYWORDS  A(92)                  000267D     001623M     001643      001674
                            VARYING(2)             001678M     001678      001680M     001680
                                                   001681      001690      001692      001693
                                                   001695      001697M     001697      001701
                                                   001703      001704      001706      001708M
                                                   001708      001725      001728M     001728
                                                   001757      001759      001761      001762M
                                                   001762      001764      001766      001773
                                                   001776M     001776      001784      001787
                                                   001792      001795      001826      001828
                                                   001831      001936      001940M     001940
                                                   001942M     001942      001943      001953
                                                   001955      001956      001958      001960M
                                                   001960      001964      001966      001967
                                                   001969      001971M     001971      001986
                                                   001989M     001989      002036M     002038M
                                                   002039      002044      002046      002049
                                                   002051      002054M     002056      002057
                                                   002059M     002060      002062      002063
                                                   002071      002073      002082M     002082
                                                   002090      002092M     002093      002095M
                                                   002095      002103      002107      002108M
                                                   002113      002115      002117      002118M
                                                   002118      002120      002122      002128
                                                   002130      002132      002133M     002133
                                                   002135      002137      002143      002145
                                                   002155      002157      002160M     002160
                                                   002169      002172      002177      002180
                                                   002212
          WORKDECLLINE      P(6,2)                 000266D     001631      002470      005157M
                                                   005164M     005190M     005251
          WORKDECLNAME      A(50)                  000265D     001178M     001894M     002050
          WORKDECLTYPE      A(2)                   000263D     001631      001637      001816
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    215
                                                   001865      001867      001869      001879
                                                   001881      001883      001887      001893
                                                   002470      002473      002474      002480
                                                   005141M     005144M     005149      005150
                                                   005151      005152      005153      005154
                                                   005155      005156      005189M
          WORKDIRECTIVE     A(10)                  000261D     000501M     000545      000561
                                                   000567      000571      000575      000579
                                                   000583      000587      000591      000595
                                                   000596      000603      000618      000761
                                                   000871      000874      001198      001203
                                                   003598
          WORKFILEADD       A(1)                   000275D     002242M     002257      002289
                                                   002299
          WORKFILEDESIG     A(1)                   000274D     002241M     002252      002253
                                                   002260      002261      002264
          WORKFILEDEVICE    A(7)                   000277D     002243M     002283      002284
                                                   002290      002291      002292      002305
                                                   002309
          WORKFILEKEYED     A(1)                   000276D     002244M     002320
          WORKFILEUSAGE     A(1)                   000273D     002240M     002251      002254
                                                   002256      002259      002263      002288
                                                   002298      002304      002308
          WORKLENGTH        P(7,0)                 000279D     002009M     002012M     002012
                                                   002014M     002014      002016      002018
          WORKLINETYPE      A(1)                   000262D     000502M     000520      000527
                                                   000530      000532      000534      000536
                                                   000538      000540      000541M     000552M
                                                   000570M     000574M     000578M     000582M
                                                   000586M     000590M     000594M     000600
                                                   000608      000608      000610M     000625M
                                                   000628      000630      000651      000664
                                                   000677      000689      000701      000713
                                                   000716      000719      000845      005229
          X                 P(5,0)                 000205D     000841M     000842      000987M
                                                   000988      000989      000991M     000992
                                                   000993      000996M     000997      001674M
                                                   001675      001677      001678      001680
                                                   001681      001690M     001691      001692M
                                                   001692      001693      001695      001695
                                                   001701M     001702      001703M     001703
                                                   001704      001706      001706      001725M
                                                   001726      001728      001757M     001758
                                                   001759      001761      001761      001762
                                                   001764      001764      001784M     001785
                                                   001786M     001786      001787      001936M
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    216
                                                   001937      001939      001940      001942
                                                   001943      001953M     001954      001955M
                                                   001955      001956      001958      001958
                                                   001964M     001965      001966M     001966
                                                   001967      001969      001969      001986M
                                                   001987      001989      002044M     002045
                                                   002046      002049      002049      002053
                                                   002060      002071M     002072      002073M
                                                   002075      002113M     002114      002115
                                                   002117      002117      002118      002120
                                                   002120      002128M     002129      002130
                                                   002132      002132      002133      002135
                                                   002135      002143M     002144      002145
                                                   002169M     002170      002171M     002171
                                                   002172      002726M     002727      002757M
                                                   002758      002763      002764      002957M
                                                   002958      002976M     002977      002981
                                                   002982      003074M     003077      003084
                                                   003085      003663M     003664      003669
                                                   003670      003940M     003942      003947
                                                   003997M     003998      004344M     004345
                                                   004349      004350      004354M     004355
                                                   004359      004360      004532M     004533
                                                   004564M     004565      004566M     004567
                                                   004578      004579      004610      004611
                                                   004648M     004649      004659M     004660
                                                   004662M     004664      004668      004916M
                                                   004917      004920      004921      004925M
                                                   004926      004930      004931      005000M
                                                   005015M     005122      005163M     005170M
                                                   005171      005172      005173M     005179M
                                                   005205      005226M     005276M     005290
                                                   005405M     005406
          XLATEBASE         A(14)                  000308D     004928M     004931M     004937
          XLATEFROM         A(14)                  000306D     004920M     004936
          XLATESTART        A(10)                  000309D     004927M     004930M     004938
                                                   004939
          XLATETO           A(14)                  000307D     004921M     004936
          Y                 P(5,0)                 000206D     001693M     001695      001697
                                                   001704M     001706      001708      001956M
                                                   001958      001960      001967M     001969
                                                   001971
          ZTFRFL            A(21)                  000461M    4000002
          ZTTOFL            A(21)                  000462M    4000003
          Z1CNVR            P(5,2)                 000478M     000480M    6000010
          Z1CTCV            P(7,0)                 000474M    6000008
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    217
          Z1CTEL            P(7,0)                 000473M    6000007
          Z1CTMV            P(7,0)                 000476M    6000006
          Z1CTNV            P(7,0)                 000475M    6000009
          Z1CTSC            P(7,0)                 000471M    6000004
          Z1CTTG            P(7,0)                 000472M    6000005
          Z1FRMB            A(10)                  000469M    6000002
          Z1QPAG            P(4,0)                 000458M    3000005
          Z1QPGM            A(10)                 3000002
          Z1QTTL            A(40)                  005565M    3000004
          Z1QUSR            A(10)                 3000003
          Z1TOMB            A(10)                  000470M    6000003
       Field References for subprocedure GETDECLARATIONTYPE
          Field             Attributes         References (D=Defined M=Modified)
          QPDECLLINE        P(6,2)                 005606D     005643M     005650M     005665M
                            BASED(_QRNL_PST+)      005684M     005691M
          QPDECLTYPE        A(2)                   005604D     005622M     005625M     005635
                            BASED(_QRNL_PST+)      005636      005637      005638      005639
                                                   005640      005641      005642      005664M
                                                   005683M     005690M
          QPSAVEDNAME       A(80)                  005605D     005623M     005626M     005629
                            BASED(_QRNL_PST+)      005631M     005631      005656      005658M
                                                   005658
          SAVEDLINETYPE     A(1)                   005612D     005648M     005676
          SAVEDSRCDTA       A(100)                 005614D     005647M     005710
          X                 P(3,0)                 005613D     005629M     005630      005631
                                                   005649M     005656M     005657      005658
                                                   005659M     005672M     005706
       Field References for subprocedure SPLITLINE
          Field             Attributes         References (D=Defined M=Modified)
          QPCURRENTLINE     A(92)                  005725D     005738      005745      005747
                            BASED(_QRNL_PST+)      005748M     005748
                            VARYING(2)
          QPMAXLENGTH       P(3,0)                 005727D     005739      005740
                            BASED(_QRNL_PST+)
          QPOVERFLOW        A(92)                  005726D     005737M     005747M
                            BASED(_QRNL_PST+)
                            VARYING(2)
          X                 P(3,0)                 005733D     005738M     005739      005740M
                                                   005744      005744      005745      005747
                                                   005748
       Field References for subprocedure ADJUSTARRAYLENGTH
          Field             Attributes         References (D=Defined M=Modified)
          ELEMENTS          P(5,0)                 005775D     005790M     005792      005793
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    218
          I                 P(3,0)                 005773D     005786M     005788      005789
                                                   005790      005790      005825
          J                 P(3,0)                 005774D     005789M     005790
          QPLENGTH          P(7,0)                 005766D     005792      005793M     005793
                            BASED(_QRNL_PST+)
          SAVEDSRCDTA       A(100)                 005776D     005780M     005829
          X                 P(3,0)                 005772D     005781M     005799M     005825
       Indicator References:
          Indicator                            References (D=Defined M=Modified)
          LR                                       005492M
        * * * * *   E N D   O F   C R O S S   R E F E R E N C E   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    219
                       E x t e r n a l   R e f e r e n c e s
       Statically bound procedures:
          Procedure                            References
          No references in the source.
       Imported fields:
          Field             Attributes         Defined
          No references in the source.
       Exported fields:
          Field             Attributes         Defined
          No references in the source.
    * * * * *   E N D   O F   E X T E R N A L   R E F E R E N C E S   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    220
                           M e s s a g e   S u m m a r y
  Msg id  Sv Number Message text
 *RNF7031 00     13 The name or indicator is not referenced.
 *RNF7066 00      1 Record-Format name of Externally-Described file is not used.
 *RNF7086 00      1 RPG handles blocking for the file. INFDS is updated only when
                    blocks of data are transferred.
 *RNF7099 00      1 A COMMIT or ROLBK operation is used in the program with no
                    files defined with commitment control.
 *RNF3776 10      1 External program on prototype for main procedure is not the
                    same as program being created.
        * * * * *   E N D   O F   M E S S A G E   S U M M A R Y   * * * * *
  5770WDS V7R2M0  140418 RN        IBM ILE RPG             CVTRPGFREE/CVTRPGFRER    DKSRV206   25-06-20 14:37:53        Page    221
                             F i n a l   S u m m a r y
   Message Totals:
     Information  (00) . . . . . . . :       16
     Warning      (10) . . . . . . . :        1
     Error        (20) . . . . . . . :        0
     Severe Error (30+)  . . . . . . :        0
     ---------------------------------  -------
     Total . . . . . . . . . . . . . :       17
   Source Totals:
     Records . . . . . . . . . . . . :     5853
     Specifications  . . . . . . . . :     3788
     Data records  . . . . . . . . . :       81
     Comments  . . . . . . . . . . . :     1050
          * * * * *   E N D   O F   F I N A L   S U M M A R Y   * * * * *
 Program CVTRPGFRER placed in library CVTRPGFREE. 10 highest severity. Created on 25-06-20 at 14:37:54.
           * * * * *   E N D   O F   C O M P I L A T I O N   * * * * *
